{"version":3,"sources":["webpack:///./client/libs/laya.core.js","webpack:///./client/libs/laya.webgl.js","webpack:///./client/libs/laya.html.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA,iDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf,eAAc,kEAAkE;AAChF,eAAc,8EAA8E;AAC5F,aAAY,oDAAoD;AAChE;AACA,6BAA4B,qHAAqH;AACjJ,4BAA2B,4BAA4B,0BAA0B,GAAG;AACpF,yBAAwB,iEAAiE;AACzF;AACA;AACA;AACA,gBAAe,KAAK;AACpB;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,gC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,+BAA+B,EAAE,yBAAyB,qBAAqB,2CAA2C;AAC5I,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,kCAAiC,KAAK;AACtC;AACA,0BAAyB;AACzB;AACA;AACA,2DAA0D;AAC1D,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA,0BAAyB;AACzB;AACA,kCAAiC;AACjC;AACA;AACA;AACA;AACA,iBAAgB,gBAAgB;AAChC;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA,gBAAe,iBAAiB,mBAAmB,0BAA0B;AAC7E,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,sBAAsB;AAClD,IAAG;AACH;AACA;AACA,8CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,qCAAqC;AACvE;AACA,4CAA2C,2BAA2B;AACtE,4CAA2C,2BAA2B;AACtE;AACA,IAAG;AACH;AACA,+BAA8B,KAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,kBAAkB,oCAAoC;AAC7E,yBAAwB,kBAAkB,cAAc,qCAAqC;AAC7F;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,8BAA6B,eAAe;AAC5C;AACA;;AAEA,qCAAoC,iBAAiB;AACrD;AACA,wCAAuC;AACvC;AACA,iDAAgD,kBAAkB;;AAElE;AACA,EAAC;;AAED;AACA;;AAEA,EAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,wCAAuC,4GAA4G;AACnJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yBAAwB,4BAA4B;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D,YAAY,mBAAmB,SAAS,kBAAkB,QAAQ;AACjI;AACA;AACA;AACA;AACA,YAAW;AACX;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA,mBAAkB,gCAAgC,KAAK;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,kEAAkE,4BAA4B;AAC1H;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;;AAEA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,iDAAiD,EAAE,4EAA4E;AACrJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,4CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,MAAM;AACvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D;AAC7D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA4B,UAAU;AACtC,2BAA0B,kDAAkD;AAC5E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,kCAAiC,QAAQ;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B,sCAAsC,0BAA0B;AAC5F;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC,MAAM;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC,MAAM;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,MAAM;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,4BAA4B;AACjD;AACA;AACA;AACA,wCAAuC,SAAS;AAChD;AACA,0CAAyC,qBAAqB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,kCAAkC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,MAAM;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAkB;AAClB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA,gBAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA0C,MAAM;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA0C,MAAM;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA0C,MAAM;AAChD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA0C,MAAM;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,kCAAkC,4BAA4B,2BAA2B,sBAAsB,UAAU;AAC7I;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,QAAQ;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,MAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,MAAM;AACvB;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,OAAO;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,8BAA8B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,6CAA6C;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,6CAA6C;AAC7D;AACA,kBAAiB,6DAA6D;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,6CAA6C;AAC7D;AACA,kBAAiB,6DAA6D;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C,qBAAqB,2BAA2B,mBAAmB;AAC/G,2CAA0C,qBAAqB,yBAAyB,mBAAmB;AAC3G,0CAAyC,qBAAqB,wBAAwB,mBAAmB;AACzG,2CAA0C,qBAAqB,yBAAyB,mBAAmB;AAC3G;AACA;AACA,oBAAmB,2CAA2C;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,wDAAuD,4JAA4J,yCAAyC;AAC5P,kDAAiD,aAAa;AAC9D;AACA;AACA,qCAAoC,kBAAkB,0BAA0B,qBAAqB,UAAU,OAAO;AACtH,yBAAwB,oCAAoC,0CAA0C;AACtG;AACA;AACA,sDAAqD,GAAG,GAAG;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,kDAAkD;AAC1F;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,OAAO;AACvC;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW,MAAM;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,MAAM;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;AACR;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA4B,yBAAyB;AACrD;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB;AACpB;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,MAAM;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,kCAAkC,uBAAuB;AAC9E;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,4BAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD,aAAa,gBAAgB,gBAAgB,iCAAiC,YAAY,mBAAmB,SAAS,QAAQ,UAAU,WAAW;AACtM;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB;AACvB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB,mBAAkB;AAClB,mBAAkB;AAClB,mBAAkB;AAClB;AACA,oBAAmB;AACnB;AACA;AACA,qBAAoB;AACpB,OAAM;AACN;AACA,qBAAoB;AACpB;AACA,MAAK;AACL,oBAAmB;AACnB;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA2D,iCAAiC,eAAe,mBAAmB,aAAa,YAAY,kCAAkC,oCAAoC;AAC7N;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yCAAwC,MAAM;AAC9C;AACA;AACA,kCAAiC;AACjC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA2B,0GAA0G;AACrI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,0GAA0G;AACrI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,QAAQ;AACtB;AACA;AACA,eAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA0C;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,MAAM;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,8CAA6C;AAC7C;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,mCAAkC,oBAAoB;AACtD;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gEAA+D;AAC/D;AACA;;AAEA;AACA,yBAAwB;AACxB,yDAAwD,aAAa;AACrE,uBAAsB;AACtB,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,8BAA8B;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,mCAAmC,8BAA8B,2JAA2J,kBAAkB,iMAAiM,0BAA0B,mEAAmE,gBAAgB;AACnjB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,mBAAmB;AACpC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,+BAA8B;AAC9B;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,QAAQ;AAClD;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,4BAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,sBAAsB;AACtC;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,2BAA2B,EAAE,2BAA2B;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,cAAc;AAC/B;AACA,iDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAuD,kDAAkD,EAAE,iDAAiD;AAC5J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAuC,kDAAkD,EAAE,iDAAiD;AAC5I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,cAAc;AAC9B;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,2BAA0B,uBAAuB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,mEAAmE;AACxF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,qCAAqC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,6CAA4C,MAAM;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,0CAAyC,MAAM;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,+CAA8C,MAAM;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,mCAAkC;AAClC;AACA;AACA;AACA;AACA,0BAAyB;AACzB,6CAA4C;AAC5C,mBAAkB;AAClB,mBAAkB;AAClB,sBAAqB;AACrB,sBAAqB;AACrB,kCAAiC;AACjC,gDAA+C;AAC/C,yBAAwB;AACxB,iEAAgE;AAChE,kBAAiB;AACjB,kBAAiB;AACjB,sBAAqB;AACrB,uBAAsB;AACtB,sBAAqB;AACrB,sBAAqB;AACrB,iCAAgC;AAChC,8CAA6C;AAC7C;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB,iCAAgC;AAChC;AACA;AACA;AACA;AACA,qCAAoC;AACpC,2CAA0C;AAC1C,iBAAgB;AAChB,iBAAgB;AAChB,oBAAmB;AACnB,oBAAmB;AACnB,gCAA+B;AAC/B,8CAA6C;AAC7C,oCAAmC;AACnC,+DAA8D;AAC9D,gBAAe;AACf,gBAAe;AACf,oBAAmB;AACnB,qBAAoB;AACpB,oBAAmB;AACnB,oBAAmB;AACnB,+BAA8B;AAC9B,wDAAuD;AACvD;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB,kCAAiC;AACjC;AACA;AACA;AACA,8BAA6B;AAC7B,iDAAgD;AAChD,uBAAsB;AACtB,uBAAsB;AACtB,0BAAyB;AACzB,0BAAyB;AACzB,sCAAqC;AACrC,qEAAoE;AACpE,6BAA4B;AAC5B,qEAAoE;AACpE,sBAAqB;AACrB,sBAAqB;AACrB,0BAAyB;AACzB,2BAA0B;AAC1B,0BAAyB;AACzB,0BAAyB;AACzB,qCAAoC;AACpC,mEAAkE;AAClE;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,4BAA4B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA,qCAAoC,QAAQ;AAC5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAgC,MAAM;AACtC;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH,4DAA2D;AAC3D;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAQ,6CAA6C,UAAU;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,mCAAkC;AAClC;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA,2BAA0B;AAC1B,wBAAuB;AACvB,qBAAoB;AACpB,uBAAsB;AACtB,yBAAwB;AACxB,iBAAgB;AAChB,iBAAgB;AAChB,qBAAoB;AACpB,sBAAqB;AACrB,uBAAsB;AACtB,iCAAgC;AAChC,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB,iCAAgC;AAChC;AACA;AACA;AACA;AACA,qCAAoC;AACpC;AACA,yBAAwB;AACxB,sBAAqB;AACrB,mBAAkB;AAClB,qBAAoB;AACpB,uBAAsB;AACtB,eAAc;AACd,eAAc;AACd,mBAAkB;AAClB,oBAAmB;AACnB,qBAAoB;AACpB,+BAA8B;AAC9B,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB,kCAAiC;AACjC;AACA;AACA;AACA,wDAAuD;AACvD;AACA,0BAAyB;AACzB,uBAAsB;AACtB,oBAAmB;AACnB,sBAAqB;AACrB,wBAAuB;AACvB,gBAAe;AACf,gBAAe;AACf,oBAAmB;AACnB,qBAAoB;AACpB,sBAAqB;AACrB,gCAA+B;AAC/B,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uCAAsC,EAAE;AACxC;AACA;AACA,0BAAyB,EAAE,KAAK,EAAE;AAClC,0DAAyD,EAAE,UAAU,EAAE;AACvE,YAAW,EAAE,EAAE,EAAE;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,qCAAoC,MAAM;AAC1C,0BAAyB,MAAM;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA,qBAAoB,MAAM;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,MAAM;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA,8CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,MAAM;AACzC;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,mCAAkC;AAClC,aAAY;AACZ;AACA;AACA;AACA,8CAA6C;AAC7C,uDAAsD;AACtD,sBAAqB;AACrB,sBAAqB;AACrB,4BAA2B;AAC3B,uBAAsB;AACtB,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB,iCAAgC;AAChC,WAAU;AACV;AACA;AACA;AACA,uCAAsC;AACtC,qDAAoD;AACpD,oBAAmB;AACnB,oBAAmB;AACnB,0BAAyB;AACzB,qBAAoB;AACpB,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB;AACvB,kCAAiC;AACjC;AACA;AACA;AACA,kDAAiD;AACjD,sDAAqD;AACrD,qBAAoB;AACpB,qBAAoB;AACpB,2BAA0B;AAC1B,sBAAqB;AACrB,oCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA,MAAK;AACL,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2GAA0G,+BAA+B,sDAAsD,+BAA+B,wDAAwD,+BAA+B,gEAAgE,+BAA+B;AACpZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,uCAAuC;AACrF;;AAEA;AACA;AACA,qCAAoC,gBAAgB,YAAY,qBAAqB,6BAA6B,0BAA0B,wBAAwB;AACpK;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC,2CAA0C;AAC1C,kCAAiC,yBAAyB;AAC1D;AACA,0CAAyC;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA,GAAE;;;AAGF;AACA,EAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA,sDAAqD;AACrD,qCAAoC;AACpC;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA,kBAAiB,WAAW;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,WAAW;AAC5B;AACA;AACA,mBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,kBAAiB,OAAO;AACxB;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA,kBAAiB,OAAO;AACxB;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA,iBAAgB,iBAAiB;AACjC,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA,kBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,MAAM;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA4C,MAAM;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B,QAAQ;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mFAAkF,wBAAwB;AAC1G,mHAAkH;AAClH,+EAA8E,2BAA2B,wBAAwB,wBAAwB,0BAA0B,0BAA0B,wBAAwB,wBAAwB;AAC7P,2FAA0F,oEAAoE,yCAAyC,uEAAuE,yGAAyG,mCAAmC,+BAA+B,uCAAuC,oBAAoB,mBAAmB,MAAM,qBAAqB,mBAAmB,MAAM,sFAAsF,kGAAkG,IAAI,GAAG,4DAA4D;AACtzB,+EAA8E,8EAA8E,6EAA6E,4EAA4E,4EAA4E,4EAA4E,6EAA6E,8EAA8E;AACxmB,yFAAwF;AACxF,iFAAgF,iCAAiC;AACjH,yHAAwH,iEAAiE,iEAAiE,iEAAiE,iEAAiE,iEAAiE;AAC7b,8EAA6E;AAC7E,kHAAiH;AACjH;AACA,gCAA+B,0BAA0B,oBAAoB,uCAAuC,kCAAkC,+DAA+D,eAAe,8CAA8C,+EAA+E,uGAAuG,wCAAwC,6DAA6D,GAAG;AAChjB,gCAA+B,0BAA0B,0BAA0B,4BAA4B,sBAAsB,6DAA6D,8DAA8D,4DAA4D,wDAAwD,iBAAiB,gDAAgD,oBAAoB,wBAAwB,yDAAyD,iEAAiE,+DAA+D,6DAA6D,GAAG;AAC1tB;AACA,gCAA+B,oBAAoB,oBAAoB,eAAe,2BAA2B,+EAA+E,GAAG;AACnM,gCAA+B,qBAAqB,sBAAsB,8DAA8D,eAAe,qDAAqD,eAAe,oBAAoB,6DAA6D,GAAG;AAC/S;AACA,gCAA+B,yBAAyB,oBAAoB,uBAAuB,qBAAqB,oBAAoB,qBAAqB,cAAc,sFAAsF,+BAA+B,+EAA+E,kBAAkB,GAAG;AACxY,gCAA+B,4BAA4B,qBAAqB,sBAAsB,cAAc,+CAA+C,gBAAgB,0DAA0D,GAAG;AAChP;AACA,gCAA+B,0BAA0B,oBAAoB,uCAAuC,kCAAkC,+DAA+D,eAAe,8CAA8C,+EAA+E,uGAAuG,wCAAwC,6DAA6D,GAAG;AAChjB,gCAA+B,0BAA0B,0BAA0B,4BAA4B,sBAAsB,0BAA0B,wBAAwB,6DAA6D,8DAA8D,4DAA4D,wDAAwD,iBAAiB,sBAAsB,gFAAgF,gFAAgF,iDAAiD,oBAAoB,wBAAwB,yDAAyD,iEAAiE,+DAA+D,6DAA6D,GAAG;AACn8B;AACA,gCAA+B,0BAA0B,uBAAuB,oBAAoB,wBAAwB,wBAAwB,oBAAoB,uBAAuB,0BAA0B,uBAAuB,eAAe,2EAA2E,gFAAgF,oBAAoB,0BAA0B,KAAK;AAC7c,gCAA+B,0BAA0B,uBAAuB,4BAA4B,sBAAsB,eAAe,iDAAiD,yCAAyC,2CAA2C,GAAG;AACzR;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,gCAAgC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,gCAAgC;AACrD;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2EAA0E;AAC1E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;;AAEA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,gEAAgE,yBAAyB;AAClH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,MAAM;AACjC,gCAA+B,OAAO;AACtC,gCAA+B,OAAO;AACtC,6BAA4B,OAAO;AACnC,6BAA4B,OAAO;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAkB,QAAQ;AAC1B;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,yBAAyB,mBAAmB,mBAAmB,yBAAyB,cAAc,kCAAkC,gBAAgB,4EAA4E,uBAAuB,EAAE,2BAA2B,yBAAyB,2BAA2B,cAAc,2CAA2C,cAAc,sBAAsB;AAC1d;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,MAAM;AAC9B,mBAAkB,UAAU;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,2EAA2E,uBAAuB,mEAAmE,uBAAuB,oEAAoE,yBAAyB;AACpT;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,MAAM;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,MAAM;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,2CAA2C,6BAA6B;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC;AACjC,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAiD,MAAM;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,cAAc;AAC1B;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,aAAY,gBAAgB;AAC5B;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,MAAM;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D,YAAY;AACzE;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAY;AACZ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,6BAA6B,+2BAA+2B,sBAAsB;AACl8B;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,8BAA8B;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA,GAAE;;;AAGF;AACA;AACA,GAAE;;;AAGF;AACA;AACA;;;AAGA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;;AAEA,EAAC;;;;;;;;;;;;;ACjpxBD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA,sDAAqD;AACrD,qCAAoC;AACpC;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA,kBAAiB,WAAW;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,WAAW;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,WAAW;AAC5B;AACA;AACA,mBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,kBAAiB,OAAO;AACxB;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA,kBAAiB,OAAO;AACxB;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA,iBAAgB,iBAAiB;AACjC,kBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA,kBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,MAAM;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA4C,MAAM;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B,QAAQ;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,wCAAwC;AAC7D,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mFAAkF,wBAAwB;AAC1G,mHAAkH;AAClH,+EAA8E,2BAA2B,wBAAwB,wBAAwB,0BAA0B,0BAA0B,wBAAwB,wBAAwB;AAC7P,2FAA0F,oEAAoE,yCAAyC,uEAAuE,yGAAyG,mCAAmC,+BAA+B,uCAAuC,oBAAoB,mBAAmB,MAAM,qBAAqB,mBAAmB,MAAM,sFAAsF,kGAAkG,IAAI,GAAG,4DAA4D;AACtzB,+EAA8E,8EAA8E,6EAA6E,4EAA4E,4EAA4E,4EAA4E,6EAA6E,8EAA8E;AACxmB,yFAAwF;AACxF,iFAAgF,iCAAiC;AACjH,yHAAwH,iEAAiE,iEAAiE,iEAAiE,iEAAiE,iEAAiE;AAC7b,8EAA6E;AAC7E,kHAAiH;AACjH;AACA,gCAA+B,0BAA0B,oBAAoB,uCAAuC,kCAAkC,+DAA+D,eAAe,8CAA8C,+EAA+E,uGAAuG,wCAAwC,6DAA6D,GAAG;AAChjB,gCAA+B,0BAA0B,0BAA0B,4BAA4B,sBAAsB,6DAA6D,8DAA8D,4DAA4D,wDAAwD,iBAAiB,gDAAgD,oBAAoB,wBAAwB,yDAAyD,iEAAiE,+DAA+D,6DAA6D,GAAG;AAC1tB;AACA,gCAA+B,oBAAoB,oBAAoB,eAAe,2BAA2B,+EAA+E,GAAG;AACnM,gCAA+B,qBAAqB,sBAAsB,8DAA8D,eAAe,qDAAqD,eAAe,oBAAoB,6DAA6D,GAAG;AAC/S;AACA,gCAA+B,yBAAyB,oBAAoB,uBAAuB,qBAAqB,oBAAoB,qBAAqB,cAAc,sFAAsF,+BAA+B,+EAA+E,kBAAkB,GAAG;AACxY,gCAA+B,4BAA4B,qBAAqB,sBAAsB,cAAc,+CAA+C,gBAAgB,0DAA0D,GAAG;AAChP;AACA,gCAA+B,0BAA0B,oBAAoB,uCAAuC,kCAAkC,+DAA+D,eAAe,8CAA8C,+EAA+E,uGAAuG,wCAAwC,6DAA6D,GAAG;AAChjB,8BAA6B,0BAA0B,0BAA0B,4BAA4B,sBAAsB,0BAA0B,wBAAwB,6DAA6D,8DAA8D,4DAA4D,wDAAwD,iBAAiB,sBAAsB,gFAAgF,gFAAgF,iDAAiD,oBAAoB,wBAAwB,yDAAyD,iEAAiE,+DAA+D,6DAA6D,GAAG;AACj8B;AACA,gCAA+B,0BAA0B,uBAAuB,oBAAoB,wBAAwB,wBAAwB,oBAAoB,uBAAuB,0BAA0B,uBAAuB,eAAe,2EAA2E,gFAAgF,oBAAoB,0BAA0B,KAAK;AAC7c,gCAA+B,0BAA0B,uBAAuB,4BAA4B,sBAAsB,eAAe,iDAAiD,yCAAyC,2CAA2C,GAAG;AACzR;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,MAAM;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,gCAAgC;AACrD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,YAAY;AAC5B;AACA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,gCAAgC;AACrD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2EAA0E;AAC1E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA8B,MAAM;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;;AAEA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,gEAAgE,yBAAyB;AAClH;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,MAAM;AACjC,gCAA+B,OAAO;AACtC,gCAA+B,OAAO;AACtC,6BAA4B,OAAO;AACnC,6BAA4B,OAAO;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAkB,QAAQ;AAC1B;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,yBAAyB,mBAAmB,mBAAmB,yBAAyB,cAAc,kCAAkC,gBAAgB,4EAA4E,uBAAuB,EAAE,2BAA2B,yBAAyB,2BAA2B,cAAc,2CAA2C,cAAc,sBAAsB;AAC1d;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,MAAM;AAC9B,mBAAkB,UAAU;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAgB,iBAAiB;AACjC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,uBAAuB;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,2EAA2E,uBAAuB,mEAAmE,uBAAuB,oEAAoE,yBAAyB;AACpT;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,MAAM;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,MAAM;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,2CAA2C,6BAA6B;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC;AACjC,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,WAAW,WAAW;AACvC,gBAAe,SAAS,SAAS;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAuB;AACvB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,oCAAoC;AACzD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAiD,MAAM;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,8BAA8B;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA,GAAE;;;AAGF;AACA;AACA,GAAE;;;AAGF;AACA;AACA;;;AAGA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,cAAc;AAC1B;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,aAAY,gBAAgB;AAC5B;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,MAAM;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,MAAM;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D,YAAY;AACzE;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,iBAAgB,MAAM;AACtB;AACA;AACA;AACA,oBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAY;AACZ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,6BAA6B,+2BAA+2B,sBAAsB;AACl8B;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,YAAY;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,6CAA6C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA,EAAC;;;;;;;;;;;;AC7pQD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,MAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA,iCAAgC,OAAO;AACvC;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,wBAAwB;AAC1C;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,MAAM;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,MAAM;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,wCAAuC,WAAW;AAClD;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,KAAI;AACJ;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA,gCAA+B,MAAM;AACrC;AACA;AACA;AACA;;AAEA,2BAA0B;AAC1B;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,yCAAwC,QAAQ;AAChD;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0BAAyB;AACzB;AACA;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH,0FAAyF;AACzF;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA,GAAE;;;;AAIF,EAAC","file":"3.3.js?7665c45963c42962955d","sourcesContent":["var window = window || global;\r\nvar document = document || (window.document = {});\r\n/***********************************/\r\n/*http://www.layabox.com 2016/11/25*/\r\n/***********************************/\r\nvar Laya=window.Laya=(function(window,document){\r\n\tvar Laya={\r\n\t\t__internals:[],\r\n\t\t__packages:{},\r\n\t\t__classmap:{'Object':Object,'Function':Function,'Array':Array,'String':String},\r\n\t\t__sysClass:{'object':'Object','array':'Array','string':'String','dictionary':'Dictionary'},\r\n\t\t__propun:{writable: true,enumerable: false,configurable: true},\r\n\t\t__presubstr:String.prototype.substr,\r\n\t\t__substr:function(ofs,sz){return arguments.length==1?Laya.__presubstr.call(this,ofs):Laya.__presubstr.call(this,ofs,sz>0?sz:(this.length+sz));},\r\n\t\t__init:function(_classs){_classs.forEach(function(o){o.__init$ && o.__init$();});},\r\n\t\t__isClass:function(o){return o && (o.__isclass || o==Object || o==String || o==Array);},\r\n\t\t__newvec:function(sz,value){\r\n\t\t\tvar d=[];\r\n\t\t\td.length=sz;\r\n\t\t\tfor(var i=0;i<sz;i++) d[i]=value;\r\n\t\t\treturn d;\r\n\t\t},\r\n\t\t__extend:function(d,b){\r\n\t\t\tfor (var p in b){\r\n\t\t\t\tif (!b.hasOwnProperty(p)) continue;\r\n\t\t\t\tvar gs=Object.getOwnPropertyDescriptor(b, p);\r\n\t\t\t\tvar g = gs.get, s = gs.set; \r\n\t\t\t\tif ( g || s ) {\r\n\t\t\t\t\tif ( g && s)\r\n\t\t\t\t\t\tObject.defineProperty(d,p,gs);\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tg && Object.defineProperty(d, p, g);\r\n\t\t\t\t\t\ts && Object.defineProperty(d, p, s);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse d[p] = b[p];\r\n\t\t\t}\r\n\t\t\tfunction __() { Laya.un(this,'constructor',d); }__.prototype=b.prototype;d.prototype=new __();Laya.un(d.prototype,'__imps',Laya.__copy({},b.prototype.__imps));\r\n\t\t},\r\n\t\t__copy:function(dec,src){\r\n\t\t\tif(!src) return null;\r\n\t\t\tdec=dec||{};\r\n\t\t\tfor(var i in src) dec[i]=src[i];\r\n\t\t\treturn dec;\r\n\t\t},\r\n\t\t__package:function(name,o){\r\n\t\t\tif(Laya.__packages[name]) return;\r\n\t\t\tLaya.__packages[name]=true;\r\n\t\t\tvar p=window,strs=name.split('.');\r\n\t\t\tif(strs.length>1){\r\n\t\t\t\tfor(var i=0,sz=strs.length-1;i<sz;i++){\r\n\t\t\t\t\tvar c=p[strs[i]];\r\n\t\t\t\t\tp=c?c:(p[strs[i]]={});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tp[strs[strs.length-1]] || (p[strs[strs.length-1]]=o||{});\r\n\t\t},\r\n\t\t__hasOwnProperty:function(name,o){\r\n\t\t\to=o ||this;\r\n\t\t    function classHas(name,o){\r\n\t\t\t\tif(Object.hasOwnProperty.call(o.prototype,name)) return true;\r\n\t\t\t\tvar s=o.prototype.__super;\r\n\t\t\t\treturn s==null?null:classHas(name,s);\r\n\t\t\t}\r\n\t\t\treturn (Object.hasOwnProperty.call(o,name)) || classHas(name,o.__class);\r\n\t\t},\r\n\t\t__typeof:function(o,value){\r\n\t\t\tif(!o || !value) return false;\r\n\t\t\tif(value===String) return (typeof o==='string');\r\n\t\t\tif(value===Number) return (typeof o==='number');\r\n\t\t\tif(value.__interface__) value=value.__interface__;\r\n\t\t\telse if(typeof value!='string')  return (o instanceof value);\r\n\t\t\treturn (o.__imps && o.__imps[value]) || (o.__class==value);\r\n\t\t},\r\n\t\t__as:function(value,type){\r\n\t\t\treturn (this.__typeof(value,type))?value:null;\r\n\t\t},\t\t\r\n\t\tinterface:function(name,_super){\r\n\t\t\tLaya.__package(name,{});\r\n\t\t\tvar ins=Laya.__internals;\r\n\t\t\tvar a=ins[name]=ins[name] || {self:name};\r\n\t\t\tif(_super)\r\n\t\t\t{\r\n\t\t\t\tvar supers=_super.split(',');\r\n\t\t\t\ta.extend=[];\r\n\t\t\t\tfor(var i=0;i<supers.length;i++){\r\n\t\t\t\t\tvar name=supers[i];\r\n\t\t\t\t\tins[name]=ins[name] || {self:name};\r\n\t\t\t\t\ta.extend.push(ins[name]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar o=window,words=name.split('.');\r\n\t\t\tfor(var i=0;i<words.length-1;i++) o=o[words[i]];o[words[words.length-1]]={__interface__:name};\r\n\t\t},\r\n\t\tclass:function(o,fullName,_super,miniName){\r\n\t\t\t_super && Laya.__extend(o,_super);\r\n\t\t\tif(fullName){\r\n\t\t\t\tLaya.__package(fullName,o);\r\n\t\t\t\tLaya.__classmap[fullName]=o;\r\n\t\t\t\tif(fullName.indexOf('.')>0){\r\n\t\t\t\t\tif(fullName.indexOf('laya.')==0){\r\n\t\t\t\t\t\tvar paths=fullName.split('.');\r\n\t\t\t\t\t\tminiName=miniName || paths[paths.length-1];\r\n\t\t\t\t\t\tif(Laya[miniName]) console.log(\"Warning!,this class[\"+miniName+\"] already exist:\",Laya[miniName]);\r\n\t\t\t\t\t\tLaya[miniName]=o;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif(fullName==\"Main\")\r\n\t\t\t\t\t\twindow.Main=o;\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tif(Laya[fullName]){\r\n\t\t\t\t\t\t\tconsole.log(\"Error!,this class[\"+fullName+\"] already exist:\",Laya[fullName]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tLaya[fullName]=o;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar un=Laya.un,p=o.prototype;\r\n\t\t\tun(p,'hasOwnProperty',Laya.__hasOwnProperty);\r\n\t\t\tun(p,'__class',o);\r\n\t\t\tun(p,'__super',_super);\r\n\t\t\tun(p,'__className',fullName);\r\n\t\t\tun(o,'__super',_super);\r\n\t\t\tun(o,'__className',fullName);\r\n\t\t\tun(o,'__isclass',true);\r\n\t\t\tun(o,'super',function(o){this.__super.call(o);});\r\n\t\t},\r\n\t\timps:function(dec,src){\r\n\t\t\tif(!src) return null;\r\n\t\t\tvar d=dec.__imps|| Laya.un(dec,'__imps',{});\r\n\t\t\tfunction __(name){\r\n\t\t\t\tvar c,exs;\r\n\t\t\t\tif(! (c=Laya.__internals[name]) ) return;\r\n\t\t\t\td[name]=true;\r\n\t\t\t\tif(!(exs=c.extend)) return;\r\n\t\t\t\tfor(var i=0;i<exs.length;i++){\r\n\t\t\t\t\t__(exs[i].self);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i in src) __(i);\r\n\t\t},\r\n\t\tgetset:function(isStatic,o,name,getfn,setfn){\r\n\t\t\tif(!isStatic){\r\n\t\t\t\tgetfn && Laya.un(o,'_$get_'+name,getfn);\r\n\t\t\t\tsetfn && Laya.un(o,'_$set_'+name,setfn);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tgetfn && (o['_$GET_'+name]=getfn);\r\n\t\t\t\tsetfn && (o['_$SET_'+name]=setfn);\r\n\t\t\t}\r\n\t\t\tif(getfn && setfn) \r\n\t\t\t\tObject.defineProperty(o,name,{get:getfn,set:setfn,enumerable:false});\r\n\t\t\telse{\r\n\t\t\t\tgetfn && Object.defineProperty(o,name,{get:getfn,enumerable:false});\r\n\t\t\t\tsetfn && Object.defineProperty(o,name,{set:setfn,enumerable:false});\r\n\t\t\t}\r\n\t\t},\r\n\t\tstatic:function(_class,def){\r\n\t\t\t\tfor(var i=0,sz=def.length;i<sz;i+=2){\r\n\t\t\t\t\tif(def[i]=='length') \r\n\t\t\t\t\t\t_class.length=def[i+1].call(_class);\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tfunction tmp(){\r\n\t\t\t\t\t\t\tvar name=def[i];\r\n\t\t\t\t\t\t\tvar getfn=def[i+1];\r\n\t\t\t\t\t\t\tObject.defineProperty(_class,name,{\r\n\t\t\t\t\t\t\t\tget:function(){delete this[name];return this[name]=getfn.call(this);},\r\n\t\t\t\t\t\t\t\tset:function(v){delete this[name];this[name]=v;},enumerable: true,configurable: true});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttmp();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t},\t\t\r\n\t\tun:function(obj,name,value){\r\n\t\t\tvalue || (value=obj[name]);\r\n\t\t\tLaya.__propun.value=value;\r\n\t\t\tObject.defineProperty(obj, name, Laya.__propun);\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tuns:function(obj,names){\r\n\t\t\tnames.forEach(function(o){Laya.un(obj,o)});\r\n\t\t}\r\n\t};\r\n\r\n\twindow.console=window.console || ({log:function(){}});\r\n\twindow.trace=window.console.log;\r\n\tError.prototype.throwError=function(){throw arguments;};\r\n\tString.prototype.substr=Laya.__substr;\r\n\tObject.defineProperty(Array.prototype,'fixed',{enumerable: false});\r\n\r\n\treturn Laya;\r\n})(window,document);\r\n\r\n(function(window,document,Laya){\r\n\tvar __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;\r\n\r\n})(window,document,Laya);\r\n\r\n\r\n(function(window,document,Laya){\r\n\tvar __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;\r\n\tLaya.interface('laya.runtime.IMarket');\r\n\tLaya.interface('laya.filters.IFilter');\r\n\tLaya.interface('laya.display.ILayout');\r\n\tLaya.interface('laya.resource.IDispose');\r\n\tLaya.interface('laya.runtime.IPlatform');\r\n\tLaya.interface('laya.resource.IDestroy');\r\n\tLaya.interface('laya.runtime.IConchNode');\r\n\tLaya.interface('laya.filters.IFilterAction');\r\n\tLaya.interface('laya.runtime.ICPlatformClass');\r\n\tLaya.interface('laya.resource.ICreateResource');\r\n\tLaya.interface('laya.runtime.IPlatformClass','laya.runtime.IPlatform');\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.utils.RunDriver\r\n\tvar RunDriver=(function(){\r\n\t\tfunction RunDriver(){};\r\n\t\t__class(RunDriver,'laya.utils.RunDriver');\r\n\t\tRunDriver.FILTER_ACTIONS=[];\r\n\t\tRunDriver.pixelRatio=-1;\r\n\t\tRunDriver._charSizeTestDiv=null\r\n\t\tRunDriver.now=function(){\r\n\t\t\treturn /*__JS__ */Date.now();\r\n\t\t}\r\n\r\n\t\tRunDriver.getWindow=function(){\r\n\t\t\treturn /*__JS__ */window;\r\n\t\t}\r\n\r\n\t\tRunDriver.newWebGLContext=function(canvas,webGLName){\r\n\t\t\treturn canvas.getContext(webGLName,{stencil:true,alpha:Config.isAlpha,antialias:Config.isAntialias,premultipliedAlpha:Config.premultipliedAlpha});\r\n\t\t}\r\n\r\n\t\tRunDriver.getPixelRatio=function(){\r\n\t\t\tif (RunDriver.pixelRatio < 0){\r\n\t\t\t\tvar ctx=Browser.context;\r\n\t\t\t\tvar backingStore=ctx.backingStorePixelRatio || ctx.webkitBackingStorePixelRatio || ctx.mozBackingStorePixelRatio || ctx.msBackingStorePixelRatio || ctx.oBackingStorePixelRatio || ctx.backingStorePixelRatio || 1;\r\n\t\t\t\tRunDriver.pixelRatio=(Browser.window.devicePixelRatio || 1)/ backingStore;\r\n\t\t\t}\r\n\t\t\treturn RunDriver.pixelRatio;\r\n\t\t}\r\n\r\n\t\tRunDriver.getIncludeStr=function(name){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tRunDriver.createShaderCondition=function(conditionScript){\r\n\t\t\tvar fn=\"(function() {return \"+conditionScript+\";})\";\r\n\t\t\treturn Browser.window.eval(fn);\r\n\t\t}\r\n\r\n\t\tRunDriver.measureText=function(txt,font){\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tvar ctx=/*__JS__ */ConchTextCanvas;\r\n\t\t\t\tctx.font=font;\r\n\t\t\t\treturn ctx.measureText(txt);\r\n\t\t\t}\r\n\t\t\tif (RunDriver._charSizeTestDiv==null){\r\n\t\t\t\tRunDriver._charSizeTestDiv=Browser.createElement('div');\r\n\t\t\t\tRunDriver._charSizeTestDiv.style.cssText=\"z-index:10000000;padding:0px;position: absolute;left:0px;visibility:hidden;top:0px;background:white\";\r\n\t\t\t\tBrowser.container.appendChild(RunDriver._charSizeTestDiv);\r\n\t\t\t}\r\n\t\t\tRunDriver._charSizeTestDiv.style.font=font;\r\n\t\t\tRunDriver._charSizeTestDiv.innerText=txt==\" \" ? \"i\" :txt;\r\n\t\t\treturn {width:RunDriver._charSizeTestDiv.offsetWidth,height:RunDriver._charSizeTestDiv.offsetHeight};\r\n\t\t}\r\n\r\n\t\tRunDriver.beginFlush=function(){\r\n\t\t};\r\n\r\n\t\tRunDriver.endFinish=function(){\r\n\t\t};\r\n\r\n\t\tRunDriver.addToAtlas=null\r\n\t\tRunDriver.flashFlushImage=function(atlasWebGLCanvas){\r\n\t\t};\r\n\r\n\t\tRunDriver.drawToCanvas=function(sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){\r\n\t\t\tvar canvas=HTMLCanvas.create(\"2D\");\r\n\t\t\tvar context=new RenderContext(canvasWidth,canvasHeight,canvas);\r\n\t\t\tRenderSprite.renders[_renderType]._fun(sprite,context,offsetX,offsetY);\r\n\t\t\treturn canvas;\r\n\t\t}\r\n\r\n\t\tRunDriver.createParticleTemplate2D=null\r\n\t\tRunDriver.createGLTextur=null;\r\n\t\tRunDriver.createWebGLContext2D=null;\r\n\t\tRunDriver.changeWebGLSize=function(w,h){\r\n\t\t};\r\n\r\n\t\tRunDriver.createRenderSprite=function(type,next){\r\n\t\t\treturn new RenderSprite(type,next);\r\n\t\t}\r\n\r\n\t\tRunDriver.createFilterAction=function(type){\r\n\t\t\treturn new ColorFilterAction();\r\n\t\t}\r\n\r\n\t\tRunDriver.createGraphics=function(){\r\n\t\t\treturn new Graphics();\r\n\t\t}\r\n\r\n\t\tRunDriver.clear=function(value){\r\n\t\t\tRender._context.ctx.clear();\r\n\t\t}\r\n\r\n\t\tRunDriver.clearAtlas=function(value){\r\n\t\t};\r\n\r\n\t\tRunDriver.addTextureToAtlas=function(value){\r\n\t\t};\r\n\r\n\t\tRunDriver.getTexturePixels=function(value,x,y,width,height){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tRunDriver.skinAniSprite=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn RunDriver;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Laya</code> 是全局对象的引用入口集。\r\n\t*/\r\n\t//class Laya\r\n\tvar ___Laya=(function(){\r\n\t\t//function Laya(){};\r\n\t\t/**\r\n\t\t*表示是否捕获全局错误并弹出提示。\r\n\t\t*/\r\n\t\t__getset(1,Laya,'alertGlobalError',null,function(value){\r\n\t\t\tvar erralert=0;\r\n\t\t\tif (value){\r\n\t\t\t\tBrowser.window.onerror=function (msg,url,line,column,detail){\r\n\t\t\t\t\tif (erralert++< 5 && detail)\r\n\t\t\t\t\t\talert(\"出错啦，请把此信息截图给研发商\\n\"+msg+\"\\n\"+detail.stack);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tBrowser.window.onerror=null;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tLaya.init=function(width,height,__plugins){\r\n\t\t\tvar plugins=[];for(var i=2,sz=arguments.length;i<sz;i++)plugins.push(arguments[i]);\r\n\t\t\tif (Laya._isinit)return;\r\n\t\t\tLaya._isinit=true;\r\n\t\t\tBrowser.__init__();\r\n\t\t\tContext.__init__();\r\n\t\t\tGraphics.__init__();\r\n\t\t\tLaya.timer=new Timer();\r\n\t\t\tLaya.loader=new LoaderManager();\r\n\t\t\tfor (var i=0,n=plugins.length;i < n;i++){\r\n\t\t\t\tif (plugins[i].enable)plugins[i].enable();\r\n\t\t\t}\r\n\t\t\tFont.__init__();\r\n\t\t\tStyle.__init__();\r\n\t\t\tResourceManager.__init__();\r\n\t\t\tCacheManger.beginCheck();\r\n\t\t\tLaya.stageBox=Laya.stage=new Stage();\r\n\t\t\tLaya.stage.model&&Laya.stage.model.setRootNode();\r\n\t\t\tvar location=Browser.window.location;\r\n\t\t\tvar pathName=location.pathname;\r\n\t\t\tpathName=pathName.charAt(2)==':' ? pathName.substring(1):pathName;\r\n\t\t\tURL.rootPath=URL.basePath=URL.getPath(location.protocol==\"file:\" ? pathName :location.protocol+\"//\"+location.host+location.pathname);\r\n\t\t\tLaya.render=new Render(0,0);\r\n\t\t\tLaya.stage.size(width,height);\r\n\t\t\tRenderSprite.__init__();\r\n\t\t\tKeyBoardManager.__init__();\r\n\t\t\tMouseManager.instance.__init__(Laya.stage,Render.canvas);\r\n\t\t\tInput.__init__();\r\n\t\t\tSoundManager.autoStopMusic=true;\r\n\t\t\tLocalStorage.__init__();\r\n\t\t\treturn Render.canvas;\r\n\t\t}\r\n\r\n\t\tLaya.stage=null;\r\n\t\tLaya.timer=null;\r\n\t\tLaya.loader=null;\r\n\t\tLaya.render=null\r\n\t\tLaya.version=\"1.5.5Beta\";\r\n\t\tLaya.stageBox=null\r\n\t\tLaya._isinit=false;\r\n\t\t__static(Laya,\r\n\t\t['conchMarket',function(){return this.conchMarket=/*__JS__ */window.conch?conchMarket:null;},'PlatformClass',function(){return this.PlatformClass=/*__JS__ */window.PlatformClass;}\r\n\t\t]);\r\n\t\treturn Laya;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*Config 用于配置一些全局参数。\r\n\t*/\r\n\t//class Config\r\n\tvar Config=(function(){\r\n\t\tfunction Config(){};\r\n\t\t__class(Config,'Config');\r\n\t\tConfig.WebGLTextCacheCount=500;\r\n\t\tConfig.atlasEnable=false;\r\n\t\tConfig.showCanvasMark=false;\r\n\t\tConfig.CPUMemoryLimit=120 *1024 *1024;\r\n\t\tConfig.GPUMemoryLimit=160 *1024 *1024;\r\n\t\tConfig.animationInterval=50;\r\n\t\tConfig.isAntialias=false;\r\n\t\tConfig.isAlpha=false;\r\n\t\tConfig.premultipliedAlpha=false;\r\n\t\treturn Config;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>EventDispatcher</code> 类是可调度事件的所有类的基类。\r\n\t*/\r\n\t//class laya.events.EventDispatcher\r\n\tvar EventDispatcher=(function(){\r\n\t\tvar EventHandler;\r\n\t\tfunction EventDispatcher(){\r\n\t\t\tthis._events=null;\r\n\t\t}\r\n\r\n\t\t__class(EventDispatcher,'laya.events.EventDispatcher');\r\n\t\tvar __proto=EventDispatcher.prototype;\r\n\t\t/**\r\n\t\t*检查 EventDispatcher 对象是否为特定事件类型注册了任何侦听器。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@return 如果指定类型的侦听器已注册，则值为 true；否则，值为 false。\r\n\t\t*/\r\n\t\t__proto.hasListener=function(type){\r\n\t\t\tvar listener=this._events && this._events[type];\r\n\t\t\treturn !!listener;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*派发事件。\r\n\t\t*@param type 事件类型。\r\n\t\t*@param data 回调数据。\r\n\t\t*<b>注意：</b>如果是需要传递多个参数 p1,p2,p3,...可以使用数组结构如：[p1,p2,p3,...] ；如果需要回调单个参数 p 是一个数组，则需要使用结构如：[p]，其他的单个参数 p ，可以直接传入参数 p。\r\n\t\t*@return 此事件类型是否有侦听者，如果有侦听者则值为 true，否则值为 false。\r\n\t\t*/\r\n\t\t__proto.event=function(type,data){\r\n\t\t\tif (!this._events || !this._events[type])return false;\r\n\t\t\tvar listeners=this._events[type];\r\n\t\t\tif (listeners.run){\r\n\t\t\t\tif (listeners.once)delete this._events[type];\r\n\t\t\t\tdata !=null ? listeners.runWith(data):listeners.run();\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var i=0,n=listeners.length;i < n;i++){\r\n\t\t\t\t\tvar listener=listeners[i];\r\n\t\t\t\t\tif (listener){\r\n\t\t\t\t\t\t(data !=null)? listener.runWith(data):listener.run();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!listener || listener.once){\r\n\t\t\t\t\t\tlisteners.splice(i,1);\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t\tn--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (listeners.length===0)delete this._events[type];\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@param caller 事件侦听函数的执行域。\r\n\t\t*@param listener 事件侦听函数。\r\n\t\t*@param args 事件侦听函数的回调参数。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.on=function(type,caller,listener,args){\r\n\t\t\treturn this._createListener(type,caller,listener,args,false);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知，此侦听事件响应一次后自动移除。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@param caller 事件侦听函数的执行域。\r\n\t\t*@param listener 事件侦听函数。\r\n\t\t*@param args 事件侦听函数的回调参数。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.once=function(type,caller,listener,args){\r\n\t\t\treturn this._createListener(type,caller,listener,args,true);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._createListener=function(type,caller,listener,args,once,offBefore){\r\n\t\t\t(offBefore===void 0)&& (offBefore=true);\r\n\t\t\toffBefore && this.off(type,caller,listener,once);\r\n\t\t\tvar handler=EventHandler.create(caller || this,listener,args,once);\r\n\t\t\tthis._events || (this._events={});\r\n\t\t\tvar events=this._events;\r\n\t\t\tif (!events[type])events[type]=handler;\r\n\t\t\telse {\r\n\t\t\t\tif (!events[type].run)events[type].push(handler);\r\n\t\t\t\telse events[type]=[events[type],handler];\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从 EventDispatcher 对象中删除侦听器。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@param caller 事件侦听函数的执行域。\r\n\t\t*@param listener 事件侦听函数。\r\n\t\t*@param onceOnly 如果值为 true ,则只移除通过 once 方法添加的侦听器。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.off=function(type,caller,listener,onceOnly){\r\n\t\t\t(onceOnly===void 0)&& (onceOnly=false);\r\n\t\t\tif (!this._events || !this._events[type])return this;\r\n\t\t\tvar listeners=this._events[type];\r\n\t\t\tif (listener !=null){\r\n\t\t\t\tif (listeners.run){\r\n\t\t\t\t\tif ((!caller || listeners.caller===caller)&& listeners.method===listener && (!onceOnly || listeners.once)){\r\n\t\t\t\t\t\tdelete this._events[type];\r\n\t\t\t\t\t\tlisteners.recover();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar count=0;\r\n\t\t\t\t\tfor (var i=0,n=listeners.length;i < n;i++){\r\n\t\t\t\t\t\tvar item=listeners[i];\r\n\t\t\t\t\t\tif (item && (!caller || item.caller===caller)&& item.method===listener && (!onceOnly || item.once)){\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t\tlisteners[i]=null;\r\n\t\t\t\t\t\t\titem.recover();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (count===n)delete this._events[type];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从 EventDispatcher 对象中删除指定事件类型的所有侦听器。\r\n\t\t*@param type 事件类型，如果值为 null，则移除本对象所有类型的侦听器。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.offAll=function(type){\r\n\t\t\tvar events=this._events;\r\n\t\t\tif (!events)return this;\r\n\t\t\tif (type){\r\n\t\t\t\tthis._recoverHandlers(events[type]);\r\n\t\t\t\tdelete events[type];\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var name in events){\r\n\t\t\t\t\tthis._recoverHandlers(events[name]);\r\n\t\t\t\t}\r\n\t\t\t\tthis._events=null;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto._recoverHandlers=function(arr){\r\n\t\t\tif (!arr)return;\r\n\t\t\tif (arr.run){\r\n\t\t\t\tarr.recover();\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var i=arr.length-1;i >-1;i--){\r\n\t\t\t\t\tif (arr[i]){\r\n\t\t\t\t\t\tarr[i].recover();\r\n\t\t\t\t\t\tarr[i]=null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测指定事件类型是否是鼠标事件。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@return 如果是鼠标事件，则值为 true;否则，值为 false。\r\n\t\t*/\r\n\t\t__proto.isMouseEvent=function(type){\r\n\t\t\treturn EventDispatcher.MOUSE_EVENTS[type];\r\n\t\t}\r\n\r\n\t\tEventDispatcher.MOUSE_EVENTS={\"rightmousedown\":true,\"rightmouseup\":true,\"rightclick\":true,\"mousedown\":true,\"mouseup\":true,\"mousemove\":true,\"mouseover\":true,\"mouseout\":true,\"click\":true,\"doubleclick\":true};\r\n\t\tEventDispatcher.__init$=function(){\r\n\t\t\t/**@private */\r\n\t\t\t//class EventHandler extends laya.utils.Handler\r\n\t\t\tEventHandler=(function(_super){\r\n\t\t\t\tfunction EventHandler(caller,method,args,once){\r\n\t\t\t\t\tEventHandler.__super.call(this,caller,method,args,once);\r\n\t\t\t\t}\r\n\t\t\t\t__class(EventHandler,'',_super);\r\n\t\t\t\tvar __proto=EventHandler.prototype;\r\n\t\t\t\t__proto.recover=function(){\r\n\t\t\t\t\tif (this._id > 0){\r\n\t\t\t\t\t\tthis._id=0;\r\n\t\t\t\t\t\tEventHandler._pool.push(this.clear());\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tEventHandler.create=function(caller,method,args,once){\r\n\t\t\t\t\t(once===void 0)&& (once=true);\r\n\t\t\t\t\tif (EventHandler._pool.length)return EventHandler._pool.pop().setTo(caller,method,args,once);\r\n\t\t\t\t\treturn new EventHandler(caller,method,args,once);\r\n\t\t\t\t}\r\n\t\t\t\tEventHandler._pool=[];\r\n\t\t\t\treturn EventHandler;\r\n\t\t\t})(Handler)\r\n\t\t}\r\n\r\n\t\treturn EventDispatcher;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<p><code>Handler</code> 是事件处理器类。</p>\r\n\t*<p>推荐使用 Handler.create()方法从对象池创建，减少对象创建消耗。</p>\r\n\t*<p><b>注意：</b>由于鼠标事件也用本对象池，不正确的回收及调用，可能会影响鼠标事件的执行。</p>\r\n\t*/\r\n\t//class laya.utils.Handler\r\n\tvar Handler=(function(){\r\n\t\tfunction Handler(caller,method,args,once){\r\n\t\t\t//this.caller=null;\r\n\t\t\t//this.method=null;\r\n\t\t\t//this.args=null;\r\n\t\t\tthis.once=false;\r\n\t\t\tthis._id=0;\r\n\t\t\t(once===void 0)&& (once=false);\r\n\t\t\tthis.setTo(caller,method,args,once);\r\n\t\t}\r\n\r\n\t\t__class(Handler,'laya.utils.Handler');\r\n\t\tvar __proto=Handler.prototype;\r\n\t\t/**\r\n\t\t*设置此对象的指定属性值。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 回调方法。\r\n\t\t*@param args 携带的参数。\r\n\t\t*@param once 是否只执行一次，如果为true，执行后执行recover()进行回收。\r\n\t\t*@return 返回 handler 本身。\r\n\t\t*/\r\n\t\t__proto.setTo=function(caller,method,args,once){\r\n\t\t\tthis._id=Handler._gid++;\r\n\t\t\tthis.caller=caller;\r\n\t\t\tthis.method=method;\r\n\t\t\tthis.args=args;\r\n\t\t\tthis.once=once;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*执行处理器。\r\n\t\t*/\r\n\t\t__proto.run=function(){\r\n\t\t\tif (this.method==null)return null;\r\n\t\t\tvar id=this._id;\r\n\t\t\tvar result=this.method.apply(this.caller,this.args);\r\n\t\t\tthis._id===id && this.once && this.recover();\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*执行处理器，携带额外数据。\r\n\t\t*@param data 附加的回调数据，可以是单数据或者Array(作为多参)。\r\n\t\t*/\r\n\t\t__proto.runWith=function(data){\r\n\t\t\tif (this.method==null)return null;\r\n\t\t\tvar id=this._id;\r\n\t\t\tif (data==null)\r\n\t\t\t\tvar result=this.method.apply(this.caller,this.args);\r\n\t\t\telse if (!this.args && !data.unshift)result=this.method.call(this.caller,data);\r\n\t\t\telse if (this.args)result=this.method.apply(this.caller,this.args.concat(data));\r\n\t\t\telse result=this.method.apply(this.caller,data);\r\n\t\t\tthis._id===id && this.once && this.recover();\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理对象引用。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.caller=null;\r\n\t\t\tthis.method=null;\r\n\t\t\tthis.args=null;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理并回收到 Handler 对象池内。\r\n\t\t*/\r\n\t\t__proto.recover=function(){\r\n\t\t\tif (this._id > 0){\r\n\t\t\t\tthis._id=0;\r\n\t\t\t\tHandler._pool.push(this.clear());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tHandler.create=function(caller,method,args,once){\r\n\t\t\t(once===void 0)&& (once=true);\r\n\t\t\tif (Handler._pool.length)return Handler._pool.pop().setTo(caller,method,args,once);\r\n\t\t\treturn new Handler(caller,method,args,once);\r\n\t\t}\r\n\r\n\t\tHandler._pool=[];\r\n\t\tHandler._gid=1;\r\n\t\treturn Handler;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>BitmapFont</code> 是位图字体类，用于定义位图字体信息。\r\n\t*/\r\n\t//class laya.display.BitmapFont\r\n\tvar BitmapFont=(function(){\r\n\t\tfunction BitmapFont(){\r\n\t\t\tthis.fontSize=12;\r\n\t\t\tthis.autoScaleSize=false;\r\n\t\t\tthis._texture=null;\r\n\t\t\tthis._fontCharDic={};\r\n\t\t\tthis._complete=null;\r\n\t\t\tthis._path=null;\r\n\t\t\tthis._maxHeight=0;\r\n\t\t\tthis._maxWidth=0;\r\n\t\t\tthis._spaceWidth=10;\r\n\t\t\tthis._leftPadding=0;\r\n\t\t\tthis._rightPadding=0;\r\n\t\t\tthis._letterSpacing=0;\r\n\t\t}\r\n\r\n\t\t__class(BitmapFont,'laya.display.BitmapFont');\r\n\t\tvar __proto=BitmapFont.prototype;\r\n\t\t/**\r\n\t\t*通过指定位图字体文件路径，加载位图字体文件。\r\n\t\t*@param path 位图字体文件的路径。\r\n\t\t*@param complete 加载完成的回调，通知上层字体文件已经完成加载并解析。\r\n\t\t*/\r\n\t\t__proto.loadFont=function(path,complete){\r\n\t\t\tthis._path=path;\r\n\t\t\tthis._complete=complete;\r\n\t\t\tLaya.loader.load([{url:this._path,type:/*laya.net.Loader.XML*/\"xml\"},{url:this._path.replace(\".fnt\",\".png\"),type:/*laya.net.Loader.IMAGE*/\"image\"}],Handler.create(this,this.onLoaded));\r\n\t\t}\r\n\r\n\t\t__proto.onLoaded=function(){\r\n\t\t\tthis.parseFont(Loader.getRes(this._path),Loader.getRes(this._path.replace(\".fnt\",\".png\")));\r\n\t\t\tthis._complete && this._complete.run();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*解析字体文件。\r\n\t\t*@param xml 字体文件XML。\r\n\t\t*@param texture 字体的纹理。\r\n\t\t*/\r\n\t\t__proto.parseFont=function(xml,texture){\r\n\t\t\tif (xml==null || texture==null)return;\r\n\t\t\tthis._texture=texture;\r\n\t\t\tvar tX=0;\r\n\t\t\tvar tScale=1;\r\n\t\t\tvar tInfo=xml.getElementsByTagName(\"info\");\r\n\t\t\tthis.fontSize=parseInt(tInfo[0].attributes[\"size\"].nodeValue);\r\n\t\t\tvar tPadding=tInfo[0].attributes[\"padding\"].nodeValue;\r\n\t\t\tvar tPaddingArray=tPadding.split(\",\");\r\n\t\t\tvar tUpPadding=parseInt(tPaddingArray[0]);\r\n\t\t\tvar tDownPadding=parseInt(tPaddingArray[2]);\r\n\t\t\tthis._leftPadding=parseInt(tPaddingArray[3]);\r\n\t\t\tthis._rightPadding=parseInt(tPaddingArray[1]);\r\n\t\t\tvar chars=xml.getElementsByTagName(\"char\");\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=0;i < chars.length;i++){\r\n\t\t\t\tvar tAttribute=chars[i].attributes;\r\n\t\t\t\tvar tId=parseInt(tAttribute[\"id\"].nodeValue);\r\n\t\t\t\tvar xOffset=parseInt(tAttribute[\"xoffset\"].nodeValue)/ tScale;\r\n\t\t\t\tvar yOffset=parseInt(tAttribute[\"yoffset\"].nodeValue)/ tScale;\r\n\t\t\t\tvar xAdvance=parseInt(tAttribute[\"xadvance\"].nodeValue)/ tScale;\r\n\t\t\t\tvar region=new Rectangle();\r\n\t\t\t\tregion.x=parseInt(tAttribute[\"x\"].nodeValue);\r\n\t\t\t\tregion.y=parseInt(tAttribute[\"y\"].nodeValue);\r\n\t\t\t\tregion.width=parseInt(tAttribute[\"width\"].nodeValue);\r\n\t\t\t\tregion.height=parseInt(tAttribute[\"height\"].nodeValue);\r\n\t\t\t\tvar tTexture=Texture.create(texture,region.x,region.y,region.width,region.height,xOffset,yOffset);\r\n\t\t\t\tthis._maxHeight=Math.max(this._maxHeight,tUpPadding+tDownPadding+tTexture.height);\r\n\t\t\t\tthis._maxWidth=Math.max(this._maxWidth,tTexture.width);\r\n\t\t\t\tthis._fontCharDic[tId]=tTexture;\r\n\t\t\t}\r\n\t\t\tif (this.getCharTexture(\" \"))this.setSpaceWidth(this.getCharWidth(\" \"));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定字符的字体纹理对象。\r\n\t\t*@param char 字符。\r\n\t\t*@return 指定的字体纹理对象。\r\n\t\t*/\r\n\t\t__proto.getCharTexture=function(char){\r\n\t\t\treturn this._fontCharDic[char.charCodeAt(0)];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*销毁位图字体，调用Text.unregisterBitmapFont 时，默认会销毁。\r\n\t\t*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tvar tTexture=null;\r\n\t\t\tfor (var p in this._fontCharDic){\r\n\t\t\t\ttTexture=this._fontCharDic[p];\r\n\t\t\t\tif (tTexture)tTexture.destroy();\r\n\t\t\t\tdelete this._fontCharDic[p];\r\n\t\t\t}\r\n\t\t\tthis._texture.destroy();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置空格的宽（如果字体库有空格，这里就可以不用设置了）。\r\n\t\t*@param spaceWidth 宽度，单位为像素。\r\n\t\t*/\r\n\t\t__proto.setSpaceWidth=function(spaceWidth){\r\n\t\t\tthis._spaceWidth=spaceWidth;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定字符的宽度。\r\n\t\t*@param char 字符。\r\n\t\t*@return 宽度。\r\n\t\t*/\r\n\t\t__proto.getCharWidth=function(char){\r\n\t\t\tif (char==\" \")return this._spaceWidth+this._letterSpacing;\r\n\t\t\tvar tTexture=this.getCharTexture(char)\r\n\t\t\tif (tTexture)return tTexture.width+tTexture.offsetX *2+this._letterSpacing;\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定文本内容的宽度。\r\n\t\t*@param text 文本内容。\r\n\t\t*@return 宽度。\r\n\t\t*/\r\n\t\t__proto.getTextWidth=function(text){\r\n\t\t\tvar tWidth=0;\r\n\t\t\tfor (var i=0,n=text.length;i < n;i++){\r\n\t\t\t\ttWidth+=this.getCharWidth(text.charAt(i));\r\n\t\t\t}\r\n\t\t\treturn tWidth;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取最大字符宽度。\r\n\t\t*/\r\n\t\t__proto.getMaxWidth=function(){\r\n\t\t\treturn this._maxWidth+this._letterSpacing;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取最大字符高度。\r\n\t\t*/\r\n\t\t__proto.getMaxHeight=function(){\r\n\t\t\treturn this._maxHeight;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*将指定的文本绘制到指定的显示对象上。\r\n\t\t*/\r\n\t\t__proto.drawText=function(text,sprite,drawX,drawY,align,width){\r\n\t\t\tvar tWidth=0;\r\n\t\t\tvar tTexture;\r\n\t\t\tfor (var i=0,n=text.length;i < n;i++){\r\n\t\t\t\ttWidth+=this.getCharWidth(text.charAt(i));\r\n\t\t\t};\r\n\t\t\tvar dx=this._leftPadding;\r\n\t\t\talign===\"center\" && (dx=(width-tWidth)/ 2);\r\n\t\t\talign===\"right\" && (dx=(width-tWidth)-this._rightPadding);\r\n\t\t\tvar tX=0;\r\n\t\t\tfor (i=0,n=text.length;i < n;i++){\r\n\t\t\t\ttTexture=this.getCharTexture(text.charAt(i));\r\n\t\t\t\tif (tTexture)sprite.graphics.drawTexture(tTexture,drawX+tX+dx,drawY,tTexture.width,tTexture.height);\r\n\t\t\t\ttX+=this.getCharWidth(text.charAt(i));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置字符之间的间距（以像素为单位）。\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取字符之间的间距（以像素为单位）。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'letterSpacing',function(){\r\n\t\t\treturn this._letterSpacing;\r\n\t\t\t},function(value){\r\n\t\t\tthis._letterSpacing=value;\r\n\t\t});\r\n\r\n\t\treturn BitmapFont;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>Style</code> 类是元素样式定义类。\r\n\t*/\r\n\t//class laya.display.css.Style\r\n\tvar Style=(function(){\r\n\t\tfunction Style(){\r\n\t\t\tthis.alpha=1;\r\n\t\t\tthis.visible=true;\r\n\t\t\tthis.scrollRect=null;\r\n\t\t\tthis.blendMode=null;\r\n\t\t\tthis._type=0;\r\n\t\t\tthis._tf=Style._TF_EMPTY;\r\n\t\t}\r\n\r\n\t\t__class(Style,'laya.display.css.Style');\r\n\t\tvar __proto=Style.prototype;\r\n\t\t__proto.getTransform=function(){\r\n\t\t\treturn this._tf;\r\n\t\t}\r\n\r\n\t\t__proto.setTransform=function(value){\r\n\t\t\tthis._tf=value==='none' || !value ? Style._TF_EMPTY :value;\r\n\t\t}\r\n\r\n\t\t__proto.setTranslateX=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.translateX=value;\r\n\t\t}\r\n\r\n\t\t__proto.setTranslateY=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.translateY=value;\r\n\t\t}\r\n\r\n\t\t__proto.setScaleX=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.scaleX=value;\r\n\t\t}\r\n\r\n\t\t__proto.setScaleY=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.scaleY=value;\r\n\t\t}\r\n\r\n\t\t__proto.setRotate=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.rotate=value;\r\n\t\t}\r\n\r\n\t\t__proto.setSkewX=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.skewX=value;\r\n\t\t}\r\n\r\n\t\t__proto.setSkewY=function(value){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.skewY=value;\r\n\t\t}\r\n\r\n\t\t/**销毁此对象。*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis.scrollRect=null;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto.render=function(sprite,context,x,y){}\r\n\t\t/**@private */\r\n\t\t__proto.getCSSStyle=function(){\r\n\t\t\treturn CSSStyle.EMPTY;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._enableLayout=function(){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**X 轴缩放值。*/\r\n\t\t__getset(0,__proto,'scaleX',function(){\r\n\t\t\treturn this._tf.scaleX;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setScaleX(value);\r\n\t\t});\r\n\r\n\t\t/**元素应用的 2D 或 3D 转换的值。该属性允许我们对元素进行旋转、缩放、移动或倾斜。*/\r\n\t\t__getset(0,__proto,'transform',function(){\r\n\t\t\treturn this.getTransform();\r\n\t\t\t},function(value){\r\n\t\t\tthis.setTransform(value);\r\n\t\t});\r\n\r\n\t\t/**定义转换，只是用 X 轴的值。*/\r\n\t\t__getset(0,__proto,'translateX',function(){\r\n\t\t\treturn this._tf.translateX;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setTranslateX(value);\r\n\t\t});\r\n\r\n\t\t/**定义转换，只是用 Y 轴的值。*/\r\n\t\t__getset(0,__proto,'translateY',function(){\r\n\t\t\treturn this._tf.translateY;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setTranslateY(value);\r\n\t\t});\r\n\r\n\t\t/**Y 轴缩放值。*/\r\n\t\t__getset(0,__proto,'scaleY',function(){\r\n\t\t\treturn this._tf.scaleY;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setScaleY(value);\r\n\t\t});\r\n\r\n\t\t/**表示元素是否显示为块级元素。*/\r\n\t\t__getset(0,__proto,'block',function(){\r\n\t\t\treturn (this._type & 0x1)!=0;\r\n\t\t});\r\n\r\n\t\t/**定义沿着 Y 轴的 2D 倾斜转换。*/\r\n\t\t__getset(0,__proto,'skewY',function(){\r\n\t\t\treturn this._tf.skewY;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setSkewY(value);\r\n\t\t});\r\n\r\n\t\t/**定义旋转角度。*/\r\n\t\t__getset(0,__proto,'rotate',function(){\r\n\t\t\treturn this._tf.rotate;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setRotate(value);\r\n\t\t});\r\n\r\n\t\t/**定义沿着 X 轴的 2D 倾斜转换。*/\r\n\t\t__getset(0,__proto,'skewX',function(){\r\n\t\t\treturn this._tf.skewX;\r\n\t\t\t},function(value){\r\n\t\t\tthis.setSkewX(value);\r\n\t\t});\r\n\r\n\t\t/**表示元素的左内边距。*/\r\n\t\t__getset(0,__proto,'paddingLeft',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t/**表示元素的上内边距。*/\r\n\t\t__getset(0,__proto,'paddingTop',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t/**是否为绝对定位。*/\r\n\t\t__getset(0,__proto,'absolute',function(){\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tStyle.__init__=function(){\r\n\t\t\tStyle._TF_EMPTY=new TransformInfo();\r\n\t\t\tStyle.EMPTY=new Style();\r\n\t\t}\r\n\r\n\t\tStyle.EMPTY=null\r\n\t\tStyle._TF_EMPTY=null\r\n\t\treturn Style;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>Font</code> 类是字体显示定义类。\r\n\t*/\r\n\t//class laya.display.css.Font\r\n\tvar Font=(function(){\r\n\t\tfunction Font(src){\r\n\t\t\tthis._type=0;\r\n\t\t\tthis._weight=0;\r\n\t\t\tthis._decoration=null;\r\n\t\t\tthis._text=null;\r\n\t\t\tthis.indent=0;\r\n\t\t\tthis._color=Color.create(Font.defaultColor);\r\n\t\t\tthis.family=Font.defaultFamily;\r\n\t\t\tthis.stroke=Font._STROKE;\r\n\t\t\tthis.size=Font.defaultSize;\r\n\t\t\tsrc && src!==Font.EMPTY && src.copyTo(this);\r\n\t\t}\r\n\r\n\t\t__class(Font,'laya.display.css.Font');\r\n\t\tvar __proto=Font.prototype;\r\n\t\t/**\r\n\t\t*字体样式字符串。\r\n\t\t*/\r\n\t\t__proto.set=function(value){\r\n\t\t\tthis._text=null;\r\n\t\t\tvar strs=value.split(' ');\r\n\t\t\tfor (var i=0,n=strs.length;i < n;i++){\r\n\t\t\t\tvar str=strs[i];\r\n\t\t\t\tswitch (str){\r\n\t\t\t\t\tcase 'italic':\r\n\t\t\t\t\t\tthis.italic=true;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\tcase 'bold':\r\n\t\t\t\t\t\tthis.bold=true;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\tif (str.indexOf('px')> 0){\r\n\t\t\t\t\tthis.size=parseInt(str);\r\n\t\t\t\t\tthis.family=strs[i+1];\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回字体样式字符串。\r\n\t\t*@return 字体样式字符串。\r\n\t\t*/\r\n\t\t__proto.toString=function(){\r\n\t\t\tthis._text=\"\"\r\n\t\t\tthis.italic && (this._text+=\"italic \");\r\n\t\t\tthis.bold && (this._text+=\"bold \");\r\n\t\t\treturn this._text+=this.size+\"px \"+this.family;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将当前的属性值复制到传入的 <code>Font</code> 对象。\r\n\t\t*@param dec 一个 Font 对象。\r\n\t\t*/\r\n\t\t__proto.copyTo=function(dec){\r\n\t\t\tdec._type=this._type;\r\n\t\t\tdec._text=this._text;\r\n\t\t\tdec._weight=this._weight;\r\n\t\t\tdec._color=this._color;\r\n\t\t\tdec.family=this.family;\r\n\t\t\tdec.stroke=this.stroke !=Font._STROKE ? this.stroke.slice():Font._STROKE;\r\n\t\t\tdec.indent=this.indent;\r\n\t\t\tdec.size=this.size;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*表示是否为密码格式。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'password',function(){\r\n\t\t\treturn (this._type & 0x400)!==0;\r\n\t\t\t},function(value){\r\n\t\t\tvalue ? (this._type |=0x400):(this._type &=~0x400);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示颜色字符串。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'color',function(){\r\n\t\t\treturn this._color.strColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._color=Color.create(value);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否为斜体。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'italic',function(){\r\n\t\t\treturn (this._type & 0x200)!==0;\r\n\t\t\t},function(value){\r\n\t\t\tvalue ? (this._type |=0x200):(this._type &=~0x200);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否为粗体。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'bold',function(){\r\n\t\t\treturn (this._type & 0x800)!==0;\r\n\t\t\t},function(value){\r\n\t\t\tvalue ? (this._type |=0x800):(this._type &=~0x800);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*文本的粗细。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'weight',function(){\r\n\t\t\treturn \"\"+this._weight;\r\n\t\t\t},function(value){\r\n\t\t\tvar weight=0;\r\n\t\t\tswitch (value){\r\n\t\t\t\tcase 'normal':\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'bold':\r\n\t\t\t\t\tthis.bold=true;\r\n\t\t\t\t\tweight=700;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'bolder':\r\n\t\t\t\t\tweight=800;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'lighter':\r\n\t\t\t\t\tweight=100;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tweight=parseInt(value);\r\n\t\t\t\t}\r\n\t\t\tthis._weight=weight;\r\n\t\t\tthis._text=null;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*规定添加到文本的修饰。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'decoration',function(){\r\n\t\t\treturn this._decoration ? this._decoration.value :\"none\";\r\n\t\t\t},function(value){\r\n\t\t\tvar strs=value.split(' ');\r\n\t\t\tthis._decoration || (this._decoration={});\r\n\t\t\tswitch (strs[0]){\r\n\t\t\t\tcase '_':\r\n\t\t\t\t\tthis._decoration.type='underline'\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase '-':\r\n\t\t\t\t\tthis._decoration.type='line-through'\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'overline':\r\n\t\t\t\t\tthis._decoration.type='overline'\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tthis._decoration.type=strs[0];\r\n\t\t\t\t}\r\n\t\t\tstrs[1] && (this._decoration.color=Color.create(strs));\r\n\t\t\tthis._decoration.value=value;\r\n\t\t});\r\n\r\n\t\tFont.__init__=function(){\r\n\t\t\tFont.EMPTY=new Font(null);\r\n\t\t}\r\n\r\n\t\tFont.EMPTY=null\r\n\t\tFont.defaultColor=\"#000000\";\r\n\t\tFont.defaultSize=12;\r\n\t\tFont.defaultFamily=\"Arial\";\r\n\t\tFont.defaultFont=\"12px Arial\";\r\n\t\tFont._STROKE=[0,\"#000000\"];\r\n\t\tFont._ITALIC=0x200;\r\n\t\tFont._PASSWORD=0x400;\r\n\t\tFont._BOLD=0x800;\r\n\t\treturn Font;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.display.css.TransformInfo\r\n\tvar TransformInfo=(function(){\r\n\t\tfunction TransformInfo(){\r\n\t\t\tthis.translateX=0;\r\n\t\t\tthis.translateY=0;\r\n\t\t\tthis.scaleX=1;\r\n\t\t\tthis.scaleY=1;\r\n\t\t\tthis.rotate=0;\r\n\t\t\tthis.skewX=0;\r\n\t\t\tthis.skewY=0;\r\n\t\t}\r\n\r\n\t\t__class(TransformInfo,'laya.display.css.TransformInfo');\r\n\t\treturn TransformInfo;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Graphics</code> 类用于创建绘图显示对象。\r\n\t*@see laya.display.Sprite#graphics\r\n\t*/\r\n\t//class laya.display.Graphics\r\n\tvar Graphics=(function(){\r\n\t\tfunction Graphics(){\r\n\t\t\t//this._sp=null;\r\n\t\t\tthis._one=null;\r\n\t\t\tthis._cmds=null;\r\n\t\t\t//this._temp=null;\r\n\t\t\t//this._bounds=null;\r\n\t\t\t//this._rstBoundPoints=null;\r\n\t\t\t//this._vectorgraphArray=null;\r\n\t\t\tthis._render=this._renderEmpty;\r\n\t\t\tthis._render=this._renderEmpty;\r\n\t\t\tif (Render.isConchNode){\r\n\t\t\t\t/*__JS__ */this._nativeObj=new _conchGraphics();;\r\n\t\t\t\t/*__JS__ */this.id=this._nativeObj.conchID;;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(Graphics,'laya.display.Graphics');\r\n\t\tvar __proto=Graphics.prototype;\r\n\t\t/**\r\n\t\t*<p>销毁此对象。</p>\r\n\t\t*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tthis._temp=null;\r\n\t\t\tthis._bounds=null;\r\n\t\t\tthis._rstBoundPoints=null;\r\n\t\t\tthis._sp && (this._sp._renderType=0);\r\n\t\t\tthis._sp=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*<p>清空绘制命令。</p>\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._one=null;\r\n\t\t\tthis._render=this._renderEmpty;\r\n\t\t\tthis._cmds=null;\r\n\t\t\tthis._temp && (this._temp.length=0);\r\n\t\t\tthis._sp && (this._sp._renderType &=~ /*laya.renders.RenderSprite.IMAGE*/0x01);\r\n\t\t\tthis._sp && (this._sp._renderType &=~ /*laya.renders.RenderSprite.GRAPHICS*/0x100);\r\n\t\t\tthis._repaint();\r\n\t\t\tif (this._vectorgraphArray){\r\n\t\t\t\tfor (var i=0,n=this._vectorgraphArray.length;i < n;i++){\r\n\t\t\t\t\tVectorGraphManager.getInstance().deleteShape(this._vectorgraphArray[i]);\r\n\t\t\t\t}\r\n\t\t\t\tthis._vectorgraphArray.length=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*重绘此对象。\r\n\t\t*/\r\n\t\t__proto._repaint=function(){\r\n\t\t\tthis._temp && (this._temp.length=0);\r\n\t\t\tthis._sp && this._sp.repaint();\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._isOnlyOne=function(){\r\n\t\t\treturn !this._cmds || this._cmds.length===0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取位置及宽高信息矩阵(比较耗，尽量少用)。\r\n\t\t*@return 位置与宽高组成的 一个 Rectangle 对象。\r\n\t\t*/\r\n\t\t__proto.getBounds=function(){\r\n\t\t\tif (!this._bounds || !this._temp || this._temp.length < 1){\r\n\t\t\t\tthis._bounds=Rectangle._getWrapRec(this.getBoundPoints(),this._bounds)\r\n\t\t\t}\r\n\t\t\treturn this._bounds;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取端点列表。\r\n\t\t*/\r\n\t\t__proto.getBoundPoints=function(){\r\n\t\t\tif (!this._temp || this._temp.length < 1)\r\n\t\t\t\tthis._temp=this._getCmdPoints();\r\n\t\t\treturn this._rstBoundPoints=Utils.copyArray(this._rstBoundPoints,this._temp);\r\n\t\t}\r\n\r\n\t\t__proto._addCmd=function(a){\r\n\t\t\tthis._cmds=this._cmds || [];\r\n\t\t\ta.callee=a.shift();\r\n\t\t\tthis._cmds.push(a);\r\n\t\t}\r\n\r\n\t\t__proto._getCmdPoints=function(){\r\n\t\t\tvar context=Render._context;\r\n\t\t\tvar cmds=this._cmds;\r\n\t\t\tvar rst;\r\n\t\t\trst=this._temp || (this._temp=[]);\r\n\t\t\trst.length=0;\r\n\t\t\tif (!cmds && this._one !=null){\r\n\t\t\t\tGraphics._tempCmds.length=0;\r\n\t\t\t\tGraphics._tempCmds.push(this._one);\r\n\t\t\t\tcmds=Graphics._tempCmds;\r\n\t\t\t}\r\n\t\t\tif (!cmds)\r\n\t\t\t\treturn rst;\r\n\t\t\tvar matrixs;\r\n\t\t\tmatrixs=Graphics._tempMatrixArrays;\r\n\t\t\tmatrixs.length=0;\r\n\t\t\tvar tMatrix=Graphics._initMatrix;\r\n\t\t\ttMatrix.identity();\r\n\t\t\tvar tempMatrix=Graphics._tempMatrix;\r\n\t\t\tvar cmd;\r\n\t\t\tfor (var i=0,n=cmds.length;i < n;i++){\r\n\t\t\t\tcmd=cmds[i];\r\n\t\t\t\tswitch (cmd.callee){\r\n\t\t\t\t\tcase context.save:\r\n\t\t\t\t\tcase 7:\r\n\t\t\t\t\t\tmatrixs.push(tMatrix);\r\n\t\t\t\t\t\ttMatrix=tMatrix.clone();\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context.restore:\r\n\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\ttMatrix=matrixs.pop();\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._scale:\r\n\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\ttempMatrix.identity();\r\n\t\t\t\t\t\ttempMatrix.translate(-cmd[2],-cmd[3]);\r\n\t\t\t\t\t\ttempMatrix.scale(cmd[0],cmd[1]);\r\n\t\t\t\t\t\ttempMatrix.translate(cmd[2],cmd[3]);\r\n\t\t\t\t\t\tthis._switchMatrix(tMatrix,tempMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._rotate:\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\ttempMatrix.identity();\r\n\t\t\t\t\t\ttempMatrix.translate(-cmd[1],-cmd[2]);\r\n\t\t\t\t\t\ttempMatrix.rotate(cmd[0]);\r\n\t\t\t\t\t\ttempMatrix.translate(cmd[1],cmd[2]);\r\n\t\t\t\t\t\tthis._switchMatrix(tMatrix,tempMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._translate:\r\n\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\ttempMatrix.identity();\r\n\t\t\t\t\t\ttempMatrix.translate(cmd[0],cmd[1]);\r\n\t\t\t\t\t\tthis._switchMatrix(tMatrix,tempMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._transform:\r\n\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\ttempMatrix.identity();\r\n\t\t\t\t\t\ttempMatrix.translate(-cmd[1],-cmd[2]);\r\n\t\t\t\t\t\ttempMatrix.concat(cmd[0]);\r\n\t\t\t\t\t\ttempMatrix.translate(cmd[1],cmd[2]);\r\n\t\t\t\t\t\tthis._switchMatrix(tMatrix,tempMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 16:\r\n\t\t\t\t\tcase 24:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 17:\r\n\t\t\t\t\t\ttMatrix.copyTo(tempMatrix);\r\n\t\t\t\t\t\ttempMatrix.concat(cmd[4]);\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tempMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawTexture:\r\n\t\t\t\t\tcase context._fillTexture:\r\n\t\t\t\t\t\tif (cmd[3] && cmd[4]){\r\n\t\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],cmd[3],cmd[4]),tMatrix);\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tvar tex=cmd[0];\r\n\t\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],tex.width,tex.height),tMatrix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawTextureWithTransform:;\r\n\t\t\t\t\t\tvar drawMatrix;\r\n\t\t\t\t\t\tif (cmd[5]){\r\n\t\t\t\t\t\t\ttMatrix.copyTo(tempMatrix);\r\n\t\t\t\t\t\t\ttempMatrix.concat(cmd[5]);\r\n\t\t\t\t\t\t\tdrawMatrix=tempMatrix;\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tdrawMatrix=tMatrix;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (cmd[3] && cmd[4]){\r\n\t\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],cmd[3],cmd[4]),drawMatrix);\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\ttex=cmd[0];\r\n\t\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[1],cmd[2],tex.width,tex.height),drawMatrix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawRect:\r\n\t\t\t\t\tcase 13:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0],cmd[1],cmd[2],cmd[3]),tMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawCircle:\r\n\t\t\t\t\tcase context._fillCircle:\r\n\t\t\t\t\tcase 14:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Rectangle._getBoundPointS(cmd[0]-cmd[2],cmd[1]-cmd[2],cmd[2]+cmd[2],cmd[2]+cmd[2]),tMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawLine:\r\n\t\t\t\t\tcase 20:\r\n\t\t\t\t\t\tGraphics._tempPoints.length=0;\r\n\t\t\t\t\t\tvar lineWidth=NaN;\r\n\t\t\t\t\t\tlineWidth=cmd[5] *0.5;\r\n\t\t\t\t\t\tif (cmd[0]==cmd[2]){\r\n\t\t\t\t\t\t\tGraphics._tempPoints.push(cmd[0]+lineWidth,cmd[1],cmd[2]+lineWidth,cmd[3],cmd[0]-lineWidth,cmd[1],cmd[2]-lineWidth,cmd[3]);\r\n\t\t\t\t\t\t\t}else if (cmd[1]==cmd[3]){\r\n\t\t\t\t\t\t\tGraphics._tempPoints.push(cmd[0],cmd[1]+lineWidth,cmd[2],cmd[3]+lineWidth,cmd[0],cmd[1]-lineWidth,cmd[2],cmd[3]-lineWidth);\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tGraphics._tempPoints.push(cmd[0],cmd[1],cmd[2],cmd[3]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Graphics._tempPoints,tMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawCurves:\r\n\t\t\t\t\tcase 22:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,Bezier.I.getBezierPoints(cmd[2]),tMatrix,cmd[0],cmd[1]);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawPoly:\r\n\t\t\t\t\tcase context._drawLines:\r\n\t\t\t\t\tcase 18:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,cmd[2],tMatrix,cmd[0],cmd[1]);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawPath:\r\n\t\t\t\t\tcase 19:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,this._getPathPoints(cmd[2]),tMatrix,cmd[0],cmd[1]);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase context._drawPie:\r\n\t\t\t\t\tcase 15:\r\n\t\t\t\t\t\tGraphics._addPointArrToRst(rst,this._getPiePoints(cmd[0],cmd[1],cmd[2],cmd[3],cmd[4]),tMatrix);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (rst.length > 200){\r\n\t\t\t\trst=Utils.copyArray(rst,Rectangle._getWrapRec(rst)._getBoundPoints());\r\n\t\t\t}else if (rst.length > 8)\r\n\t\t\trst=GrahamScan.scanPList(rst);\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t__proto._switchMatrix=function(tMatix,tempMatrix){\r\n\t\t\ttempMatrix.concat(tMatix);\r\n\t\t\ttempMatrix.copyTo(tMatix);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制纹理。\r\n\t\t*@param tex 纹理。\r\n\t\t*@param x X 轴偏移量。\r\n\t\t*@param y Y 轴偏移量。\r\n\t\t*@param width 宽度。\r\n\t\t*@param height 高度。\r\n\t\t*@param m 矩阵信息。\r\n\t\t*/\r\n\t\t__proto.drawTexture=function(tex,x,y,width,height,m,alpha){\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t(alpha===void 0)&& (alpha=1);\r\n\t\t\tif (!tex)return;\r\n\t\t\tif (!width)width=tex.sourceWidth;\r\n\t\t\tif (!height)height=tex.sourceHeight;\r\n\t\t\twidth=width-tex.sourceWidth+tex.width;\r\n\t\t\theight=height-tex.sourceHeight+tex.height;\r\n\t\t\tif (tex.loaded && (width <=0 || height <=0))return;\r\n\t\t\tx+=tex.offsetX;\r\n\t\t\ty+=tex.offsetY;\r\n\t\t\tthis._sp && (this._sp._renderType |=/*laya.renders.RenderSprite.GRAPHICS*/0x100);\r\n\t\t\tvar args=[tex,x,y,width,height,m,alpha];\r\n\t\t\targs.callee=(m || alpha !=1)? Render._context._drawTextureWithTransform :Render._context._drawTexture;\r\n\t\t\tif (this._one==null && !m && alpha==1){\r\n\t\t\t\tthis._one=args;\r\n\t\t\t\tthis._render=this._renderOneImg;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._saveToCmd(args.callee,args);\r\n\t\t\t}\r\n\t\t\tif (!tex.loaded){\r\n\t\t\t\ttex.once(/*laya.events.Event.LOADED*/\"loaded\",this,this._textureLoaded,[tex,args]);\r\n\t\t\t}\r\n\t\t\tthis._repaint();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private 清理贴图并替换为最新的\r\n\t\t*@param tex\r\n\t\t*/\r\n\t\t__proto.cleanByTexture=function(tex,x,y,width,height){\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\tif (!tex)return this.clear();\r\n\t\t\tif (this._one && this._render===this._renderOneImg){\r\n\t\t\t\tif (!width)width=tex.sourceWidth;\r\n\t\t\t\tif (!height)height=tex.sourceHeight;\r\n\t\t\t\twidth=width-tex.sourceWidth+tex.width;\r\n\t\t\t\theight=height-tex.sourceHeight+tex.height;\r\n\t\t\t\tx+=tex.offsetX;\r\n\t\t\t\ty+=tex.offsetY;\r\n\t\t\t\tthis._one[0]=tex;\r\n\t\t\t\tthis._one[1]=x;\r\n\t\t\t\tthis._one[2]=y;\r\n\t\t\t\tthis._one[3]=width;\r\n\t\t\t\tthis._one[4]=height;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.clear();\r\n\t\t\t\ttex && this.drawTexture(tex,x,y,width,height);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*批量绘制同样纹理。\r\n\t\t*@param tex 纹理。\r\n\t\t*@param pos 绘制次数和坐标。\r\n\t\t*/\r\n\t\t__proto.drawTextures=function(tex,pos){\r\n\t\t\tif (!tex)return;\r\n\t\t\tthis._saveToCmd(Render._context._drawTextures,[tex,pos]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*用texture填充\r\n\t\t*@param tex 纹理。\r\n\t\t*@param x X 轴偏移量。\r\n\t\t*@param y Y 轴偏移量。\r\n\t\t*@param width 宽度。\r\n\t\t*@param height 高度。\r\n\t\t*@param type 填充类型 repeat|repeat-x|repeat-y|no-repeat\r\n\t\t*@param offset 贴图纹理偏移\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.fillTexture=function(tex,x,y,width,height,type,offset){\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t(type===void 0)&& (type=\"repeat\");\r\n\t\t\tif (!tex)return;\r\n\t\t\tvar args=[tex,x,y,width,height,type,offset||Point.EMPTY,{}];\r\n\t\t\tif (!tex.loaded){\r\n\t\t\t\ttex.once(/*laya.events.Event.LOADED*/\"loaded\",this,this._textureLoaded,[tex,args]);\r\n\t\t\t}\r\n\t\t\tthis._saveToCmd(Render._context._fillTexture,args);\r\n\t\t}\r\n\r\n\t\t__proto._textureLoaded=function(tex,param){\r\n\t\t\tparam[3]=param[3] || tex.width;\r\n\t\t\tparam[4]=param[4] || tex.height;\r\n\t\t\tthis._repaint();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*保存到命令流。\r\n\t\t*/\r\n\t\t__proto._saveToCmd=function(fun,args){\r\n\t\t\tthis._sp && (this._sp._renderType |=/*laya.renders.RenderSprite.GRAPHICS*/0x100);\r\n\t\t\tif (this._one==null){\r\n\t\t\t\tthis._one=args;\r\n\t\t\t\tthis._render=this._renderOne;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._sp && (this._sp._renderType &=~ /*laya.renders.RenderSprite.IMAGE*/0x01);\r\n\t\t\t\tthis._render=this._renderAll;\r\n\t\t\t\t(this._cmds || (this._cmds=[])).length===0 && this._cmds.push(this._one);\r\n\t\t\t\tthis._cmds.push(args);\r\n\t\t\t}\r\n\t\t\targs.callee=fun;\r\n\t\t\tthis._temp && (this._temp.length=0);\r\n\t\t\tthis._repaint();\r\n\t\t\treturn args;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置剪裁区域，超出剪裁区域的坐标不显示。\r\n\t\t*@param x X 轴偏移量。\r\n\t\t*@param y Y 轴偏移量。\r\n\t\t*@param width 宽度。\r\n\t\t*@param height 高度。\r\n\t\t*/\r\n\t\t__proto.clipRect=function(x,y,width,height){\r\n\t\t\tthis._saveToCmd(Render._context._clipRect,[x,y,width,height]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在画布上绘制文本。\r\n\t\t*@param text 在画布上输出的文本。\r\n\t\t*@param x 开始绘制文本的 x 坐标位置（相对于画布）。\r\n\t\t*@param y 开始绘制文本的 y 坐标位置（相对于画布）。\r\n\t\t*@param font 定义字号和字体，比如\"20px Arial\"。\r\n\t\t*@param color 定义文本颜色，比如\"#ff0000\"。\r\n\t\t*@param textAlign 文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n\t\t*/\r\n\t\t__proto.fillText=function(text,x,y,font,color,textAlign){\r\n\t\t\tthis._saveToCmd(Render._context._fillText,[text,x,y,font || Font.defaultFont,color,textAlign]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在画布上绘制“被填充且镶边的”文本。\r\n\t\t*@param text 在画布上输出的文本。\r\n\t\t*@param x 开始绘制文本的 x 坐标位置（相对于画布）。\r\n\t\t*@param y 开始绘制文本的 y 坐标位置（相对于画布）。\r\n\t\t*@param font 定义字体和字号，比如\"20px Arial\"。\r\n\t\t*@param fillColor 定义文本颜色，比如\"#ff0000\"。\r\n\t\t*@param borderColor 定义镶边文本颜色。\r\n\t\t*@param lineWidth 镶边线条宽度。\r\n\t\t*@param textAlign 文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n\t\t*/\r\n\t\t__proto.fillBorderText=function(text,x,y,font,fillColor,borderColor,lineWidth,textAlign){\r\n\t\t\tthis._saveToCmd(Render._context._fillBorderText,[text,x,y,font || Font.defaultFont,fillColor,borderColor,lineWidth,textAlign]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在画布上绘制文本（没有填色）。文本的默认颜色是黑色。\r\n\t\t*@param text 在画布上输出的文本。\r\n\t\t*@param x 开始绘制文本的 x 坐标位置（相对于画布）。\r\n\t\t*@param y 开始绘制文本的 y 坐标位置（相对于画布）。\r\n\t\t*@param font 定义字体和字号，比如\"20px Arial\"。\r\n\t\t*@param color 定义文本颜色，比如\"#ff0000\"。\r\n\t\t*@param lineWidth 线条宽度。\r\n\t\t*@param textAlign 文本对齐方式，可选值：\"left\"，\"center\"，\"right\"。\r\n\t\t*/\r\n\t\t__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){\r\n\t\t\tthis._saveToCmd(Render._context._strokeText,[text,x,y,font || Font.defaultFont,color,lineWidth,textAlign]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置透明度。\r\n\t\t*@param value 透明度。\r\n\t\t*/\r\n\t\t__proto.alpha=function(value){\r\n\t\t\tthis._saveToCmd(Render._context._alpha,[value]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*替换绘图的当前转换矩阵。\r\n\t\t*@param mat 矩阵。\r\n\t\t*@param pivotX 水平方向轴心点坐标。\r\n\t\t*@param pivotY 垂直方向轴心点坐标。\r\n\t\t*/\r\n\t\t__proto.transform=function(matrix,pivotX,pivotY){\r\n\t\t\t(pivotX===void 0)&& (pivotX=0);\r\n\t\t\t(pivotY===void 0)&& (pivotY=0);\r\n\t\t\tthis._saveToCmd(Render._context._transform,[matrix,pivotX,pivotY]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*旋转当前绘图。(推荐使用transform，性能更高)\r\n\t\t*@param angle 旋转角度，以弧度计。\r\n\t\t*@param pivotX 水平方向轴心点坐标。\r\n\t\t*@param pivotY 垂直方向轴心点坐标。\r\n\t\t*/\r\n\t\t__proto.rotate=function(angle,pivotX,pivotY){\r\n\t\t\t(pivotX===void 0)&& (pivotX=0);\r\n\t\t\t(pivotY===void 0)&& (pivotY=0);\r\n\t\t\tthis._saveToCmd(Render._context._rotate,[angle,pivotX,pivotY]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*缩放当前绘图至更大或更小。(推荐使用transform，性能更高)\r\n\t\t*@param scaleX 水平方向缩放值。\r\n\t\t*@param scaleY 垂直方向缩放值。\r\n\t\t*@param pivotX 水平方向轴心点坐标。\r\n\t\t*@param pivotY 垂直方向轴心点坐标。\r\n\t\t*/\r\n\t\t__proto.scale=function(scaleX,scaleY,pivotX,pivotY){\r\n\t\t\t(pivotX===void 0)&& (pivotX=0);\r\n\t\t\t(pivotY===void 0)&& (pivotY=0);\r\n\t\t\tthis._saveToCmd(Render._context._scale,[scaleX,scaleY,pivotX,pivotY]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*重新映射画布上的 (0,0)位置。\r\n\t\t*@param x 添加到水平坐标（x）上的值。\r\n\t\t*@param y 添加到垂直坐标（y）上的值。\r\n\t\t*/\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tthis._saveToCmd(Render._context._translate,[x,y]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*保存当前环境的状态。\r\n\t\t*/\r\n\t\t__proto.save=function(){\r\n\t\t\tthis._saveToCmd(Render._context._save,[]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回之前保存过的路径状态和属性。\r\n\t\t*/\r\n\t\t__proto.restore=function(){\r\n\t\t\tthis._saveToCmd(Render._context._restore,[]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*替换文本内容。\r\n\t\t*@param text 文本内容。\r\n\t\t*@return 替换成功则值为true，否则值为flase。\r\n\t\t*/\r\n\t\t__proto.replaceText=function(text){\r\n\t\t\tthis._repaint();\r\n\t\t\tvar cmds=this._cmds;\r\n\t\t\tif (!cmds){\r\n\t\t\t\tif (this._one && this._isTextCmd(this._one.callee)){\r\n\t\t\t\t\tif (this._one[0].toUpperCase)this._one[0]=text;\r\n\t\t\t\t\telse this._one[0].setText(text);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var i=cmds.length-1;i >-1;i--){\r\n\t\t\t\t\tif (this._isTextCmd(cmds[i].callee)){\r\n\t\t\t\t\t\tif (cmds[i][0].toUpperCase)cmds[i][0]=text;\r\n\t\t\t\t\t\telse cmds[i][0].setText(text);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._isTextCmd=function(fun){\r\n\t\t\treturn fun===Render._context._fillText || fun===Render._context._fillBorderText || fun===Render._context._strokeText;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*替换文本颜色。\r\n\t\t*@param color 颜色。\r\n\t\t*/\r\n\t\t__proto.replaceTextColor=function(color){\r\n\t\t\tthis._repaint();\r\n\t\t\tvar cmds=this._cmds;\r\n\t\t\tif (!cmds){\r\n\t\t\t\tif (this._one && this._isTextCmd(this._one.callee)){\r\n\t\t\t\t\tthis._one[4]=color;\r\n\t\t\t\t\tif (!this._one[0].toUpperCase)this._one[0].changed=true;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var i=cmds.length-1;i >-1;i--){\r\n\t\t\t\t\tif (this._isTextCmd(cmds[i].callee)){\r\n\t\t\t\t\t\tcmds[i][4]=color;\r\n\t\t\t\t\t\tif (!cmds[i][0].toUpperCase)cmds[i][0].changed=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载并显示一个图片。\r\n\t\t*@param url 图片地址。\r\n\t\t*@param x 显示图片的x位置。\r\n\t\t*@param y 显示图片的y位置。\r\n\t\t*@param width 显示图片的宽度，设置为0表示使用图片默认宽度。\r\n\t\t*@param height 显示图片的高度，设置为0表示使用图片默认高度。\r\n\t\t*@param complete 加载完成回调。\r\n\t\t*/\r\n\t\t__proto.loadImage=function(url,x,y,width,height,complete){\r\n\t\t\tvar _$this=this;\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\tvar tex=Loader.getRes(url);\r\n\t\t\tif (tex)onloaded(tex);\r\n\t\t\telse Laya.loader.load(url,Handler.create(null,onloaded),null,/*laya.net.Loader.IMAGE*/\"image\");\r\n\t\t\tfunction onloaded (tex){\r\n\t\t\t\tif (tex){\r\n\t\t\t\t\t_$this.drawTexture(tex,x,y,width,height);\r\n\t\t\t\t\tif (complete !=null)complete.call(_$this._sp,tex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._renderEmpty=function(sprite,context,x,y){}\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._renderAll=function(sprite,context,x,y){\r\n\t\t\tvar cmds=this._cmds,cmd;\r\n\t\t\tfor (var i=0,n=cmds.length;i < n;i++){\r\n\t\t\t\t(cmd=cmds[i]).callee.call(context,x,y,cmd);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._renderOne=function(sprite,context,x,y){\r\n\t\t\tthis._one.callee.call(context,x,y,this._one);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._renderOneImg=function(sprite,context,x,y){\r\n\t\t\tthis._one.callee.call(context,x,y,this._one);\r\n\t\t\tif (sprite._renderType!==2305){\r\n\t\t\t\tsprite._renderType |=/*laya.renders.RenderSprite.IMAGE*/0x01;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制一条线。\r\n\t\t*@param fromX X 轴开始位置。\r\n\t\t*@param fromY Y 轴开始位置。\r\n\t\t*@param toX X 轴结束位置。\r\n\t\t*@param toY Y 轴结束位置。\r\n\t\t*@param lineColor 颜色。\r\n\t\t*@param lineWidth 线条宽度。\r\n\t\t*/\r\n\t\t__proto.drawLine=function(fromX,fromY,toX,toY,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar tId=0;\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\ttId=VectorGraphManager.getInstance().getId();\r\n\t\t\t\tif (this._vectorgraphArray==null)this._vectorgraphArray=[];\r\n\t\t\t\tthis._vectorgraphArray.push(tId);\r\n\t\t\t};\r\n\t\t\tvar arr=[fromX+0.5,fromY+0.5,toX+0.5,toY+0.5,lineColor,lineWidth,tId];\r\n\t\t\tthis._saveToCmd(Render._context._drawLine,arr);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制一系列线段。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param points 线段的点集合。格式:[x1,y1,x2,y2,x3,y3...]。\r\n\t\t*@param lineColor 线段颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 线段宽度。\r\n\t\t*/\r\n\t\t__proto.drawLines=function(x,y,points,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar tId=0;\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\ttId=VectorGraphManager.getInstance().getId();\r\n\t\t\t\tif (this._vectorgraphArray==null)this._vectorgraphArray=[];\r\n\t\t\t\tthis._vectorgraphArray.push(tId);\r\n\t\t\t};\r\n\t\t\tvar arr=[x+0.5,y+0.5,points,lineColor,lineWidth,tId];\r\n\t\t\tthis._saveToCmd(Render._context._drawLines,arr);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制一系列曲线。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param points 线段的点集合，格式[startx,starty,ctrx,ctry,startx,starty...]。\r\n\t\t*@param lineColor 线段颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 线段宽度。\r\n\t\t*/\r\n\t\t__proto.drawCurves=function(x,y,points,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar arr=[x+0.5,y+0.5,points,lineColor,lineWidth];\r\n\t\t\tthis._saveToCmd(Render._context._drawCurves,arr);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制矩形。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param width 矩形宽度。\r\n\t\t*@param height 矩形高度。\r\n\t\t*@param fillColor 填充颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineColor 边框颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 边框宽度。\r\n\t\t*/\r\n\t\t__proto.drawRect=function(x,y,width,height,fillColor,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar offset=lineColor ? 0.5 :0;\r\n\t\t\tvar arr=[x+offset,y+offset,width,height,fillColor,lineColor,lineWidth];\r\n\t\t\tthis._saveToCmd(Render._context._drawRect,arr);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制圆形。\r\n\t\t*@param x 圆点X 轴位置。\r\n\t\t*@param y 圆点Y 轴位置。\r\n\t\t*@param radius 半径。\r\n\t\t*@param fillColor 填充颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineColor 边框颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 边框宽度。\r\n\t\t*/\r\n\t\t__proto.drawCircle=function(x,y,radius,fillColor,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar offset=lineColor ? 0.5 :0;\r\n\t\t\tvar tId=0;\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\ttId=VectorGraphManager.getInstance().getId();\r\n\t\t\t\tif (this._vectorgraphArray==null)this._vectorgraphArray=[];\r\n\t\t\t\tthis._vectorgraphArray.push(tId);\r\n\t\t\t};\r\n\t\t\tvar arr=[x+offset,y+offset,radius,fillColor,lineColor,lineWidth,tId];\r\n\t\t\tthis._saveToCmd(Render._context._drawCircle,arr);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制扇形。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param radius 扇形半径。\r\n\t\t*@param startAngle 开始角度。\r\n\t\t*@param endAngle 结束角度。\r\n\t\t*@param fillColor 填充颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineColor 边框颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 边框宽度。\r\n\t\t*/\r\n\t\t__proto.drawPie=function(x,y,radius,startAngle,endAngle,fillColor,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar offset=lineColor ? 0.5 :0;\r\n\t\t\tvar tId=0;\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\ttId=VectorGraphManager.getInstance().getId();\r\n\t\t\t\tif (this._vectorgraphArray==null)this._vectorgraphArray=[];\r\n\t\t\t\tthis._vectorgraphArray.push(tId);\r\n\t\t\t};\r\n\t\t\tvar arr=[x+offset,y+offset,radius,startAngle,endAngle,fillColor,lineColor,lineWidth,tId];\r\n\t\t\tarr[3]=Utils.toRadian(startAngle);\r\n\t\t\tarr[4]=Utils.toRadian(endAngle);\r\n\t\t\tthis._saveToCmd(Render._context._drawPie,arr);\r\n\t\t}\r\n\r\n\t\t__proto._getPiePoints=function(x,y,radius,startAngle,endAngle){\r\n\t\t\tvar rst=Graphics._tempPoints;\r\n\t\t\tGraphics._tempPoints.length=0;\r\n\t\t\trst.push(x,y);\r\n\t\t\tvar dP=Math.PI / 10;\r\n\t\t\tvar i=NaN;\r\n\t\t\tfor (i=startAngle;i < endAngle;i+=dP){\r\n\t\t\t\trst.push(x+radius *Math.cos(i),y+radius *Math.sin(i));\r\n\t\t\t}\r\n\t\t\tif (endAngle !=i){\r\n\t\t\t\trst.push(x+radius *Math.cos(endAngle),y+radius *Math.sin(endAngle));\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制多边形。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param points 多边形的点集合。\r\n\t\t*@param fillColor 填充颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineColor 边框颜色，或者填充绘图的渐变对象。\r\n\t\t*@param lineWidth 边框宽度。\r\n\t\t*/\r\n\t\t__proto.drawPoly=function(x,y,points,fillColor,lineColor,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar offset=lineColor ? 0.5 :0;\r\n\t\t\tvar tId=0;\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\ttId=VectorGraphManager.getInstance().getId();\r\n\t\t\t\tif (this._vectorgraphArray==null)this._vectorgraphArray=[];\r\n\t\t\t\tthis._vectorgraphArray.push(tId);\r\n\t\t\t\tvar tIsConvexPolygon=false;\r\n\t\t\t\tif (points.length > 6){\r\n\t\t\t\t\ttIsConvexPolygon=false;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\ttIsConvexPolygon=true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar arr=[x+offset,y+offset,points,fillColor,lineColor,lineWidth,tId,tIsConvexPolygon];\r\n\t\t\tthis._saveToCmd(Render._context._drawPoly,arr);\r\n\t\t}\r\n\r\n\t\t__proto._getPathPoints=function(paths){\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tvar rst=Graphics._tempPoints;\r\n\t\t\trst.length=0;\r\n\t\t\tlen=paths.length;\r\n\t\t\tvar tCMD;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\ttCMD=paths[i];\r\n\t\t\t\tif (tCMD.length > 1){\r\n\t\t\t\t\trst.push(tCMD[1],tCMD[2]);\r\n\t\t\t\t\tif (tCMD.length > 3){\r\n\t\t\t\t\t\trst.push(tCMD[3],tCMD[4]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制路径。\r\n\t\t*@param x 开始绘制的 X 轴位置。\r\n\t\t*@param y 开始绘制的 Y 轴位置。\r\n\t\t*@param paths 路径集合，路径支持以下格式：[[\"moveTo\",x,y],[\"lineTo\",x,y,x,y,x,y],[\"arcTo\",x1,y1,x2,y2,r],[\"closePath\"]]。\r\n\t\t*@param brush 刷子定义，支持以下设置{fillStyle}。\r\n\t\t*@param pen 画笔定义，支持以下设置{strokeStyle,lineWidth,lineJoin,lineCap,miterLimit}。\r\n\t\t*/\r\n\t\t__proto.drawPath=function(x,y,paths,brush,pen){\r\n\t\t\tvar arr=[x+0.5,y+0.5,paths,brush,pen];\r\n\t\t\tthis._saveToCmd(Render._context._drawPath,arr);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*命令流。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'cmds',function(){\r\n\t\t\treturn this._cmds;\r\n\t\t\t},function(value){\r\n\t\t\tthis._sp && (this._sp._renderType |=/*laya.renders.RenderSprite.GRAPHICS*/0x100);\r\n\t\t\tthis._cmds=value;\r\n\t\t\tthis._render=this._renderAll;\r\n\t\t\tthis._repaint();\r\n\t\t});\r\n\r\n\t\tGraphics.__init__=function(){\r\n\t\t\tif (Render.isConchNode){\r\n\t\t\t\tvar from=laya.display.Graphics.prototype;\r\n\t\t\t\tvar to=/*__JS__ */ConchGraphics.prototype;\r\n\t\t\t\tvar list=[\"clear\",\"destroy\",\"alpha\",\"rotate\",\"transform\",\"scale\",\"translate\",\"save\",\"restore\",\"clipRect\",\"blendMode\",\"fillText\",\"fillBorderText\",\"_fands\",\"drawRect\",\"drawCircle\",\"drawPie\",\"drawPoly\",\"drawPath\",\"drawImageM\",\"drawLine\",\"drawLines\",\"_drawPs\",\"drawCurves\",\"replaceText\",\"replaceTextColor\",\"_fillImage\",\"fillTexture\",\"setSkinMesh\",\"drawParticle\",\"drawImageS\"];\r\n\t\t\t\tfor (var i=0,len=list.length;i <=len;i++){\r\n\t\t\t\t\tvar temp=list[i];\r\n\t\t\t\t\tfrom[temp]=to[temp];\r\n\t\t\t\t}\r\n\t\t\t\tfrom._saveToCmd=null;\r\n\t\t\t\tif (to.drawImageS){\r\n\t\t\t\t\tfrom.drawTextures=function (tex,pos){\r\n\t\t\t\t\t\tif (!tex)return;\r\n\t\t\t\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;\r\n\t\t\t\t\t\tthis.drawImageS(tex.bitmap.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,tex.offsetX,tex.offsetY,tex.width,tex.height,pos);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfrom.drawTexture=function (tex,x,y,width,height,m){\r\n\t\t\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t\t\t(y===void 0)&& (y=0);\r\n\t\t\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t\t\tif (!tex)return;\r\n\t\t\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!width)width=tex.sourceWidth;\r\n\t\t\t\t\tif (!height)height=tex.sourceHeight;\r\n\t\t\t\t\twidth=width-tex.sourceWidth+tex.width;\r\n\t\t\t\t\theight=height-tex.sourceHeight+tex.height;\r\n\t\t\t\t\tif (width <=0 || height <=0)return;\r\n\t\t\t\t\tx+=tex.offsetX;\r\n\t\t\t\t\ty+=tex.offsetY;\r\n\t\t\t\t\tvar uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;\r\n\t\t\t\t\tthis.drawImageM(tex.bitmap.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x,y,width,height,m);\r\n\t\t\t\t}\r\n\t\t\t\tfrom.fillTexture=function (tex,x,y,width,height,type,offset){\r\n\t\t\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t\t\t(type===void 0)&& (type=\"repeat\");\r\n\t\t\t\t\tif (!tex)return;\r\n\t\t\t\t\tif (tex.loaded){\r\n\t\t\t\t\t\tvar ctxi=Render._context.ctx;\r\n\t\t\t\t\t\tvar w=tex.bitmap.width,h=tex.bitmap.height,uv=tex.uv;\r\n\t\t\t\t\t\tvar pat;\r\n\t\t\t\t\t\tif (tex.uv !=Texture.DEF_UV){\r\n\t\t\t\t\t\t\tpat=ctxi.createPattern(tex.bitmap.source,type,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h);\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tpat=ctxi.createPattern(tex.bitmap.source,type);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar sX=0,sY=0;\r\n\t\t\t\t\t\tif (offset){\r\n\t\t\t\t\t\t\tx+=offset.x % tex.width;\r\n\t\t\t\t\t\t\ty+=offset.y % tex.height;\r\n\t\t\t\t\t\t\tsX-=offset.x % tex.width;\r\n\t\t\t\t\t\t\tsY-=offset.y % tex.height;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._fillImage(pat,x,y,sX,sY,width,height);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tGraphics._addPointArrToRst=function(rst,points,matrix,dx,dy){\r\n\t\t\t(dx===void 0)&& (dx=0);\r\n\t\t\t(dy===void 0)&& (dy=0);\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=points.length;\r\n\t\t\tfor (i=0;i < len;i+=2){\r\n\t\t\t\tGraphics._addPointToRst(rst,points[i]+dx,points[i+1]+dy,matrix);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tGraphics._addPointToRst=function(rst,x,y,matrix){\r\n\t\t\tvar _tempPoint=Point.TEMP;\r\n\t\t\t_tempPoint.setTo(x ? x :0,y ? y :0);\r\n\t\t\tmatrix.transformPoint(_tempPoint);\r\n\t\t\trst.push(_tempPoint.x,_tempPoint.y);\r\n\t\t}\r\n\r\n\t\tGraphics._tempPoints=[];\r\n\t\tGraphics._tempMatrixArrays=[];\r\n\t\tGraphics._tempCmds=[];\r\n\t\t__static(Graphics,\r\n\t\t['_tempMatrix',function(){return this._tempMatrix=new Matrix();},'_initMatrix',function(){return this._initMatrix=new Matrix();}\r\n\t\t]);\r\n\t\treturn Graphics;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Event</code> 是事件类型的集合。\r\n\t*/\r\n\t//class laya.events.Event\r\n\tvar Event=(function(){\r\n\t\tfunction Event(){\r\n\t\t\t//this.type=null;\r\n\t\t\t//this.nativeEvent=null;\r\n\t\t\t//this.target=null;\r\n\t\t\t//this.currentTarget=null;\r\n\t\t\t//this._stoped=false;\r\n\t\t\t//this.touchId=0;\r\n\t\t\t//this.keyCode=0;\r\n\t\t}\r\n\r\n\t\t__class(Event,'laya.events.Event');\r\n\t\tvar __proto=Event.prototype;\r\n\t\t/**\r\n\t\t*设置事件数据。\r\n\t\t*@param type 事件类型。\r\n\t\t*@param currentTarget 事件目标触发对象。\r\n\t\t*@param target 事件当前冒泡对象。\r\n\t\t*@return 返回当前 Event 对象。\r\n\t\t*/\r\n\t\t__proto.setTo=function(type,currentTarget,target){\r\n\t\t\tthis.type=type;\r\n\t\t\tthis.currentTarget=currentTarget;\r\n\t\t\tthis.target=target;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*防止对事件流中当前节点的后续节点中的所有事件侦听器进行处理。\r\n\t\t*/\r\n\t\t__proto.stopPropagation=function(){\r\n\t\t\tthis._stoped=true;\r\n\t\t}\r\n\r\n\t\t/**鼠标在 Stage 上的 Y 轴坐标*/\r\n\t\t__getset(0,__proto,'stageY',function(){\r\n\t\t\treturn Laya.stage.mouseY;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*包含按下或释放的键的字符代码值。字符代码值为英文键盘值。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'charCode',function(){\r\n\t\t\treturn this.nativeEvent.charCode;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*触摸点列表。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'touches',function(){\r\n\t\t\tvar arr=this.nativeEvent.touches;\r\n\t\t\tif (arr){\r\n\t\t\t\tvar stage=Laya.stage;\r\n\t\t\t\tfor (var i=0,n=arr.length;i < n;i++){\r\n\t\t\t\t\tvar e=arr[i];\r\n\t\t\t\t\tvar point=Point.TEMP;\r\n\t\t\t\t\tpoint.setTo(e.clientX,e.clientY);\r\n\t\t\t\t\tstage._canvasTransform.invertTransformPoint(point);\r\n\t\t\t\t\tstage.transform.invertTransformPoint(point);\r\n\t\t\t\t\te.stageX=point.x;\r\n\t\t\t\t\te.stageY=point.y;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn arr;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示键在键盘上的位置。这对于区分在键盘上多次出现的键非常有用。<br>\r\n\t\t*例如，您可以根据此属性的值来区分左 Shift 键和右 Shift 键：左 Shift 键的值为 KeyLocation.LEFT，右 Shift 键的值为 KeyLocation.RIGHT。另一个示例是区分标准键盘 (KeyLocation.STANDARD)与数字键盘 (KeyLocation.NUM_PAD)上按下的数字键。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'keyLocation',function(){\r\n\t\t\treturn this.nativeEvent.keyLocation;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示 Ctrl 键是处于活动状态 (true)还是非活动状态 (false)。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'ctrlKey',function(){\r\n\t\t\treturn this.nativeEvent.ctrlKey;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示 Alt 键是处于活动状态 (true)还是非活动状态 (false)。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'altKey',function(){\r\n\t\t\treturn this.nativeEvent.altKey;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示 Shift 键是处于活动状态 (true)还是非活动状态 (false)。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'shiftKey',function(){\r\n\t\t\treturn this.nativeEvent.shiftKey;\r\n\t\t});\r\n\r\n\t\t/**鼠标在 Stage 上的 X 轴坐标*/\r\n\t\t__getset(0,__proto,'stageX',function(){\r\n\t\t\treturn Laya.stage.mouseX;\r\n\t\t});\r\n\r\n\t\tEvent.EMPTY=new Event();\r\n\t\tEvent.MOUSE_DOWN=\"mousedown\";\r\n\t\tEvent.MOUSE_UP=\"mouseup\";\r\n\t\tEvent.CLICK=\"click\";\r\n\t\tEvent.RIGHT_MOUSE_DOWN=\"rightmousedown\";\r\n\t\tEvent.RIGHT_MOUSE_UP=\"rightmouseup\";\r\n\t\tEvent.RIGHT_CLICK=\"rightclick\";\r\n\t\tEvent.MOUSE_MOVE=\"mousemove\";\r\n\t\tEvent.MOUSE_OVER=\"mouseover\";\r\n\t\tEvent.MOUSE_OUT=\"mouseout\";\r\n\t\tEvent.MOUSE_WHEEL=\"mousewheel\";\r\n\t\tEvent.ROLL_OVER=\"mouseover\";\r\n\t\tEvent.ROLL_OUT=\"mouseout\";\r\n\t\tEvent.DOUBLE_CLICK=\"doubleclick\";\r\n\t\tEvent.CHANGE=\"change\";\r\n\t\tEvent.CHANGED=\"changed\";\r\n\t\tEvent.RESIZE=\"resize\";\r\n\t\tEvent.ADDED=\"added\";\r\n\t\tEvent.REMOVED=\"removed\";\r\n\t\tEvent.DISPLAY=\"display\";\r\n\t\tEvent.UNDISPLAY=\"undisplay\";\r\n\t\tEvent.ERROR=\"error\";\r\n\t\tEvent.COMPLETE=\"complete\";\r\n\t\tEvent.LOADED=\"loaded\";\r\n\t\tEvent.PROGRESS=\"progress\";\r\n\t\tEvent.INPUT=\"input\";\r\n\t\tEvent.RENDER=\"render\";\r\n\t\tEvent.OPEN=\"open\";\r\n\t\tEvent.MESSAGE=\"message\";\r\n\t\tEvent.CLOSE=\"close\";\r\n\t\tEvent.KEY_DOWN=\"keydown\";\r\n\t\tEvent.KEY_PRESS=\"keypress\";\r\n\t\tEvent.KEY_UP=\"keyup\";\r\n\t\tEvent.FRAME=\"enterframe\";\r\n\t\tEvent.DRAG_START=\"dragstart\";\r\n\t\tEvent.DRAG_MOVE=\"dragmove\";\r\n\t\tEvent.DRAG_END=\"dragend\";\r\n\t\tEvent.ENTER=\"enter\";\r\n\t\tEvent.SELECT=\"select\";\r\n\t\tEvent.BLUR=\"blur\";\r\n\t\tEvent.FOCUS=\"focus\";\r\n\t\tEvent.PLAYED=\"played\";\r\n\t\tEvent.PAUSED=\"paused\";\r\n\t\tEvent.STOPPED=\"stopped\";\r\n\t\tEvent.START=\"start\";\r\n\t\tEvent.END=\"end\";\r\n\t\tEvent.ENABLED_CHANGED=\"enabledchanged\";\r\n\t\tEvent.COMPONENT_ADDED=\"componentadded\";\r\n\t\tEvent.COMPONENT_REMOVED=\"componentremoved\";\r\n\t\tEvent.ACTIVE_CHANGED=\"activechanged\";\r\n\t\tEvent.LAYER_CHANGED=\"layerchanged\";\r\n\t\tEvent.HIERARCHY_LOADED=\"hierarchyloaded\";\r\n\t\tEvent.RECOVERING=\"recovering\";\r\n\t\tEvent.RECOVERED=\"recovered\";\r\n\t\tEvent.RELEASED=\"released\";\r\n\t\tEvent.LINK=\"link\";\r\n\t\tEvent.LABEL=\"label\";\r\n\t\tEvent.FULL_SCREEN_CHANGE=\"fullscreenchange\";\r\n\t\tEvent.DEVICE_LOST=\"devicelost\";\r\n\t\tEvent.MESH_CHANGED=\"meshchanged\";\r\n\t\tEvent.MATERIAL_CHANGED=\"materialchanged\";\r\n\t\tEvent.RENDERQUEUE_CHANGED=\"renderqueuechanged\";\r\n\t\tEvent.WORLDMATRIX_NEEDCHANGE=\"worldmatrixneedchanged\";\r\n\t\tEvent.ANIMATION_CHANGED=\"animationchanged\";\r\n\t\treturn Event;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Keyboard</code> 类的属性是一些常数，这些常数表示控制游戏时最常用的键。\r\n\t*/\r\n\t//class laya.events.Keyboard\r\n\tvar Keyboard=(function(){\r\n\t\tfunction Keyboard(){};\r\n\t\t__class(Keyboard,'laya.events.Keyboard');\r\n\t\tKeyboard.NUMBER_0=48;\r\n\t\tKeyboard.NUMBER_1=49;\r\n\t\tKeyboard.NUMBER_2=50;\r\n\t\tKeyboard.NUMBER_3=51;\r\n\t\tKeyboard.NUMBER_4=52;\r\n\t\tKeyboard.NUMBER_5=53;\r\n\t\tKeyboard.NUMBER_6=54;\r\n\t\tKeyboard.NUMBER_7=55;\r\n\t\tKeyboard.NUMBER_8=56;\r\n\t\tKeyboard.NUMBER_9=57;\r\n\t\tKeyboard.A=65;\r\n\t\tKeyboard.B=66;\r\n\t\tKeyboard.C=67;\r\n\t\tKeyboard.D=68;\r\n\t\tKeyboard.E=69;\r\n\t\tKeyboard.F=70;\r\n\t\tKeyboard.G=71;\r\n\t\tKeyboard.H=72;\r\n\t\tKeyboard.I=73;\r\n\t\tKeyboard.J=74;\r\n\t\tKeyboard.K=75;\r\n\t\tKeyboard.L=76;\r\n\t\tKeyboard.M=77;\r\n\t\tKeyboard.N=78;\r\n\t\tKeyboard.O=79;\r\n\t\tKeyboard.P=80;\r\n\t\tKeyboard.Q=81;\r\n\t\tKeyboard.R=82;\r\n\t\tKeyboard.S=83;\r\n\t\tKeyboard.T=84;\r\n\t\tKeyboard.U=85;\r\n\t\tKeyboard.V=86;\r\n\t\tKeyboard.W=87;\r\n\t\tKeyboard.X=88;\r\n\t\tKeyboard.Y=89;\r\n\t\tKeyboard.Z=90;\r\n\t\tKeyboard.F1=112;\r\n\t\tKeyboard.F2=113;\r\n\t\tKeyboard.F3=114;\r\n\t\tKeyboard.F4=115;\r\n\t\tKeyboard.F5=116;\r\n\t\tKeyboard.F6=117;\r\n\t\tKeyboard.F7=118;\r\n\t\tKeyboard.F8=119;\r\n\t\tKeyboard.F9=120;\r\n\t\tKeyboard.F10=121;\r\n\t\tKeyboard.F11=122;\r\n\t\tKeyboard.F12=123;\r\n\t\tKeyboard.F13=124;\r\n\t\tKeyboard.F14=125;\r\n\t\tKeyboard.F15=126;\r\n\t\tKeyboard.NUMPAD=21;\r\n\t\tKeyboard.NUMPAD_0=96;\r\n\t\tKeyboard.NUMPAD_1=97;\r\n\t\tKeyboard.NUMPAD_2=98;\r\n\t\tKeyboard.NUMPAD_3=99;\r\n\t\tKeyboard.NUMPAD_4=100;\r\n\t\tKeyboard.NUMPAD_5=101;\r\n\t\tKeyboard.NUMPAD_6=102;\r\n\t\tKeyboard.NUMPAD_7=103;\r\n\t\tKeyboard.NUMPAD_8=104;\r\n\t\tKeyboard.NUMPAD_9=105;\r\n\t\tKeyboard.NUMPAD_ADD=107;\r\n\t\tKeyboard.NUMPAD_DECIMAL=110;\r\n\t\tKeyboard.NUMPAD_DIVIDE=111;\r\n\t\tKeyboard.NUMPAD_ENTER=108;\r\n\t\tKeyboard.NUMPAD_MULTIPLY=106;\r\n\t\tKeyboard.NUMPAD_SUBTRACT=109;\r\n\t\tKeyboard.SEMICOLON=186;\r\n\t\tKeyboard.EQUAL=187;\r\n\t\tKeyboard.COMMA=188;\r\n\t\tKeyboard.MINUS=189;\r\n\t\tKeyboard.PERIOD=190;\r\n\t\tKeyboard.SLASH=191;\r\n\t\tKeyboard.BACKQUOTE=192;\r\n\t\tKeyboard.LEFTBRACKET=219;\r\n\t\tKeyboard.BACKSLASH=220;\r\n\t\tKeyboard.RIGHTBRACKET=221;\r\n\t\tKeyboard.QUOTE=222;\r\n\t\tKeyboard.ALTERNATE=18;\r\n\t\tKeyboard.BACKSPACE=8;\r\n\t\tKeyboard.CAPS_LOCK=20;\r\n\t\tKeyboard.COMMAND=15;\r\n\t\tKeyboard.CONTROL=17;\r\n\t\tKeyboard.DELETE=46;\r\n\t\tKeyboard.ENTER=13;\r\n\t\tKeyboard.ESCAPE=27;\r\n\t\tKeyboard.PAGE_UP=33;\r\n\t\tKeyboard.PAGE_DOWN=34;\r\n\t\tKeyboard.END=35;\r\n\t\tKeyboard.HOME=36;\r\n\t\tKeyboard.LEFT=37;\r\n\t\tKeyboard.UP=38;\r\n\t\tKeyboard.RIGHT=39;\r\n\t\tKeyboard.DOWN=40;\r\n\t\tKeyboard.SHIFT=16;\r\n\t\tKeyboard.SPACE=32;\r\n\t\tKeyboard.TAB=9;\r\n\t\tKeyboard.INSERT=45;\r\n\t\treturn Keyboard;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<p><code>KeyBoardManager</code> 是键盘事件管理类。</p>\r\n\t*<p>该类从浏览器中接收键盘事件，并派发该事件。\r\n\t*派发事件时若 Stage.focus 为空则只从 Stage 上派发该事件，否则将从 Stage.focus 对象开始一直冒泡派发该事件。\r\n\t*所以在 Laya.stage 上监听键盘事件一定能够收到，如果在其他地方监听，则必须处在Stage.focus的冒泡链上才能收到该事件。</p>\r\n\t*<p>用户可以通过代码 Laya.stage.focus=someNode 的方式来设置focus对象。</p>\r\n\t*<p>用户可统一的根据事件对象中 e.keyCode 来判断按键类型，该属性兼容了不同浏览器的实现。</p>\r\n\t*/\r\n\t//class laya.events.KeyBoardManager\r\n\tvar KeyBoardManager=(function(){\r\n\t\tfunction KeyBoardManager(){};\r\n\t\t__class(KeyBoardManager,'laya.events.KeyBoardManager');\r\n\t\tKeyBoardManager.__init__=function(){\r\n\t\t\tKeyBoardManager._addEvent(\"keydown\");\r\n\t\t\tKeyBoardManager._addEvent(\"keypress\");\r\n\t\t\tKeyBoardManager._addEvent(\"keyup\");\r\n\t\t}\r\n\r\n\t\tKeyBoardManager._addEvent=function(type){\r\n\t\t\tBrowser.document.addEventListener(type,function(e){\r\n\t\t\t\tlaya.events.KeyBoardManager._dispatch(e,type);\r\n\t\t\t},true);\r\n\t\t}\r\n\r\n\t\tKeyBoardManager._dispatch=function(e,type){\r\n\t\t\tif (!KeyBoardManager.enabled)return;\r\n\t\t\tKeyBoardManager._event._stoped=false;\r\n\t\t\tKeyBoardManager._event.nativeEvent=e;\r\n\t\t\tKeyBoardManager._event.keyCode=e.keyCode || e.which || e.charCode;\r\n\t\t\tif (type===\"keydown\")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=true;\r\n\t\t\telse if (type===\"keyup\")KeyBoardManager._pressKeys[KeyBoardManager._event.keyCode]=null;\r\n\t\t\tvar target=(Laya.stage.focus && (Laya.stage.focus.event !=null))? Laya.stage.focus :Laya.stage;\r\n\t\t\tvar ct=target;\r\n\t\t\twhile (ct){\r\n\t\t\t\tct.event(type,KeyBoardManager._event.setTo(type,ct,target));\r\n\t\t\t\tct=ct.parent;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tKeyBoardManager.hasKeyDown=function(key){\r\n\t\t\treturn KeyBoardManager._pressKeys[key];\r\n\t\t}\r\n\r\n\t\tKeyBoardManager._pressKeys={};\r\n\t\tKeyBoardManager.enabled=true;\r\n\t\t__static(KeyBoardManager,\r\n\t\t['_event',function(){return this._event=new Event();}\r\n\t\t]);\r\n\t\treturn KeyBoardManager;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<p><code>KeyLocation</code> 类包含表示在键盘或类似键盘的输入设备上按键位置的常量。</p>\r\n\t*<p><code>KeyLocation</code> 常数用在键盘事件对象的 <code>keyLocation </code>属性中。</p>\r\n\t*/\r\n\t//class laya.events.KeyLocation\r\n\tvar KeyLocation=(function(){\r\n\t\tfunction KeyLocation(){};\r\n\t\t__class(KeyLocation,'laya.events.KeyLocation');\r\n\t\tKeyLocation.STANDARD=0;\r\n\t\tKeyLocation.LEFT=1;\r\n\t\tKeyLocation.RIGHT=2;\r\n\t\tKeyLocation.NUM_PAD=3;\r\n\t\treturn KeyLocation;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>MouseManager</code> 是鼠标、触摸交互管理器。\r\n\t*/\r\n\t//class laya.events.MouseManager\r\n\tvar MouseManager=(function(){\r\n\t\tfunction MouseManager(){\r\n\t\t\tthis.mouseX=0;\r\n\t\t\tthis.mouseY=0;\r\n\t\t\tthis.disableMouseEvent=false;\r\n\t\t\tthis.mouseDownTime=0;\r\n\t\t\tthis.mouseMoveAccuracy=2;\r\n\t\t\tthis._stage=null;\r\n\t\t\tthis._target=null;\r\n\t\t\tthis._lastOvers=[];\r\n\t\t\tthis._currOvers=[];\r\n\t\t\tthis._lastClickTimer=0;\r\n\t\t\tthis._lastMoveTimer=0;\r\n\t\t\tthis._isDoubleClick=false;\r\n\t\t\tthis._isLeftMouse=false;\r\n\t\t\tthis._eventList=[];\r\n\t\t\tthis._touchIDs={};\r\n\t\t\tthis._id=1;\r\n\t\t\tthis._event=new Event();\r\n\t\t\tthis._matrix=new Matrix();\r\n\t\t\tthis._point=new Point();\r\n\t\t\tthis._rect=new Rectangle();\r\n\t\t\tthis._prePoint=new Point();\r\n\t\t}\r\n\r\n\t\t__class(MouseManager,'laya.events.MouseManager');\r\n\t\tvar __proto=MouseManager.prototype;\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*初始化。\r\n\t\t*/\r\n\t\t__proto.__init__=function(stage,canvas){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._stage=stage;\r\n\t\t\tvar _this=this;\r\n\t\t\tvar list=this._eventList;\r\n\t\t\tcanvas.oncontextmenu=function (e){\r\n\t\t\t\tif (MouseManager.enabled)return false;\r\n\t\t\t}\r\n\t\t\tcanvas.addEventListener('mousedown',function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t\t_this.mouseDownTime=Browser.now();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tcanvas.addEventListener('mouseup',function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t\t_this.mouseDownTime=-Browser.now();\r\n\t\t\t\t}\r\n\t\t\t},true);\r\n\t\t\tcanvas.addEventListener('mousemove',function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar now=Browser.now();\r\n\t\t\t\t\tif (now-_this._lastMoveTimer < 10)return;\r\n\t\t\t\t\t_this._lastMoveTimer=now;\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t}\r\n\t\t\t},true);\r\n\t\t\tcanvas.addEventListener(\"mouseout\",function(e){\r\n\t\t\t\tif (MouseManager.enabled)list.push(e);\r\n\t\t\t})\r\n\t\t\tcanvas.addEventListener(\"mouseover\",function(e){\r\n\t\t\t\tif (MouseManager.enabled)list.push(e);\r\n\t\t\t})\r\n\t\t\tcanvas.addEventListener(\"touchstart\",function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t\t_$this.runEvent();\r\n\t\t\t\t\tif (!Input.isInputting)e.preventDefault();\r\n\t\t\t\t\t_this.mouseDownTime=Browser.now();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tcanvas.addEventListener(\"touchend\",function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\tif (!Input.isInputting)e.preventDefault();\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t\t_this.mouseDownTime=-Browser.now();\r\n\t\t\t\t}\r\n\t\t\t},true);\r\n\t\t\tcanvas.addEventListener(\"touchmove\",function(e){\r\n\t\t\t\tif (MouseManager.enabled){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tlist.push(e);\r\n\t\t\t\t}\r\n\t\t\t},true);\r\n\t\t\tcanvas.addEventListener('mousewheel',function(e){\r\n\t\t\t\tif (MouseManager.enabled)list.push(e);\r\n\t\t\t});\r\n\t\t\tcanvas.addEventListener('DOMMouseScroll',function(e){\r\n\t\t\t\tif (MouseManager.enabled)list.push(e);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t__proto.initEvent=function(e,nativeEvent){\r\n\t\t\tvar _this=this;\r\n\t\t\t_this._event._stoped=false;\r\n\t\t\t_this._event.nativeEvent=nativeEvent || e;\r\n\t\t\t_this._target=null;\r\n\t\t\tthis._point.setTo(e.clientX,e.clientY);\r\n\t\t\tthis._stage._canvasTransform.invertTransformPoint(this._point);\r\n\t\t\t_this.mouseX=this._point.x;\r\n\t\t\t_this.mouseY=this._point.y;\r\n\t\t\t_this._event.touchId=e.identifier || 0;\r\n\t\t}\r\n\r\n\t\t__proto.checkMouseWheel=function(e){\r\n\t\t\tthis._event.delta=e.wheelDelta ? e.wheelDelta *0.025 :-e.detail;\r\n\t\t\tfor (var i=0,n=this._lastOvers.length;i < n;i++){\r\n\t\t\t\tvar ele=this._lastOvers[i];\r\n\t\t\t\tele.event(/*laya.events.Event.MOUSE_WHEEL*/\"mousewheel\",this._event.setTo(/*laya.events.Event.MOUSE_WHEEL*/\"mousewheel\",ele,this._target));\r\n\t\t\t}\r\n\t\t\tthis._stage.event(/*laya.events.Event.MOUSE_WHEEL*/\"mousewheel\",this._event.setTo(/*laya.events.Event.MOUSE_WHEEL*/\"mousewheel\",this._stage,this._target));\r\n\t\t}\r\n\r\n\t\t__proto.checkMouseOut=function(){\r\n\t\t\tif (this.disableMouseEvent)return;\r\n\t\t\tfor (var i=0,n=this._lastOvers.length;i < n;i++){\r\n\t\t\t\tvar ele=this._lastOvers[i];\r\n\t\t\t\tif (!ele.destroyed && this._currOvers.indexOf(ele)< 0){\r\n\t\t\t\t\tele._set$P(\"$_MOUSEOVER\",false);\r\n\t\t\t\t\tele.event(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",this._event.setTo(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",ele,this._target));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar temp=this._lastOvers;\r\n\t\t\tthis._lastOvers=this._currOvers;\r\n\t\t\tthis._currOvers=temp;\r\n\t\t\tthis._currOvers.length=0;\r\n\t\t}\r\n\r\n\t\t__proto.onMouseMove=function(ele){\r\n\t\t\tthis.sendMouseMove(ele);\r\n\t\t\tthis._event._stoped=false;\r\n\t\t\tthis.sendMouseOver(this._target);\r\n\t\t}\r\n\r\n\t\t__proto.sendMouseMove=function(ele){\r\n\t\t\tele.event(/*laya.events.Event.MOUSE_MOVE*/\"mousemove\",this._event.setTo(/*laya.events.Event.MOUSE_MOVE*/\"mousemove\",ele,this._target));\r\n\t\t\t!this._event._stoped && ele.parent && this.sendMouseMove(ele.parent);\r\n\t\t}\r\n\r\n\t\t__proto.sendMouseOver=function(ele){\r\n\t\t\tif (ele.parent || ele===this._stage){\r\n\t\t\t\tif (!ele._get$P(\"$_MOUSEOVER\")){\r\n\t\t\t\t\tele._set$P(\"$_MOUSEOVER\",true);\r\n\t\t\t\t\tele.event(/*laya.events.Event.MOUSE_OVER*/\"mouseover\",this._event.setTo(/*laya.events.Event.MOUSE_OVER*/\"mouseover\",ele,this._target));\r\n\t\t\t\t}\r\n\t\t\t\tthis._currOvers.push(ele);\r\n\t\t\t}\r\n\t\t\t!this._event._stoped && ele.parent && this.sendMouseOver(ele.parent);\r\n\t\t}\r\n\r\n\t\t__proto.onMouseDown=function(ele){\r\n\t\t\tif (Input.isInputting && Laya.stage.focus && Laya.stage.focus[\"focus\"] && !Laya.stage.focus.contains(this._target)){\r\n\t\t\t\tLaya.stage.focus[\"focus\"]=false;\r\n\t\t\t}\r\n\t\t\tthis._onMouseDown(ele);\r\n\t\t}\r\n\r\n\t\t__proto._onMouseDown=function(ele){\r\n\t\t\tif (this._isLeftMouse){\r\n\t\t\t\tele._set$P(\"$_MOUSEDOWN\",this._touchIDs[this._event.touchId]);\r\n\t\t\t\tele.event(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",this._event.setTo(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",ele,this._target));\r\n\t\t\t\t}else {\r\n\t\t\t\tele._set$P(\"$_RIGHTMOUSEDOWN\",this._touchIDs[this._event.touchId]);\r\n\t\t\t\tele.event(/*laya.events.Event.RIGHT_MOUSE_DOWN*/\"rightmousedown\",this._event.setTo(/*laya.events.Event.RIGHT_MOUSE_DOWN*/\"rightmousedown\",ele,this._target));\r\n\t\t\t}\r\n\t\t\t!this._event._stoped && ele.parent && this.onMouseDown(ele.parent);\r\n\t\t}\r\n\r\n\t\t__proto.onMouseUp=function(ele){\r\n\t\t\tvar type=this._isLeftMouse ? /*laya.events.Event.MOUSE_UP*/\"mouseup\" :/*laya.events.Event.RIGHT_MOUSE_UP*/\"rightmouseup\";\r\n\t\t\tthis.sendMouseUp(ele,type);\r\n\t\t\tthis._event._stoped=false;\r\n\t\t\tthis.sendClick(this._target,type);\r\n\t\t}\r\n\r\n\t\t__proto.sendMouseUp=function(ele,type){\r\n\t\t\tele.event(type,this._event.setTo(type,ele,this._target));\r\n\t\t\t!this._event._stoped && ele.parent && this.sendMouseUp(ele.parent,type);\r\n\t\t}\r\n\r\n\t\t__proto.sendClick=function(ele,type){\r\n\t\t\tif (ele.destroyed)return;\r\n\t\t\tif (type===/*laya.events.Event.MOUSE_UP*/\"mouseup\" && ele._get$P(\"$_MOUSEDOWN\")===this._touchIDs[this._event.touchId]){\r\n\t\t\t\tele._set$P(\"$_MOUSEDOWN\",-1);\r\n\t\t\t\tele.event(/*laya.events.Event.CLICK*/\"click\",this._event.setTo(/*laya.events.Event.CLICK*/\"click\",ele,this._target));\r\n\t\t\t\tthis._isDoubleClick && ele.event(/*laya.events.Event.DOUBLE_CLICK*/\"doubleclick\",this._event.setTo(/*laya.events.Event.DOUBLE_CLICK*/\"doubleclick\",ele,this._target));\r\n\t\t\t\t}else if (type===/*laya.events.Event.RIGHT_MOUSE_UP*/\"rightmouseup\" && ele._get$P(\"$_RIGHTMOUSEDOWN\")===this._touchIDs[this._event.touchId]){\r\n\t\t\t\tele._set$P(\"$_RIGHTMOUSEDOWN\",-1);\r\n\t\t\t\tele.event(/*laya.events.Event.RIGHT_CLICK*/\"rightclick\",this._event.setTo(/*laya.events.Event.RIGHT_CLICK*/\"rightclick\",ele,this._target));\r\n\t\t\t}\r\n\t\t\t!this._event._stoped && ele.parent && this.sendClick(ele.parent,type);\r\n\t\t}\r\n\r\n\t\t__proto.check=function(sp,mouseX,mouseY,callBack){\r\n\t\t\tvar transform=sp.transform || this._matrix;\r\n\t\t\tvar pivotX=sp.pivotX;\r\n\t\t\tvar pivotY=sp.pivotY;\r\n\t\t\tif (pivotX===0 && pivotY===0){\r\n\t\t\t\ttransform.setTranslate(sp.x,sp.y);\r\n\t\t\t\t}else {\r\n\t\t\t\tif (transform===this._matrix){\r\n\t\t\t\t\ttransform.setTranslate(sp.x-pivotX,sp.y-pivotY);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar cos=transform.cos;\r\n\t\t\t\t\tvar sin=transform.sin;\r\n\t\t\t\t\ttransform.setTranslate(sp.x-(pivotX *cos-pivotY *sin)*sp.scaleX,sp.y-(pivotX *sin+pivotY *cos)*sp.scaleY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttransform.invertTransformPoint(this._point.setTo(mouseX,mouseY));\r\n\t\t\ttransform.setTranslate(0,0);\r\n\t\t\tmouseX=this._point.x;\r\n\t\t\tmouseY=this._point.y;\r\n\t\t\tvar scrollRect=sp.scrollRect;\r\n\t\t\tif (scrollRect){\r\n\t\t\t\tthis._rect.setTo(0,0,scrollRect.width,scrollRect.height);\r\n\t\t\t\tvar isHit=this._rect.contains(mouseX,mouseY);\r\n\t\t\t\tif (!isHit)return false;\r\n\t\t\t}\r\n\t\t\tif (!this.disableMouseEvent){\r\n\t\t\t\tvar flag=false;\r\n\t\t\t\tif (sp.hitTestPrior && !sp.mouseThrough && !this.hitTest(sp,mouseX,mouseY)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i=sp._childs.length-1;i >-1;i--){\r\n\t\t\t\t\tvar child=sp._childs[i];\r\n\t\t\t\t\tif (!child.destroyed && child.mouseEnabled && child.visible){\r\n\t\t\t\t\t\tflag=this.check(child,mouseX+(scrollRect ? scrollRect.x :0),mouseY+(scrollRect ? scrollRect.y :0),callBack);\r\n\t\t\t\t\t\tif (flag)return true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tisHit=this.hitTest(sp,mouseX,mouseY);\r\n\t\t\tif (isHit){\r\n\t\t\t\tthis._target=sp;\r\n\t\t\t\tcallBack.call(this,sp);\r\n\t\t\t\t}else if (callBack===this.onMouseUp && sp===this._stage){\r\n\t\t\t\tthis._target=this._stage;\r\n\t\t\t\tcallBack.call(this,this._target);\r\n\t\t\t}\r\n\t\t\treturn isHit;\r\n\t\t}\r\n\r\n\t\t__proto.hitTest=function(sp,mouseX,mouseY){\r\n\t\t\tvar isHit=false;\r\n\t\t\tif ((sp.hitArea instanceof laya.utils.HitArea )){\r\n\t\t\t\treturn sp.hitArea.isHit(mouseX,mouseY);\r\n\t\t\t}\r\n\t\t\tif (sp.width > 0 && sp.height > 0 || sp.mouseThrough || sp.hitArea){\r\n\t\t\t\tvar hitRect=this._rect;\r\n\t\t\t\tif (!sp.mouseThrough){\r\n\t\t\t\t\tif (sp.hitArea)hitRect=sp.hitArea;\r\n\t\t\t\t\telse hitRect.setTo(0,0,sp.width,sp.height);\r\n\t\t\t\t\tisHit=hitRect.contains(mouseX,mouseY);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tisHit=sp.getGraphicBounds().contains(mouseX,mouseY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn isHit;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*执行事件处理。\r\n\t\t*/\r\n\t\t__proto.runEvent=function(){\r\n\t\t\tvar len=this._eventList.length;\r\n\t\t\tif (!len)return;\r\n\t\t\tvar _this=this;\r\n\t\t\tvar i=0;\r\n\t\t\twhile (i < len){\r\n\t\t\t\tvar evt=this._eventList[i];\r\n\t\t\t\tif (evt.type!=='mousemove')this._prePoint.x=this._prePoint.y=-1000000;\r\n\t\t\t\tswitch (evt.type){\r\n\t\t\t\t\tcase 'mousedown':\r\n\t\t\t\t\t\tthis._touchIDs[0]=this._id++;\r\n\t\t\t\t\t\tif (!MouseManager._isTouchRespond){\r\n\t\t\t\t\t\t\t_this._isLeftMouse=evt.button===0;\r\n\t\t\t\t\t\t\t_this.initEvent(evt);\r\n\t\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseDown);\r\n\t\t\t\t\t\t}else\r\n\t\t\t\t\t\tMouseManager._isTouchRespond=false;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'mouseup':\r\n\t\t\t\t\t\t_this._isLeftMouse=evt.button===0;\r\n\t\t\t\t\t\tvar now=Browser.now();\r\n\t\t\t\t\t\t_this._isDoubleClick=(now-_this._lastClickTimer)< 300;\r\n\t\t\t\t\t\t_this._lastClickTimer=now;\r\n\t\t\t\t\t\t_this.initEvent(evt);\r\n\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseUp);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'mousemove':\r\n\t\t\t\t\t\tif ((Math.abs(this._prePoint.x-evt.clientX)+Math.abs(this._prePoint.y-evt.clientY))>=this.mouseMoveAccuracy){\r\n\t\t\t\t\t\t\tthis._prePoint.x=evt.clientX;\r\n\t\t\t\t\t\t\tthis._prePoint.y=evt.clientY;\r\n\t\t\t\t\t\t\t_this.initEvent(evt);\r\n\t\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseMove);\r\n\t\t\t\t\t\t\t_this.checkMouseOut();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"touchstart\":\r\n\t\t\t\t\t\tMouseManager._isTouchRespond=true;\r\n\t\t\t\t\t\t_this._isLeftMouse=true;\r\n\t\t\t\t\t\tvar touches=evt.changedTouches;\r\n\t\t\t\t\t\tfor (var j=0,n=touches.length;j < n;j++){\r\n\t\t\t\t\t\t\tvar touch=touches[j];\r\n\t\t\t\t\t\t\tif (this._id % 200===0)this._touchIDs={};\r\n\t\t\t\t\t\t\tthis._touchIDs[touch.identifier]=this._id++;\r\n\t\t\t\t\t\t\t_this.initEvent(touch,evt);\r\n\t\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseDown);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"touchend\":\r\n\t\t\t\t\t\tMouseManager._isTouchRespond=true;\r\n\t\t\t\t\t\t_this._isLeftMouse=true;\r\n\t\t\t\t\t\tnow=Browser.now();\r\n\t\t\t\t\t\t_this._isDoubleClick=(now-_this._lastClickTimer)< 300;\r\n\t\t\t\t\t\t_this._lastClickTimer=now;\r\n\t\t\t\t\t\tvar touchends=evt.changedTouches;\r\n\t\t\t\t\t\tfor (j=0,n=touchends.length;j < n;j++){\r\n\t\t\t\t\t\t\t_this.initEvent(touchends[j],evt);\r\n\t\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseUp);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"touchmove\":;\r\n\t\t\t\t\t\tvar touchemoves=evt.changedTouches;\r\n\t\t\t\t\t\tfor (j=0,n=touchemoves.length;j < n;j++){\r\n\t\t\t\t\t\t\t_this.initEvent(touchemoves[j],evt);\r\n\t\t\t\t\t\t\t_this.check(_this._stage,_this.mouseX,_this.mouseY,_this.onMouseMove);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.checkMouseOut();\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"wheel\":\r\n\t\t\t\t\tcase \"mousewheel\":\r\n\t\t\t\t\tcase \"DOMMouseScroll\":\r\n\t\t\t\t\t\t_this.checkMouseWheel(evt);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"mouseout\":\r\n\t\t\t\t\t\t_this._stage.event(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",_this._event.setTo(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",_this._stage,_this._stage));\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"mouseover\":\r\n\t\t\t\t\t\t_this._stage.event(/*laya.events.Event.MOUSE_OVER*/\"mouseover\",_this._event.setTo(/*laya.events.Event.MOUSE_OVER*/\"mouseover\",_this._stage,_this._stage));\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\tthis._eventList.length=0;\r\n\t\t}\r\n\r\n\t\tMouseManager.enabled=true;\r\n\t\tMouseManager._isTouchRespond=false;\r\n\t\t__static(MouseManager,\r\n\t\t['instance',function(){return this.instance=new MouseManager();}\r\n\t\t]);\r\n\t\treturn MouseManager;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Filter</code> 是滤镜基类。\r\n\t*/\r\n\t//class laya.filters.Filter\r\n\tvar Filter=(function(){\r\n\t\tfunction Filter(){\r\n\t\t\tthis._action=null;\r\n\t\t}\r\n\r\n\t\t__class(Filter,'laya.filters.Filter');\r\n\t\tvar __proto=Filter.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilter\":true})\r\n\t\t/**@private */\r\n\t\t__proto.callNative=function(sp){}\r\n\t\t/**@private 滤镜类型。*/\r\n\t\t__getset(0,__proto,'type',function(){return-1});\r\n\t\t/**@private 滤镜动作。*/\r\n\t\t__getset(0,__proto,'action',function(){return this._action });\r\n\t\tFilter.BLUR=0x10;\r\n\t\tFilter.COLOR=0x20;\r\n\t\tFilter.GLOW=0x08;\r\n\t\tFilter._filterStart=null\r\n\t\tFilter._filterEnd=null\r\n\t\tFilter._EndTarget=null\r\n\t\tFilter._recycleScope=null\r\n\t\tFilter._filter=null\r\n\t\tFilter._useSrc=null\r\n\t\tFilter._endSrc=null\r\n\t\tFilter._useOut=null\r\n\t\tFilter._endOut=null\r\n\t\treturn Filter;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>ColorFilterAction</code> 是一个颜色滤镜应用类。\r\n\t*/\r\n\t//class laya.filters.ColorFilterAction\r\n\tvar ColorFilterAction=(function(){\r\n\t\tfunction ColorFilterAction(){\r\n\t\t\tthis.data=null;\r\n\t\t}\r\n\r\n\t\t__class(ColorFilterAction,'laya.filters.ColorFilterAction');\r\n\t\tvar __proto=ColorFilterAction.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilterAction\":true})\r\n\t\t/**\r\n\t\t*给指定的对象应用颜色滤镜。\r\n\t\t*@param srcCanvas 需要应用画布对象。\r\n\t\t*@return 应用了滤镜后的画布对象。\r\n\t\t*/\r\n\t\t__proto.apply=function(srcCanvas){\r\n\t\t\tvar ctx=srcCanvas.ctx.ctx;\r\n\t\t\tvar canvas=srcCanvas.ctx.ctx.canvas;\r\n\t\t\tif (canvas.width==0 || canvas.height==0)return canvas;\r\n\t\t\tvar imgdata=ctx.getImageData(0,0,canvas.width,canvas.height);\r\n\t\t\tvar data=imgdata.data;\r\n\t\t\tvar nData;\r\n\t\t\tfor (var i=0,n=data.length;i < n;i+=4){\r\n\t\t\t\tnData=this.getColor(data[i],data[i+1],data[i+2],data[i+3]);\r\n\t\t\t\tif (data[i+3]==0)continue ;\r\n\t\t\t\tdata[i]=nData[0];\r\n\t\t\t\tdata[i+1]=nData[1];\r\n\t\t\t\tdata[i+2]=nData[2];\r\n\t\t\t\tdata[i+3]=nData[3];\r\n\t\t\t}\r\n\t\t\tctx.putImageData(imgdata,0,0);\r\n\t\t\treturn srcCanvas;\r\n\t\t}\r\n\r\n\t\t__proto.getColor=function(red,green,blue,alpha){\r\n\t\t\tvar rst=[];\r\n\t\t\tif (this.data._mat && this.data._alpha){\r\n\t\t\t\tvar mat=this.data._mat;\r\n\t\t\t\tvar tempAlpha=this.data._alpha;\r\n\t\t\t\trst[0]=mat[0] *red+mat[1] *green+mat[2] *blue+mat[3] *alpha+tempAlpha[0];\r\n\t\t\t\trst[1]=mat[4] *red+mat[5] *green+mat[6] *blue+mat[7] *alpha+tempAlpha[1];\r\n\t\t\t\trst[2]=mat[8] *red+mat[9] *green+mat[10] *blue+mat[11] *alpha+tempAlpha[2];\r\n\t\t\t\trst[3]=mat[12] *red+mat[13] *green+mat[14] *blue+mat[15] *alpha+tempAlpha[3];\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\treturn ColorFilterAction;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.maths.Arith\r\n\tvar Arith=(function(){\r\n\t\tfunction Arith(){};\r\n\t\t__class(Arith,'laya.maths.Arith');\r\n\t\tArith.formatR=function(r){\r\n\t\t\tif (r > Math.PI)r-=Math.PI *2;\r\n\t\t\tif (r <-Math.PI)r+=Math.PI *2;\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\tArith.isPOT=function(w,h){\r\n\t\t\treturn (w > 0 && (w & (w-1))===0 && h > 0 && (h & (h-1))===0);\r\n\t\t}\r\n\r\n\t\tArith.setMatToArray=function(mat,array){\r\n\t\t\tmat.a,mat.b,0,0,mat.c,mat.d,0,0,0,0,1,0,mat.tx+20,mat.ty+20,0,1\r\n\t\t\tarray[0]=mat.a;\r\n\t\t\tarray[1]=mat.b;\r\n\t\t\tarray[4]=mat.c;\r\n\t\t\tarray[5]=mat.d;\r\n\t\t\tarray[12]=mat.tx;\r\n\t\t\tarray[13]=mat.ty;\r\n\t\t}\r\n\r\n\t\treturn Arith;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*计算贝塞尔曲线的工具类。\r\n\t*/\r\n\t//class laya.maths.Bezier\r\n\tvar Bezier=(function(){\r\n\t\tfunction Bezier(){\r\n\t\t\tthis._controlPoints=[new Point(),new Point(),new Point()];\r\n\t\t\tthis._calFun=this.getPoint2;\r\n\t\t}\r\n\r\n\t\t__class(Bezier,'laya.maths.Bezier');\r\n\t\tvar __proto=Bezier.prototype;\r\n\t\t/**@private */\r\n\t\t__proto._switchPoint=function(x,y){\r\n\t\t\tvar tPoint=this._controlPoints.shift();\r\n\t\t\ttPoint.setTo(x,y);\r\n\t\t\tthis._controlPoints.push(tPoint);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*计算二次贝塞尔点。\r\n\t\t*@param t\r\n\t\t*@param rst\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.getPoint2=function(t,rst){\r\n\t\t\tvar p1=this._controlPoints[0];\r\n\t\t\tvar p2=this._controlPoints[1];\r\n\t\t\tvar p3=this._controlPoints[2];\r\n\t\t\tvar lineX=Math.pow((1-t),2)*p1.x+2 *t *(1-t)*p2.x+Math.pow(t,2)*p3.x;\r\n\t\t\tvar lineY=Math.pow((1-t),2)*p1.y+2 *t *(1-t)*p2.y+Math.pow(t,2)*p3.y;\r\n\t\t\trst.push(lineX,lineY);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*计算三次贝塞尔点\r\n\t\t*@param t\r\n\t\t*@param rst\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.getPoint3=function(t,rst){\r\n\t\t\tvar p1=this._controlPoints[0];\r\n\t\t\tvar p2=this._controlPoints[1];\r\n\t\t\tvar p3=this._controlPoints[2];\r\n\t\t\tvar p4=this._controlPoints[3];\r\n\t\t\tvar lineX=Math.pow((1-t),3)*p1.x+3 *p2.x *t *(1-t)*(1-t)+3 *p3.x *t *t *(1-t)+p4.x *Math.pow(t,3);\r\n\t\t\tvar lineY=Math.pow((1-t),3)*p1.y+3 *p2.y *t *(1-t)*(1-t)+3 *p3.y *t *t *(1-t)+p4.y *Math.pow(t,3);\r\n\t\t\trst.push(lineX,lineY);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*计算贝塞尔点序列\r\n\t\t*@param count\r\n\t\t*@param rst\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.insertPoints=function(count,rst){\r\n\t\t\tvar i=NaN;\r\n\t\t\tcount=count > 0 ? count :5;\r\n\t\t\tvar dLen=NaN;\r\n\t\t\tdLen=1 / count;\r\n\t\t\tfor (i=0;i <=1;i+=dLen){\r\n\t\t\t\tthis._calFun(i,rst);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取贝塞尔曲线上的点。\r\n\t\t*@param pList 控制点[x0,y0,x1,y1...]\r\n\t\t*@param inSertCount 每次曲线的插值数量\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.getBezierPoints=function(pList,inSertCount,count){\r\n\t\t\t(inSertCount===void 0)&& (inSertCount=5);\r\n\t\t\t(count===void 0)&& (count=2);\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=pList.length;\r\n\t\t\tif (len < (count+1)*2)return [];\r\n\t\t\tvar rst;\r\n\t\t\trst=[];\r\n\t\t\tswitch (count){\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tthis._calFun=this.getPoint2;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tthis._calFun=this.getPoint3;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\twhile(this._controlPoints.length<=count){\r\n\t\t\t\tthis._controlPoints.push(new Point());\r\n\t\t\t}\r\n\t\t\tfor (i=0;i < count *2;i+=2){\r\n\t\t\t\tthis._switchPoint(pList[i],pList[i+1]);\r\n\t\t\t}\r\n\t\t\tfor (i=count *2;i < len;i+=2){\r\n\t\t\t\tthis._switchPoint(pList[i],pList[i+1]);\r\n\t\t\t\tif ((i / 2)% count==0)\r\n\t\t\t\t\tthis.insertPoints(inSertCount,rst);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t__static(Bezier,\r\n\t\t['I',function(){return this.I=new Bezier();}\r\n\t\t]);\r\n\t\treturn Bezier;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*凸包算法。\r\n\t*/\r\n\t//class laya.maths.GrahamScan\r\n\tvar GrahamScan=(function(){\r\n\t\tfunction GrahamScan(){};\r\n\t\t__class(GrahamScan,'laya.maths.GrahamScan');\r\n\t\tGrahamScan.multiply=function(p1,p2,p0){\r\n\t\t\treturn ((p1.x-p0.x)*(p2.y-p0.y)-(p2.x-p0.x)*(p1.y-p0.y));\r\n\t\t}\r\n\r\n\t\tGrahamScan.dis=function(p1,p2){\r\n\t\t\treturn (p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);\r\n\t\t}\r\n\r\n\t\tGrahamScan._getPoints=function(count,tempUse,rst){\r\n\t\t\t(tempUse===void 0)&& (tempUse=false);\r\n\t\t\tif (!GrahamScan._mPointList)GrahamScan._mPointList=[];\r\n\t\t\twhile (GrahamScan._mPointList.length < count)GrahamScan._mPointList.push(new Point());\r\n\t\t\tif (!rst)rst=[];\r\n\t\t\trst.length=0;\r\n\t\t\tif (tempUse){\r\n\t\t\t\tGrahamScan.getFrom(rst,GrahamScan._mPointList,count);\r\n\t\t\t\t}else {\r\n\t\t\t\tGrahamScan.getFromR(rst,GrahamScan._mPointList,count);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGrahamScan.getFrom=function(rst,src,count){\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=0;i < count;i++){\r\n\t\t\t\trst.push(src[i]);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGrahamScan.getFromR=function(rst,src,count){\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=0;i < count;i++){\r\n\t\t\t\trst.push(src.pop());\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGrahamScan.pListToPointList=function(pList,tempUse){\r\n\t\t\t(tempUse===void 0)&& (tempUse=false);\r\n\t\t\tvar i=0,len=pList.length / 2,rst=GrahamScan._getPoints(len,tempUse,GrahamScan._tempPointList);\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\trst[i].setTo(pList[i+i],pList[i+i+1]);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGrahamScan.pointListToPlist=function(pointList){\r\n\t\t\tvar i=0,len=pointList.length,rst=GrahamScan._temPList,tPoint;\r\n\t\t\trst.length=0;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\ttPoint=pointList[i];\r\n\t\t\t\trst.push(tPoint.x,tPoint.y);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGrahamScan.scanPList=function(pList){\r\n\t\t\treturn Utils.copyArray(pList,GrahamScan.pointListToPlist(GrahamScan.scan(GrahamScan.pListToPointList(pList,true))));\r\n\t\t}\r\n\r\n\t\tGrahamScan.scan=function(PointSet){\r\n\t\t\tvar i=0,j=0,k=0,top=2,tmp,n=PointSet.length,ch;\r\n\t\t\tvar _tmpDic={};\r\n\t\t\tvar key;\r\n\t\t\tch=GrahamScan._temArr;\r\n\t\t\tch.length=0;\r\n\t\t\tn=PointSet.length;\r\n\t\t\tfor (i=n-1;i >=0;i--){\r\n\t\t\t\ttmp=PointSet[i];\r\n\t\t\t\tkey=tmp.x+\"_\"+tmp.y;\r\n\t\t\t\tif (!_tmpDic.hasOwnProperty(key)){\r\n\t\t\t\t\t_tmpDic[key]=true;\r\n\t\t\t\t\tch.push(tmp);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tn=ch.length;\r\n\t\t\tUtils.copyArray(PointSet,ch);\r\n\t\t\tfor (i=1;i < n;i++)\r\n\t\t\tif ((PointSet[i].y < PointSet[k].y)|| ((PointSet[i].y==PointSet[k].y)&& (PointSet[i].x < PointSet[k].x)))\r\n\t\t\t\tk=i;\r\n\t\t\ttmp=PointSet[0];\r\n\t\t\tPointSet[0]=PointSet[k];\r\n\t\t\tPointSet[k]=tmp;\r\n\t\t\tfor (i=1;i < n-1;i++){\r\n\t\t\t\tk=i;\r\n\t\t\t\tfor (j=i+1;j < n;j++)\r\n\t\t\t\tif ((GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])> 0)|| ((GrahamScan.multiply(PointSet[j],PointSet[k],PointSet[0])==0)&& (GrahamScan.dis(PointSet[0],PointSet[j])< GrahamScan.dis(PointSet[0],PointSet[k]))))\r\n\t\t\t\t\tk=j;\r\n\t\t\t\ttmp=PointSet[i];\r\n\t\t\t\tPointSet[i]=PointSet[k];\r\n\t\t\t\tPointSet[k]=tmp;\r\n\t\t\t}\r\n\t\t\tch=GrahamScan._temArr;\r\n\t\t\tch.length=0;\r\n\t\t\tif (PointSet.length < 3){\r\n\t\t\t\treturn Utils.copyArray(ch,PointSet);\r\n\t\t\t}\r\n\t\t\tch.push(PointSet[0],PointSet[1],PointSet[2]);\r\n\t\t\tfor (i=3;i < n;i++){\r\n\t\t\t\twhile (ch.length >=2 && GrahamScan.multiply(PointSet[i],ch[ch.length-1],ch[ch.length-2])>=0)ch.pop();\r\n\t\t\t\tPointSet[i] && ch.push(PointSet[i]);\r\n\t\t\t}\r\n\t\t\treturn ch;\r\n\t\t}\r\n\r\n\t\tGrahamScan._mPointList=null\r\n\t\tGrahamScan._tempPointList=[];\r\n\t\tGrahamScan._temPList=[];\r\n\t\tGrahamScan._temArr=[];\r\n\t\treturn GrahamScan;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>MathUtil</code> 是一个数据处理工具类。\r\n\t*/\r\n\t//class laya.maths.MathUtil\r\n\tvar MathUtil=(function(){\r\n\t\tfunction MathUtil(){};\r\n\t\t__class(MathUtil,'laya.maths.MathUtil');\r\n\t\tMathUtil.subtractVector3=function(l,r,o){\r\n\t\t\to[0]=l[0]-r[0];\r\n\t\t\to[1]=l[1]-r[1];\r\n\t\t\to[2]=l[2]-r[2];\r\n\t\t}\r\n\r\n\t\tMathUtil.lerp=function(left,right,amount){\r\n\t\t\treturn left *(1-amount)+right *amount;\r\n\t\t}\r\n\r\n\t\tMathUtil.scaleVector3=function(f,b,e){\r\n\t\t\te[0]=f[0] *b;\r\n\t\t\te[1]=f[1] *b;\r\n\t\t\te[2]=f[2] *b;\r\n\t\t}\r\n\r\n\t\tMathUtil.lerpVector3=function(l,r,t,o){\r\n\t\t\tvar ax=l[0],ay=l[1],az=l[2];\r\n\t\t\to[0]=ax+t *(r[0]-ax);\r\n\t\t\to[1]=ay+t *(r[1]-ay);\r\n\t\t\to[2]=az+t *(r[2]-az);\r\n\t\t}\r\n\r\n\t\tMathUtil.lerpVector4=function(l,r,t,o){\r\n\t\t\tvar ax=l[0],ay=l[1],az=l[2],aw=l[3];\r\n\t\t\to[0]=ax+t *(r[0]-ax);\r\n\t\t\to[1]=ay+t *(r[1]-ay);\r\n\t\t\to[2]=az+t *(r[2]-az);\r\n\t\t\to[3]=aw+t *(r[3]-aw);\r\n\t\t}\r\n\r\n\t\tMathUtil.slerpQuaternionArray=function(a,Offset1,b,Offset2,t,out,Offset3){\r\n\t\t\tvar ax=a[Offset1+0],ay=a[Offset1+1],az=a[Offset1+2],aw=a[Offset1+3],bx=b[Offset2+0],by=b[Offset2+1],bz=b[Offset2+2],bw=b[Offset2+3];\r\n\t\t\tvar omega,cosom,sinom,scale0,scale1;\r\n\t\t\tcosom=ax *bx+ay *by+az *bz+aw *bw;\r\n\t\t\tif (cosom < 0.0){\r\n\t\t\t\tcosom=-cosom;\r\n\t\t\t\tbx=-bx;\r\n\t\t\t\tby=-by;\r\n\t\t\t\tbz=-bz;\r\n\t\t\t\tbw=-bw;\r\n\t\t\t}\r\n\t\t\tif ((1.0-cosom)> 0.000001){\r\n\t\t\t\tomega=Math.acos(cosom);\r\n\t\t\t\tsinom=Math.sin(omega);\r\n\t\t\t\tscale0=Math.sin((1.0-t)*omega)/ sinom;\r\n\t\t\t\tscale1=Math.sin(t *omega)/ sinom;\r\n\t\t\t\t}else {\r\n\t\t\t\tscale0=1.0-t;\r\n\t\t\t\tscale1=t;\r\n\t\t\t}\r\n\t\t\tout[Offset3+0]=scale0 *ax+scale1 *bx;\r\n\t\t\tout[Offset3+1]=scale0 *ay+scale1 *by;\r\n\t\t\tout[Offset3+2]=scale0 *az+scale1 *bz;\r\n\t\t\tout[Offset3+3]=scale0 *aw+scale1 *bw;\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMathUtil.getRotation=function(x0,y0,x1,y1){\r\n\t\t\treturn Math.atan2(y1-y0,x1-x0)/ Math.PI *180;\r\n\t\t}\r\n\r\n\t\tMathUtil.sortBigFirst=function(a,b){\r\n\t\t\tif (a==b)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn b > a ? 1 :-1;\r\n\t\t}\r\n\r\n\t\tMathUtil.sortSmallFirst=function(a,b){\r\n\t\t\tif (a==b)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn b > a ?-1 :1;\r\n\t\t}\r\n\r\n\t\tMathUtil.sortNumBigFirst=function(a,b){\r\n\t\t\treturn parseFloat(b)-parseFloat(a);\r\n\t\t}\r\n\r\n\t\tMathUtil.sortNumSmallFirst=function(a,b){\r\n\t\t\treturn parseFloat(a)-parseFloat(b);\r\n\t\t}\r\n\r\n\t\tMathUtil.sortByKey=function(key,bigFirst,forceNum){\r\n\t\t\t(bigFirst===void 0)&& (bigFirst=false);\r\n\t\t\t(forceNum===void 0)&& (forceNum=true);\r\n\t\t\tvar _sortFun;\r\n\t\t\tif (bigFirst){\r\n\t\t\t\t_sortFun=forceNum ? MathUtil.sortNumBigFirst :MathUtil.sortBigFirst;\r\n\t\t\t\t}else {\r\n\t\t\t\t_sortFun=forceNum ? MathUtil.sortNumSmallFirst :MathUtil.sortSmallFirst;\r\n\t\t\t}\r\n\t\t\treturn function (a,b){\r\n\t\t\t\treturn _sortFun(a[key],b[key]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn MathUtil;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Matrix</code> 类表示一个转换矩阵，它确定如何将点从一个坐标空间映射到另一个坐标空间。\r\n\t*/\r\n\t//class laya.maths.Matrix\r\n\tvar Matrix=(function(){\r\n\t\tfunction Matrix(a,b,c,d,tx,ty){\r\n\t\t\tthis.cos=1;\r\n\t\t\tthis.sin=0;\r\n\t\t\t//this.a=NaN;\r\n\t\t\t//this.b=NaN;\r\n\t\t\t//this.c=NaN;\r\n\t\t\t//this.d=NaN;\r\n\t\t\t//this.tx=NaN;\r\n\t\t\t//this.ty=NaN;\r\n\t\t\tthis.inPool=false;\r\n\t\t\tthis.bTransform=false;\r\n\t\t\t(a===void 0)&& (a=1);\r\n\t\t\t(b===void 0)&& (b=0);\r\n\t\t\t(c===void 0)&& (c=0);\r\n\t\t\t(d===void 0)&& (d=1);\r\n\t\t\t(tx===void 0)&& (tx=0);\r\n\t\t\t(ty===void 0)&& (ty=0);\r\n\t\t\tthis.a=a;\r\n\t\t\tthis.b=b;\r\n\t\t\tthis.c=c;\r\n\t\t\tthis.d=d;\r\n\t\t\tthis.tx=tx;\r\n\t\t\tthis.ty=ty;\r\n\t\t\tthis._checkTransform();\r\n\t\t}\r\n\r\n\t\t__class(Matrix,'laya.maths.Matrix');\r\n\t\tvar __proto=Matrix.prototype;\r\n\t\t/**\r\n\t\t*为每个矩阵属性设置一个值。\r\n\t\t*@return 返回当前矩形。\r\n\t\t*/\r\n\t\t__proto.identity=function(){\r\n\t\t\tthis.a=this.d=1;\r\n\t\t\tthis.b=this.tx=this.ty=this.c=0;\r\n\t\t\tthis.bTransform=false;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**@private*/\r\n\t\t__proto._checkTransform=function(){\r\n\t\t\treturn this.bTransform=(this.a!==1 || this.b!==0 || this.c!==0 || this.d!==1);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置沿 x 、y 轴平移每个点的距离。\r\n\t\t*@param x 沿 x 轴平移每个点的距离。\r\n\t\t*@param y 沿 y 轴平移每个点的距离。\r\n\t\t*@return 返回对象本身\r\n\t\t*/\r\n\t\t__proto.setTranslate=function(x,y){\r\n\t\t\tthis.tx=x;\r\n\t\t\tthis.ty=y;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*沿 x 和 y 轴平移矩阵，由 x 和 y 参数指定。\r\n\t\t*@param x 沿 x 轴向右移动的量（以像素为单位）。\r\n\t\t*@param y 沿 y 轴向下移动的量（以像素为单位）。\r\n\t\t*@return 返回此矩形。\r\n\t\t*/\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tthis.tx+=x;\r\n\t\t\tthis.ty+=y;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对矩阵应用缩放转换。\r\n\t\t*@param x 用于沿 x 轴缩放对象的乘数。\r\n\t\t*@param y 用于沿 y 轴缩放对象的乘数。\r\n\t\t*/\r\n\t\t__proto.scale=function(x,y){\r\n\t\t\tthis.a *=x;\r\n\t\t\tthis.d *=y;\r\n\t\t\tthis.c *=x;\r\n\t\t\tthis.b *=y;\r\n\t\t\tthis.tx *=x;\r\n\t\t\tthis.ty *=y;\r\n\t\t\tthis.bTransform=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对 Matrix 对象应用旋转转换。\r\n\t\t*@param angle 以弧度为单位的旋转角度。\r\n\t\t*/\r\n\t\t__proto.rotate=function(angle){\r\n\t\t\tvar cos=this.cos=Math.cos(angle);\r\n\t\t\tvar sin=this.sin=Math.sin(angle);\r\n\t\t\tvar a1=this.a;\r\n\t\t\tvar c1=this.c;\r\n\t\t\tvar tx1=this.tx;\r\n\t\t\tthis.a=a1 *cos-this.b *sin;\r\n\t\t\tthis.b=a1 *sin+this.b *cos;\r\n\t\t\tthis.c=c1 *cos-this.d *sin;\r\n\t\t\tthis.d=c1 *sin+this.d *cos;\r\n\t\t\tthis.tx=tx1 *cos-this.ty *sin;\r\n\t\t\tthis.ty=tx1 *sin+this.ty *cos;\r\n\t\t\tthis.bTransform=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对 Matrix 对象应用倾斜转换。\r\n\t\t*@param x 沿着 X 轴的 2D 倾斜弧度。\r\n\t\t*@param y 沿着 Y 轴的 2D 倾斜弧度。\r\n\t\t*@return 当前 Matrix 对象。\r\n\t\t*/\r\n\t\t__proto.skew=function(x,y){\r\n\t\t\tvar tanX=Math.tan(x);\r\n\t\t\tvar tanY=Math.tan(y);\r\n\t\t\tvar a1=this.a;\r\n\t\t\tvar b1=this.b;\r\n\t\t\tthis.a+=tanY *this.c;\r\n\t\t\tthis.b+=tanY *this.d;\r\n\t\t\tthis.c+=tanX *a1;\r\n\t\t\tthis.d+=tanX *b1;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对指定的点应用当前矩阵的逆转化并返回此点。\r\n\t\t*@param out 待转化的点 Point 对象。\r\n\t\t*@return 返回out\r\n\t\t*/\r\n\t\t__proto.invertTransformPoint=function(out){\r\n\t\t\tvar a1=this.a;\r\n\t\t\tvar b1=this.b;\r\n\t\t\tvar c1=this.c;\r\n\t\t\tvar d1=this.d;\r\n\t\t\tvar tx1=this.tx;\r\n\t\t\tvar n=a1 *d1-b1 *c1;\r\n\t\t\tvar a2=d1 / n;\r\n\t\t\tvar b2=-b1 / n;\r\n\t\t\tvar c2=-c1 / n;\r\n\t\t\tvar d2=a1 / n;\r\n\t\t\tvar tx2=(c1 *this.ty-d1 *tx1)/ n;\r\n\t\t\tvar ty2=-(a1 *this.ty-b1 *tx1)/ n;\r\n\t\t\treturn out.setTo(a2 *out.x+c2 *out.y+tx2,b2 *out.x+d2 *out.y+ty2);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将 Matrix 对象表示的几何转换应用于指定点。\r\n\t\t*@param out 用来设定输出结果的点。\r\n\t\t*@return 返回out\r\n\t\t*/\r\n\t\t__proto.transformPoint=function(out){\r\n\t\t\treturn out.setTo(this.a *out.x+this.c *out.y+this.tx,this.b *out.x+this.d *out.y+this.ty);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*将 Matrix 对象表示的几何转换应用于指定点。\r\n\t\t*@param data 点集合。\r\n\t\t*@param out 存储应用转化的点的列表。\r\n\t\t*@return 返回out数组\r\n\t\t*/\r\n\t\t__proto.transformPointArray=function(data,out){\r\n\t\t\tvar len=data.length;\r\n\t\t\tfor (var i=0;i < len;i+=2){\r\n\t\t\t\tvar x=data[i],y=data[i+1];\r\n\t\t\t\tout[i]=this.a *x+this.c *y+this.tx;\r\n\t\t\t\tout[i+1]=this.b *x+this.d *y+this.ty;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*将 Matrix 对象表示的几何缩放转换应用于指定点。\r\n\t\t*@param data 点集合。\r\n\t\t*@param out 存储应用转化的点的列表。\r\n\t\t*@return 返回out数组\r\n\t\t*/\r\n\t\t__proto.transformPointArrayScale=function(data,out){\r\n\t\t\tvar len=data.length;\r\n\t\t\tfor (var i=0;i < len;i+=2){\r\n\t\t\t\tvar x=data[i],y=data[i+1];\r\n\t\t\t\tout[i]=this.a *x+this.c *y;\r\n\t\t\t\tout[i+1]=this.b *x+this.d *y;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取 X 轴缩放值。\r\n\t\t*@return X 轴缩放值。\r\n\t\t*/\r\n\t\t__proto.getScaleX=function(){\r\n\t\t\treturn this.b===0 ? this.a :Math.sqrt(this.a *this.a+this.b *this.b);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取 Y 轴缩放值。\r\n\t\t*@return Y 轴缩放值。\r\n\t\t*/\r\n\t\t__proto.getScaleY=function(){\r\n\t\t\treturn this.c===0 ? this.d :Math.sqrt(this.c *this.c+this.d *this.d);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*执行原始矩阵的逆转换。\r\n\t\t*@return 当前矩阵对象。\r\n\t\t*/\r\n\t\t__proto.invert=function(){\r\n\t\t\tvar a1=this.a;\r\n\t\t\tvar b1=this.b;\r\n\t\t\tvar c1=this.c;\r\n\t\t\tvar d1=this.d;\r\n\t\t\tvar tx1=this.tx;\r\n\t\t\tvar n=a1 *d1-b1 *c1;\r\n\t\t\tthis.a=d1 / n;\r\n\t\t\tthis.b=-b1 / n;\r\n\t\t\tthis.c=-c1 / n;\r\n\t\t\tthis.d=a1 / n;\r\n\t\t\tthis.tx=(c1 *this.ty-d1 *tx1)/ n;\r\n\t\t\tthis.ty=-(a1 *this.ty-b1 *tx1)/ n;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将 Matrix 的成员设置为指定值。\r\n\t\t*@param a 缩放或旋转图像时影响像素沿 x 轴定位的值。\r\n\t\t*@param b 旋转或倾斜图像时影响像素沿 y 轴定位的值。\r\n\t\t*@param c 旋转或倾斜图像时影响像素沿 x 轴定位的值。\r\n\t\t*@param d 缩放或旋转图像时影响像素沿 y 轴定位的值。\r\n\t\t*@param tx 沿 x 轴平移每个点的距离。\r\n\t\t*@param ty 沿 y 轴平移每个点的距离。\r\n\t\t*@return 当前矩阵对象。\r\n\t\t*/\r\n\t\t__proto.setTo=function(a,b,c,d,tx,ty){\r\n\t\t\tthis.a=a,this.b=b,this.c=c,this.d=d,this.tx=tx,this.ty=ty;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将指定矩阵与当前矩阵连接，从而将这两个矩阵的几何效果有效地结合在一起。\r\n\t\t*@param matrix 要连接到源矩阵的矩阵。\r\n\t\t*@return 当前矩阵。\r\n\t\t*/\r\n\t\t__proto.concat=function(matrix){\r\n\t\t\tvar a=this.a;\r\n\t\t\tvar c=this.c;\r\n\t\t\tvar tx=this.tx;\r\n\t\t\tthis.a=a *matrix.a+this.b *matrix.c;\r\n\t\t\tthis.b=a *matrix.b+this.b *matrix.d;\r\n\t\t\tthis.c=c *matrix.a+this.d *matrix.c;\r\n\t\t\tthis.d=c *matrix.b+this.d *matrix.d;\r\n\t\t\tthis.tx=tx *matrix.a+this.ty *matrix.c+matrix.tx;\r\n\t\t\tthis.ty=tx *matrix.b+this.ty *matrix.d+matrix.ty;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对矩阵应用缩放转换。反向相乘\r\n\t\t*@param x 用于沿 x 轴缩放对象的乘数。\r\n\t\t*@param y 用于沿 y 轴缩放对象的乘数。\r\n\t\t*/\r\n\t\t__proto.scaleEx=function(x,y){\r\n\t\t\tvar ba=this.a,bb=this.b,bc=this.c,bd=this.d;\r\n\t\t\tif (bb!==0 || bc!==0){\r\n\t\t\t\tthis.a=x *ba;\r\n\t\t\t\tthis.b=x *bb;\r\n\t\t\t\tthis.c=y *bc;\r\n\t\t\t\tthis.d=y *bd;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.a=x *ba;\r\n\t\t\t\tthis.b=0 *bd;\r\n\t\t\t\tthis.c=0 *ba;\r\n\t\t\t\tthis.d=y *bd;\r\n\t\t\t}\r\n\t\t\tthis.bTransform=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*对 Matrix 对象应用旋转转换。反向相乘\r\n\t\t*@param angle 以弧度为单位的旋转角度。\r\n\t\t*/\r\n\t\t__proto.rotateEx=function(angle){\r\n\t\t\tvar cos=Math.cos(angle);\r\n\t\t\tvar sin=Math.sin(angle);\r\n\t\t\tvar ba=this.a,bb=this.b,bc=this.c,bd=this.d;\r\n\t\t\tif (bb!==0 || bc!==0){\r\n\t\t\t\tthis.a=cos *ba+sin *bc;\r\n\t\t\t\tthis.b=cos *bb+sin *bd;\r\n\t\t\t\tthis.c=-sin *ba+cos *bc;\r\n\t\t\t\tthis.d=-sin *bb+cos *bd;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.a=cos *ba;\r\n\t\t\t\tthis.b=sin *bd;\r\n\t\t\t\tthis.c=-sin *ba;\r\n\t\t\t\tthis.d=cos *bd;\r\n\t\t\t}\r\n\t\t\tthis.bTransform=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回一个新的 Matrix 对象，它是此矩阵的克隆，带有与所含对象完全相同的副本。\r\n\t\t*@return 一个 Matrix 对象。\r\n\t\t*/\r\n\t\t__proto.clone=function(){\r\n\t\t\tvar no=Matrix._cache;\r\n\t\t\tvar dec=!no._length ? (new Matrix()):no[--no._length];\r\n\t\t\tdec.a=this.a;\r\n\t\t\tdec.b=this.b;\r\n\t\t\tdec.c=this.c;\r\n\t\t\tdec.d=this.d;\r\n\t\t\tdec.tx=this.tx;\r\n\t\t\tdec.ty=this.ty;\r\n\t\t\tdec.bTransform=this.bTransform;\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将当前 Matrix 对象中的所有矩阵数据复制到指定的 Matrix 对象中。\r\n\t\t*@param dec 要复制当前矩阵数据的 Matrix 对象。\r\n\t\t*@return 已复制当前矩阵数据的 Matrix 对象。\r\n\t\t*/\r\n\t\t__proto.copyTo=function(dec){\r\n\t\t\tdec.a=this.a;\r\n\t\t\tdec.b=this.b;\r\n\t\t\tdec.c=this.c;\r\n\t\t\tdec.d=this.d;\r\n\t\t\tdec.tx=this.tx;\r\n\t\t\tdec.ty=this.ty;\r\n\t\t\tdec.bTransform=this.bTransform;\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回列出该 Matrix 对象属性的文本值。\r\n\t\t*@return 一个字符串，它包含 Matrix 对象的属性值：a、b、c、d、tx 和 ty。\r\n\t\t*/\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this.a+\",\"+this.b+\",\"+this.c+\",\"+this.d+\",\"+this.tx+\",\"+this.ty;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*销毁此对象。\r\n\t\t*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tif (this.inPool)return;\r\n\t\t\tvar cache=Matrix._cache;\r\n\t\t\tthis.inPool=true;\r\n\t\t\tcache._length || (cache._length=0);\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.a=this.d=1;\r\n\t\t\tthis.b=this.c=this.tx=this.ty=0;\r\n\t\t\tthis.bTransform=false;\r\n\t\t}\r\n\r\n\t\tMatrix.mul=function(m1,m2,out){\r\n\t\t\tvar aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;\r\n\t\t\tvar ba=m2.a,bb=m2.b,bc=m2.c,bd=m2.d,btx=m2.tx,bty=m2.ty;\r\n\t\t\tif (bb!==0 || bc!==0){\r\n\t\t\t\tout.a=aa *ba+ab *bc;\r\n\t\t\t\tout.b=aa *bb+ab *bd;\r\n\t\t\t\tout.c=ac *ba+ad *bc;\r\n\t\t\t\tout.d=ac *bb+ad *bd;\r\n\t\t\t\tout.tx=ba *atx+bc *aty+btx;\r\n\t\t\t\tout.ty=bb *atx+bd *aty+bty;\r\n\t\t\t\t}else {\r\n\t\t\t\tout.a=aa *ba;\r\n\t\t\t\tout.b=ab *bd;\r\n\t\t\t\tout.c=ac *ba;\r\n\t\t\t\tout.d=ad *bd;\r\n\t\t\t\tout.tx=ba *atx+btx;\r\n\t\t\t\tout.ty=bd *aty+bty;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMatrix.mulPre=function(m1,ba,bb,bc,bd,btx,bty,out){\r\n\t\t\tvar aa=m1.a,ab=m1.b,ac=m1.c,ad=m1.d,atx=m1.tx,aty=m1.ty;\r\n\t\t\tif (bb!==0 || bc!==0){\r\n\t\t\t\tout.a=aa *ba+ab *bc;\r\n\t\t\t\tout.b=aa *bb+ab *bd;\r\n\t\t\t\tout.c=ac *ba+ad *bc;\r\n\t\t\t\tout.d=ac *bb+ad *bd;\r\n\t\t\t\tout.tx=ba *atx+bc *aty+btx;\r\n\t\t\t\tout.ty=bb *atx+bd *aty+bty;\r\n\t\t\t\t}else {\r\n\t\t\t\tout.a=aa *ba;\r\n\t\t\t\tout.b=ab *bd;\r\n\t\t\t\tout.c=ac *ba;\r\n\t\t\t\tout.d=ad *bd;\r\n\t\t\t\tout.tx=ba *atx+btx;\r\n\t\t\t\tout.ty=bd *aty+bty;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMatrix.mulPos=function(m1,aa,ab,ac,ad,atx,aty,out){\r\n\t\t\tvar ba=m1.a,bb=m1.b,bc=m1.c,bd=m1.d,btx=m1.tx,bty=m1.ty;\r\n\t\t\tif (bb!==0 || bc!==0){\r\n\t\t\t\tout.a=aa *ba+ab *bc;\r\n\t\t\t\tout.b=aa *bb+ab *bd;\r\n\t\t\t\tout.c=ac *ba+ad *bc;\r\n\t\t\t\tout.d=ac *bb+ad *bd;\r\n\t\t\t\tout.tx=ba *atx+bc *aty+btx;\r\n\t\t\t\tout.ty=bb *atx+bd *aty+bty;\r\n\t\t\t\t}else {\r\n\t\t\t\tout.a=aa *ba;\r\n\t\t\t\tout.b=ab *bd;\r\n\t\t\t\tout.c=ac *ba;\r\n\t\t\t\tout.d=ad *bd;\r\n\t\t\t\tout.tx=ba *atx+btx;\r\n\t\t\t\tout.ty=bd *aty+bty;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMatrix.preMul=function(parent,self,out){\r\n\t\t\tvar pa=parent.a,pb=parent.b,pc=parent.c,pd=parent.d;\r\n\t\t\tvar na=self.a,nb=self.b,nc=self.c,nd=self.d,ntx=self.tx,nty=self.ty;\r\n\t\t\tout.a=na *pa;\r\n\t\t\tout.b=out.c=0;\r\n\t\t\tout.d=nd *pd;\r\n\t\t\tout.tx=ntx *pa+parent.tx;\r\n\t\t\tout.ty=nty *pd+parent.ty;\r\n\t\t\tif (nb!==0 || nc!==0 || pb!==0 || pc!==0){\r\n\t\t\t\tout.a+=nb *pc;\r\n\t\t\t\tout.d+=nc *pb;\r\n\t\t\t\tout.b+=na *pb+nb *pd;\r\n\t\t\t\tout.c+=nc *pa+nd *pc;\r\n\t\t\t\tout.tx+=nty *pc;\r\n\t\t\t\tout.ty+=ntx *pb;\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMatrix.preMulXY=function(parent,x,y,out){\r\n\t\t\tvar pa=parent.a,pb=parent.b,pc=parent.c,pd=parent.d;\r\n\t\t\tout.a=pa;\r\n\t\t\tout.b=pb;\r\n\t\t\tout.c=pc;\r\n\t\t\tout.d=pd;\r\n\t\t\tout.tx=x *pa+parent.tx+y *pc;\r\n\t\t\tout.ty=y *pd+parent.ty+x *pb;\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tMatrix.create=function(){\r\n\t\t\tvar cache=Matrix._cache;\r\n\t\t\tvar mat=!cache._length ? (new Matrix()):cache[--cache._length];\r\n\t\t\tmat.inPool=false;\r\n\t\t\treturn mat;\r\n\t\t}\r\n\r\n\t\tMatrix.EMPTY=new Matrix();\r\n\t\tMatrix.TEMP=new Matrix();\r\n\t\tMatrix._cache=[];\r\n\t\treturn Matrix;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Point</code> 对象表示二维坐标系统中的某个位置，其中 x 表示水平轴，y 表示垂直轴。\r\n\t*/\r\n\t//class laya.maths.Point\r\n\tvar Point=(function(){\r\n\t\tfunction Point(x,y){\r\n\t\t\t//this.x=NaN;\r\n\t\t\t//this.y=NaN;\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t}\r\n\r\n\t\t__class(Point,'laya.maths.Point');\r\n\t\tvar __proto=Point.prototype;\r\n\t\t/**\r\n\t\t*将 <code>Point</code> 的成员设置为指定值。\r\n\t\t*@param x 水平坐标。\r\n\t\t*@param y 垂直坐标。\r\n\t\t*@return 当前 Point 对象。\r\n\t\t*/\r\n\t\t__proto.setTo=function(x,y){\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*计算当前点和目标x，y点的距离\r\n\t\t*@param x 水平坐标。\r\n\t\t*@param y 垂直坐标。\r\n\t\t*@return 返回之间的距离\r\n\t\t*/\r\n\t\t__proto.distance=function(x,y){\r\n\t\t\treturn Math.sqrt((this.x-x)*(this.x-x)+(this.y-y)*(this.y-y));\r\n\t\t}\r\n\r\n\t\t/**返回包含 x 和 y 坐标的值的字符串。*/\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this.x+\",\"+this.y;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*标准化向量\r\n\t\t*/\r\n\t\t__proto.normalize=function(){\r\n\t\t\tvar d=Math.sqrt(this.x *this.x+this.y *this.y);\r\n\t\t\tif (d > 0){\r\n\t\t\t\tvar id=1.0 / d;\r\n\t\t\t\tthis.x *=id;\r\n\t\t\t\tthis.y *=id;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tPoint.TEMP=new Point();\r\n\t\tPoint.EMPTY=new Point();\r\n\t\treturn Point;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Rectangle</code> 对象是按其位置（由它左上角的点 (x,y)确定）以及宽度和高度定义的区域。\r\n\t*/\r\n\t//class laya.maths.Rectangle\r\n\tvar Rectangle=(function(){\r\n\t\tfunction Rectangle(x,y,width,height){\r\n\t\t\t//this.x=NaN;\r\n\t\t\t//this.y=NaN;\r\n\t\t\t//this.width=NaN;\r\n\t\t\t//this.height=NaN;\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t\tthis.width=width;\r\n\t\t\tthis.height=height;\r\n\t\t}\r\n\r\n\t\t__class(Rectangle,'laya.maths.Rectangle');\r\n\t\tvar __proto=Rectangle.prototype;\r\n\t\t/**\r\n\t\t*将 Rectangle 的属性设置为指定值。\r\n\t\t*@param x x 矩形左上角的 X 轴坐标。\r\n\t\t*@param y x 矩形左上角的 Y 轴坐标。\r\n\t\t*@param width 矩形的宽度。\r\n\t\t*@param height 矩形的高。\r\n\t\t*@return 返回属性值修改后的矩形对象本身。\r\n\t\t*/\r\n\t\t__proto.setTo=function(x,y,width,height){\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t\tthis.width=width;\r\n\t\t\tthis.height=height;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*复制 source 对象的属性值到此矩形对象中。\r\n\t\t*@param sourceRect 源 Rectangle 对象。\r\n\t\t*@return 返回属性值修改后的矩形对象本身。\r\n\t\t*/\r\n\t\t__proto.copyFrom=function(source){\r\n\t\t\tthis.x=source.x;\r\n\t\t\tthis.y=source.y;\r\n\t\t\tthis.width=source.width;\r\n\t\t\tthis.height=source.height;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测此矩形对象是否包含指定的点。\r\n\t\t*@param x 点的 X 轴坐标值（水平位置）。\r\n\t\t*@param y 点的 Y 轴坐标值（垂直位置）。\r\n\t\t*@return 如果 Rectangle 对象包含指定的点，则值为 true；否则为 false。\r\n\t\t*/\r\n\t\t__proto.contains=function(x,y){\r\n\t\t\tif (this.width <=0 || this.height <=0)return false;\r\n\t\t\tif (x >=this.x && x < this.right){\r\n\t\t\t\tif (y >=this.y && y < this.bottom){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测传入的矩形对象是否与此对象相交。\r\n\t\t*@param rect Rectangle 对象。\r\n\t\t*@return 如果传入的矩形对象与此对象相交，则返回 true 值，否则返回 false。\r\n\t\t*/\r\n\t\t__proto.intersects=function(rect){\r\n\t\t\treturn !(rect.x > (this.x+this.width)|| (rect.x+rect.width)< this.x || rect.y > (this.y+this.height)|| (rect.y+rect.height)< this.y);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取此对象与传入的矩形对象的相交区域。并将相交区域赋值给传入的输出矩形对象。\r\n\t\t*@param rect 待比较的矩形区域。\r\n\t\t*@param out 待输出的矩形区域。建议：尽量用此对象复用对象，减少对象创建消耗。\r\n\t\t*@return 返回相交的矩形区域对象。\r\n\t\t*/\r\n\t\t__proto.intersection=function(rect,out){\r\n\t\t\tif (!this.intersects(rect))return null;\r\n\t\t\tout || (out=new Rectangle());\r\n\t\t\tout.x=Math.max(this.x,rect.x);\r\n\t\t\tout.y=Math.max(this.y,rect.y);\r\n\t\t\tout.width=Math.min(this.right,rect.right)-out.x;\r\n\t\t\tout.height=Math.min(this.bottom,rect.bottom)-out.y;\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*矩形联合，通过填充两个矩形之间的水平和垂直空间，将这两个矩形组合在一起以创建一个新的 Rectangle 对象。\r\n\t\t*@param 目标矩形对象。\r\n\t\t*@param out 待输出结果的矩形对象。建议：尽量用此对象复用对象，减少对象创建消耗。\r\n\t\t*@return 两个矩形后联合的 Rectangle 对象 out 。\r\n\t\t*/\r\n\t\t__proto.union=function(source,out){\r\n\t\t\tout || (out=new Rectangle());\r\n\t\t\tthis.clone(out);\r\n\t\t\tif (source.width <=0 || source.height <=0)return out;\r\n\t\t\tout.addPoint(source.x,source.y);\r\n\t\t\tout.addPoint(source.right,source.bottom);\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回一个 Rectangle 对象，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。\r\n\t\t*@param out 待输出的矩形对象。建议：尽量用此对象复用对象，减少对象创建消耗。\r\n\t\t*@return Rectangle 对象 out ，其 x、y、width 和 height 属性的值与当前 Rectangle 对象的对应值相同。\r\n\t\t*/\r\n\t\t__proto.clone=function(out){\r\n\t\t\tout || (out=new Rectangle());\r\n\t\t\tout.x=this.x;\r\n\t\t\tout.y=this.y;\r\n\t\t\tout.width=this.width;\r\n\t\t\tout.height=this.height;\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*当前 Rectangle 对象的水平位置 x 和垂直位置 y 以及高度 width 和宽度 height 以逗号连接成的字符串。\r\n\t\t*/\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this.x+\",\"+this.y+\",\"+this.width+\",\"+this.height;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测传入的 Rectangle 对象的属性是否与当前 Rectangle 对象的属性 x、y、width、height 属性值都相等。\r\n\t\t*@param rect 待比较的 Rectangle 对象。\r\n\t\t*@return 如果判断的属性都相等，则返回 true ,否则返回 false。\r\n\t\t*/\r\n\t\t__proto.equals=function(rect){\r\n\t\t\tif (!rect || rect.x!==this.x || rect.y!==this.y || rect.width!==this.width || rect.height!==this.height)return false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前矩形区域中加一个点。\r\n\t\t*@param x 点的 X 坐标。\r\n\t\t*@param y 点的 Y 坐标。\r\n\t\t*@return 返回此 Rectangle 对象。\r\n\t\t*/\r\n\t\t__proto.addPoint=function(x,y){\r\n\t\t\tthis.x > x && (this.width+=this.x-x,this.x=x);\r\n\t\t\tthis.y > y && (this.height+=this.y-y,this.y=y);\r\n\t\t\tif (this.width < x-this.x)this.width=x-this.x;\r\n\t\t\tif (this.height < y-this.y)this.height=y-this.y;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*返回代表当前矩形的顶点数据。\r\n\t\t*@return 顶点数据。\r\n\t\t*/\r\n\t\t__proto._getBoundPoints=function(){\r\n\t\t\tvar rst=Rectangle._temB;\r\n\t\t\trst.length=0;\r\n\t\t\tif (this.width==0 || this.height==0)return rst;\r\n\t\t\trst.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height);\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t/**确定此 Rectangle 对象是否为空。*/\r\n\t\t__proto.isEmpty=function(){\r\n\t\t\tif (this.width <=0 || this.height <=0)return true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**此矩形的右边距。 x 和 width 属性的和。*/\r\n\t\t__getset(0,__proto,'right',function(){\r\n\t\t\treturn this.x+this.width;\r\n\t\t});\r\n\r\n\t\t/**此矩形的底边距。y 和 height 属性的和。*/\r\n\t\t__getset(0,__proto,'bottom',function(){\r\n\t\t\treturn this.y+this.height;\r\n\t\t});\r\n\r\n\t\tRectangle._getBoundPointS=function(x,y,width,height){\r\n\t\t\tvar rst=Rectangle._temA;\r\n\t\t\trst.length=0;\r\n\t\t\tif (width==0 || height==0)return rst;\r\n\t\t\trst.push(x,y,x+width,y,x,y+height,x+width,y+height);\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tRectangle._getWrapRec=function(pointList,rst){\r\n\t\t\tif (!pointList || pointList.length < 1)return rst ? rst.setTo(0,0,0,0):Rectangle.TEMP.setTo(0,0,0,0);\r\n\t\t\trst=rst ? rst :new Rectangle();\r\n\t\t\tvar i,len=pointList.length,minX,maxX,minY,maxY,tPoint=Point.TEMP;\r\n\t\t\tminX=minY=99999;\r\n\t\t\tmaxX=maxY=-minX;\r\n\t\t\tfor (i=0;i < len;i+=2){\r\n\t\t\t\ttPoint.x=pointList[i];\r\n\t\t\t\ttPoint.y=pointList[i+1];\r\n\t\t\t\tminX=minX < tPoint.x ? minX :tPoint.x;\r\n\t\t\t\tminY=minY < tPoint.y ? minY :tPoint.y;\r\n\t\t\t\tmaxX=maxX > tPoint.x ? maxX :tPoint.x;\r\n\t\t\t\tmaxY=maxY > tPoint.y ? maxY :tPoint.y;\r\n\t\t\t}\r\n\t\t\treturn rst.setTo(minX,minY,maxX-minX,maxY-minY);\r\n\t\t}\r\n\r\n\t\tRectangle.EMPTY=new Rectangle();\r\n\t\tRectangle.TEMP=new Rectangle();\r\n\t\tRectangle._temB=[];\r\n\t\tRectangle._temA=[];\r\n\t\treturn Rectangle;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>SoundManager</code> 是一个声音管理类。\r\n\t*/\r\n\t//class laya.media.SoundManager\r\n\tvar SoundManager=(function(){\r\n\t\tfunction SoundManager(){};\r\n\t\t__class(SoundManager,'laya.media.SoundManager');\r\n\t\t/**\r\n\t\t*设置是否失去焦点后自动停止背景音乐。\r\n\t\t*@param v Boolean 值。\r\n\t\t*\r\n\t\t*/\r\n\t\t/**\r\n\t\t*表示是否失去焦点后自动停止背景音乐。\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__getset(1,SoundManager,'autoStopMusic',function(){\r\n\t\t\treturn SoundManager._autoStopMusic;\r\n\t\t\t},function(v){\r\n\t\t\tLaya.stage.off(/*laya.events.Event.BLUR*/\"blur\",null,SoundManager._stageOnBlur);\r\n\t\t\tLaya.stage.off(/*laya.events.Event.FOCUS*/\"focus\",null,SoundManager._stageOnFocus);\r\n\t\t\tSoundManager._autoStopMusic=v;\r\n\t\t\tif (v){\r\n\t\t\t\tLaya.stage.on(/*laya.events.Event.BLUR*/\"blur\",null,SoundManager._stageOnBlur);\r\n\t\t\t\tLaya.stage.on(/*laya.events.Event.FOCUS*/\"focus\",null,SoundManager._stageOnFocus);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否静音。\r\n\t\t*/\r\n\t\t__getset(1,SoundManager,'muted',function(){\r\n\t\t\treturn SoundManager._muted;\r\n\t\t\t},function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tSoundManager.stopAll();\r\n\t\t\t}\r\n\t\t\tSoundManager._muted=value;\r\n\t\t});\r\n\r\n\t\t/**表示是否使背景音乐静音。*/\r\n\t\t__getset(1,SoundManager,'musicMuted',function(){\r\n\t\t\treturn SoundManager._musicMuted;\r\n\t\t\t},function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tif (SoundManager._tMusic)\r\n\t\t\t\t\tSoundManager.stopSound(SoundManager._tMusic);\r\n\t\t\t\tSoundManager._musicMuted=value;\r\n\t\t\t\t}else {\r\n\t\t\t\tSoundManager._musicMuted=value;\r\n\t\t\t\tif (SoundManager._tMusic){\r\n\t\t\t\t\tSoundManager.playMusic(SoundManager._tMusic);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**表示是否使音效静音。*/\r\n\t\t__getset(1,SoundManager,'soundMuted',function(){\r\n\t\t\treturn SoundManager._soundMuted;\r\n\t\t\t},function(value){\r\n\t\t\tSoundManager._soundMuted=value;\r\n\t\t});\r\n\r\n\t\tSoundManager.addChannel=function(channel){\r\n\t\t\tif (SoundManager._channels.indexOf(channel)>=0)return;\r\n\t\t\tSoundManager._channels.push(channel);\r\n\t\t}\r\n\r\n\t\tSoundManager.removeChannel=function(channel){\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=SoundManager._channels.length-1;i >=0;i--){\r\n\t\t\t\tif (SoundManager._channels[i]==channel){\r\n\t\t\t\t\tSoundManager._channels.splice(i,1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager._stageOnBlur=function(){\r\n\t\t\tif (SoundManager._musicChannel){\r\n\t\t\t\tif (!SoundManager._musicChannel.isStopped){\r\n\t\t\t\t\tSoundManager._blurPaused=true;\r\n\t\t\t\t\tSoundManager._musicLoops=SoundManager._musicChannel.loops;\r\n\t\t\t\t\tSoundManager._musicCompleteHandler=SoundManager._musicChannel.completeHandler;\r\n\t\t\t\t\tSoundManager._musicPosition=SoundManager._musicChannel.position;\r\n\t\t\t\t\tSoundManager._musicChannel.stop();\r\n\t\t\t\t\tLaya.stage.once(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",null,SoundManager._stageOnFocus);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager._stageOnFocus=function(){\r\n\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",null,SoundManager._stageOnFocus);\r\n\t\t\tif (SoundManager._blurPaused){\r\n\t\t\t\tSoundManager.playMusic(SoundManager._tMusic,SoundManager._musicLoops,SoundManager._musicCompleteHandler,SoundManager._musicPosition);\r\n\t\t\t\tSoundManager._blurPaused=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.playSound=function(url,loops,complete,soundClass,startTime){\r\n\t\t\t(loops===void 0)&& (loops=1);\r\n\t\t\t(startTime===void 0)&& (startTime=0);\r\n\t\t\tif (SoundManager._muted)\r\n\t\t\t\treturn null;\r\n\t\t\tif (url==SoundManager._tMusic){\r\n\t\t\t\tif (SoundManager._musicMuted)return null;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (SoundManager._soundMuted)return null;\r\n\t\t\t};\r\n\t\t\tvar tSound=Laya.loader.getRes(url);\r\n\t\t\tif (!soundClass)soundClass=SoundManager._soundClass;\r\n\t\t\tif (!tSound){\r\n\t\t\t\ttSound=new soundClass();\r\n\t\t\t\ttSound.load(url);\r\n\t\t\t\tLoader.cacheRes(url,tSound);\r\n\t\t\t};\r\n\t\t\tvar channel;\r\n\t\t\tchannel=tSound.play(startTime,loops);\r\n\t\t\tchannel.url=url;\r\n\t\t\tchannel.volume=(url==SoundManager._tMusic)? SoundManager.musicVolume :SoundManager.soundVolume;\r\n\t\t\tchannel.completeHandler=complete;\r\n\t\t\treturn channel;\r\n\t\t}\r\n\r\n\t\tSoundManager.destroySound=function(url){\r\n\t\t\tvar tSound=Laya.loader.getRes(url);\r\n\t\t\tif (tSound){\r\n\t\t\t\tLoader.clearRes(url);\r\n\t\t\t\ttSound.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.playMusic=function(url,loops,complete,startTime){\r\n\t\t\t(loops===void 0)&& (loops=0);\r\n\t\t\t(startTime===void 0)&& (startTime=0);\r\n\t\t\tSoundManager._tMusic=url;\r\n\t\t\tif (SoundManager._musicChannel)\r\n\t\t\t\tSoundManager._musicChannel.stop();\r\n\t\t\treturn SoundManager._musicChannel=SoundManager.playSound(url,loops,complete,null,startTime);\r\n\t\t}\r\n\r\n\t\tSoundManager.stopSound=function(url){\r\n\t\t\tvar i=0;\r\n\t\t\tvar channel;\r\n\t\t\tfor (i=SoundManager._channels.length-1;i >=0;i--){\r\n\t\t\t\tchannel=SoundManager._channels[i];\r\n\t\t\t\tif (channel.url==url){\r\n\t\t\t\t\tchannel.stop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.stopAll=function(){\r\n\t\t\tvar i=0;\r\n\t\t\tvar channel;\r\n\t\t\tfor (i=SoundManager._channels.length-1;i >=0;i--){\r\n\t\t\t\tchannel=SoundManager._channels[i];\r\n\t\t\t\tchannel.stop();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.stopMusic=function(){\r\n\t\t\tif (SoundManager._musicChannel)\r\n\t\t\t\tSoundManager._musicChannel.stop();\r\n\t\t}\r\n\r\n\t\tSoundManager.setSoundVolume=function(volume,url){\r\n\t\t\tif (url){\r\n\t\t\t\tSoundManager._setVolume(url,volume);\r\n\t\t\t\t}else {\r\n\t\t\t\tSoundManager.soundVolume=volume;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.setMusicVolume=function(volume){\r\n\t\t\tSoundManager.musicVolume=volume;\r\n\t\t\tSoundManager._setVolume(SoundManager._tMusic,volume);\r\n\t\t}\r\n\r\n\t\tSoundManager._setVolume=function(url,volume){\r\n\t\t\tvar i=0;\r\n\t\t\tvar channel;\r\n\t\t\tfor (i=SoundManager._channels.length-1;i >=0;i--){\r\n\t\t\t\tchannel=SoundManager._channels[i];\r\n\t\t\t\tif (channel.url==url){\r\n\t\t\t\t\tchannel.volume=volume;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSoundManager.musicVolume=1;\r\n\t\tSoundManager.soundVolume=1;\r\n\t\tSoundManager._muted=false;\r\n\t\tSoundManager._soundMuted=false;\r\n\t\tSoundManager._musicMuted=false;\r\n\t\tSoundManager._tMusic=null;\r\n\t\tSoundManager._musicChannel=null;\r\n\t\tSoundManager._channels=[];\r\n\t\tSoundManager._autoStopMusic=false;\r\n\t\tSoundManager._blurPaused=false;\r\n\t\tSoundManager._musicLoops=0;\r\n\t\tSoundManager._musicPosition=0;\r\n\t\tSoundManager._musicCompleteHandler=null;\r\n\t\tSoundManager._soundClass=null\r\n\t\treturn SoundManager;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<p> <code>LocalStorage</code> 类用于没有时间限制的数据存储。</p>\r\n\t*/\r\n\t//class laya.net.LocalStorage\r\n\tvar LocalStorage=(function(){\r\n\t\tvar Storage;\r\n\t\tfunction LocalStorage(){};\r\n\t\t__class(LocalStorage,'laya.net.LocalStorage');\r\n\t\tLocalStorage.__init__=function(){\r\n\t\t\tif (!LocalStorage._baseClass){\r\n\t\t\t\tLocalStorage._baseClass=Storage;\r\n\t\t\t\tStorage.init();\r\n\t\t\t}\r\n\t\t\tLocalStorage.items=LocalStorage._baseClass.items;\r\n\t\t\tLocalStorage.support=LocalStorage._baseClass.support;\r\n\t\t}\r\n\r\n\t\tLocalStorage.setItem=function(key,value){\r\n\t\t\tLocalStorage._baseClass.setItem(key,value);\r\n\t\t}\r\n\r\n\t\tLocalStorage.getItem=function(key){\r\n\t\t\treturn LocalStorage._baseClass.getItem(key);\r\n\t\t}\r\n\r\n\t\tLocalStorage.setJSON=function(key,value){\r\n\t\t\tLocalStorage._baseClass.setJSON(key,value);\r\n\t\t}\r\n\r\n\t\tLocalStorage.getJSON=function(key){\r\n\t\t\treturn LocalStorage._baseClass.getJSON(key);\r\n\t\t}\r\n\r\n\t\tLocalStorage.removeItem=function(key){\r\n\t\t\tLocalStorage._baseClass.removeItem(key);\r\n\t\t}\r\n\r\n\t\tLocalStorage.clear=function(){\r\n\t\t\tLocalStorage._baseClass.clear();\r\n\t\t}\r\n\r\n\t\tLocalStorage._baseClass=null\r\n\t\tLocalStorage.items=null\r\n\t\tLocalStorage.support=false;\r\n\t\tLocalStorage.__init$=function(){\r\n\t\t\t//class Storage\r\n\t\t\tStorage=(function(){\r\n\t\t\t\tfunction Storage(){};\r\n\t\t\t\t__class(Storage,'');\r\n\t\t\t\tStorage.init=function(){\r\n\t\t\t\t\t/*__JS__ */try{Storage.items=window.localStorage;Storage.setItem('laya','1');Storage.removeItem('laya');Storage.support=true;}catch(e){}if(!Storage.support)console.log('LocalStorage is not supprot or browser is private mode.');\r\n\t\t\t\t}\r\n\t\t\t\tStorage.setItem=function(key,value){\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tStorage.support && Storage.items.setItem(key,value);\r\n\t\t\t\t\t\t}catch (e){\r\n\t\t\t\t\t\tconsole.log(\"set localStorage failed\",e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tStorage.getItem=function(key){\r\n\t\t\t\t\treturn Storage.support ? Storage.items.getItem(key):null;\r\n\t\t\t\t}\r\n\t\t\t\tStorage.setJSON=function(key,value){\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tStorage.support && Storage.items.setItem(key,JSON.stringify(value));\r\n\t\t\t\t\t\t}catch (e){\r\n\t\t\t\t\t\tconsole.log(\"set localStorage failed\",e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tStorage.getJSON=function(key){\r\n\t\t\t\t\treturn JSON.parse(Storage.support ? Storage.items.getItem(key):null);\r\n\t\t\t\t}\r\n\t\t\t\tStorage.removeItem=function(key){\r\n\t\t\t\t\tStorage.support && Storage.items.removeItem(key);\r\n\t\t\t\t}\r\n\t\t\t\tStorage.clear=function(){\r\n\t\t\t\t\tStorage.support && Storage.items.clear();\r\n\t\t\t\t}\r\n\t\t\t\tStorage.items=null\r\n\t\t\t\tStorage.support=true;\r\n\t\t\t\treturn Storage;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn LocalStorage;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<p> <code>URL</code> 类用于定义地址信息。</p>\r\n\t*/\r\n\t//class laya.net.URL\r\n\tvar URL=(function(){\r\n\t\tfunction URL(url){\r\n\t\t\tthis._url=null;\r\n\t\t\tthis._path=null;\r\n\t\t\tthis._url=URL.formatURL(url);\r\n\t\t\tthis._path=URL.getPath(url);\r\n\t\t}\r\n\r\n\t\t__class(URL,'laya.net.URL');\r\n\t\tvar __proto=URL.prototype;\r\n\t\t/**地址的路径。*/\r\n\t\t__getset(0,__proto,'path',function(){\r\n\t\t\treturn this._path;\r\n\t\t});\r\n\r\n\t\t/**格式化后的地址。*/\r\n\t\t__getset(0,__proto,'url',function(){\r\n\t\t\treturn this._url;\r\n\t\t});\r\n\r\n\t\tURL.formatURL=function(url,base){\r\n\t\t\tif (URL.customFormat !=null)url=URL.customFormat(url,base);\r\n\t\t\tif (!url)return \"null path\";\r\n\t\t\tif (url.indexOf(\"data:image\")===0)return url;\r\n\t\t\tif (Render.isConchApp==false){\r\n\t\t\t\tURL.version[url] && (url+=\"?v=\"+URL.version[url]);\r\n\t\t\t}\r\n\t\t\tif (url.charAt(0)=='~')return URL.rootPath+url.substring(1);\r\n\t\t\tif (URL.isAbsolute(url))return url;\r\n\t\t\tvar retVal=(base || URL.basePath)+url;\r\n\t\t\treturn URL.formatRelativePath(retVal);\r\n\t\t}\r\n\r\n\t\tURL.formatRelativePath=function(value){\r\n\t\t\tif (value.indexOf(\"../\")>-1){\r\n\t\t\t\tvar parts=value.split(\"/\");\r\n\t\t\t\tfor (var i=0,len=parts.length;i < len;i++){\r\n\t\t\t\t\tif (parts[i]=='..'){\r\n\t\t\t\t\t\tparts.splice(i-1,2);\r\n\t\t\t\t\t\ti-=2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn parts.join('/');\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tURL.isAbsolute=function(url){\r\n\t\t\treturn url.indexOf(\":\")> 0 || url.charAt(0)=='/';\r\n\t\t}\r\n\r\n\t\tURL.getPath=function(url){\r\n\t\t\tvar ofs=url.lastIndexOf('/');\r\n\t\t\treturn ofs > 0 ? url.substr(0,ofs+1):\"\";\r\n\t\t}\r\n\r\n\t\tURL.getFileName=function(url){\r\n\t\t\tvar ofs=url.lastIndexOf('/');\r\n\t\t\treturn ofs > 0 ? url.substr(ofs+1):url;\r\n\t\t}\r\n\r\n\t\tURL.version={};\r\n\t\tURL.basePath=\"\";\r\n\t\tURL.rootPath=\"\";\r\n\t\tURL.customFormat=null\r\n\t\treturn URL;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>Render</code> 是渲染管理类。它是一个单例，可以使用 Laya.render 访问。\r\n\t*/\r\n\t//class laya.renders.Render\r\n\tvar Render=(function(){\r\n\t\tfunction Render(width,height){\r\n\t\t\tthis._timeId=0;\r\n\t\t\tvar style=Render._mainCanvas.source.style;\r\n\t\t\tstyle.position='absolute';\r\n\t\t\tstyle.top=style.left=\"0px\";\r\n\t\t\tstyle.background=\"#000000\";\r\n\t\t\tRender._mainCanvas.source.id=Render._mainCanvas.source.id || \"layaCanvas\";\r\n\t\t\tvar isWebGl=laya.renders.Render.isWebGL;\r\n\t\t\tisWebGl && Render.WebGL.init(Render._mainCanvas,width,height);\r\n\t\t\tif (Render._mainCanvas.source.nodeName || laya.renders.Render.isConchApp){\r\n\t\t\t\tBrowser.container.appendChild(Render._mainCanvas.source);\r\n\t\t\t}\r\n\t\t\tRender._context=new RenderContext(width,height,isWebGl ? null :Render._mainCanvas);\r\n\t\t\tRender._context.ctx.setIsMainContext();\r\n\t\t\tBrowser.window.requestAnimationFrame(loop);\r\n\t\t\tfunction loop (){\r\n\t\t\t\tLaya.stage._loop();\r\n\t\t\t\tBrowser.window.requestAnimationFrame(loop);\r\n\t\t\t}\r\n\t\t\tLaya.stage.on(/*laya.events.Event.BLUR*/\"blur\",this,this._onBlur);\r\n\t\t\tLaya.stage.on(/*laya.events.Event.FOCUS*/\"focus\",this,this._onFocus);\r\n\t\t}\r\n\r\n\t\t__class(Render,'laya.renders.Render');\r\n\t\tvar __proto=Render.prototype;\r\n\t\t/**@private */\r\n\t\t__proto._onFocus=function(){\r\n\t\t\tBrowser.window.clearInterval(this._timeId);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._onBlur=function(){\r\n\t\t\tthis._timeId=Browser.window.setInterval(this._enterFrame,1000);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._enterFrame=function(e){\r\n\t\t\tLaya.stage._loop();\r\n\t\t}\r\n\r\n\t\t/**是否是加速器 只读*/\r\n\t\t__getset(1,Render,'isConchApp',function(){\r\n\t\t\treturn /*__JS__ */(window.ConchRenderType & 0x04)==0x04;\r\n\t\t});\r\n\r\n\t\t/**目前使用的渲染器。*/\r\n\t\t__getset(1,Render,'context',function(){\r\n\t\t\treturn Render._context;\r\n\t\t});\r\n\r\n\t\t/**加速器模式下设置是否是节点模式 如果是否就是非节点模式 默认为canvas模式 如果设置了isConchWebGL则是webGL模式*/\r\n\t\t__getset(1,Render,'isConchNode',function(){\r\n\t\t\treturn /*__JS__ */(window.ConchRenderType & 5)==5;\r\n\t\t\t},function(b){\r\n\t\t\tif (b){\r\n\t\t\t\t/*__JS__ */window.ConchRenderType |=0x01;\r\n\t\t\t\t}else {\r\n\t\t\t\t/*__JS__ */window.ConchRenderType &=~ 0x01;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**加速器模式下设置是否是WebGL模式*/\r\n\t\t__getset(1,Render,'isConchWebGL',function(){\r\n\t\t\treturn /*__JS__ */window.ConchRenderType==6;\r\n\t\t\t},function(b){\r\n\t\t\tif (b){\r\n\t\t\t\tRender.isConchNode=false;\r\n\t\t\t\t/*__JS__ */window.ConchRenderType |=0x02;\r\n\t\t\t\t}else {\r\n\t\t\t\t/*__JS__ */window.ConchRenderType &=~ 0x02;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**渲染使用的原生画布引用。 */\r\n\t\t__getset(1,Render,'canvas',function(){\r\n\t\t\treturn Render._mainCanvas.source;\r\n\t\t});\r\n\r\n\t\tRender._context=null\r\n\t\tRender._mainCanvas=null\r\n\t\tRender.WebGL=null\r\n\t\tRender.NODE=0x01;\r\n\t\tRender.WEBGL=0x02;\r\n\t\tRender.CONCH=0x04;\r\n\t\tRender.isWebGL=false;\r\n\t\tRender.is3DMode=false;\r\n\t\tRender.optimizeTextureMemory=function(url,texture){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tRender.__init$=function(){\r\n\t\t\t/*__JS__ */window.ConchRenderType=window.ConchRenderType||1;;\r\n\t\t\t/*__JS__ */window.ConchRenderType|=(!window.conch?0:0x04);;;\r\n\t\t}\r\n\r\n\t\treturn Render;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*渲染环境\r\n\t*/\r\n\t//class laya.renders.RenderContext\r\n\tvar RenderContext=(function(){\r\n\t\tfunction RenderContext(width,height,canvas){\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t\t//this.canvas=null;\r\n\t\t\t//this.ctx=null;\r\n\t\t\tthis._drawTexture=function(x,y,args){\r\n\t\t\t\tif (args[0].loaded)this.ctx.drawTexture(args[0],args[1],args[2],args[3],args[4],x,y);\r\n\t\t\t}\r\n\t\t\tthis._fillTexture=function(x,y,args){\r\n\t\t\t\tif (args[0].loaded)this.ctx.fillTexture(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6],args[7]);\r\n\t\t\t}\r\n\t\t\tthis._drawTextureWithTransform=function(x,y,args){\r\n\t\t\t\tif (args[0].loaded)this.ctx.drawTextureWithTransform(args[0],args[1],args[2],args[3],args[4],args[5],x,y,args[6]);\r\n\t\t\t}\r\n\t\t\tthis._fillQuadrangle=function(x,y,args){\r\n\t\t\t\tthis.ctx.fillQuadrangle(args[0],args[1],args[2],args[3],args[4]);\r\n\t\t\t}\r\n\t\t\tthis._drawRect=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tif (args[4] !=null){\r\n\t\t\t\t\tctx.fillStyle=args[4];\r\n\t\t\t\t\tctx.fillRect(x+args[0],y+args[1],args[2],args[3],null);\r\n\t\t\t\t}\r\n\t\t\t\tif (args[5] !=null){\r\n\t\t\t\t\tctx.strokeStyle=args[5];\r\n\t\t\t\t\tctx.lineWidth=args[6];\r\n\t\t\t\t\tctx.strokeRect(x+args[0],y+args[1],args[2],args[3],args[6]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._drawPie=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(args[8]);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tctx.movePath(args[0]+x,args[1]+y);\r\n\t\t\t\t\tctx.moveTo(0,0);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx.moveTo(x+args[0],y+args[1]);\r\n\t\t\t\t}\r\n\t\t\t\tctx.arc(x+args[0],y+args[1],args[2],args[3],args[4]);\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tthis._fillAndStroke(args[5],args[6],args[7],true);\r\n\t\t\t}\r\n\t\t\tthis._clipRect=function(x,y,args){\r\n\t\t\t\tthis.ctx.clipRect(x+args[0],y+args[1],args[2],args[3]);\r\n\t\t\t}\r\n\t\t\tthis._fillRect=function(x,y,args){\r\n\t\t\t\tthis.ctx.fillRect(x+args[0],y+args[1],args[2],args[3],args[4]);\r\n\t\t\t}\r\n\t\t\tthis._drawCircle=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(args[6]);\r\n\t\t\t\tStat.drawCall++;\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tRender.isWebGL && ctx.movePath(args[0]+x,args[1]+y);\r\n\t\t\t\tctx.arc(args[0]+x,args[1]+y,args[2],0,RenderContext.PI2);\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tthis._fillAndStroke(args[3],args[4],args[5],true);\r\n\t\t\t}\r\n\t\t\tthis._fillCircle=function(x,y,args){\r\n\t\t\t\tStat.drawCall++;\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.fillStyle=args[3];\r\n\t\t\t\tctx.arc(args[0]+x,args[1]+y,args[2],0,RenderContext.PI2);\r\n\t\t\t\tctx.fill();\r\n\t\t\t}\r\n\t\t\tthis._setShader=function(x,y,args){\r\n\t\t\t\tthis.ctx.setShader(args[0]);\r\n\t\t\t}\r\n\t\t\tthis._drawLine=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(args[6]);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.strokeStyle=args[4];\r\n\t\t\t\tctx.lineWidth=args[5];\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tctx.movePath(x,y);\r\n\t\t\t\t\tctx.moveTo(args[0],args[1]);\r\n\t\t\t\t\tctx.lineTo(args[2],args[3]);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx.moveTo(x+args[0],y+args[1]);\r\n\t\t\t\t\tctx.lineTo(x+args[2],y+args[3]);\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t\tthis._drawLines=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(args[5]);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tx+=args[0],y+=args[1];\r\n\t\t\t\tRender.isWebGL && ctx.movePath(x,y);\r\n\t\t\t\tctx.strokeStyle=args[3];\r\n\t\t\t\tctx.lineWidth=args[4];\r\n\t\t\t\tvar points=args[2];\r\n\t\t\t\tvar i=2,n=points.length;\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tctx.moveTo(points[0],points[1]);\r\n\t\t\t\t\twhile (i < n){\r\n\t\t\t\t\t\tctx.lineTo(points[i++],points[i++]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx.moveTo(x+points[0],y+points[1]);\r\n\t\t\t\t\twhile (i < n){\r\n\t\t\t\t\t\tctx.lineTo(x+points[i++],y+points[i++]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t\tthis._drawLinesWebGL=function(x,y,args){\r\n\t\t\t\tthis.ctx.drawLines(x+this.x+args[0],y+this.y+args[1],args[2],args[3],args[4]);\r\n\t\t\t}\r\n\t\t\tthis._drawCurves=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(-1);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.strokeStyle=args[3];\r\n\t\t\t\tctx.lineWidth=args[4];\r\n\t\t\t\tvar points=args[2];\r\n\t\t\t\tx+=args[0],y+=args[1];\r\n\t\t\t\tctx.moveTo(x+points[0],y+points[1]);\r\n\t\t\t\tvar i=2,n=points.length;\r\n\t\t\t\twhile (i < n){\r\n\t\t\t\t\tctx.quadraticCurveTo(x+points[i++],y+points[i++],x+points[i++],y+points[i++]);\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t\tthis._draw=function(x,y,args){\r\n\t\t\t\targs[0].call(null,this,x,y);\r\n\t\t\t}\r\n\t\t\tthis._transformByMatrix=function(x,y,args){\r\n\t\t\t\tthis.ctx.transformByMatrix(args[0]);\r\n\t\t\t}\r\n\t\t\tthis._setTransform=function(x,y,args){\r\n\t\t\t\tthis.ctx.setTransform(args[0],args[1],args[2],args[3],args[4],args[5]);\r\n\t\t\t}\r\n\t\t\tthis._setTransformByMatrix=function(x,y,args){\r\n\t\t\t\tthis.ctx.setTransformByMatrix(args[0]);\r\n\t\t\t}\r\n\t\t\tthis._save=function(x,y,args){\r\n\t\t\t\tthis.ctx.save();\r\n\t\t\t}\r\n\t\t\tthis._restore=function(x,y,args){\r\n\t\t\t\tthis.ctx.restore();\r\n\t\t\t}\r\n\t\t\tthis._translate=function(x,y,args){\r\n\t\t\t\tthis.ctx.translate(args[0],args[1]);\r\n\t\t\t}\r\n\t\t\tthis._transform=function(x,y,args){\r\n\t\t\t\tthis.ctx.translate(args[1]+x,args[2]+y);\r\n\t\t\t\tvar mat=args[0];\r\n\t\t\t\tthis.ctx.transform(mat.a,mat.b,mat.c,mat.d,mat.tx,mat.ty);\r\n\t\t\t\tthis.ctx.translate(-x-args[1],-y-args[2]);\r\n\t\t\t}\r\n\t\t\tthis._rotate=function(x,y,args){\r\n\t\t\t\tthis.ctx.translate(args[1]+x,args[2]+y);\r\n\t\t\t\tthis.ctx.rotate(args[0]);\r\n\t\t\t\tthis.ctx.translate(-x-args[1],-y-args[2]);\r\n\t\t\t}\r\n\t\t\tthis._scale=function(x,y,args){\r\n\t\t\t\tthis.ctx.translate(args[2]+x,args[3]+y);\r\n\t\t\t\tthis.ctx.scale(args[0],args[1]);\r\n\t\t\t\tthis.ctx.translate(-x-args[2],-y-args[3]);\r\n\t\t\t}\r\n\t\t\tthis._alpha=function(x,y,args){\r\n\t\t\t\tthis.ctx.globalAlpha *=args[0];\r\n\t\t\t}\r\n\t\t\tthis._setAlpha=function(x,y,args){\r\n\t\t\t\tthis.ctx.globalAlpha=args[0];\r\n\t\t\t}\r\n\t\t\tthis._fillText=function(x,y,args){\r\n\t\t\t\tthis.ctx.fillText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5]);\r\n\t\t\t}\r\n\t\t\tthis._strokeText=function(x,y,args){\r\n\t\t\t\tthis.ctx.strokeText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6]);\r\n\t\t\t}\r\n\t\t\tthis._fillBorderText=function(x,y,args){\r\n\t\t\t\tthis.ctx.fillBorderText(args[0],args[1]+x,args[2]+y,args[3],args[4],args[5],args[6],args[7]);\r\n\t\t\t}\r\n\t\t\tthis._blendMode=function(x,y,args){\r\n\t\t\t\tthis.ctx.globalCompositeOperation=args[0];\r\n\t\t\t}\r\n\t\t\tthis._beginClip=function(x,y,args){\r\n\t\t\t\tthis.ctx.beginClip && this.ctx.beginClip(x+args[0],y+args[1],args[2],args[3]);\r\n\t\t\t}\r\n\t\t\tthis._setIBVB=function(x,y,args){\r\n\t\t\t\tthis.ctx.setIBVB(args[0]+x,args[1]+y,args[2],args[3],args[4],args[5],args[6],args[7]);\r\n\t\t\t}\r\n\t\t\tthis._fillTrangles=function(x,y,args){\r\n\t\t\t\tthis.ctx.fillTrangles(args[0],args[1]+x,args[2]+y,args[3],args[4]);\r\n\t\t\t}\r\n\t\t\tthis._drawPath=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tRender.isWebGL && ctx.setPathId(-1);\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tx+=args[0],y+=args[1];\r\n\t\t\t\tvar paths=args[2];\r\n\t\t\t\tfor (var i=0,n=paths.length;i < n;i++){\r\n\t\t\t\t\tvar path=paths[i];\r\n\t\t\t\t\tswitch (path[0]){\r\n\t\t\t\t\t\tcase \"moveTo\":\r\n\t\t\t\t\t\t\tctx.moveTo(x+path[1],y+path[2]);\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tcase \"lineTo\":\r\n\t\t\t\t\t\t\tctx.lineTo(x+path[1],y+path[2]);\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tcase \"arcTo\":\r\n\t\t\t\t\t\t\tctx.arcTo(x+path[1],y+path[2],x+path[3],y+path[4],path[5]);\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tcase \"closePath\":\r\n\t\t\t\t\t\t\tctx.closePath();\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tvar brush=args[3];\r\n\t\t\t\tif (brush !=null){\r\n\t\t\t\t\tctx.fillStyle=brush.fillStyle;\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t};\r\n\t\t\t\tvar pen=args[4];\r\n\t\t\t\tif (pen !=null){\r\n\t\t\t\t\tctx.strokeStyle=pen.strokeStyle;\r\n\t\t\t\t\tctx.lineWidth=pen.lineWidth || 1;\r\n\t\t\t\t\tctx.lineJoin=pen.lineJoin;\r\n\t\t\t\t\tctx.lineCap=pen.lineCap;\r\n\t\t\t\t\tctx.miterLimit=pen.miterLimit;\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.drawPoly=function(x,y,args){\r\n\t\t\t\tthis.ctx.drawPoly(x+this.x+args[0],y+this.y+args[1],args[2],args[3],args[4],args[5],args[6]);\r\n\t\t\t}\r\n\t\t\tthis._drawPoly=function(x,y,args){\r\n\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\tvar points=args[2];\r\n\t\t\t\tvar i=2,n=points.length;\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tctx.setPathId(args[6]);\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tx+=args[0],y+=args[1];\r\n\t\t\t\t\tctx.movePath(x,y);\r\n\t\t\t\t\tctx.moveTo(points[0],points[1]);\r\n\t\t\t\t\twhile (i < n){\r\n\t\t\t\t\t\tctx.lineTo(points[i++],points[i++]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tx+=args[0],y+=args[1];\r\n\t\t\t\t\tctx.moveTo(x+points[0],y+points[1]);\r\n\t\t\t\t\twhile (i < n){\r\n\t\t\t\t\t\tctx.lineTo(x+points[i++],y+points[i++]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tthis._fillAndStroke(args[3],args[4],args[5],args[7]);\r\n\t\t\t}\r\n\t\t\tthis._drawSkin=function(x,y,args){\r\n\t\t\t\tvar tSprite=args[0];\r\n\t\t\t\tif (tSprite){\r\n\t\t\t\t\tvar ctx=this.ctx;\r\n\t\t\t\t\ttSprite.render(ctx,x,y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._drawParticle=function(x,y,args){\r\n\t\t\t\tthis.ctx.drawParticle(x+this.x,y+this.y,args[0]);\r\n\t\t\t}\r\n\t\t\tif (canvas){\r\n\t\t\t\tthis.ctx=canvas.getContext('2d');\r\n\t\t\t\t}else {\r\n\t\t\t\tcanvas=HTMLCanvas.create(\"3D\");\r\n\t\t\t\tthis.ctx=RunDriver.createWebGLContext2D(canvas);\r\n\t\t\t\tcanvas._setContext(this.ctx);\r\n\t\t\t}\r\n\t\t\tcanvas.size(width,height);\r\n\t\t\tthis.canvas=canvas;\r\n\t\t}\r\n\r\n\t\t__class(RenderContext,'laya.renders.RenderContext');\r\n\t\tvar __proto=RenderContext.prototype;\r\n\t\t/**销毁当前渲染环境*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tif (this.canvas){\r\n\t\t\t\tthis.canvas.destroy();\r\n\t\t\t\tthis.canvas=null;\r\n\t\t\t}\r\n\t\t\tif (this.ctx){\r\n\t\t\t\tthis.ctx.destroy();\r\n\t\t\t\tthis.ctx=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTexture=function(tex,x,y,width,height){\r\n\t\t\tif (tex.loaded)this.ctx.drawTexture(tex,x,y,width,height,this.x,this.y);\r\n\t\t}\r\n\r\n\t\t__proto._drawTextures=function(x,y,args){\r\n\t\t\tif (args[0].loaded)this.ctx.drawTextures(args[0],args[1],x+this.x,y+this.y);\r\n\t\t}\r\n\r\n\t\t__proto.drawTextureWithTransform=function(tex,x,y,width,height,m,alpha){\r\n\t\t\tif (tex.loaded)this.ctx.drawTextureWithTransform(tex,x,y,width,height,m,this.x,this.y,alpha);\r\n\t\t}\r\n\r\n\t\t__proto.fillQuadrangle=function(tex,x,y,point4,m){\r\n\t\t\tthis.ctx.fillQuadrangle(tex,x,y,point4,m);\r\n\t\t}\r\n\r\n\t\t__proto.drawCanvas=function(canvas,x,y,width,height){\r\n\t\t\tthis.ctx.drawCanvas(canvas,x+this.x,y+this.y,width,height);\r\n\t\t}\r\n\r\n\t\t__proto.drawRect=function(x,y,width,height,color,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar ctx=this.ctx;\r\n\t\t\tctx.strokeStyle=color;\r\n\t\t\tctx.lineWidth=lineWidth;\r\n\t\t\tctx.strokeRect(x+this.x,y+this.y,width,height,lineWidth);\r\n\t\t}\r\n\r\n\t\t__proto._fillAndStroke=function(fillColor,strokeColor,lineWidth,isConvexPolygon){\r\n\t\t\t(isConvexPolygon===void 0)&& (isConvexPolygon=false);\r\n\t\t\tvar ctx=this.ctx;\r\n\t\t\tif (fillColor !=null){\r\n\t\t\t\tctx.fillStyle=fillColor;\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tctx.fill(isConvexPolygon);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (strokeColor !=null && lineWidth > 0){\r\n\t\t\t\tctx.strokeStyle=strokeColor;\r\n\t\t\t\tctx.lineWidth=lineWidth;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//ctx.translate(-x-args[0],-y-args[1]);\r\n\t\t__proto.clipRect=function(x,y,width,height){\r\n\t\t\tthis.ctx.clipRect(x+this.x,y+this.y,width,height);\r\n\t\t}\r\n\r\n\t\t__proto.fillRect=function(x,y,width,height,fillStyle){\r\n\t\t\tthis.ctx.fillRect(x+this.x,y+this.y,width,height,fillStyle);\r\n\t\t}\r\n\r\n\t\t__proto.drawCircle=function(x,y,radius,color,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tStat.drawCall++;\r\n\t\t\tvar ctx=this.ctx;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.strokeStyle=color;\r\n\t\t\tctx.lineWidth=lineWidth;\r\n\t\t\tctx.arc(x+this.x,y+this.y,radius,0,RenderContext.PI2);\r\n\t\t\tctx.stroke();\r\n\t\t}\r\n\r\n\t\t__proto.fillCircle=function(x,y,radius,color){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tvar ctx=this.ctx;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.fillStyle=color;\r\n\t\t\tctx.arc(x+this.x,y+this.y,radius,0,RenderContext.PI2);\r\n\t\t\tctx.fill();\r\n\t\t}\r\n\r\n\t\t__proto.setShader=function(shader){\r\n\t\t\tthis.ctx.setShader(shader);\r\n\t\t}\r\n\r\n\t\t__proto.drawLine=function(fromX,fromY,toX,toY,color,lineWidth){\r\n\t\t\t(lineWidth===void 0)&& (lineWidth=1);\r\n\t\t\tvar ctx=this.ctx;\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.strokeStyle=color;\r\n\t\t\tctx.lineWidth=lineWidth;\r\n\t\t\tctx.moveTo(this.x+fromX,this.y+fromY);\r\n\t\t\tctx.lineTo(this.x+toX,this.y+toY);\r\n\t\t\tctx.stroke();\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.ctx.clear();\r\n\t\t}\r\n\r\n\t\t__proto.transformByMatrix=function(value){\r\n\t\t\tthis.ctx.transformByMatrix(value);\r\n\t\t}\r\n\r\n\t\t__proto.setTransform=function(a,b,c,d,tx,ty){\r\n\t\t\tthis.ctx.setTransform(a,b,c,d,tx,ty);\r\n\t\t}\r\n\r\n\t\t__proto.setTransformByMatrix=function(value){\r\n\t\t\tthis.ctx.setTransformByMatrix(value);\r\n\t\t}\r\n\r\n\t\t__proto.save=function(){\r\n\t\t\tthis.ctx.save();\r\n\t\t}\r\n\r\n\t\t__proto.restore=function(){\r\n\t\t\tthis.ctx.restore();\r\n\t\t}\r\n\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tthis.ctx.translate(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.transform=function(a,b,c,d,tx,ty){\r\n\t\t\tthis.ctx.transform(a,b,c,d,tx,ty);\r\n\t\t}\r\n\r\n\t\t__proto.rotate=function(angle){\r\n\t\t\tthis.ctx.rotate(angle);\r\n\t\t}\r\n\r\n\t\t__proto.scale=function(scaleX,scaleY){\r\n\t\t\tthis.ctx.scale(scaleX,scaleY);\r\n\t\t}\r\n\r\n\t\t__proto.alpha=function(value){\r\n\t\t\tthis.ctx.globalAlpha *=value;\r\n\t\t}\r\n\r\n\t\t__proto.setAlpha=function(value){\r\n\t\t\tthis.ctx.globalAlpha=value;\r\n\t\t}\r\n\r\n\t\t__proto.fillWords=function(words,x,y,font,color){\r\n\t\t\tthis.ctx.fillWords(words,x,y,font,color);\r\n\t\t}\r\n\r\n\t\t__proto.fillText=function(text,x,y,font,color,textAlign){\r\n\t\t\tthis.ctx.fillText(text,x+this.x,y+this.y,font,color,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){\r\n\t\t\tthis.ctx.strokeText(text,x+this.x,y+this.y,font,color,lineWidth,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto.blendMode=function(type){\r\n\t\t\tthis.ctx.globalCompositeOperation=type;\r\n\t\t}\r\n\r\n\t\t__proto.flush=function(){\r\n\t\t\tthis.ctx.flush && this.ctx.flush();\r\n\t\t}\r\n\r\n\t\t__proto.addRenderObject=function(o){\r\n\t\t\tthis.ctx.addRenderObject(o);\r\n\t\t}\r\n\r\n\t\t__proto.beginClip=function(x,y,w,h){\r\n\t\t\tthis.ctx.beginClip && this.ctx.beginClip(x,y,w,h);\r\n\t\t}\r\n\r\n\t\t__proto.endClip=function(){\r\n\t\t\tthis.ctx.endClip && this.ctx.endClip();\r\n\t\t}\r\n\r\n\t\t__proto.fillTrangles=function(x,y,args){\r\n\t\t\tthis.ctx.fillTrangles(args[0],args[1],args[2],args[3],args.length > 4 ? args[4] :null);\r\n\t\t}\r\n\r\n\t\tRenderContext.PI2=2 *Math.PI;\r\n\t\treturn RenderContext;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*精灵渲染器\r\n\t*/\r\n\t//class laya.renders.RenderSprite\r\n\tvar RenderSprite=(function(){\r\n\t\tfunction RenderSprite(type,next){\r\n\t\t\t//this._next=null;\r\n\t\t\t//this._fun=null;\r\n\t\t\tthis._next=next || RenderSprite.NORENDER;\r\n\t\t\tswitch (type){\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\tthis._fun=this._no;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x01:\r\n\t\t\t\t\tthis._fun=this._image;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x02:\r\n\t\t\t\t\tthis._fun=this._alpha;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x04:\r\n\t\t\t\t\tthis._fun=this._transform;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x20:\r\n\t\t\t\t\tthis._fun=this._blend;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x08:\r\n\t\t\t\t\tthis._fun=this._canvas;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x40:\r\n\t\t\t\t\tthis._fun=this._clip;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x80:\r\n\t\t\t\t\tthis._fun=this._style;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x100:\r\n\t\t\t\t\tthis._fun=this._graphics;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x800:\r\n\t\t\t\t\tthis._fun=this._childs;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x200:\r\n\t\t\t\t\tthis._fun=this._custom;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x01 | 0x100:\r\n\t\t\t\t\tthis._fun=this._image2;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x01 | 0x04 | 0x100:\r\n\t\t\t\t\tthis._fun=this._image2;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x10:\r\n\t\t\t\t\tthis._fun=Filter._filter;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x11111:\r\n\t\t\t\t\tthis._fun=RenderSprite._initRenderFun;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\tthis.onCreate(type);\r\n\t\t}\r\n\r\n\t\t__class(RenderSprite,'laya.renders.RenderSprite');\r\n\t\tvar __proto=RenderSprite.prototype;\r\n\t\t__proto.onCreate=function(type){}\r\n\t\t__proto._style=function(sprite,context,x,y){\r\n\t\t\tsprite._style.render(sprite,context,x,y);\r\n\t\t\tvar next=this._next;\r\n\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t}\r\n\r\n\t\t__proto._no=function(sprite,context,x,y){}\r\n\t\t__proto._custom=function(sprite,context,x,y){\r\n\t\t\tsprite.customRender(context,x,y);\r\n\t\t\tvar tf=sprite._style._tf;\r\n\t\t\tthis._next._fun.call(this._next,sprite,context,x-tf.translateX,y-tf.translateY);\r\n\t\t}\r\n\r\n\t\t__proto._clip=function(sprite,context,x,y){\r\n\t\t\tvar next=this._next;\r\n\t\t\tif (next==RenderSprite.NORENDER)return;\r\n\t\t\tvar r=sprite._style.scrollRect;\r\n\t\t\tcontext.ctx.save();\r\n\t\t\tcontext.ctx.clipRect(x,y,r.width,r.height);\r\n\t\t\tnext._fun.call(next,sprite,context,x-r.x,y-r.y);\r\n\t\t\tcontext.ctx.restore();\r\n\t\t}\r\n\r\n\t\t__proto._blend=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tif (style.blendMode){\r\n\t\t\t\tcontext.ctx.globalCompositeOperation=style.blendMode;\r\n\t\t\t};\r\n\t\t\tvar next=this._next;\r\n\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\tvar mask=sprite.mask;\r\n\t\t\tif (mask){\r\n\t\t\t\tcontext.ctx.globalCompositeOperation=\"destination-in\";\r\n\t\t\t\tif (mask.numChildren > 0 || !mask.graphics._isOnlyOne()){\r\n\t\t\t\t\tmask.cacheAsBitmap=true;\r\n\t\t\t\t}\r\n\t\t\t\tmask.render(context,x,y);\r\n\t\t\t}\r\n\t\t\tcontext.ctx.globalCompositeOperation=\"source-over\";\r\n\t\t}\r\n\r\n\t\t__proto._graphics=function(sprite,context,x,y){\r\n\t\t\tvar tf=sprite._style._tf;\r\n\t\t\tsprite._graphics && sprite._graphics._render(sprite,context,x-tf.translateX,y-tf.translateY);\r\n\t\t\tvar next=this._next;\r\n\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t}\r\n\r\n\t\t__proto._image=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tcontext.ctx.drawTexture2(x,y,style._tf.translateX,style._tf.translateY,sprite.transform,style.alpha,style.blendMode,sprite._graphics._one);\r\n\t\t}\r\n\r\n\t\t__proto._image2=function(sprite,context,x,y){\r\n\t\t\tvar tf=sprite._style._tf;\r\n\t\t\tcontext.ctx.drawTexture2(x,y,tf.translateX,tf.translateY,sprite.transform,1,null,sprite._graphics._one);\r\n\t\t}\r\n\r\n\t\t__proto._alpha=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tvar alpha;\r\n\t\t\tif ((alpha=style.alpha)> 0.01){\r\n\t\t\t\tvar temp=context.ctx.globalAlpha;\r\n\t\t\t\tcontext.ctx.globalAlpha *=alpha;\r\n\t\t\t\tvar next=this._next;\r\n\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\tcontext.ctx.globalAlpha=temp;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._transform=function(sprite,context,x,y){\r\n\t\t\tvar transform=sprite.transform,_next=this._next;\r\n\t\t\tif (transform && _next !=RenderSprite.NORENDER){\r\n\t\t\t\tcontext.save();\r\n\t\t\t\tcontext.transform(transform.a,transform.b,transform.c,transform.d,transform.tx+x,transform.ty+y);\r\n\t\t\t\t_next._fun.call(_next,sprite,context,0,0);\r\n\t\t\t\tcontext.restore();\r\n\t\t\t}else\r\n\t\t\t_next._fun.call(_next,sprite,context,x,y);\r\n\t\t}\r\n\r\n\t\t__proto._childs=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tx+=-style._tf.translateX+style.paddingLeft;\r\n\t\t\ty+=-style._tf.translateY+style.paddingTop;\r\n\t\t\tif (style._calculation){\r\n\t\t\t\tvar words=sprite._getWords();\r\n\t\t\t\twords && context.fillWords(words,x,y,(style).font,(style).color);\r\n\t\t\t};\r\n\t\t\tvar childs=sprite._childs,n=childs.length,ele;\r\n\t\t\tif (!sprite.viewport || !sprite.optimizeScrollRect){\r\n\t\t\t\tfor (var i=0;i < n;++i)\r\n\t\t\t\t(ele=(childs [i]))._style.visible && ele.render(context,x,y);\r\n\t\t\t\t}else {\r\n\t\t\t\tvar rect=sprite.viewport;\r\n\t\t\t\tvar left=rect.x;\r\n\t\t\t\tvar top=rect.y;\r\n\t\t\t\tvar right=rect.right;\r\n\t\t\t\tvar bottom=rect.bottom;\r\n\t\t\t\tvar _x=NaN,_y=NaN;\r\n\t\t\t\tfor (i=0;i < n;++i){\r\n\t\t\t\t\tif ((ele=childs [i]).visible && ((_x=ele._x)< right && (_x+ele.width)> left && (_y=ele._y)< bottom && (_y+ele.height)> top)){\r\n\t\t\t\t\t\tele.render(context,x,y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._canvas=function(sprite,context,x,y){\r\n\t\t\tvar _cacheCanvas=sprite._$P.cacheCanvas;\r\n\t\t\tvar _next=this._next;\r\n\t\t\tif (!_cacheCanvas){\r\n\t\t\t\t_next._fun.call(_next,sprite,tx,x,y);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar tx=_cacheCanvas.ctx;\r\n\t\t\tvar _repaint=sprite._needRepaint()|| (!tx);\r\n\t\t\tvar canvas;\r\n\t\t\tvar left;\r\n\t\t\tvar top;\r\n\t\t\tvar tRec;\r\n\t\t\t_cacheCanvas.type==='bitmap' ? (Stat.canvasBitmap++):(Stat.canvasNormal++);\r\n\t\t\tif (_repaint){\r\n\t\t\t\tif (!_cacheCanvas._cacheRec)\r\n\t\t\t\t\t_cacheCanvas._cacheRec=new Rectangle();\r\n\t\t\t\tvar w,h;\r\n\t\t\t\ttRec=sprite.getSelfBounds();\r\n\t\t\t\ttRec.x-=sprite.pivotX;\r\n\t\t\t\ttRec.y-=sprite.pivotY;\r\n\t\t\t\ttRec.x-=10;\r\n\t\t\t\ttRec.y-=10;\r\n\t\t\t\ttRec.width+=20;\r\n\t\t\t\ttRec.height+=20;\r\n\t\t\t\ttRec.x=Math.floor(tRec.x+x)-x;\r\n\t\t\t\ttRec.y=Math.floor(tRec.y+y)-y;\r\n\t\t\t\ttRec.width=Math.floor(tRec.width);\r\n\t\t\t\ttRec.height=Math.floor(tRec.height);\r\n\t\t\t\t_cacheCanvas._cacheRec.copyFrom(tRec);\r\n\t\t\t\ttRec=_cacheCanvas._cacheRec;\r\n\t\t\t\tvar scaleX=Render.isWebGL ? 1 :Browser.pixelRatio *Laya.stage.clientScaleX;\r\n\t\t\t\tvar scaleY=Render.isWebGL ? 1 :Browser.pixelRatio *Laya.stage.clientScaleY;\r\n\t\t\t\tif (!Render.isWebGL){\r\n\t\t\t\t\tvar chainScaleX=1;\r\n\t\t\t\t\tvar chainScaleY=1;\r\n\t\t\t\t\tvar tar;\r\n\t\t\t\t\ttar=sprite;\r\n\t\t\t\t\twhile (tar && tar !=Laya.stage){\r\n\t\t\t\t\t\tchainScaleX *=tar.scaleX;\r\n\t\t\t\t\t\tchainScaleY *=tar.scaleY;\r\n\t\t\t\t\t\ttar=tar.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(Render.isWebGL){\r\n\t\t\t\t\t\tif (chainScaleX < 1)scaleX *=chainScaleX;\r\n\t\t\t\t\t\tif (chainScaleY < 1)scaleY *=chainScaleY;\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif (chainScaleX > 1)scaleX *=chainScaleX;\r\n\t\t\t\t\t\tif (chainScaleY > 1)scaleY *=chainScaleY;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tw=tRec.width *scaleX;\r\n\t\t\t\th=tRec.height *scaleY;\r\n\t\t\t\tleft=tRec.x;\r\n\t\t\t\ttop=tRec.y;\r\n\t\t\t\tif (Render.isWebGL && _cacheCanvas.type==='bitmap' && (w > 2048 || h > 2048)){\r\n\t\t\t\t\tconsole.log(\"cache bitmap size larger than 2048,cache ignored\");\r\n\t\t\t\t\tif(_cacheCanvas.ctx){\r\n\t\t\t\t\t\tPool.recover(\"RenderContext\",_cacheCanvas.ctx);\r\n\t\t\t\t\t\t_cacheCanvas.ctx=null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_next._fun.call(_next,sprite,context,x,y);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!tx){\r\n\t\t\t\t\ttx=_cacheCanvas.ctx=Pool.getItem(\"RenderContext\")|| new RenderContext(w,h,HTMLCanvas.create(/*laya.resource.HTMLCanvas.TYPEAUTO*/\"AUTO\"));\r\n\t\t\t\t\ttx.ctx.sprite=sprite;\r\n\t\t\t\t}\r\n\t\t\t\tcanvas=tx.canvas;\r\n\t\t\t\tif (_cacheCanvas.type==='bitmap')canvas.context.asBitmap=true;\r\n\t\t\t\tcanvas.clear();\r\n\t\t\t\t(canvas.width !=w || canvas.height !=h)&& canvas.size(w,h);\r\n\t\t\t\tvar t;\r\n\t\t\t\tif (scaleX !=1 || scaleY !=1){\r\n\t\t\t\t\tvar ctx=(tx).ctx;\r\n\t\t\t\t\tctx.save();\r\n\t\t\t\t\tctx.scale(scaleX,scaleY);\r\n\t\t\t\t\tif (!Render.isConchWebGL && Render.isConchApp){\r\n\t\t\t\t\t\tt=sprite._$P.cf;\r\n\t\t\t\t\t\tt && ctx.setFilterMatrix && ctx.setFilterMatrix(t._mat,t._alpha);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_next._fun.call(_next,sprite,tx,-left,-top);\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t\tif (!Render.isConchApp || Render.isConchWebGL)sprite._applyFilters();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tctx=(tx).ctx;\r\n\t\t\t\t\tif (!Render.isConchWebGL && Render.isConchApp){\r\n\t\t\t\t\t\tt=sprite._$P.cf;\r\n\t\t\t\t\t\tt && ctx.setFilterMatrix && ctx.setFilterMatrix(t._mat,t._alpha);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_next._fun.call(_next,sprite,tx,-left,-top);\r\n\t\t\t\t\tif (!Render.isConchApp || Render.isConchWebGL)sprite._applyFilters();\r\n\t\t\t\t}\r\n\t\t\t\tif (sprite._$P.staticCache)_cacheCanvas.reCache=false;\r\n\t\t\t\tStat.canvasReCache++;\r\n\t\t\t\t}else {\r\n\t\t\t\ttRec=_cacheCanvas._cacheRec;\r\n\t\t\t\tleft=tRec.x;\r\n\t\t\t\ttop=tRec.y;\r\n\t\t\t\tcanvas=tx.canvas;\r\n\t\t\t}\r\n\t\t\tcontext.drawCanvas(canvas,x+left,y+top,tRec.width,tRec.height);\r\n\t\t}\r\n\r\n\t\tRenderSprite.__init__=function(){\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tvar initRender;\r\n\t\t\tinitRender=RunDriver.createRenderSprite(0x11111,null);\r\n\t\t\tlen=RenderSprite.renders.length=0x800 *2;\r\n\t\t\tfor (i=0;i < len;i++)\r\n\t\t\tRenderSprite.renders[i]=initRender;\r\n\t\t\tRenderSprite.renders[0]=RunDriver.createRenderSprite(0,null);\r\n\t\t\tfunction _initSame (value,o){\r\n\t\t\t\tvar n=0;\r\n\t\t\t\tfor (var i=0;i < value.length;i++){\r\n\t\t\t\t\tn |=value[i];\r\n\t\t\t\t\tRenderSprite.renders[n]=o;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_initSame([0x01,0x100,0x04,0x02],new RenderSprite(0x01,null));\r\n\t\t\tRenderSprite.renders[0x01 | 0x100]=RunDriver.createRenderSprite(0x01 | 0x100,null);\r\n\t\t\tRenderSprite.renders[0x01 | 0x04 | 0x100]=new RenderSprite(0x01 | 0x04 | 0x100,null);\r\n\t\t}\r\n\r\n\t\tRenderSprite._initRenderFun=function(sprite,context,x,y){\r\n\t\t\tvar type=sprite._renderType;\r\n\t\t\tvar r=RenderSprite.renders[type]=RenderSprite._getTypeRender(type);\r\n\t\t\tr._fun(sprite,context,x,y);\r\n\t\t}\r\n\r\n\t\tRenderSprite._getTypeRender=function(type){\r\n\t\t\tvar rst=null;\r\n\t\t\tvar tType=0x800;\r\n\t\t\twhile (tType > 1){\r\n\t\t\t\tif (tType & type)\r\n\t\t\t\t\trst=RunDriver.createRenderSprite(tType,rst);\r\n\t\t\t\ttType=tType >> 1;\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tRenderSprite.IMAGE=0x01;\r\n\t\tRenderSprite.ALPHA=0x02;\r\n\t\tRenderSprite.TRANSFORM=0x04;\r\n\t\tRenderSprite.CANVAS=0x08;\r\n\t\tRenderSprite.FILTERS=0x10;\r\n\t\tRenderSprite.BLEND=0x20;\r\n\t\tRenderSprite.CLIP=0x40;\r\n\t\tRenderSprite.STYLE=0x80;\r\n\t\tRenderSprite.GRAPHICS=0x100;\r\n\t\tRenderSprite.CUSTOM=0x200;\r\n\t\tRenderSprite.CHILDS=0x800;\r\n\t\tRenderSprite.INIT=0x11111;\r\n\t\tRenderSprite.renders=[];\r\n\t\tRenderSprite.NORENDER=new RenderSprite(0,null);\r\n\t\treturn RenderSprite;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*Context扩展类\r\n\t*/\r\n\t//class laya.resource.Context\r\n\tvar Context=(function(){\r\n\t\tfunction Context(){\r\n\t\t\t//this._canvas=null;\r\n\t\t\tthis._repaint=false;\r\n\t\t}\r\n\r\n\t\t__class(Context,'laya.resource.Context');\r\n\t\tvar __proto=Context.prototype;\r\n\t\t__proto.setIsMainContext=function(){}\r\n\t\t__proto.drawTextures=function(tex,pos,tx,ty){\r\n\t\t\tStat.drawCall+=pos.length / 2;\r\n\t\t\tvar w=tex.bitmap.width;\r\n\t\t\tvar h=tex.bitmap.height;\r\n\t\t\tfor (var i=0,sz=pos.length;i < sz;i+=2){\r\n\t\t\t\tthis.drawTexture(tex,pos[i],pos[i+1],w,h,tx,ty);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.drawCanvas=function(canvas,x,y,width,height){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tthis.drawImage(canvas.source,x,y,width,height);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.fillRect=function(x,y,width,height,style){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tstyle && (this.fillStyle=style);\r\n\t\t\t/*__JS__ */this.__fillRect(x,y,width,height);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.fillText=function(text,x,y,font,color,textAlign){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tif (arguments.length > 3 && font !=null){\r\n\t\t\t\tthis.font=font;\r\n\t\t\t\tthis.fillStyle=color;\r\n\t\t\t\t/*__JS__ */this.textAlign=textAlign;\r\n\t\t\t\tthis.textBaseline=\"top\";\r\n\t\t\t}\r\n\t\t\t/*__JS__ */this.__fillText(text,x,y);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.fillBorderText=function(text,x,y,font,fillColor,borderColor,lineWidth,textAlign){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tthis.font=font;\r\n\t\t\tthis.fillStyle=fillColor;\r\n\t\t\tthis.textBaseline=\"top\";\r\n\t\t\t/*__JS__ */this.strokeStyle=borderColor;\r\n\t\t\t/*__JS__ */this.lineWidth=lineWidth;\r\n\t\t\t/*__JS__ */this.textAlign=textAlign;\r\n\t\t\t/*__JS__ */this.__strokeText(text,x,y);\r\n\t\t\t/*__JS__ */this.__fillText(text,x,y);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.strokeText=function(text,x,y,font,color,lineWidth,textAlign){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tif (arguments.length > 3 && font !=null){\r\n\t\t\t\tthis.font=font;\r\n\t\t\t\t/*__JS__ */this.strokeStyle=color;\r\n\t\t\t\t/*__JS__ */this.lineWidth=lineWidth;\r\n\t\t\t\t/*__JS__ */this.textAlign=textAlign;\r\n\t\t\t\tthis.textBaseline=\"top\";\r\n\t\t\t}\r\n\t\t\t/*__JS__ */this.__strokeText(text,x,y);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.transformByMatrix=function(value){\r\n\t\t\tthis.transform(value.a,value.b,value.c,value.d,value.tx,value.ty);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.setTransformByMatrix=function(value){\r\n\t\t\tthis.setTransform(value.a,value.b,value.c,value.d,value.tx,value.ty);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.clipRect=function(x,y,width,height){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tthis.beginPath();\r\n\t\t\tthis.rect(x,y,width,height);\r\n\t\t\tthis.clip();\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.drawTexture=function(tex,x,y,width,height,tx,ty){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tvar uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;\r\n\t\t\tthis.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x+tx,y+ty,width,height);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.drawTextureWithTransform=function(tex,x,y,width,height,m,tx,ty,alpha){\r\n\t\t\tStat.drawCall++;\r\n\t\t\tvar uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;\r\n\t\t\tthis.save();\r\n\t\t\talpha !=1 && (this.globalAlpha *=alpha);\r\n\t\t\tif (m){\r\n\t\t\t\tthis.transform(m.a,m.b,m.c,m.d,m.tx+tx,m.ty+ty);\r\n\t\t\t\tthis.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x ,y,width,height);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,x+tx ,y+ty,width,height);\r\n\t\t\t}\r\n\t\t\tthis.restore();\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.drawTexture2=function(x,y,pivotX,pivotY,m,alpha,blendMode,args2){\r\n\t\t\t'use strict';\r\n\t\t\tvar tex=args2[0];\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tvar alphaChanged=alpha!==1;\r\n\t\t\tif (alphaChanged){\r\n\t\t\t\tvar temp=this.globalAlpha;\r\n\t\t\t\tthis.globalAlpha *=alpha;\r\n\t\t\t};\r\n\t\t\tvar uv=tex.uv,w=tex.bitmap.width,h=tex.bitmap.height;\r\n\t\t\tif (m){\r\n\t\t\t\tthis.save();\r\n\t\t\t\tthis.transform(m.a,m.b,m.c,m.d,m.tx+x,m.ty+y);\r\n\t\t\t\tthis.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,args2[1]-pivotX ,args2[2]-pivotY,args2[3],args2[4]);\r\n\t\t\t\tthis.restore();\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.drawImage(tex.source,uv[0] *w,uv[1] *h,(uv[2]-uv[0])*w,(uv[5]-uv[3])*h,args2[1]-pivotX+x ,args2[2]-pivotY+y,args2[3],args2[4]);\r\n\t\t\t}\r\n\t\t\tif (alphaChanged)this.globalAlpha=temp;\r\n\t\t}\r\n\r\n\t\t__proto.fillTexture=function(texture,x,y,width,height,type,offset,other){\r\n\t\t\tif (!other.pat){\r\n\t\t\t\tif (texture.uv !=Texture.DEF_UV){\r\n\t\t\t\t\tvar canvas=new HTMLCanvas(\"2D\");\r\n\t\t\t\t\tcanvas.getContext('2d');\r\n\t\t\t\t\tcanvas.size(texture.width,texture.height);\r\n\t\t\t\t\tcanvas.context.drawTexture(texture,0,0,texture.width,texture.height,0,0);\r\n\t\t\t\t\ttexture=new Texture(canvas);\r\n\t\t\t\t}\r\n\t\t\t\tother.pat=this.createPattern(texture.bitmap.source,type);\r\n\t\t\t};\r\n\t\t\tvar oX=x,oY=y;\r\n\t\t\tvar sX=0,sY=0;\r\n\t\t\tif (offset){\r\n\t\t\t\toX+=offset.x % texture.width;\r\n\t\t\t\toY+=offset.y % texture.height;\r\n\t\t\t\tsX-=offset.x % texture.width;\r\n\t\t\t\tsY-=offset.y % texture.height;\r\n\t\t\t}\r\n\t\t\tthis.translate(oX,oY);\r\n\t\t\tthis.fillRect(sX,sY,width,height,other.pat);\r\n\t\t\tthis.translate(-oX,-oY);\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.flush=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.fillWords=function(words,x,y,font,color){\r\n\t\t\tfont && (this.font=font);\r\n\t\t\tcolor && (this.fillStyle=color);\r\n\t\t\tvar _this=this;\r\n\t\t\tthis.textBaseline=\"top\";\r\n\t\t\t/*__JS__ */this.textAlign='left';\r\n\t\t\tfor (var i=0,n=words.length;i < n;i++){\r\n\t\t\t\tvar a=words[i];\r\n\t\t\t\t/*__JS__ */this.__fillText(a.char,a.x+x,a.y+y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.destroy=function(){\r\n\t\t\t/*__JS__ */this.canvas.width=this.canvas.height=0;\r\n\t\t}\r\n\r\n\t\t/***@private */\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.clearRect(0,0,this._canvas.width,this._canvas.height);\r\n\t\t\tthis._repaint=false;\r\n\t\t}\r\n\r\n\t\tContext.__init__=function(to){\r\n\t\t\tvar from=laya.resource.Context.prototype;\r\n\t\t\tto=to || /*__JS__ */CanvasRenderingContext2D.prototype;\r\n\t\t\tto.__fillText=to.fillText;\r\n\t\t\tto.__fillRect=to.fillRect;\r\n\t\t\tto.__strokeText=to.strokeText;\r\n\t\t\tvar funs=['drawTextures','fillWords','setIsMainContext','fillRect','strokeText','fillTexture','fillText','transformByMatrix','setTransformByMatrix','clipRect','drawTexture','drawTexture2','drawTextureWithTransform','flush','clear','destroy','drawCanvas','fillBorderText'];\r\n\t\t\tfuns.forEach(function(i){\r\n\t\t\t\tto[i]=from[i] || to[i];\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tContext._default=new Context();\r\n\t\treturn Context;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>ResourceManager</code> 是资源管理类。它用于资源的载入、获取、销毁。\r\n\t*/\r\n\t//class laya.resource.ResourceManager\r\n\tvar ResourceManager=(function(){\r\n\t\tfunction ResourceManager(){\r\n\t\t\tthis._id=0;\r\n\t\t\tthis._name=null;\r\n\t\t\tthis._resources=null;\r\n\t\t\tthis._memorySize=0;\r\n\t\t\tthis._garbageCollectionRate=NaN;\r\n\t\t\tthis._isOverflow=false;\r\n\t\t\tthis.autoRelease=false;\r\n\t\t\tthis.autoReleaseMaxSize=0;\r\n\t\t\tthis._id=++ResourceManager._uniqueIDCounter;\r\n\t\t\tthis._name=\"Content Manager\";\r\n\t\t\tResourceManager._isResourceManagersSorted=false;\r\n\t\t\tthis._memorySize=0;\r\n\t\t\tthis._isOverflow=false;\r\n\t\t\tthis.autoRelease=false;\r\n\t\t\tthis.autoReleaseMaxSize=1024 *1024 *512;\r\n\t\t\tthis._garbageCollectionRate=0.2;\r\n\t\t\tResourceManager._resourceManagers.push(this);\r\n\t\t\tthis._resources=[];\r\n\t\t}\r\n\r\n\t\t__class(ResourceManager,'laya.resource.ResourceManager');\r\n\t\tvar __proto=ResourceManager.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.resource.IDispose\":true})\r\n\t\t/**\r\n\t\t*获取指定索引的资源 Resource 对象。\r\n\t\t*@param 索引。\r\n\t\t*@return 资源 Resource 对象。\r\n\t\t*/\r\n\t\t__proto.getResourceByIndex=function(index){\r\n\t\t\treturn this._resources[index];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取此管理器所管理的资源个数。\r\n\t\t*@return 资源个数。\r\n\t\t*/\r\n\t\t__proto.getResourcesLength=function(){\r\n\t\t\treturn this._resources.length;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*添加指定资源。\r\n\t\t*@param resource 需要添加的资源 Resource 对象。\r\n\t\t*@return 是否添加成功。\r\n\t\t*/\r\n\t\t__proto.addResource=function(resource){\r\n\t\t\tif (resource.resourceManager)\r\n\t\t\t\tresource.resourceManager.removeResource(resource);\r\n\t\t\tvar index=this._resources.indexOf(resource);\r\n\t\t\tif (index===-1){\r\n\t\t\t\tresource._resourceManager=this;\r\n\t\t\t\tthis._resources.push(resource);\r\n\t\t\t\tthis.addSize(resource.memorySize);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*移除指定资源。\r\n\t\t*@param resource 需要移除的资源 Resource 对象\r\n\t\t*@return 是否移除成功。\r\n\t\t*/\r\n\t\t__proto.removeResource=function(resource){\r\n\t\t\tvar index=this._resources.indexOf(resource);\r\n\t\t\tif (index!==-1){\r\n\t\t\t\tthis._resources.splice(index,1);\r\n\t\t\t\tresource._resourceManager=null;\r\n\t\t\t\tthis._memorySize-=resource.memorySize;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*卸载此资源管理器载入的资源。\r\n\t\t*/\r\n\t\t__proto.unload=function(){\r\n\t\t\tvar tempResources=this._resources.slice(0,this._resources.length);\r\n\t\t\tfor (var i=0;i < tempResources.length;i++){\r\n\t\t\t\tvar resource=tempResources[i];\r\n\t\t\t\tresource.dispose();\r\n\t\t\t}\r\n\t\t\ttempResources.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置唯一名字。\r\n\t\t*@param newName 名字，如果名字重复则自动加上“-copy”。\r\n\t\t*/\r\n\t\t__proto.setUniqueName=function(newName){\r\n\t\t\tvar isUnique=true;\r\n\t\t\tfor (var i=0;i < ResourceManager._resourceManagers.length;i++){\r\n\t\t\t\tif (ResourceManager._resourceManagers[i]._name!==newName || ResourceManager._resourceManagers[i]===this)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tisUnique=false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isUnique){\r\n\t\t\t\tif (this.name !=newName){\r\n\t\t\t\t\tthis.name=newName;\r\n\t\t\t\t\tResourceManager._isResourceManagersSorted=false;\r\n\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\tthis.setUniqueName(newName.concat(\"-copy\"));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**释放资源。*/\r\n\t\t__proto.dispose=function(){\r\n\t\t\tif (this===ResourceManager._systemResourceManager)\r\n\t\t\t\tthrow new Error(\"systemResourceManager不能被释放！\");\r\n\t\t\tResourceManager._resourceManagers.splice(ResourceManager._resourceManagers.indexOf(this),1);\r\n\t\t\tResourceManager._isResourceManagersSorted=false;\r\n\t\t\tvar tempResources=this._resources.slice(0,this._resources.length);\r\n\t\t\tfor (var i=0;i < tempResources.length;i++){\r\n\t\t\t\tvar resource=tempResources[i];\r\n\t\t\t\tresource.resourceManager.removeResource(resource);\r\n\t\t\t\tresource.dispose();\r\n\t\t\t}\r\n\t\t\ttempResources.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*增加内存。\r\n\t\t*@param add 需要增加的内存大小。\r\n\t\t*/\r\n\t\t__proto.addSize=function(add){\r\n\t\t\tif (add){\r\n\t\t\t\tif (this.autoRelease && add > 0)\r\n\t\t\t\t\t((this._memorySize+add)> this.autoReleaseMaxSize)&& (this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize));\r\n\t\t\t\tthis._memorySize+=add;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*垃圾回收。\r\n\t\t*@param reserveSize 保留尺寸。\r\n\t\t*/\r\n\t\t__proto.garbageCollection=function(reserveSize){\r\n\t\t\tvar all=this._resources;\r\n\t\t\tall=all.slice();\r\n\t\t\tall.sort(function(a,b){\r\n\t\t\t\tif (!a || !b)\r\n\t\t\t\t\tthrow new Error(\"a或b不能为空！\");\r\n\t\t\t\tif (a.released && b.released)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\telse if (a.released)\r\n\t\t\t\treturn 1;\r\n\t\t\t\telse if (b.released)\r\n\t\t\t\treturn-1;\r\n\t\t\t\treturn a.lastUseFrameCount-b.lastUseFrameCount;\r\n\t\t\t});\r\n\t\t\tvar currentFrameCount=Stat.loopCount;\r\n\t\t\tfor (var i=0,n=all.length;i < n;i++){\r\n\t\t\t\tvar resou=all[i];\r\n\t\t\t\tif (currentFrameCount-resou.lastUseFrameCount > 1){\r\n\t\t\t\t\tresou.releaseResource();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tif (this._memorySize >=reserveSize)\r\n\t\t\t\t\t\tthis._isOverflow=true;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this._memorySize < reserveSize){\r\n\t\t\t\t\tthis._isOverflow=false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*唯一标识 ID 。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'id',function(){\r\n\t\t\treturn this._id;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*名字。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'name',function(){\r\n\t\t\treturn this._name;\r\n\t\t\t},function(value){\r\n\t\t\tif ((value || value!==\"\")&& this._name!==value){\r\n\t\t\t\tthis._name=value;\r\n\t\t\t\tResourceManager._isResourceManagersSorted=false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*此管理器所管理资源的累计内存，以字节为单位。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'memorySize',function(){\r\n\t\t\treturn this._memorySize;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*系统资源管理器。\r\n\t\t*/\r\n\t\t__getset(1,ResourceManager,'systemResourceManager',function(){\r\n\t\t\t(ResourceManager._systemResourceManager===null)&& (ResourceManager._systemResourceManager=new ResourceManager(),ResourceManager._systemResourceManager._name=\"System Resource Manager\");\r\n\t\t\treturn ResourceManager._systemResourceManager;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*排序后的资源管理器列表。\r\n\t\t*/\r\n\t\t__getset(1,ResourceManager,'sortedResourceManagersByName',function(){\r\n\t\t\tif (!ResourceManager._isResourceManagersSorted){\r\n\t\t\t\tResourceManager._isResourceManagersSorted=true;\r\n\t\t\t\tResourceManager._resourceManagers.sort(ResourceManager.compareResourceManagersByName);\r\n\t\t\t}\r\n\t\t\treturn ResourceManager._resourceManagers;\r\n\t\t});\r\n\r\n\t\tResourceManager.__init__=function(){\r\n\t\t\tResourceManager.currentResourceManager=ResourceManager.systemResourceManager;\r\n\t\t}\r\n\r\n\t\tResourceManager.getLoadedResourceManagerByIndex=function(index){\r\n\t\t\treturn ResourceManager._resourceManagers[index];\r\n\t\t}\r\n\r\n\t\tResourceManager.getLoadedResourceManagersCount=function(){\r\n\t\t\treturn ResourceManager._resourceManagers.length;\r\n\t\t}\r\n\r\n\t\tResourceManager.recreateContentManagers=function(force){\r\n\t\t\t(force===void 0)&& (force=false);\r\n\t\t\tvar temp=ResourceManager.currentResourceManager;\r\n\t\t\tfor (var i=0;i < ResourceManager._resourceManagers.length;i++){\r\n\t\t\t\tResourceManager.currentResourceManager=ResourceManager._resourceManagers[i];\r\n\t\t\t\tfor (var j=0;j < ResourceManager.currentResourceManager._resources.length;j++){\r\n\t\t\t\t\tResourceManager.currentResourceManager._resources[j].releaseResource(force);\r\n\t\t\t\t\tResourceManager.currentResourceManager._resources[j].activeResource(force);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tResourceManager.currentResourceManager=temp;\r\n\t\t}\r\n\r\n\t\tResourceManager.releaseContentManagers=function(force){\r\n\t\t\t(force===void 0)&& (force=false);\r\n\t\t\tvar temp=ResourceManager.currentResourceManager;\r\n\t\t\tfor (var i=0;i < ResourceManager._resourceManagers.length;i++){\r\n\t\t\t\tResourceManager.currentResourceManager=ResourceManager._resourceManagers[i];\r\n\t\t\t\tfor (var j=0;j < ResourceManager.currentResourceManager._resources.length;j++){\r\n\t\t\t\t\tvar resource=ResourceManager.currentResourceManager._resources[j];\r\n\t\t\t\t\t(!resource.released)&& (resource.releaseResource(force));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tResourceManager.currentResourceManager=temp;\r\n\t\t}\r\n\r\n\t\tResourceManager.compareResourceManagersByName=function(left,right){\r\n\t\t\tif (left==right)\r\n\t\t\t\treturn 0;\r\n\t\t\tvar x=left._name;\r\n\t\t\tvar y=right._name;\r\n\t\t\tif (x==null){\r\n\t\t\t\tif (y==null)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\telse\r\n\t\t\t\treturn-1;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (y==null)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar retval=x.localeCompare(y);\r\n\t\t\t\t\tif (retval !=0)\r\n\t\t\t\t\t\treturn retval;\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tright.setUniqueName(y);\r\n\t\t\t\t\t\ty=right._name;\r\n\t\t\t\t\t\treturn x.localeCompare(y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tResourceManager._uniqueIDCounter=0;\r\n\t\tResourceManager._systemResourceManager=null\r\n\t\tResourceManager._isResourceManagersSorted=false;\r\n\t\tResourceManager._resourceManagers=[];\r\n\t\tResourceManager.currentResourceManager=null\r\n\t\treturn ResourceManager;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.resource.WXCanvas\r\n\tvar WXCanvas=(function(){\r\n\t\tfunction WXCanvas(id){\r\n\t\t\tthis._ctx=null;\r\n\t\t\tthis._id=null;\r\n\t\t\tthis.style={};\r\n\t\t\tthis._id=id;\r\n\t\t}\r\n\r\n\t\t__class(WXCanvas,'laya.resource.WXCanvas');\r\n\t\tvar __proto=WXCanvas.prototype;\r\n\t\t__proto.getContext=function(){\r\n\t\t\tvar wx=laya.resource.WXCanvas.wx;\r\n\t\t\tvar ctx=wx.createContext();\r\n\t\t\tctx.id=this._id;\r\n\t\t\tctx.fillRect=function (x,y,w,h){\r\n\t\t\t\tthis.rect(x,y,w,h);\r\n\t\t\t\tthis.fill();\r\n\t\t\t}\r\n\t\t\tctx.strokeRect=function (x,y,w,h){\r\n\t\t\t\tthis.rect(x,y,w,h);\r\n\t\t\t\tthis.stroke();\r\n\t\t\t}\r\n\t\t\tctx.___drawImage=ctx.drawImage;\r\n\t\t\tctx.drawImage=function (){\r\n\t\t\t\tvar img=arguments[0].tempFilePath;\r\n\t\t\t\tif (img==null)return;\r\n\t\t\t\tswitch(arguments.length){\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\tthis.___drawImage(img,arguments[1],arguments[2],arguments[0].width,arguments[0].height);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\tthis.___drawImage(img,arguments[1],arguments[2],arguments[3],arguments[4]);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase 9:\r\n\t\t\t\t\t\tthis.___drawImage(img,arguments[5],arguments[6],arguments[7],arguments[8]);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tObject.defineProperty(ctx,\"strokeStyle\",{set:function (value){this.setStrokeStyle(value)},enumerable:false });\r\n\t\t\tObject.defineProperty(ctx,\"fillStyle\",{set:function (value){this.setFillStyle(value)},enumerable:false });\r\n\t\t\tObject.defineProperty(ctx,\"fontSize\",{set:function (value){this.setFontSize(value)},enumerable:false });\r\n\t\t\tObject.defineProperty(ctx,\"lineWidth\",{set:function (value){this.setLineWidth(value)},enumerable:false });\r\n\t\t\tContext.__init__(ctx);\r\n\t\t\tctx.flush=function (){\r\n\t\t\t\twx.drawCanvas({canvasId:this.id,actions:this.getActions()});\r\n\t\t\t}\r\n\t\t\treturn ctx;\r\n\t\t}\r\n\r\n\t\t__proto.oncontextmenu=function(e){}\r\n\t\t__proto.addEventListener=function(){}\r\n\t\t__getset(0,__proto,'id',function(){\r\n\t\t\treturn this._id;\r\n\t\t\t},function(value){\r\n\t\t\tthis._id=value;\r\n\t\t});\r\n\r\n\t\tWXCanvas.wx=null;\r\n\t\treturn WXCanvas;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.system.System\r\n\tvar System=(function(){\r\n\t\tfunction System(){};\r\n\t\t__class(System,'laya.system.System');\r\n\t\tSystem.changeDefinition=function(name,classObj){\r\n\t\t\tLaya[name]=classObj;\r\n\t\t\tvar str=name+\"=classObj\";\r\n\t\t\t/*__JS__ */eval(str);\r\n\t\t}\r\n\r\n\t\tSystem.__init__=function(){\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\t/*__JS__ */conch.disableConchResManager();\r\n\t\t\t\t/*__JS__ */conch.disableConchAutoRestoreLostedDevice();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn System;\r\n\t})()\r\n\r\n\r\n\tSoundManager;\r\n\t/**\r\n\t*<code>Browser</code> 是浏览器代理类。封装浏览器及原生 js 提供的一些功能。\r\n\t*/\r\n\t//class laya.utils.Browser\r\n\tvar Browser=(function(){\r\n\t\tfunction Browser(){};\r\n\t\t__class(Browser,'laya.utils.Browser');\r\n\t\t/**设备像素比。*/\r\n\t\t__getset(1,Browser,'pixelRatio',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn RunDriver.getPixelRatio();\r\n\t\t});\r\n\r\n\t\t/**浏览器物理高度。*/\r\n\t\t__getset(1,Browser,'height',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn ((Laya.stage && Laya.stage.canvasRotation)? Browser.clientWidth :Browser.clientHeight)*Browser.pixelRatio;\r\n\t\t});\r\n\r\n\t\t/**浏览器可视宽度。*/\r\n\t\t__getset(1,Browser,'clientWidth',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser.window.innerWidth || Browser.document.body.clientWidth;\r\n\t\t});\r\n\r\n\t\t/**浏览器原生 window 对象的引用。*/\r\n\t\t__getset(1,Browser,'window',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser._window;\r\n\t\t});\r\n\r\n\t\t/**浏览器可视高度。*/\r\n\t\t__getset(1,Browser,'clientHeight',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser.window.innerHeight || Browser.document.body.clientHeight || Browser.document.documentElement.clientHeight;\r\n\t\t});\r\n\r\n\t\t/**浏览器物理宽度，。*/\r\n\t\t__getset(1,Browser,'width',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn ((Laya.stage && Laya.stage.canvasRotation)? Browser.clientHeight :Browser.clientWidth)*Browser.pixelRatio;\r\n\t\t});\r\n\r\n\t\t/**画布容器，用来盛放画布的容器。方便对画布进行控制*/\r\n\t\t__getset(1,Browser,'container',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\tif (!Browser._container){\r\n\t\t\t\tBrowser._container=Browser.createElement(\"div\");\r\n\t\t\t\tBrowser._container.id=\"layaContainer\";\r\n\t\t\t\tBrowser._container.style.cssText=\"width:100%;height:100%\";\r\n\t\t\t\tBrowser.document.body.appendChild(Browser._container);\r\n\t\t\t}\r\n\t\t\treturn Browser._container;\r\n\t\t\t},function(value){\r\n\t\t\tBrowser._container=value;\r\n\t\t});\r\n\r\n\t\t/**浏览器原生 document 对象的引用。*/\r\n\t\t__getset(1,Browser,'document',function(){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser._document;\r\n\t\t});\r\n\r\n\t\tBrowser.__init__=function(){\r\n\t\t\tSoundManager;\r\n\t\t\tif (Browser._window)return;\r\n\t\t\tBrowser._window=RunDriver.getWindow();\r\n\t\t\tBrowser._document=Browser.window.document;\r\n\t\t\tBrowser._window.addEventListener('message',function(e){\r\n\t\t\t\tlaya.utils.Browser._onMessage(e);\r\n\t\t\t},false);\r\n\t\t\t/*__JS__ */Browser.document.__createElement=Browser.document.createElement;\r\n\t\t\t/*__JS__ */window.requestAnimationFrame=(function(){return window.requestAnimationFrame || window.webkitRequestAnimationFrame ||window.mozRequestAnimationFrame || window.oRequestAnimationFrame ||function (c){return window.setTimeout(c,1000 / 60);};})();\r\n\t\t\t/*__JS__ */var $BS=window.document.body.style;$BS.margin=0;$BS.overflow='hidden';;\r\n\t\t\t/*__JS__ */var metas=window.document.getElementsByTagName('meta');;\r\n\t\t\t/*__JS__ */var i=0,flag=false,content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no';;\r\n\t\t\t/*__JS__ */while(i<metas.length){var meta=metas[i];if(meta.name=='viewport'){meta.content=content;flag=true;break;}i++;};\r\n\t\t\t/*__JS__ */if(!flag){meta=document.createElement('meta');meta.name='viewport',meta.content=content;document.getElementsByTagName('head')[0].appendChild(meta);};\r\n\t\t\tBrowser.userAgent=/*[SAFE]*/ Browser.window.navigator.userAgent;\r\n\t\t\tBrowser.u=/*[SAFE]*/ Browser.userAgent;\r\n\t\t\tBrowser.onIOS=/*[SAFE]*/ !!Browser.u.match(/\\(i[^;]+;(U;)? CPU.+Mac OS X/);\r\n\t\t\tBrowser.onMobile=/*[SAFE]*/ Browser.u.indexOf(\"Mobile\")>-1;\r\n\t\t\tBrowser.onIPhone=/*[SAFE]*/ Browser.u.indexOf(\"iPhone\")>-1;\r\n\t\t\tBrowser.onIPad=/*[SAFE]*/ Browser.u.indexOf(\"iPad\")>-1;\r\n\t\t\tBrowser.onAndriod=/*[SAFE]*/ Browser.u.indexOf('Android')>-1 || Browser.u.indexOf('Adr')>-1;\r\n\t\t\tBrowser.onWP=/*[SAFE]*/ Browser.u.indexOf(\"Windows Phone\")>-1;\r\n\t\t\tBrowser.onQQBrowser=/*[SAFE]*/ Browser.u.indexOf(\"QQBrowser\")>-1;\r\n\t\t\tBrowser.onMQQBrowser=/*[SAFE]*/ Browser.u.indexOf(\"MQQBrowser\")>-1;\r\n\t\t\tBrowser.onWeiXin=/*[SAFE]*/ Browser.u.indexOf('MicroMessenger')>-1;\r\n\t\t\tBrowser.onPC=/*[SAFE]*/ !Browser.onMobile;\r\n\t\t\tBrowser.onSafari=/*[SAFE]*/ !!Browser.u.match(/Version\\/\\d+\\.\\d\\x20Mobile\\/\\S+\\x20Safari/);\r\n\t\t\tBrowser.httpProtocol=/*[SAFE]*/ Browser.window.location.protocol==\"http:\";\r\n\t\t\tBrowser.webAudioEnabled=/*[SAFE]*/ Browser.window[\"AudioContext\"] || Browser.window[\"webkitAudioContext\"] || Browser.window[\"mozAudioContext\"] ? true :false;\r\n\t\t\tBrowser.soundType=/*[SAFE]*/ Browser.webAudioEnabled ? \"WEBAUDIOSOUND\" :\"AUDIOSOUND\";\r\n\t\t\t/*__JS__ */Sound=Browser.webAudioEnabled?WebAudioSound:AudioSound;;\r\n\t\t\t/*__JS__ */if (Browser.webAudioEnabled)WebAudioSound.initWebAudio();;\r\n\t\t\t/*__JS__ */Browser.enableTouch=(('ontouchstart' in window)|| window.DocumentTouch && document instanceof DocumentTouch);\r\n\t\t\t/*__JS__ */window.focus();\r\n\t\t\t/*__JS__ */SoundManager._soundClass=Sound;;\r\n\t\t\tvar MainCanvas=null;\r\n\t\t\tif (Browser.window.MainCanvasID){\r\n\t\t\t\tvar _wx=/*__JS__ */wx;\r\n\t\t\t\tif (_wx && !_wx.createContext)_wx=null;\r\n\t\t\t\tif ((WXCanvas.wx=_wx)!=null){\r\n\t\t\t\t\tMainCanvas=new WXCanvas(Browser.window.MainCanvasID);\r\n\t\t\t\t\tvar from=Context.prototype;\r\n\t\t\t\t\tfrom.flush=null;\r\n\t\t\t\t\tBrowser.window.Image=function (){\r\n\t\t\t\t\t\tthis.setSrc=function (url){\r\n\t\t\t\t\t\t\tthis.__src=url;\r\n\t\t\t\t\t\t\tvar _this=this;\r\n\t\t\t\t\t\t\tthis.success();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.success=function (res){\r\n\t\t\t\t\t\t\tthis.width=200;\r\n\t\t\t\t\t\t\tthis.height=200;\r\n\t\t\t\t\t\t\tthis.tempFilePath=res ? res.tempFilePath :this.__src;\r\n\t\t\t\t\t\t\tthis.onload && this.onload();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.getSrc=function (){\r\n\t\t\t\t\t\t\treturn this.__src;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tObject.defineProperty(this,\"src\",{get:this.getSrc,set:this.setSrc,enumerable:false });\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tMainCanvas=Browser.document.getElementById(Browser.window.MainCanvasID);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tRender._mainCanvas=Render._mainCanvas || HTMLCanvas.create('2D',MainCanvas);\r\n\t\t\tif (Browser.canvas)return;\r\n\t\t\tBrowser.canvas=HTMLCanvas.create('2D');\r\n\t\t\tBrowser.context=Browser.canvas.getContext('2d');\r\n\t\t}\r\n\r\n\t\tBrowser._onMessage=function(e){\r\n\t\t\tif (!e.data)return;\r\n\t\t\tif (e.data.name==\"size\"){\r\n\t\t\t\tBrowser.window.innerWidth=e.data.width;\r\n\t\t\t\tBrowser.window.innerHeight=e.data.height;\r\n\t\t\t\tBrowser.window.__innerHeight=e.data.clientHeight;\r\n\t\t\t\tif (!Browser.document.createEvent){\r\n\t\t\t\t\tconsole.log(\"no document.createEvent\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t};\r\n\t\t\t\tvar evt=Browser.document.createEvent(\"HTMLEvents\");\r\n\t\t\t\tevt.initEvent(\"resize\",false,false);\r\n\t\t\t\tBrowser.window.dispatchEvent(evt);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tBrowser.createElement=function(type){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser.document.__createElement(type);\r\n\t\t}\r\n\r\n\t\tBrowser.getElementById=function(type){\r\n\t\t\tBrowser.__init__();\r\n\t\t\treturn Browser.document.getElementById(type);\r\n\t\t}\r\n\r\n\t\tBrowser.removeElement=function(ele){\r\n\t\t\tif (ele && ele.parentNode)ele.parentNode.removeChild(ele);\r\n\t\t}\r\n\r\n\t\tBrowser.now=function(){\r\n\t\t\treturn RunDriver.now();\r\n\t\t}\r\n\r\n\t\tBrowser._window=null\r\n\t\tBrowser._document=null\r\n\t\tBrowser._container=null\r\n\t\tBrowser.userAgent=null\r\n\t\tBrowser.u=null\r\n\t\tBrowser.onIOS=false;\r\n\t\tBrowser.onMobile=false;\r\n\t\tBrowser.onIPhone=false;\r\n\t\tBrowser.onIPad=false;\r\n\t\tBrowser.onAndriod=false;\r\n\t\tBrowser.onWP=false;\r\n\t\tBrowser.onQQBrowser=false;\r\n\t\tBrowser.onMQQBrowser=false;\r\n\t\tBrowser.onSafari=false;\r\n\t\tBrowser.onWeiXin=false;\r\n\t\tBrowser.onPC=false;\r\n\t\tBrowser.httpProtocol=false;\r\n\t\tBrowser.webAudioEnabled=false;\r\n\t\tBrowser.soundType=null\r\n\t\tBrowser.enableTouch=false;\r\n\t\tBrowser.canvas=null\r\n\t\tBrowser.context=null\r\n\t\tBrowser.__init$=function(){\r\n\t\t\tAudioSound;\r\n\t\t\tWebAudioSound;\r\n\t\t}\r\n\r\n\t\treturn Browser;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*\r\n\t*<code>Byte</code> 类提供用于优化读取、写入以及处理二进制数据的方法和属性。\r\n\t*/\r\n\t//class laya.utils.Byte\r\n\tvar Byte=(function(){\r\n\t\tfunction Byte(data){\r\n\t\t\tthis._xd_=true;\r\n\t\t\tthis._allocated_=8;\r\n\t\t\t//this._d_=null;\r\n\t\t\t//this._u8d_=null;\r\n\t\t\tthis._pos_=0;\r\n\t\t\tthis._length=0;\r\n\t\t\tif (data){\r\n\t\t\t\tthis._u8d_=new Uint8Array(data);\r\n\t\t\t\tthis._d_=new DataView(this._u8d_.buffer);\r\n\t\t\t\tthis._length=this._d_.byteLength;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.___resizeBuffer(this._allocated_);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(Byte,'laya.utils.Byte');\r\n\t\tvar __proto=Byte.prototype;\r\n\t\t/**@private */\r\n\t\t__proto.___resizeBuffer=function(len){\r\n\t\t\ttry {\r\n\t\t\t\tvar newByteView=new Uint8Array(len);\r\n\t\t\t\tif (this._u8d_ !=null){\r\n\t\t\t\t\tif (this._u8d_.length <=len)newByteView.set(this._u8d_);\r\n\t\t\t\t\telse newByteView.set(this._u8d_.subarray(0,len));\r\n\t\t\t\t}\r\n\t\t\t\tthis._u8d_=newByteView;\r\n\t\t\t\tthis._d_=new DataView(newByteView.buffer);\r\n\t\t\t\t}catch (err){\r\n\t\t\t\tthrow \"___resizeBuffer err:\"+len;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*读取字符型值。\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getString=function(){\r\n\t\t\treturn this.rUTF(this.getUint16());\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从指定的位置读取指定长度的数据用于创建一个 Float32Array 对象并返回此对象。\r\n\t\t*@param start 开始位置。\r\n\t\t*@param len 需要读取的字节长度。\r\n\t\t*@return 读出的 Float32Array 对象。\r\n\t\t*/\r\n\t\t__proto.getFloat32Array=function(start,len){\r\n\t\t\tvar v=new Float32Array(this._d_.buffer.slice(start,start+len));\r\n\t\t\tthis._pos_+=len;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从指定的位置读取指定长度的数据用于创建一个 Uint8Array 对象并返回此对象。\r\n\t\t*@param start 开始位置。\r\n\t\t*@param len 需要读取的字节长度。\r\n\t\t*@return 读出的 Uint8Array 对象。\r\n\t\t*/\r\n\t\t__proto.getUint8Array=function(start,len){\r\n\t\t\tvar v=new Uint8Array(this._d_.buffer.slice(start,start+len));\r\n\t\t\tthis._pos_+=len;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从指定的位置读取指定长度的数据用于创建一个 Int16Array 对象并返回此对象。\r\n\t\t*@param start 开始位置。\r\n\t\t*@param len 需要读取的字节长度。\r\n\t\t*@return 读出的 Uint8Array 对象。\r\n\t\t*/\r\n\t\t__proto.getInt16Array=function(start,len){\r\n\t\t\tvar v=new Int16Array(this._d_.buffer.slice(start,start+len));\r\n\t\t\tthis._pos_+=len;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在指定字节偏移量位置处读取 Float32 值。\r\n\t\t*@return Float32 值。\r\n\t\t*/\r\n\t\t__proto.getFloat32=function(){\r\n\t\t\tvar v=this._d_.getFloat32(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t__proto.getFloat64=function(){\r\n\t\t\tvar v=this._d_.getFloat64(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=8;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Float32 值。\r\n\t\t*@param value 需要写入的 Float32 值。\r\n\t\t*/\r\n\t\t__proto.writeFloat32=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+4);\r\n\t\t\tthis._d_.setFloat32(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t}\r\n\r\n\t\t__proto.writeFloat64=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+8);\r\n\t\t\tthis._d_.setFloat64(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=8;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处读取 Int32 值。\r\n\t\t*@return Int32 值。\r\n\t\t*/\r\n\t\t__proto.getInt32=function(){\r\n\t\t\tvar float=this._d_.getInt32(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t\treturn float;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处读取 Uint32 值。\r\n\t\t*@return Uint32 值。\r\n\t\t*/\r\n\t\t__proto.getUint32=function(){\r\n\t\t\tvar v=this._d_.getUint32(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Int32 值。\r\n\t\t*@param value 需要写入的 Int32 值。\r\n\t\t*/\r\n\t\t__proto.writeInt32=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+4);\r\n\t\t\tthis._d_.setInt32(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Uint32 值。\r\n\t\t*@param value 需要写入的 Uint32 值。\r\n\t\t*/\r\n\t\t__proto.writeUint32=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+4);\r\n\t\t\tthis._d_.setUint32(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=4;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处读取 Int16 值。\r\n\t\t*@return Int16 值。\r\n\t\t*/\r\n\t\t__proto.getInt16=function(){\r\n\t\t\tvar us=this._d_.getInt16(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=2;\r\n\t\t\treturn us;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处读取 Uint16 值。\r\n\t\t*@return Uint16 值。\r\n\t\t*/\r\n\t\t__proto.getUint16=function(){\r\n\t\t\tvar us=this._d_.getUint16(this._pos_,this._xd_);\r\n\t\t\tthis._pos_+=2;\r\n\t\t\treturn us;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Uint16 值。\r\n\t\t*@param value 需要写入的Uint16 值。\r\n\t\t*/\r\n\t\t__proto.writeUint16=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+2);\r\n\t\t\tthis._d_.setUint16(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=2;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Int16 值。\r\n\t\t*@param value 需要写入的 Int16 值。\r\n\t\t*/\r\n\t\t__proto.writeInt16=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+2);\r\n\t\t\tthis._d_.setInt16(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_+=2;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处读取 Uint8 值。\r\n\t\t*@return Uint8 值。\r\n\t\t*/\r\n\t\t__proto.getUint8=function(){\r\n\t\t\treturn this._d_.getUint8(this._pos_++);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在当前字节偏移量位置处写入 Uint8 值。\r\n\t\t*@param value 需要写入的 Uint8 值。\r\n\t\t*/\r\n\t\t__proto.writeUint8=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+1);\r\n\t\t\tthis._d_.setUint8(this._pos_,value,this._xd_);\r\n\t\t\tthis._pos_++;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*在指定位置处读取 Uint8 值。\r\n\t\t*@param pos 字节读取位置。\r\n\t\t*@return Uint8 值。\r\n\t\t*/\r\n\t\t__proto._getUInt8=function(pos){\r\n\t\t\treturn this._d_.getUint8(pos);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*在指定位置处读取 Uint16 值。\r\n\t\t*@param pos 字节读取位置。\r\n\t\t*@return Uint16 值。\r\n\t\t*/\r\n\t\t__proto._getUint16=function(pos){\r\n\t\t\treturn this._d_.getUint16(pos,this._xd_);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*使用 getFloat32()读取6个值，用于创建并返回一个 Matrix 对象。\r\n\t\t*@return Matrix 对象。\r\n\t\t*/\r\n\t\t__proto._getMatrix=function(){\r\n\t\t\tvar rst=new Matrix(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*读取指定长度的 UTF 型字符串。\r\n\t\t*@param len 需要读取的长度。\r\n\t\t*@return 读出的字符串。\r\n\t\t*/\r\n\t\t__proto.rUTF=function(len){\r\n\t\t\tvar v=\"\",max=this._pos_+len,c=0,c2=0,c3=0,f=String.fromCharCode;\r\n\t\t\tvar u=this._u8d_,i=0;\r\n\t\t\twhile (this._pos_ < max){\r\n\t\t\t\tc=u[this._pos_++];\r\n\t\t\t\tif (c < 0x80){\r\n\t\t\t\t\tif (c !=0){\r\n\t\t\t\t\t\tv+=f(c);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else if (c < 0xE0){\r\n\t\t\t\t\tv+=f(((c & 0x3F)<< 6)| (u[this._pos_++] & 0x7F));\r\n\t\t\t\t\t}else if (c < 0xF0){\r\n\t\t\t\t\tc2=u[this._pos_++];\r\n\t\t\t\t\tv+=f(((c & 0x1F)<< 12)| ((c2 & 0x7F)<< 6)| (u[this._pos_++] & 0x7F));\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tc2=u[this._pos_++];\r\n\t\t\t\t\tc3=u[this._pos_++];\r\n\t\t\t\t\tv+=f(((c & 0x0F)<< 18)| ((c2 & 0x7F)<< 12)| ((c3 << 6)& 0x7F)| (u[this._pos_++] & 0x7F));\r\n\t\t\t\t}\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*字符串读取。\r\n\t\t*@param len\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getCustomString=function(len){\r\n\t\t\tvar v=\"\",ulen=0,c=0,c2=0,f=String.fromCharCode;\r\n\t\t\tvar u=this._u8d_,i=0;\r\n\t\t\twhile (len > 0){\r\n\t\t\t\tc=u[this._pos_];\r\n\t\t\t\tif (c < 0x80){\r\n\t\t\t\t\tv+=f(c);\r\n\t\t\t\t\tthis._pos_++;\r\n\t\t\t\t\tlen--;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tulen=c-0x80;\r\n\t\t\t\t\tthis._pos_++;\r\n\t\t\t\t\tlen-=ulen;\r\n\t\t\t\t\twhile (ulen > 0){\r\n\t\t\t\t\t\tc=u[this._pos_++];\r\n\t\t\t\t\t\tc2=u[this._pos_++];\r\n\t\t\t\t\t\tv+=f((c2 << 8)| c);\r\n\t\t\t\t\t\tulen--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn v;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清除数据。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._pos_=0;\r\n\t\t\tthis.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取此对象的 ArrayBuffer 引用。\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.__getBuffer=function(){\r\n\t\t\treturn this._d_.buffer;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*写入字符串，该方法写的字符串要使用 readUTFBytes 方法读取。\r\n\t\t*@param value 要写入的字符串。\r\n\t\t*/\r\n\t\t__proto.writeUTFBytes=function(value){\r\n\t\t\tvalue=value+\"\";\r\n\t\t\tfor (var i=0,sz=value.length;i < sz;i++){\r\n\t\t\t\tvar c=value.charCodeAt(i);\r\n\t\t\t\tif (c <=0x7F){\r\n\t\t\t\t\tthis.writeByte(c);\r\n\t\t\t\t\t}else if (c <=0x7FF){\r\n\t\t\t\t\tthis.writeByte(0xC0 | (c >> 6));\r\n\t\t\t\t\tthis.writeByte(0x80 | (c & 63));\r\n\t\t\t\t\t}else if (c <=0xFFFF){\r\n\t\t\t\t\tthis.writeByte(0xE0 | (c >> 12));\r\n\t\t\t\t\tthis.writeByte(0x80 | ((c >> 6)& 63));\r\n\t\t\t\t\tthis.writeByte(0x80 | (c & 63));\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis.writeByte(0xF0 | (c >> 18));\r\n\t\t\t\t\tthis.writeByte(0x80 | ((c >> 12)& 63));\r\n\t\t\t\t\tthis.writeByte(0x80 | ((c >> 6)& 63));\r\n\t\t\t\t\tthis.writeByte(0x80 | (c & 63));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将 UTF-8 字符串写入字节流。\r\n\t\t*@param value 要写入的字符串值。\r\n\t\t*/\r\n\t\t__proto.writeUTFString=function(value){\r\n\t\t\tvar tPos=0;\r\n\t\t\ttPos=this.pos;\r\n\t\t\tthis.writeUint16(1);\r\n\t\t\tthis.writeUTFBytes(value);\r\n\t\t\tvar dPos=0;\r\n\t\t\tdPos=this.pos-tPos-2;\r\n\t\t\tthis._d_.setUint16(tPos,dPos,this._xd_);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*读取 UTF-8 字符串。\r\n\t\t*@return 读出的字符串。\r\n\t\t*/\r\n\t\t__proto.readUTFString=function(){\r\n\t\t\tvar tPos=0;\r\n\t\t\ttPos=this.pos;\r\n\t\t\tvar len=0;\r\n\t\t\tlen=this.getUint16();\r\n\t\t\treturn this.readUTFBytes(len);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*读取 UTF-8 字符串。\r\n\t\t*@return 读出的字符串。\r\n\t\t*/\r\n\t\t__proto.getUTFString=function(){\r\n\t\t\treturn this.readUTFString();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*读字符串，必须是 writeUTFBytes 方法写入的字符串。\r\n\t\t*@param len 要读的buffer长度,默认将读取缓冲区全部数据。\r\n\t\t*@return 读取的字符串。\r\n\t\t*/\r\n\t\t__proto.readUTFBytes=function(len){\r\n\t\t\t(len===void 0)&& (len=-1);\r\n\t\t\tif(len==0)return \"\";\r\n\t\t\tlen=len > 0 ? len :this.bytesAvailable;\r\n\t\t\treturn this.rUTF(len);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*读字符串，必须是 writeUTFBytes 方法写入的字符串。\r\n\t\t*@param len 要读的buffer长度,默认将读取缓冲区全部数据。\r\n\t\t*@return 读取的字符串。\r\n\t\t*/\r\n\t\t__proto.getUTFBytes=function(len){\r\n\t\t\t(len===void 0)&& (len=-1);\r\n\t\t\treturn this.readUTFBytes(len);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在字节流中写入一个字节。\r\n\t\t*@param value\r\n\t\t*/\r\n\t\t__proto.writeByte=function(value){\r\n\t\t\tthis.ensureWrite(this._pos_+1);\r\n\t\t\tthis._d_.setInt8(this._pos_,value);\r\n\t\t\tthis._pos_+=1;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*在字节流中读一个字节。\r\n\t\t*/\r\n\t\t__proto.readByte=function(){\r\n\t\t\treturn this._d_.getInt8(this._pos_++);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在字节流中读一个字节。\r\n\t\t*/\r\n\t\t__proto.getByte=function(){\r\n\t\t\treturn this.readByte();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*指定该字节流的长度。\r\n\t\t*@param lengthToEnsure 指定的长度。\r\n\t\t*/\r\n\t\t__proto.ensureWrite=function(lengthToEnsure){\r\n\t\t\tif (this._length < lengthToEnsure)this._length=lengthToEnsure;\r\n\t\t\tif (this._allocated_ < lengthToEnsure)this.length=lengthToEnsure;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*写入指定的 Arraybuffer 对象。\r\n\t\t*@param arraybuffer 需要写入的 Arraybuffer 对象。\r\n\t\t*@param offset 偏移量（以字节为单位）\r\n\t\t*@param length 长度（以字节为单位）\r\n\t\t*/\r\n\t\t__proto.writeArrayBuffer=function(arraybuffer,offset,length){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(length===void 0)&& (length=0);\r\n\t\t\tif (offset < 0 || length < 0)throw \"writeArrayBuffer error - Out of bounds\";\r\n\t\t\tif (length==0)length=arraybuffer.byteLength-offset;\r\n\t\t\tthis.ensureWrite(this._pos_+length);\r\n\t\t\tvar uint8array=new Uint8Array(arraybuffer);\r\n\t\t\tthis._u8d_.set(uint8array.subarray(offset,offset+length),this._pos_);\r\n\t\t\tthis._pos_+=length;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取此对象的 ArrayBuffer数据,数据只包含有效数据部分 。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'buffer',function(){\r\n\t\t\tvar rstBuffer=this._d_.buffer;\r\n\t\t\tif (rstBuffer.byteLength==this.length)return rstBuffer;\r\n\t\t\treturn rstBuffer.slice(0,this.length);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字节顺序。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'endian',function(){\r\n\t\t\treturn this._xd_ ? \"littleEndian\" :\"bigEndian\";\r\n\t\t\t},function(endianStr){\r\n\t\t\tthis._xd_=(endianStr==\"littleEndian\");\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字节长度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'length',function(){\r\n\t\t\treturn this._length;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._allocated_ < value)\r\n\t\t\t\tthis.___resizeBuffer(this._allocated_=Math.floor(Math.max(value,this._allocated_ *2)));\r\n\t\t\telse if (this._allocated_ > value)\r\n\t\t\tthis.___resizeBuffer(this._allocated_=value);\r\n\t\t\tthis._length=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*当前读取到的位置。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'pos',function(){\r\n\t\t\treturn this._pos_;\r\n\t\t\t},function(value){\r\n\t\t\tthis._pos_=value;\r\n\t\t\tthis._d_.byteOffset=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*可从字节流的当前位置到末尾读取的数据的字节数。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'bytesAvailable',function(){\r\n\t\t\treturn this.length-this._pos_;\r\n\t\t});\r\n\r\n\t\tByte.getSystemEndian=function(){\r\n\t\t\tif (!Byte._sysEndian){\r\n\t\t\t\tvar buffer=new ArrayBuffer(2);\r\n\t\t\t\tnew DataView(buffer).setInt16(0,256,true);\r\n\t\t\t\tByte._sysEndian=(new Int16Array(buffer))[0]===256 ? /*CLASS CONST:laya.utils.Byte.LITTLE_ENDIAN*/\"littleEndian\" :/*CLASS CONST:laya.utils.Byte.BIG_ENDIAN*/\"bigEndian\";\r\n\t\t\t}\r\n\t\t\treturn Byte._sysEndian;\r\n\t\t}\r\n\r\n\t\tByte.BIG_ENDIAN=\"bigEndian\";\r\n\t\tByte.LITTLE_ENDIAN=\"littleEndian\";\r\n\t\tByte._sysEndian=null;\r\n\t\treturn Byte;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*对象缓存统一管理类\r\n\t*/\r\n\t//class laya.utils.CacheManger\r\n\tvar CacheManger=(function(){\r\n\t\tfunction CacheManger(){}\r\n\t\t__class(CacheManger,'laya.utils.CacheManger');\r\n\t\tCacheManger.regCacheByFunction=function(disposeFunction,getCacheListFunction){\r\n\t\t\tCacheManger.unRegCacheByFunction(disposeFunction,getCacheListFunction);\r\n\t\t\tvar cache;\r\n\t\t\tcache={\r\n\t\t\t\ttryDispose:disposeFunction,\r\n\t\t\t\tgetCacheList:getCacheListFunction\r\n\t\t\t};\r\n\t\t\tCacheManger._cacheList.push(cache);\r\n\t\t}\r\n\r\n\t\tCacheManger.unRegCacheByFunction=function(disposeFunction,getCacheListFunction){\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=CacheManger._cacheList.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tif (CacheManger._cacheList[i].tryDispose==disposeFunction && CacheManger._cacheList[i].getCacheList==getCacheListFunction){\r\n\t\t\t\t\tCacheManger._cacheList.splice(i,1);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tCacheManger.forceDispose=function(){\r\n\t\t\tvar i=0,len=CacheManger._cacheList.length;\r\n\t\t\tfor(i=0;i<len;i++){\r\n\t\t\t\tCacheManger._cacheList[i].tryDispose(true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tCacheManger.beginCheck=function(waitTime){\r\n\t\t\t(waitTime===void 0)&& (waitTime=15000);\r\n\t\t\tLaya.timer.loop(waitTime,null,CacheManger._checkLoop);\r\n\t\t}\r\n\r\n\t\tCacheManger.stopCheck=function(){\r\n\t\t\tLaya.timer.clear(null,CacheManger._checkLoop);\r\n\t\t}\r\n\r\n\t\tCacheManger._checkLoop=function(){\r\n\t\t\tvar cacheList=CacheManger._cacheList;\r\n\t\t\tif (cacheList.length < 1)return;\r\n\t\t\tvar tTime=Browser.now();\r\n\t\t\tvar count=0;\r\n\t\t\tvar len=0;\r\n\t\t\tlen=count=cacheList.length;\r\n\t\t\twhile (count > 0){\r\n\t\t\t\tCacheManger._index++;\r\n\t\t\t\tCacheManger._index=CacheManger._index % len;\r\n\t\t\t\tcacheList[CacheManger._index].tryDispose(false);\r\n\t\t\t\tif (Browser.now()-tTime > CacheManger.loopTimeLimit)break ;\r\n\t\t\t\tcount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tCacheManger.loopTimeLimit=2;\r\n\t\tCacheManger._cacheList=[];\r\n\t\tCacheManger._index=0;\r\n\t\treturn CacheManger;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>ClassUtils</code> 是一个类工具类。\r\n\t*/\r\n\t//class laya.utils.ClassUtils\r\n\tvar ClassUtils=(function(){\r\n\t\tfunction ClassUtils(){};\r\n\t\t__class(ClassUtils,'laya.utils.ClassUtils');\r\n\t\tClassUtils.regClass=function(className,classDef){\r\n\t\t\tClassUtils._classMap[className]=classDef;\r\n\t\t}\r\n\r\n\t\tClassUtils.getRegClass=function(className){\r\n\t\t\treturn ClassUtils._classMap[className];\r\n\t\t}\r\n\r\n\t\tClassUtils.getInstance=function(className){\r\n\t\t\tvar compClass=ClassUtils.getClass(className);\r\n\t\t\tif (compClass)\r\n\t\t\t\treturn new compClass();\r\n\t\t\telse\r\n\t\t\tconsole.log(\"[error] Undefined class:\",className);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tClassUtils.createByJson=function(json,node,root,customHandler,instanceHandler){\r\n\t\t\tif ((typeof json=='string'))\r\n\t\t\t\tjson=JSON.parse(json);\r\n\t\t\tvar props=json.props;\r\n\t\t\tif (!node){\r\n\t\t\t\tnode=instanceHandler ? instanceHandler.runWith(json):ClassUtils.getInstance(props.runtime || json.type);\r\n\t\t\t\tif (!node)\r\n\t\t\t\t\treturn null;\r\n\t\t\t};\r\n\t\t\tvar child=json.child;\r\n\t\t\tif (child){\r\n\t\t\t\tfor (var i=0,n=child.length;i < n;i++){\r\n\t\t\t\t\tvar data=child[i];\r\n\t\t\t\t\tif ((data.props.name===\"render\" || data.props.renderType===\"render\")&& node[\"_$set_itemRender\"])\r\n\t\t\t\t\t\tnode.itemRender=data;\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (data.type==\"Graphic\"){\r\n\t\t\t\t\t\t\tClassUtils.addGraphicsToSprite(data,node);\r\n\t\t\t\t\t\t\t}else if (ClassUtils.isDrawType(data.type)){\r\n\t\t\t\t\t\t\tClassUtils.addGraphicToSprite(data,node,true);\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tvar tChild=ClassUtils.createByJson(data,null,root,customHandler,instanceHandler)\r\n\t\t\t\t\t\t\tif (data.type==\"Script\"){\r\n\t\t\t\t\t\t\t\ttChild[\"owner\"]=node;\r\n\t\t\t\t\t\t\t\t}else if (data.props.renderType==\"mask\"){\r\n\t\t\t\t\t\t\t\tnode.mask=tChild;\r\n\t\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\t\tnode.addChild(tChild);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (props){\r\n\t\t\t\tfor (var prop in props){\r\n\t\t\t\t\tvar value=props[prop];\r\n\t\t\t\t\tif (prop===\"var\" && root){\r\n\t\t\t\t\t\troot[value]=node;\r\n\t\t\t\t\t\t}else if ((value instanceof Array)&& (typeof (node[prop])=='function')){\r\n\t\t\t\t\t\tnode[prop].apply(node,value);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tnode[prop]=value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (customHandler && json.customProps){\r\n\t\t\t\tcustomHandler.runWith([node,json]);\r\n\t\t\t}\r\n\t\t\tif (node[\"created\"])\r\n\t\t\t\tnode.created();\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\tClassUtils.addGraphicsToSprite=function(graphicO,sprite){\r\n\t\t\tvar graphics;\r\n\t\t\tgraphics=graphicO.child;\r\n\t\t\tif (!graphics || graphics.length < 1)\r\n\t\t\t\treturn;\r\n\t\t\tvar g;\r\n\t\t\tg=ClassUtils._getGraphicsFromSprite(graphicO,sprite);\r\n\t\t\tvar ox=0;\r\n\t\t\tvar oy=0;\r\n\t\t\tif (graphicO.props){\r\n\t\t\t\tox=ClassUtils._getObjVar(graphicO.props,\"x\",0);\r\n\t\t\t\toy=ClassUtils._getObjVar(graphicO.props,\"y\",0);\r\n\t\t\t}\r\n\t\t\tif (ox !=0 && oy !=0){\r\n\t\t\t\tg.translate(ox,oy);\r\n\t\t\t};\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=graphics.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tClassUtils._addGraphicToGraphics(graphics[i],g);\r\n\t\t\t}\r\n\t\t\tif (ox !=0 && oy !=0){\r\n\t\t\t\tg.translate(-ox,-oy);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tClassUtils.addGraphicToSprite=function(graphicO,sprite,isChild){\r\n\t\t\t(isChild===void 0)&& (isChild=false);\r\n\t\t\tvar g;\r\n\t\t\tg=isChild ? ClassUtils._getGraphicsFromSprite(graphicO,sprite):sprite.graphics;\r\n\t\t\tClassUtils._addGraphicToGraphics(graphicO,g);\r\n\t\t}\r\n\r\n\t\tClassUtils._getGraphicsFromSprite=function(dataO,sprite){\r\n\t\t\tvar g;\r\n\t\t\tif (!dataO || !dataO.props)\r\n\t\t\t\treturn sprite.graphics;\r\n\t\t\tvar propsName;\r\n\t\t\tpropsName=dataO.props.renderType;\r\n\t\t\tswitch (propsName){\r\n\t\t\t\tcase \"hit\":\r\n\t\t\t\tcase \"unHit\":;\r\n\t\t\t\t\tvar hitArea;\r\n\t\t\t\t\tif (!sprite.hitArea){\r\n\t\t\t\t\t\tsprite.hitArea=new HitArea();\r\n\t\t\t\t\t}\r\n\t\t\t\t\thitArea=sprite.hitArea;\r\n\t\t\t\t\tif (!hitArea[propsName]){\r\n\t\t\t\t\t\thitArea[propsName]=new Graphics();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tg=hitArea[propsName];\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t}\r\n\t\t\tif (!g)\r\n\t\t\t\tg=sprite.graphics;\r\n\t\t\treturn g;\r\n\t\t}\r\n\r\n\t\tClassUtils._getTransformData=function(propsO){\r\n\t\t\tvar m;\r\n\t\t\tif (propsO.hasOwnProperty(\"pivotX\")|| propsO.hasOwnProperty(\"pivotY\")){\r\n\t\t\t\tm=m || new Matrix();\r\n\t\t\t\tm.translate(-ClassUtils._getObjVar(propsO,\"pivotX\",0),-ClassUtils._getObjVar(propsO,\"pivotY\",0));\r\n\t\t\t};\r\n\t\t\tvar sx=ClassUtils._getObjVar(propsO,\"scaleX\",1),sy=ClassUtils._getObjVar(propsO,\"scaleY\",1);\r\n\t\t\tvar rotate=ClassUtils._getObjVar(propsO,\"rotation\",0);\r\n\t\t\tvar skewX=ClassUtils._getObjVar(propsO,\"skewX\",0);\r\n\t\t\tvar skewY=ClassUtils._getObjVar(propsO,\"skewY\",0);\r\n\t\t\tif (sx !=1 || sy !=1 || rotate !=0){\r\n\t\t\t\tm=m || new Matrix();\r\n\t\t\t\tm.scale(sx,sy);\r\n\t\t\t\tm.rotate(rotate *0.0174532922222222);\r\n\t\t\t}\r\n\t\t\treturn m;\r\n\t\t}\r\n\r\n\t\tClassUtils._addGraphicToGraphics=function(graphicO,graphic){\r\n\t\t\tvar propsO;\r\n\t\t\tpropsO=graphicO.props;\r\n\t\t\tif (!propsO)\r\n\t\t\t\treturn;\r\n\t\t\tvar drawConfig;\r\n\t\t\tdrawConfig=ClassUtils.DrawTypeDic[graphicO.type];\r\n\t\t\tif (!drawConfig)\r\n\t\t\t\treturn;\r\n\t\t\tvar g;\r\n\t\t\tg=graphic;\r\n\t\t\tvar m;\r\n\t\t\tvar params=ClassUtils._getParams(propsO,drawConfig[1],drawConfig[2],drawConfig[3]);\r\n\t\t\tm=ClassUtils._tM;\r\n\t\t\tif (m || ClassUtils._alpha !=1){\r\n\t\t\t\tg.save();\r\n\t\t\t\tif (m)\r\n\t\t\t\t\tg.transform(m);\r\n\t\t\t\tif (ClassUtils._alpha !=1)\r\n\t\t\t\t\tg.alpha(ClassUtils._alpha);\r\n\t\t\t}\r\n\t\t\tg[drawConfig[0]].apply(g,params);\r\n\t\t\tif (m || ClassUtils._alpha !=1){\r\n\t\t\t\tg.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tClassUtils._adptLineData=function(params){\r\n\t\t\tparams[2]=parseFloat(params[0])+parseFloat(params[2]);\r\n\t\t\tparams[3]=parseFloat(params[1])+parseFloat(params[3]);\r\n\t\t\treturn params;\r\n\t\t}\r\n\r\n\t\tClassUtils._adptTextureData=function(params){\r\n\t\t\tparams[0]=Loader.getRes(params[0]);\r\n\t\t\treturn params;\r\n\t\t}\r\n\r\n\t\tClassUtils._adptLinesData=function(params){\r\n\t\t\tparams[2]=ClassUtils._getPointListByStr(params[2]);\r\n\t\t\treturn params;\r\n\t\t}\r\n\r\n\t\tClassUtils.isDrawType=function(type){\r\n\t\t\tif (type==\"Image\")\r\n\t\t\t\treturn false;\r\n\t\t\treturn ClassUtils.DrawTypeDic.hasOwnProperty(type);\r\n\t\t}\r\n\r\n\t\tClassUtils._getParams=function(obj,params,xPos,adptFun){\r\n\t\t\t(xPos===void 0)&& (xPos=0);\r\n\t\t\tvar rst;\r\n\t\t\trst=ClassUtils._temParam;\r\n\t\t\trst.length=params.length;\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=params.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\trst[i]=ClassUtils._getObjVar(obj,params[i][0],params[i][1]);\r\n\t\t\t}\r\n\t\t\tClassUtils._alpha=ClassUtils._getObjVar(obj,\"alpha\",1);\r\n\t\t\tvar m;\r\n\t\t\tm=ClassUtils._getTransformData(obj);\r\n\t\t\tif (m){\r\n\t\t\t\tif (!xPos)xPos=0;\r\n\t\t\t\tm.translate(rst[xPos],rst[xPos+1]);\r\n\t\t\t\trst[xPos]=rst[xPos+1]=0;\r\n\t\t\t\tClassUtils._tM=m;\r\n\t\t\t\t}else {\r\n\t\t\t\tClassUtils._tM=null;\r\n\t\t\t}\r\n\t\t\tif (adptFun && ClassUtils[adptFun]){\r\n\t\t\t\trst=ClassUtils[adptFun](rst);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tClassUtils._getPointListByStr=function(str){\r\n\t\t\tvar pointArr;\r\n\t\t\tpointArr=str.split(\",\");\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=pointArr.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tpointArr[i]=parseFloat(pointArr[i]);\r\n\t\t\t}\r\n\t\t\treturn pointArr;\r\n\t\t}\r\n\r\n\t\tClassUtils._getObjVar=function(obj,key,noValue){\r\n\t\t\tif (obj.hasOwnProperty(key)){\r\n\t\t\t\treturn obj[key];\r\n\t\t\t}\r\n\t\t\treturn noValue;\r\n\t\t}\r\n\r\n\t\tClassUtils._temParam=[];\r\n\t\tClassUtils._classMap={'Sprite':'laya.display.Sprite','Text':'laya.display.Text','Animation':'laya.display.Animation','Skeleton':'laya.ani.bone.Skeleton','Particle2D':'laya.particle.Particle2D','div':'laya.html.dom.HTMLDivElement','img':'laya.html.dom.HTMLImageElement','span':'laya.html.dom.HTMLElement','br':'laya.html.dom.HTMLBrElement','style':'laya.html.dom.HTMLStyleElement','font':'laya.html.dom.HTMLElement','a':'laya.html.dom.HTMLElement','#text':'laya.html.dom.HTMLElement'};\r\n\t\tClassUtils.getClass=function(className){\r\n\t\t\tvar classObject=ClassUtils._classMap[className] || className;\r\n\t\t\tif ((typeof classObject=='string'))\r\n\t\t\t\treturn Laya[\"__classmap\"][classObject];\r\n\t\t\treturn classObject;\r\n\t\t}\r\n\r\n\t\tClassUtils._tM=null\r\n\t\tClassUtils._alpha=NaN\r\n\t\t__static(ClassUtils,\r\n\t\t['DrawTypeDic',function(){return this.DrawTypeDic={\"Rect\":[\"drawRect\",[[\"x\",0],[\"y\",0],[\"width\",0],[\"height\",0],[\"fillColor\",null],[\"lineColor\",null],[\"lineWidth\",1]]],\"Circle\":[\"drawCircle\",[[\"x\",0],[\"y\",0],[\"radius\",0],[\"fillColor\",null],[\"lineColor\",null],[\"lineWidth\",1]]],\"Pie\":[\"drawPie\",[[\"x\",0],[\"y\",0],[\"radius\",0],[\"startAngle\",0],[\"endAngle\",0],[\"fillColor\",null],[\"lineColor\",null],[\"lineWidth\",1]]],\"Image\":[\"drawTexture\",[[\"x\",0],[\"y\",0],[\"width\",0],[\"height\",0]]],\"Texture\":[\"drawTexture\",[[\"skin\",null],[\"x\",0],[\"y\",0],[\"width\",0],[\"height\",0]],1,\"_adptTextureData\"],\"FillTexture\":[\"fillTexture\",[[\"skin\",null],[\"x\",0],[\"y\",0],[\"width\",0],[\"height\",0],[\"repeat\",null]],1,\"_adptTextureData\"],\"FillText\":[\"fillText\",[[\"text\",\"\"],[\"x\",0],[\"y\",0],[\"font\",null],[\"color\",null],[\"textAlign\",null]],1],\"Line\":[\"drawLine\",[[\"x\",0],[\"y\",0],[\"toX\",0],[\"toY\",0],[\"lineColor\",null],[\"lineWidth\",0]],0,\"_adptLineData\"],\"Lines\":[\"drawLines\",[[\"x\",0],[\"y\",0],[\"points\",\"\"],[\"lineColor\",null],[\"lineWidth\",0]],0,\"_adptLinesData\"],\"Curves\":[\"drawCurves\",[[\"x\",0],[\"y\",0],[\"points\",\"\"],[\"lineColor\",null],[\"lineWidth\",0]],0,\"_adptLinesData\"],\"Poly\":[\"drawPoly\",[[\"x\",0],[\"y\",0],[\"points\",\"\"],[\"fillColor\",null],[\"lineColor\",null],[\"lineWidth\",1]],0,\"_adptLinesData\"]};}\r\n\t\t]);\r\n\t\treturn ClassUtils;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Color</code> 是一个颜色值处理类。\r\n\t*/\r\n\t//class laya.utils.Color\r\n\tvar Color=(function(){\r\n\t\tfunction Color(str){\r\n\t\t\tthis._color=[];\r\n\t\t\t//this.strColor=null;\r\n\t\t\t//this.numColor=0;\r\n\t\t\t//this._drawStyle=null;\r\n\t\t\tif ((typeof str=='string')){\r\n\t\t\t\tthis.strColor=str;\r\n\t\t\t\tif (str===null)str=\"#000000\";\r\n\t\t\t\tstr.charAt(0)=='#' && (str=str.substr(1));\r\n\t\t\t\tvar color=this.numColor=parseInt(str,16);\r\n\t\t\t\tvar flag=(str.length==8);\r\n\t\t\t\tif (flag){\r\n\t\t\t\t\tthis._color=[parseInt(str.substr(0,2),16)/ 255,((0x00FF0000 & color)>> 16)/ 255,((0x0000FF00 & color)>> 8)/ 255,(0x000000FF & color)/ 255];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tcolor=this.numColor=str;\r\n\t\t\t\tthis.strColor=Utils.toHexColor(color);\r\n\t\t\t}\r\n\t\t\tthis._color=[((0xFF0000 & color)>> 16)/ 255,((0xFF00 & color)>> 8)/ 255,(0xFF & color)/ 255,1];\r\n\t\t\t(this._color).__id=++Color._COLODID;\r\n\t\t}\r\n\r\n\t\t__class(Color,'laya.utils.Color');\r\n\t\tColor._initDefault=function(){\r\n\t\t\tColor._DEFAULT={};\r\n\t\t\tfor (var i in Color._COLOR_MAP)Color._SAVE[i]=Color._DEFAULT[i]=new Color(Color._COLOR_MAP[i]);\r\n\t\t\treturn Color._DEFAULT;\r\n\t\t}\r\n\r\n\t\tColor._initSaveMap=function(){\r\n\t\t\tColor._SAVE_SIZE=0;\r\n\t\t\tColor._SAVE={};\r\n\t\t\tfor (var i in Color._DEFAULT)Color._SAVE[i]=Color._DEFAULT[i];\r\n\t\t}\r\n\r\n\t\tColor.create=function(str){\r\n\t\t\tvar color=Color._SAVE[str+\"\"];\r\n\t\t\tif (color !=null)return color;\r\n\t\t\t(Color._SAVE_SIZE < 1000)|| Color._initSaveMap();\r\n\t\t\treturn Color._SAVE[str+\"\"]=new Color(str);\r\n\t\t}\r\n\r\n\t\tColor._SAVE={};\r\n\t\tColor._SAVE_SIZE=0;\r\n\t\tColor._COLOR_MAP={\"white\":'#FFFFFF',\"red\":'#FF0000',\"green\":'#00FF00',\"blue\":'#0000FF',\"black\":'#000000',\"yellow\":'#FFFF00','gray':'#AAAAAA'};\r\n\t\tColor._DEFAULT=Color._initDefault();\r\n\t\tColor._COLODID=1;\r\n\t\treturn Color;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Dictionary</code> 是一个字典型的数据存取类。\r\n\t*/\r\n\t//class laya.utils.Dictionary\r\n\tvar Dictionary=(function(){\r\n\t\tfunction Dictionary(){\r\n\t\t\tthis._values=[];\r\n\t\t\tthis._keys=[];\r\n\t\t}\r\n\r\n\t\t__class(Dictionary,'laya.utils.Dictionary');\r\n\t\tvar __proto=Dictionary.prototype;\r\n\t\t/**\r\n\t\t*给指定的键名设置值。\r\n\t\t*@param key 键名。\r\n\t\t*@param value 值。\r\n\t\t*/\r\n\t\t__proto.set=function(key,value){\r\n\t\t\tvar index=this.indexOf(key);\r\n\t\t\tif (index >=0){\r\n\t\t\t\tthis._values[index]=value;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._keys.push(key);\r\n\t\t\tthis._values.push(value);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定对象的键名索引。\r\n\t\t*@param key 键名对象。\r\n\t\t*@return 键名索引。\r\n\t\t*/\r\n\t\t__proto.indexOf=function(key){\r\n\t\t\tvar index=this._keys.indexOf(key);\r\n\t\t\tif (index >=0)return index;\r\n\t\t\tkey=((typeof key=='string'))? Number(key):(((typeof key=='number'))? key.toString():key);\r\n\t\t\treturn this._keys.indexOf(key);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回指定键名的值。\r\n\t\t*@param key 键名对象。\r\n\t\t*@return 指定键名的值。\r\n\t\t*/\r\n\t\t__proto.get=function(key){\r\n\t\t\tvar index=this.indexOf(key);\r\n\t\t\treturn index < 0 ? null :this._values[index];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*移除指定键名的值。\r\n\t\t*@param key 键名对象。\r\n\t\t*@return 是否成功移除。\r\n\t\t*/\r\n\t\t__proto.remove=function(key){\r\n\t\t\tvar index=this.indexOf(key);\r\n\t\t\tif (index >=0){\r\n\t\t\t\tthis._keys.splice(index,1);\r\n\t\t\t\tthis._values.splice(index,1);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清除此对象的键名列表和键值列表。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._values.length=0;\r\n\t\t\tthis._keys.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取所有的子元素列表。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'values',function(){\r\n\t\t\treturn this._values;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取所有的子元素键名列表。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'keys',function(){\r\n\t\t\treturn this._keys;\r\n\t\t});\r\n\r\n\t\treturn Dictionary;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Dragging</code> 类是触摸滑动控件。\r\n\t*/\r\n\t//class laya.utils.Dragging\r\n\tvar Dragging=(function(){\r\n\t\tfunction Dragging(){\r\n\t\t\t//this.target=null;\r\n\t\t\tthis.ratio=0.92;\r\n\t\t\tthis.maxOffset=60;\r\n\t\t\t//this.area=null;\r\n\t\t\t//this.hasInertia=false;\r\n\t\t\t//this.elasticDistance=NaN;\r\n\t\t\t//this.elasticBackTime=NaN;\r\n\t\t\t//this.data=null;\r\n\t\t\tthis._dragging=false;\r\n\t\t\tthis._clickOnly=true;\r\n\t\t\t//this._elasticRateX=NaN;\r\n\t\t\t//this._elasticRateY=NaN;\r\n\t\t\t//this._lastX=NaN;\r\n\t\t\t//this._lastY=NaN;\r\n\t\t\t//this._offsetX=NaN;\r\n\t\t\t//this._offsetY=NaN;\r\n\t\t\t//this._offsets=null;\r\n\t\t\t//this._disableMouseEvent=false;\r\n\t\t\t//this._tween=null;\r\n\t\t\t//this._parent=null;\r\n\t\t}\r\n\r\n\t\t__class(Dragging,'laya.utils.Dragging');\r\n\t\tvar __proto=Dragging.prototype;\r\n\t\t/**\r\n\t\t*开始拖拽。\r\n\t\t*@param target 待拖拽的 <code>Sprite</code> 对象。\r\n\t\t*@param area 滑动范围。\r\n\t\t*@param hasInertia 拖动是否有惯性。\r\n\t\t*@param elasticDistance 橡皮筋最大值。\r\n\t\t*@param elasticBackTime 橡皮筋回弹时间，单位为毫秒。\r\n\t\t*@param data 事件携带数据。\r\n\t\t*@param disableMouseEvent 鼠标事件是否有效。\r\n\t\t*@param ratio 惯性阻尼系数\r\n\t\t*/\r\n\t\t__proto.start=function(target,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){\r\n\t\t\t(ratio===void 0)&& (ratio=0.92);\r\n\t\t\tthis.clearTimer();\r\n\t\t\tthis.target=target;\r\n\t\t\tthis.area=area;\r\n\t\t\tthis.hasInertia=hasInertia;\r\n\t\t\tthis.elasticDistance=area ? elasticDistance :0;\r\n\t\t\tthis.elasticBackTime=elasticBackTime;\r\n\t\t\tthis.data=data;\r\n\t\t\tthis._disableMouseEvent=disableMouseEvent;\r\n\t\t\tthis.ratio=ratio;\r\n\t\t\tif (target.globalScaleX !=1 || target.globalScaleY !=1){\r\n\t\t\t\tthis._parent=target.parent;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._parent=Laya.stage;\r\n\t\t\t}\r\n\t\t\tthis._clickOnly=true;\r\n\t\t\tthis._dragging=true;\r\n\t\t\tthis._elasticRateX=this._elasticRateY=1;\r\n\t\t\tthis._lastX=this._parent.mouseX;\r\n\t\t\tthis._lastY=this._parent.mouseY;\r\n\t\t\tLaya.stage.on(/*laya.events.Event.MOUSE_UP*/\"mouseup\",this,this.onStageMouseUp);\r\n\t\t\tLaya.stage.on(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",this,this.onStageMouseUp);\r\n\t\t\tLaya.timer.frameLoop(1,this,this.loop);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清除计时器。\r\n\t\t*/\r\n\t\t__proto.clearTimer=function(){\r\n\t\t\tLaya.timer.clear(this,this.loop);\r\n\t\t\tLaya.timer.clear(this,this.tweenMove);\r\n\t\t\tif (this._tween){\r\n\t\t\t\tthis._tween.recover();\r\n\t\t\t\tthis._tween=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止拖拽。\r\n\t\t*/\r\n\t\t__proto.stop=function(){\r\n\t\t\tif (this._dragging){\r\n\t\t\t\tMouseManager.instance.disableMouseEvent=false;\r\n\t\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_UP*/\"mouseup\",this,this.onStageMouseUp);\r\n\t\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",this,this.onStageMouseUp);\r\n\t\t\t\tthis._dragging=false;\r\n\t\t\t\tthis.target && this.area && this.backToArea();\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*拖拽的循环处理函数。\r\n\t\t*/\r\n\t\t__proto.loop=function(){\r\n\t\t\tvar point=this._parent.getMousePoint();\r\n\t\t\tvar mouseX=point.x;\r\n\t\t\tvar mouseY=point.y;\r\n\t\t\tvar offsetX=mouseX-this._lastX;\r\n\t\t\tvar offsetY=mouseY-this._lastY;\r\n\t\t\tif (this._clickOnly){\r\n\t\t\t\tif (Math.abs(offsetX *Laya.stage._canvasTransform.getScaleX())> 1 || Math.abs(offsetY *Laya.stage._canvasTransform.getScaleY())> 1){\r\n\t\t\t\t\tthis._clickOnly=false;\r\n\t\t\t\t\tthis._offsets || (this._offsets=[]);\r\n\t\t\t\t\tthis._offsets.length=0;\r\n\t\t\t\t\tthis.target.event(/*laya.events.Event.DRAG_START*/\"dragstart\",this.data);\r\n\t\t\t\t\tMouseManager.instance.disableMouseEvent=this._disableMouseEvent;\r\n\t\t\t\t\tthis.target._set$P(\"$_MOUSEDOWN\",false);\r\n\t\t\t\t}else return;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._offsets.push(offsetX,offsetY);\r\n\t\t\t}\r\n\t\t\tif (offsetX===0 && offsetY===0)return;\r\n\t\t\tthis._lastX=mouseX;\r\n\t\t\tthis._lastY=mouseY;\r\n\t\t\tthis.target.x+=offsetX *this._elasticRateX;\r\n\t\t\tthis.target.y+=offsetY *this._elasticRateY;\r\n\t\t\tthis.area && this.checkArea();\r\n\t\t\tthis.target.event(/*laya.events.Event.DRAG_MOVE*/\"dragmove\",this.data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*拖拽区域检测。\r\n\t\t*/\r\n\t\t__proto.checkArea=function(){\r\n\t\t\tif (this.elasticDistance <=0){\r\n\t\t\t\tthis.backToArea();\r\n\t\t\t\t}else {\r\n\t\t\t\tif (this.target.x < this.area.x){\r\n\t\t\t\t\tvar offsetX=this.area.x-this.target.x;\r\n\t\t\t\t\t}else if (this.target.x > this.area.x+this.area.width){\r\n\t\t\t\t\toffsetX=this.target.x-this.area.x-this.area.width;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\toffsetX=0;\r\n\t\t\t\t}\r\n\t\t\t\tthis._elasticRateX=Math.max(0,1-(offsetX / this.elasticDistance));\r\n\t\t\t\tif (this.target.y < this.area.y){\r\n\t\t\t\t\tvar offsetY=this.area.y-this.target.y;\r\n\t\t\t\t\t}else if (this.target.y > this.area.y+this.area.height){\r\n\t\t\t\t\toffsetY=this.target.y-this.area.y-this.area.height;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\toffsetY=0;\r\n\t\t\t\t}\r\n\t\t\t\tthis._elasticRateY=Math.max(0,1-(offsetY / this.elasticDistance));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*移动至设定的拖拽区域。\r\n\t\t*/\r\n\t\t__proto.backToArea=function(){\r\n\t\t\tthis.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width);\r\n\t\t\tthis.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*舞台的抬起事件侦听函数。\r\n\t\t*@param e Event 对象。\r\n\t\t*/\r\n\t\t__proto.onStageMouseUp=function(e){\r\n\t\t\tMouseManager.instance.disableMouseEvent=false;\r\n\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_UP*/\"mouseup\",this,this.onStageMouseUp);\r\n\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_OUT*/\"mouseout\",this,this.onStageMouseUp);\r\n\t\t\tLaya.timer.clear(this,this.loop);\r\n\t\t\tif (this._clickOnly || !this.target)return;\r\n\t\t\tif (this.hasInertia){\r\n\t\t\t\tif (this._offsets.length < 1){\r\n\t\t\t\t\tthis._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY);\r\n\t\t\t\t}\r\n\t\t\t\tthis._offsetX=this._offsetY=0;\r\n\t\t\t\tvar len=this._offsets.length;\r\n\t\t\t\tvar n=Math.min(len,6);\r\n\t\t\t\tvar m=this._offsets.length-n;\r\n\t\t\t\tfor (var i=len-1;i > m;i--){\r\n\t\t\t\t\tthis._offsetY+=this._offsets[i--];\r\n\t\t\t\t\tthis._offsetX+=this._offsets[i];\r\n\t\t\t\t}\r\n\t\t\t\tthis._offsetX=this._offsetX / n *2;\r\n\t\t\t\tthis._offsetY=this._offsetY / n *2;\r\n\t\t\t\tif (Math.abs(this._offsetX)> this.maxOffset)this._offsetX=this._offsetX > 0 ? this.maxOffset :-this.maxOffset;\r\n\t\t\t\tif (Math.abs(this._offsetY)> this.maxOffset)this._offsetY=this._offsetY > 0 ? this.maxOffset :-this.maxOffset;\r\n\t\t\t\tLaya.timer.frameLoop(1,this,this.tweenMove);\r\n\t\t\t\t}else if (this.elasticDistance > 0){\r\n\t\t\t\tthis.checkElastic();\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*橡皮筋效果检测。\r\n\t\t*/\r\n\t\t__proto.checkElastic=function(){\r\n\t\t\tvar tx=NaN;\r\n\t\t\tvar ty=NaN;\r\n\t\t\tif (this.target.x < this.area.x)tx=this.area.x;\r\n\t\t\telse if (this.target.x > this.area.x+this.area.width)tx=this.area.x+this.area.width;\r\n\t\t\tif (this.target.y < this.area.y)ty=this.area.y;\r\n\t\t\telse if (this.target.y > this.area.y+this.area.height)ty=this.area.y+this.area.height;\r\n\t\t\tif (!isNaN(tx)|| !isNaN(ty)){\r\n\t\t\t\tvar obj={};\r\n\t\t\t\tif (!isNaN(tx))obj.x=tx;\r\n\t\t\t\tif (!isNaN(ty))obj.y=ty;\r\n\t\t\t\tthis._tween=Tween.to(this.target,obj,this.elasticBackTime,Ease.sineOut,Handler.create(this,this.clear),0,false,false);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*移动。\r\n\t\t*/\r\n\t\t__proto.tweenMove=function(){\r\n\t\t\tthis._offsetX *=this.ratio *this._elasticRateX;\r\n\t\t\tthis._offsetY *=this.ratio *this._elasticRateY;\r\n\t\t\tthis.target.x+=this._offsetX;\r\n\t\t\tthis.target.y+=this._offsetY;\r\n\t\t\tthis.area && this.checkArea();\r\n\t\t\tthis.target.event(/*laya.events.Event.DRAG_MOVE*/\"dragmove\",this.data);\r\n\t\t\tif ((Math.abs(this._offsetX)< 1 && Math.abs(this._offsetY)< 1)|| this._elasticRateX < 0.5 || this._elasticRateY < 0.5){\r\n\t\t\t\tLaya.timer.clear(this,this.tweenMove);\r\n\t\t\t\tif (this.elasticDistance > 0)this.checkElastic();\r\n\t\t\t\telse this.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*结束拖拽。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tif (this.target){\r\n\t\t\t\tthis.clearTimer();\r\n\t\t\t\tvar sp=this.target;\r\n\t\t\t\tthis.target=null;\r\n\t\t\t\tthis._parent=null;\r\n\t\t\t\tsp.event(/*laya.events.Event.DRAG_END*/\"dragend\",this.data);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn Dragging;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Ease</code> 类定义了缓动函数，以便实现 <code>Tween</code> 动画的缓动效果。\r\n\t*/\r\n\t//class laya.utils.Ease\r\n\tvar Ease=(function(){\r\n\t\tfunction Ease(){};\r\n\t\t__class(Ease,'laya.utils.Ease');\r\n\t\tEase.linearNone=function(t,b,c,d){\r\n\t\t\treturn c *t / d+b;\r\n\t\t}\r\n\r\n\t\tEase.linearIn=function(t,b,c,d){\r\n\t\t\treturn c *t / d+b;\r\n\t\t}\r\n\r\n\t\tEase.linearInOut=function(t,b,c,d){\r\n\t\t\treturn c *t / d+b;\r\n\t\t}\r\n\r\n\t\tEase.linearOut=function(t,b,c,d){\r\n\t\t\treturn c *t / d+b;\r\n\t\t}\r\n\r\n\t\tEase.bounceIn=function(t,b,c,d){\r\n\t\t\treturn c-Ease.bounceOut(d-t,0,c,d)+b;\r\n\t\t}\r\n\r\n\t\tEase.bounceInOut=function(t,b,c,d){\r\n\t\t\tif (t < d *0.5)return Ease.bounceIn(t *2,0,c,d)*.5+b;\r\n\t\t\telse return Ease.bounceOut(t *2-d,0,c,d)*.5+c *.5+b;\r\n\t\t}\r\n\r\n\t\tEase.bounceOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d)< (1 / 2.75))return c *(7.5625 *t *t)+b;\r\n\t\t\telse if (t < (2 / 2.75))return c *(7.5625 *(t-=(1.5 / 2.75))*t+.75)+b;\r\n\t\t\telse if (t < (2.5 / 2.75))return c *(7.5625 *(t-=(2.25 / 2.75))*t+.9375)+b;\r\n\t\t\telse return c *(7.5625 *(t-=(2.625 / 2.75))*t+.984375)+b;\r\n\t\t}\r\n\r\n\t\tEase.backIn=function(t,b,c,d,s){\r\n\t\t\t(s===void 0)&& (s=1.70158);\r\n\t\t\treturn c *(t /=d)*t *((s+1)*t-s)+b;\r\n\t\t}\r\n\r\n\t\tEase.backInOut=function(t,b,c,d,s){\r\n\t\t\t(s===void 0)&& (s=1.70158);\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *(t *t *(((s *=(1.525))+1)*t-s))+b;\r\n\t\t\treturn c / 2 *((t-=2)*t *(((s *=(1.525))+1)*t+s)+2)+b;\r\n\t\t}\r\n\r\n\t\tEase.backOut=function(t,b,c,d,s){\r\n\t\t\t(s===void 0)&& (s=1.70158);\r\n\t\t\treturn c *((t=t / d-1)*t *((s+1)*t+s)+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.elasticIn=function(t,b,c,d,a,p){\r\n\t\t\t(a===void 0)&& (a=0);\r\n\t\t\t(p===void 0)&& (p=0);\r\n\t\t\tvar s;\r\n\t\t\tif (t==0)return b;\r\n\t\t\tif ((t /=d)==1)return b+c;\r\n\t\t\tif (!p)p=d *.3;\r\n\t\t\tif (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){\r\n\t\t\t\ta=c;\r\n\t\t\t\ts=p / 4;\r\n\t\t\t}else s=p / Ease.PI2 *Math.asin(c / a);\r\n\t\t\treturn-(a *Math.pow(2,10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p))+b;\r\n\t\t}\r\n\r\n\t\tEase.elasticInOut=function(t,b,c,d,a,p){\r\n\t\t\t(a===void 0)&& (a=0);\r\n\t\t\t(p===void 0)&& (p=0);\r\n\t\t\tvar s;\r\n\t\t\tif (t==0)return b;\r\n\t\t\tif ((t /=d *0.5)==2)return b+c;\r\n\t\t\tif (!p)p=d *(.3 *1.5);\r\n\t\t\tif (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){\r\n\t\t\t\ta=c;\r\n\t\t\t\ts=p / 4;\r\n\t\t\t}else s=p / Ease.PI2 *Math.asin(c / a);\r\n\t\t\tif (t < 1)return-.5 *(a *Math.pow(2,10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p))+b;\r\n\t\t\treturn a *Math.pow(2,-10 *(t-=1))*Math.sin((t *d-s)*Ease.PI2 / p)*.5+c+b;\r\n\t\t}\r\n\r\n\t\tEase.elasticOut=function(t,b,c,d,a,p){\r\n\t\t\t(a===void 0)&& (a=0);\r\n\t\t\t(p===void 0)&& (p=0);\r\n\t\t\tvar s;\r\n\t\t\tif (t==0)return b;\r\n\t\t\tif ((t /=d)==1)return b+c;\r\n\t\t\tif (!p)p=d *.3;\r\n\t\t\tif (!a || (c > 0 && a < c)|| (c < 0 && a <-c)){\r\n\t\t\t\ta=c;\r\n\t\t\t\ts=p / 4;\r\n\t\t\t}else s=p / Ease.PI2 *Math.asin(c / a);\r\n\t\t\treturn (a *Math.pow(2,-10 *t)*Math.sin((t *d-s)*Ease.PI2 / p)+c+b);\r\n\t\t}\r\n\r\n\t\tEase.strongIn=function(t,b,c,d){\r\n\t\t\treturn c *(t /=d)*t *t *t *t+b;\r\n\t\t}\r\n\r\n\t\tEase.strongInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t *t+b;\r\n\t\t\treturn c *0.5 *((t-=2)*t *t *t *t+2)+b;\r\n\t\t}\r\n\r\n\t\tEase.strongOut=function(t,b,c,d){\r\n\t\t\treturn c *((t=t / d-1)*t *t *t *t+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.sineInOut=function(t,b,c,d){\r\n\t\t\treturn-c *0.5 *(Math.cos(Math.PI *t / d)-1)+b;\r\n\t\t}\r\n\r\n\t\tEase.sineIn=function(t,b,c,d){\r\n\t\t\treturn-c *Math.cos(t / d *Ease.HALF_PI)+c+b;\r\n\t\t}\r\n\r\n\t\tEase.sineOut=function(t,b,c,d){\r\n\t\t\treturn c *Math.sin(t / d *Ease.HALF_PI)+b;\r\n\t\t}\r\n\r\n\t\tEase.quintIn=function(t,b,c,d){\r\n\t\t\treturn c *(t /=d)*t *t *t *t+b;\r\n\t\t}\r\n\r\n\t\tEase.quintInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t *t+b;\r\n\t\t\treturn c *0.5 *((t-=2)*t *t *t *t+2)+b;\r\n\t\t}\r\n\r\n\t\tEase.quintOut=function(t,b,c,d){\r\n\t\t\treturn c *((t=t / d-1)*t *t *t *t+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.quartIn=function(t,b,c,d){\r\n\t\t\treturn c *(t /=d)*t *t *t+b;\r\n\t\t}\r\n\r\n\t\tEase.quartInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *t *t *t *t+b;\r\n\t\t\treturn-c *0.5 *((t-=2)*t *t *t-2)+b;\r\n\t\t}\r\n\r\n\t\tEase.quartOut=function(t,b,c,d){\r\n\t\t\treturn-c *((t=t / d-1)*t *t *t-1)+b;\r\n\t\t}\r\n\r\n\t\tEase.cubicIn=function(t,b,c,d){\r\n\t\t\treturn c *(t /=d)*t *t+b;\r\n\t\t}\r\n\r\n\t\tEase.cubicInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *t *t *t+b;\r\n\t\t\treturn c *0.5 *((t-=2)*t *t+2)+b;\r\n\t\t}\r\n\r\n\t\tEase.cubicOut=function(t,b,c,d){\r\n\t\t\treturn c *((t=t / d-1)*t *t+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.quadIn=function(t,b,c,d){\r\n\t\t\treturn c *(t /=d)*t+b;\r\n\t\t}\r\n\r\n\t\tEase.quadInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *t *t+b;\r\n\t\t\treturn-c *0.5 *((--t)*(t-2)-1)+b;\r\n\t\t}\r\n\r\n\t\tEase.quadOut=function(t,b,c,d){\r\n\t\t\treturn-c *(t /=d)*(t-2)+b;\r\n\t\t}\r\n\r\n\t\tEase.expoIn=function(t,b,c,d){\r\n\t\t\treturn (t==0)? b :c *Math.pow(2,10 *(t / d-1))+b-c *0.001;\r\n\t\t}\r\n\r\n\t\tEase.expoInOut=function(t,b,c,d){\r\n\t\t\tif (t==0)return b;\r\n\t\t\tif (t==d)return b+c;\r\n\t\t\tif ((t /=d *0.5)< 1)return c *0.5 *Math.pow(2,10 *(t-1))+b;\r\n\t\t\treturn c *0.5 *(-Math.pow(2,-10 *--t)+2)+b;\r\n\t\t}\r\n\r\n\t\tEase.expoOut=function(t,b,c,d){\r\n\t\t\treturn (t==d)? b+c :c *(-Math.pow(2,-10 *t / d)+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.circIn=function(t,b,c,d){\r\n\t\t\treturn-c *(Math.sqrt(1-(t /=d)*t)-1)+b;\r\n\t\t}\r\n\r\n\t\tEase.circInOut=function(t,b,c,d){\r\n\t\t\tif ((t /=d *0.5)< 1)return-c *0.5 *(Math.sqrt(1-t *t)-1)+b;\r\n\t\t\treturn c *0.5 *(Math.sqrt(1-(t-=2)*t)+1)+b;\r\n\t\t}\r\n\r\n\t\tEase.circOut=function(t,b,c,d){\r\n\t\t\treturn c *Math.sqrt(1-(t=t / d-1)*t)+b;\r\n\t\t}\r\n\r\n\t\tEase.HALF_PI=Math.PI *0.5;\r\n\t\tEase.PI2=Math.PI *2;\r\n\t\treturn Ease;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*鼠标点击区域，可以设置绘制一系列矢量图作为点击区域和非点击区域（目前只支持圆形，矩形，多边形）\r\n\t*/\r\n\t//class laya.utils.HitArea\r\n\tvar HitArea=(function(){\r\n\t\tfunction HitArea(){\r\n\t\t\tthis._hit=null;\r\n\t\t\tthis._unHit=null;\r\n\t\t}\r\n\r\n\t\t__class(HitArea,'laya.utils.HitArea');\r\n\t\tvar __proto=HitArea.prototype;\r\n\t\t/**\r\n\t\t*是否包含某个点\r\n\t\t*@param x x坐标\r\n\t\t*@param y y坐标\r\n\t\t*@return 是否点击到\r\n\t\t*/\r\n\t\t__proto.isHit=function(x,y){\r\n\t\t\tif (!HitArea.isHitGraphic(x,y,this.hit))return false;\r\n\t\t\treturn !HitArea.isHitGraphic(x,y,this.unHit);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*可点击区域，可以设置绘制一系列矢量图作为点击区域（目前只支持圆形，矩形，多边形）\r\n\t\t*/\r\n\t\t__getset(0,__proto,'hit',function(){\r\n\t\t\tif (!this._hit)this._hit=new Graphics();\r\n\t\t\treturn this._hit;\r\n\t\t\t},function(value){\r\n\t\t\tthis._hit=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*不可点击区域，可以设置绘制一系列矢量图作为非点击区域（目前只支持圆形，矩形，多边形）\r\n\t\t*/\r\n\t\t__getset(0,__proto,'unHit',function(){\r\n\t\t\tif (!this._unHit)this._unHit=new Graphics();\r\n\t\t\treturn this._unHit;\r\n\t\t\t},function(value){\r\n\t\t\tthis._unHit=value;\r\n\t\t});\r\n\r\n\t\tHitArea.isHitGraphic=function(x,y,graphic){\r\n\t\t\tif (!graphic)return false;\r\n\t\t\tvar cmds;\r\n\t\t\tcmds=graphic.cmds;\r\n\t\t\tif (!cmds && graphic._one){\r\n\t\t\t\tcmds=HitArea._cmds;\r\n\t\t\t\tcmds.length=1;\r\n\t\t\t\tcmds[0]=graphic._one;\r\n\t\t\t}\r\n\t\t\tif (!cmds)return false;\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=cmds.length;\r\n\t\t\tvar cmd;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tcmd=cmds[i];\r\n\t\t\t\tif (!cmd)continue ;\r\n\t\t\t\tvar context=Render._context;\r\n\t\t\t\tswitch (cmd.callee){\r\n\t\t\t\t\tcase context._translate:\r\n\t\t\t\t\tcase 6:\r\n\t\t\t\t\t\tx-=cmd[0];\r\n\t\t\t\t\t\ty-=cmd[1];\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t}\r\n\t\t\t\tif (HitArea.isHitCmd(x,y,cmd))return true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tHitArea.isHitCmd=function(x,y,cmd){\r\n\t\t\tif (!cmd)return false;\r\n\t\t\tvar context=Render._context;\r\n\t\t\tvar rst=false;\r\n\t\t\tswitch (cmd[\"callee\"]){\r\n\t\t\t\tcase context._drawRect:\r\n\t\t\t\tcase 13:\r\n\t\t\t\t\tHitArea._rec.setTo(cmd[0],cmd[1],cmd[2],cmd[3]);\r\n\t\t\t\t\trst=HitArea._rec.contains(x,y);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase context._drawCircle:\r\n\t\t\t\tcase context._fillCircle:\r\n\t\t\t\tcase 14:;\r\n\t\t\t\t\tvar d=NaN;\r\n\t\t\t\t\tx-=cmd[0];\r\n\t\t\t\t\ty-=cmd[1];\r\n\t\t\t\t\td=x *x+y *y;\r\n\t\t\t\t\trst=d < cmd[2] *cmd[2];\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase context._drawPoly:\r\n\t\t\t\tcase 18:\r\n\t\t\t\t\tx-=cmd[0];\r\n\t\t\t\t\ty-=cmd[1];\r\n\t\t\t\t\trst=HitArea.ptInPolygon(x,y,cmd[2]);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tHitArea.ptInPolygon=function(x,y,areaPoints){\r\n\t\t\tvar p;\r\n\t\t\tp=HitArea._ptPoint;\r\n\t\t\tp.setTo(x,y);\r\n\t\t\tvar nCross=0;\r\n\t\t\tvar p1x=NaN,p1y=NaN,p2x=NaN,p2y=NaN;\r\n\t\t\tvar len=0;\r\n\t\t\tlen=areaPoints.length;\r\n\t\t\tfor (var i=0;i < len;i+=2){\r\n\t\t\t\tp1x=areaPoints[i];\r\n\t\t\t\tp1y=areaPoints[i+1];\r\n\t\t\t\tp2x=areaPoints[(i+2)% len];\r\n\t\t\t\tp2y=areaPoints[(i+3)% len];\r\n\t\t\t\tif (p1y==p2y)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tif (p.y < Math.min(p1y,p2y))\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tif (p.y >=Math.max(p1y,p2y))\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tvar tx=(p.y-p1y)*(p2x-p1x)/ (p2y-p1y)+p1x;\r\n\t\t\t\tif (tx > p.x){\r\n\t\t\t\t\tnCross++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn (nCross % 2==1);\r\n\t\t}\r\n\r\n\t\tHitArea._cmds=[];\r\n\t\t__static(HitArea,\r\n\t\t['_rec',function(){return this._rec=new Rectangle();},'_ptPoint',function(){return this._ptPoint=new Point();}\r\n\t\t]);\r\n\t\treturn HitArea;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>HTMLChar</code> 是一个 HTML 字符类。\r\n\t*/\r\n\t//class laya.utils.HTMLChar\r\n\tvar HTMLChar=(function(){\r\n\t\tfunction HTMLChar(char,w,h,style){\r\n\t\t\t//this._sprite=null;\r\n\t\t\t//this._x=NaN;\r\n\t\t\t//this._y=NaN;\r\n\t\t\t//this._w=NaN;\r\n\t\t\t//this._h=NaN;\r\n\t\t\t//this.isWord=false;\r\n\t\t\t//this.char=null;\r\n\t\t\t//this.charNum=NaN;\r\n\t\t\t//this.style=null;\r\n\t\t\tthis.char=char;\r\n\t\t\tthis.charNum=char.charCodeAt(0);\r\n\t\t\tthis._x=this._y=0;\r\n\t\t\tthis.width=w;\r\n\t\t\tthis.height=h;\r\n\t\t\tthis.style=style;\r\n\t\t\tthis.isWord=!HTMLChar._isWordRegExp.test(char);\r\n\t\t}\r\n\r\n\t\t__class(HTMLChar,'laya.utils.HTMLChar');\r\n\t\tvar __proto=HTMLChar.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.display.ILayout\":true})\r\n\t\t/**\r\n\t\t*设置与此对象绑定的显示对象 <code>Sprite</code> 。\r\n\t\t*@param sprite 显示对象 <code>Sprite</code> 。\r\n\t\t*/\r\n\t\t__proto.setSprite=function(sprite){\r\n\t\t\tthis._sprite=sprite;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取与此对象绑定的显示对象 <code>Sprite</code>。\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getSprite=function(){\r\n\t\t\treturn this._sprite;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._isChar=function(){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getCSSStyle=function(){\r\n\t\t\treturn this.style;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*宽度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\treturn this._w;\r\n\t\t\t},function(value){\r\n\t\t\tthis._w=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*此对象存储的 X 轴坐标值。\r\n\t\t*当设置此值时，如果此对象有绑定的 Sprite 对象，则改变 Sprite 对象的属性 x 的值。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'x',function(){\r\n\t\t\treturn this._x;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._sprite){\r\n\t\t\t\tthis._sprite.x=value;\r\n\t\t\t}\r\n\t\t\tthis._x=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*此对象存储的 Y 轴坐标值。\r\n\t\t*当设置此值时，如果此对象有绑定的 Sprite 对象，则改变 Sprite 对象的属性 y 的值。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'y',function(){\r\n\t\t\treturn this._y;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._sprite){\r\n\t\t\t\tthis._sprite.y=value;\r\n\t\t\t}\r\n\t\t\tthis._y=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*高度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\treturn this._h;\r\n\t\t\t},function(value){\r\n\t\t\tthis._h=value;\r\n\t\t});\r\n\r\n\t\tHTMLChar._isWordRegExp=new RegExp(\"[\\\\w\\.]\",\"\");\r\n\t\treturn HTMLChar;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Log</code> 类用于在界面内显示日志记录信息。\r\n\t*/\r\n\t//class laya.utils.Log\r\n\tvar Log=(function(){\r\n\t\tfunction Log(){};\r\n\t\t__class(Log,'laya.utils.Log');\r\n\t\tLog.enable=function(){\r\n\t\t\tif (!Log._logdiv){\r\n\t\t\t\tLog._logdiv=Browser.window.document.createElement('div');\r\n\t\t\t\tBrowser.window.document.body.appendChild(Log._logdiv);\r\n\t\t\t\tLog._logdiv.style.cssText=\"pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLog.toggle=function(){\r\n\t\t\tvar style=Log._logdiv.style;\r\n\t\t\tif (style.width==\"1px\"){\r\n\t\t\t\tstyle.width=style.height=\"50%\";\r\n\t\t\t\t}else {\r\n\t\t\t\tstyle.width=style.height=\"1px\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLog.print=function(value){\r\n\t\t\tif (Log._logdiv){\r\n\t\t\t\tif (Log._count >=Log.maxCount)Log.clear();\r\n\t\t\t\tLog._count++;\r\n\t\t\t\tLog._logdiv.innerText+=value+\"\\n\";\r\n\t\t\t\tLog._logdiv.scrollTop=Log._logdiv.scrollHeight;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLog.clear=function(){\r\n\t\t\tLog._logdiv.innerText=\"\";\r\n\t\t\tLog._count=0;\r\n\t\t}\r\n\r\n\t\tLog._logdiv=null\r\n\t\tLog._count=0;\r\n\t\tLog.maxCount=20;\r\n\t\treturn Log;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Mouse</code> 类用于控制鼠标光标。\r\n\t*/\r\n\t//class laya.utils.Mouse\r\n\tvar Mouse=(function(){\r\n\t\tfunction Mouse(){}\r\n\t\t__class(Mouse,'laya.utils.Mouse');\r\n\t\t/**\r\n\t\t*设置鼠标样式\r\n\t\t*@param cursorStr\r\n\t\t*例如auto move no-drop col-resize\r\n\t\t*all-scroll pointer not-allowed row-resize\r\n\t\t*crosshair progress e-resize ne-resize\r\n\t\t*default text n-resize nw-resize\r\n\t\t*help vertical-text s-resize se-resize\r\n\t\t*inherit wait w-resize sw-resize\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(1,Mouse,'cursor',function(){\r\n\t\t\treturn Mouse._style.cursor;\r\n\t\t\t},function(cursorStr){\r\n\t\t\tMouse._style.cursor=cursorStr;\r\n\t\t});\r\n\r\n\t\tMouse.hide=function(){\r\n\t\t\tif (Mouse.cursor !=\"none\"){\r\n\t\t\t\tMouse._preCursor=Mouse.cursor;\r\n\t\t\t\tMouse.cursor=\"none\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tMouse.show=function(){\r\n\t\t\tif (Mouse.cursor==\"none\"){\r\n\t\t\t\tif (Mouse._preCursor){\r\n\t\t\t\t\tMouse.cursor=Mouse._preCursor;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\tMouse.cursor=\"auto\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tMouse._preCursor=null\r\n\t\t__static(Mouse,\r\n\t\t['_style',function(){return this._style=Browser.document.body.style;}\r\n\t\t]);\r\n\t\treturn Mouse;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Pool</code> 是对象池类，用于对象的存贮、重复使用。\r\n\t*/\r\n\t//class laya.utils.Pool\r\n\tvar Pool=(function(){\r\n\t\tfunction Pool(){};\r\n\t\t__class(Pool,'laya.utils.Pool');\r\n\t\tPool.getPoolBySign=function(sign){\r\n\t\t\treturn Pool._poolDic[sign] || (Pool._poolDic[sign]=[]);\r\n\t\t}\r\n\r\n\t\tPool.clearBySign=function(sign){\r\n\t\t\tif (Pool._poolDic[sign])Pool._poolDic[sign].length=0;\r\n\t\t}\r\n\r\n\t\tPool.recover=function(sign,item){\r\n\t\t\tif (item[\"__InPool\"])return;\r\n\t\t\titem[\"__InPool\"]=true;\r\n\t\t\tPool.getPoolBySign(sign).push(item);\r\n\t\t}\r\n\r\n\t\tPool.getItemByClass=function(sign,cls){\r\n\t\t\tvar pool=Pool.getPoolBySign(sign);\r\n\t\t\tvar rst=pool.length ? pool.pop():new cls();\r\n\t\t\trst[\"__InPool\"]=false;\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tPool.getItemByCreateFun=function(sign,createFun){\r\n\t\t\tvar pool=Pool.getPoolBySign(sign);\r\n\t\t\tvar rst=pool.length ? pool.pop():createFun();\r\n\t\t\trst[\"__InPool\"]=false;\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tPool.getItem=function(sign){\r\n\t\t\tvar pool=Pool.getPoolBySign(sign);\r\n\t\t\tvar rst=pool.length ? pool.pop():null;\r\n\t\t\tif (rst){\r\n\t\t\t\trst[\"__InPool\"]=false;\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tPool._poolDic={};\r\n\t\tPool.InPoolSign=\"__InPool\";\r\n\t\treturn Pool;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*基于个数的对象缓存管理器\r\n\t*/\r\n\t//class laya.utils.PoolCache\r\n\tvar PoolCache=(function(){\r\n\t\tfunction PoolCache(){\r\n\t\t\tthis.sign=null;\r\n\t\t\tthis.maxCount=1000;\r\n\t\t}\r\n\r\n\t\t__class(PoolCache,'laya.utils.PoolCache');\r\n\t\tvar __proto=PoolCache.prototype;\r\n\t\t/**\r\n\t\t*获取缓存的对象列表\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.getCacheList=function(){\r\n\t\t\treturn Pool.getPoolBySign(this.sign);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*尝试清理缓存\r\n\t\t*@param force 是否强制清理\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.tryDispose=function(force){\r\n\t\t\tvar list;\r\n\t\t\tlist=Pool.getPoolBySign(this.sign);\r\n\t\t\tif (list.length > this.maxCount){\r\n\t\t\t\tlist.splice(this.maxCount,list.length-this.maxCount);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tPoolCache.addPoolCacheManager=function(sign,maxCount){\r\n\t\t\t(maxCount===void 0)&& (maxCount=100);\r\n\t\t\tvar cache;\r\n\t\t\tcache=new PoolCache();\r\n\t\t\tcache.sign=sign;\r\n\t\t\tcache.maxCount=maxCount;\r\n\t\t\tCacheManger.regCacheByFunction(Utils.bind(cache.tryDispose,cache),Utils.bind(cache.getCacheList,cache));\r\n\t\t}\r\n\r\n\t\treturn PoolCache;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Stat</code> 用于显示帧率统计信息。\r\n\t*/\r\n\t//class laya.utils.Stat\r\n\tvar Stat=(function(){\r\n\t\tfunction Stat(){};\r\n\t\t__class(Stat,'laya.utils.Stat');\r\n\t\t/**\r\n\t\t*点击帧频显示区域的处理函数。\r\n\t\t*/\r\n\t\t__getset(1,Stat,'onclick',null,function(fn){\r\n\t\t\tStat._canvas.source.onclick=fn;\r\n\t\t\tStat._canvas.source.style.pointerEvents='';\r\n\t\t});\r\n\r\n\t\tStat.show=function(x,y){\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\t/*__JS__ */conch.showFPS&&conch.showFPS(x,y);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar pixel=Browser.pixelRatio;\r\n\t\t\tStat._width=pixel *120;\r\n\t\t\tStat._vx=pixel *70;\r\n\t\t\tStat._view[0]={title:\"FPS(Canvas)\",value:\"_fpsStr\",color:\"yellow\",units:\"int\"};\r\n\t\t\tStat._view[1]={title:\"Sprite\",value:\"spriteCount\",color:\"white\",units:\"int\"};\r\n\t\t\tStat._view[2]={title:\"DrawCall\",value:\"drawCall\",color:\"white\",units:\"int\"};\r\n\t\t\tStat._view[3]={title:\"CurMem\",value:\"currentMemorySize\",color:\"yellow\",units:\"M\"};\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\tStat._view[4]={title:\"Shader\",value:\"shaderCall\",color:\"white\",units:\"int\"};\r\n\t\t\t\tif (!Render.is3DMode){\r\n\t\t\t\t\tStat._view[0].title=\"FPS(WebGL)\";\r\n\t\t\t\t\tStat._view[5]={title:\"Canvas\",value:\"_canvasStr\",color:\"white\",units:\"int\"};\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tStat._view[0].title=\"FPS(3D)\";\r\n\t\t\t\t\tStat._view[5]={title:\"TriFaces\",value:\"trianglesFaces\",color:\"white\",units:\"int\"};\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tStat._view[4]={title:\"Canvas\",value:\"_canvasStr\",color:\"white\",units:\"int\"};\r\n\t\t\t}\r\n\t\t\tStat._fontSize=12 *pixel;\r\n\t\t\tfor (var i=0;i < Stat._view.length;i++){\r\n\t\t\t\tStat._view[i].x=4;\r\n\t\t\t\tStat._view[i].y=i *Stat._fontSize+2 *pixel;\r\n\t\t\t}\r\n\t\t\tStat._height=pixel *(Stat._view.length *12+3 *pixel);\r\n\t\t\tif (!Stat._canvas){\r\n\t\t\t\tStat._canvas=new HTMLCanvas('2D');\r\n\t\t\t\tStat._canvas.size(Stat._width,Stat._height);\r\n\t\t\t\tStat._ctx=Stat._canvas.getContext('2d');\r\n\t\t\t\tStat._ctx.textBaseline=\"top\";\r\n\t\t\t\tStat._ctx.font=Stat._fontSize+\"px Sans-serif\";\r\n\t\t\t\tStat._canvas.source.style.cssText=\"pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;left:\"+x+\"px;top:\"+y+\"px;width:\"+(Stat._width / pixel)+\"px;height:\"+(Stat._height / pixel)+\"px;\";\r\n\t\t\t}\r\n\t\t\tStat._first=true;\r\n\t\t\tStat.loop();\r\n\t\t\tStat._first=false;\r\n\t\t\tBrowser.container.appendChild(Stat._canvas.source);\r\n\t\t\tStat.enable();\r\n\t\t}\r\n\r\n\t\tStat.enable=function(){\r\n\t\t\tLaya.timer.frameLoop(1,Stat,Stat.loop);\r\n\t\t}\r\n\r\n\t\tStat.hide=function(){\r\n\t\t\tBrowser.removeElement(Stat._canvas.source);\r\n\t\t\tLaya.timer.clear(Stat,Stat.loop);\r\n\t\t}\r\n\r\n\t\tStat.clear=function(){\r\n\t\t\tStat.trianglesFaces=Stat.drawCall=Stat.shaderCall=Stat.spriteCount=Stat.canvasNormal=Stat.canvasBitmap=Stat.canvasReCache=0;\r\n\t\t}\r\n\r\n\t\tStat.loop=function(){\r\n\t\t\tStat._count++;\r\n\t\t\tvar timer=Browser.now();\r\n\t\t\tif (timer-Stat._timer < 1000)return;\r\n\t\t\tvar count=Stat._count;\r\n\t\t\tStat.FPS=Math.round((count *1000)/ (timer-Stat._timer));\r\n\t\t\tif (Stat._canvas){\r\n\t\t\t\tStat.trianglesFaces=Math.round(Stat.trianglesFaces / count);\r\n\t\t\t\tStat.drawCall=Math.round(Stat.drawCall / count)-2;\r\n\t\t\t\tStat.shaderCall=Math.round(Stat.shaderCall / count);\r\n\t\t\t\tStat.spriteCount=Math.round(Stat.spriteCount / count)-1;\r\n\t\t\t\tStat.canvasNormal=Math.round(Stat.canvasNormal / count);\r\n\t\t\t\tStat.canvasBitmap=Math.round(Stat.canvasBitmap / count);\r\n\t\t\t\tStat.canvasReCache=Math.ceil(Stat.canvasReCache / count);\r\n\t\t\t\tStat._fpsStr=Stat.FPS+(Stat.renderSlow ? \" slow\" :\"\");\r\n\t\t\t\tStat._canvasStr=Stat.canvasReCache+\"/\"+Stat.canvasNormal+\"/\"+Stat.canvasBitmap;\r\n\t\t\t\tStat.currentMemorySize=ResourceManager.systemResourceManager.memorySize;\r\n\t\t\t\tvar ctx=Stat._ctx;\r\n\t\t\t\tctx.clearRect(Stat._first ? 0 :Stat._vx,0,Stat._width,Stat._height);\r\n\t\t\t\tfor (var i=0;i < Stat._view.length;i++){\r\n\t\t\t\t\tvar one=Stat._view[i];\r\n\t\t\t\t\tif (Stat._first){\r\n\t\t\t\t\t\tctx.fillStyle=\"white\";\r\n\t\t\t\t\t\tctx.fillText(one.title,one.x,one.y,null,null,null);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.fillStyle=one.color;\r\n\t\t\t\t\tvar value=Stat[one.value];\r\n\t\t\t\t\t(one.units==\"M\")&& (value=Math.floor(value / (1024 *1024)*100)/ 100+\" M\");\r\n\t\t\t\t\tctx.fillText(value+\"\",one.x+Stat._vx,one.y,null,null,null);\r\n\t\t\t\t}\r\n\t\t\t\tStat.clear();\r\n\t\t\t}\r\n\t\t\tStat._count=0;\r\n\t\t\tStat._timer=timer;\r\n\t\t}\r\n\r\n\t\tStat.loopCount=0;\r\n\t\tStat.shaderCall=0;\r\n\t\tStat.drawCall=0;\r\n\t\tStat.trianglesFaces=0;\r\n\t\tStat.spriteCount=0;\r\n\t\tStat.FPS=0;\r\n\t\tStat.canvasNormal=0;\r\n\t\tStat.canvasBitmap=0;\r\n\t\tStat.canvasReCache=0;\r\n\t\tStat.renderSlow=false;\r\n\t\tStat.currentMemorySize=0;\r\n\t\tStat._fpsStr=null\r\n\t\tStat._canvasStr=null\r\n\t\tStat._canvas=null\r\n\t\tStat._ctx=null\r\n\t\tStat._timer=0;\r\n\t\tStat._count=0;\r\n\t\tStat._width=120;\r\n\t\tStat._height=100;\r\n\t\tStat._view=[];\r\n\t\tStat._fontSize=12;\r\n\t\tStat._first=false;\r\n\t\tStat._vx=NaN\r\n\t\treturn Stat;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>StringKey</code> 类用于存取字符串对应的数字。\r\n\t*/\r\n\t//class laya.utils.StringKey\r\n\tvar StringKey=(function(){\r\n\t\tfunction StringKey(){\r\n\t\t\tthis._strs={};\r\n\t\t\tthis._length=0;\r\n\t\t}\r\n\r\n\t\t__class(StringKey,'laya.utils.StringKey');\r\n\t\tvar __proto=StringKey.prototype;\r\n\t\t/**\r\n\t\t*添加一个字符。\r\n\t\t*@param str 字符，将作为key 存储相应生成的数字。\r\n\t\t*@return 此字符对应的数字。\r\n\t\t*/\r\n\t\t__proto.add=function(str){\r\n\t\t\tvar index=this._strs[str];\r\n\t\t\tif (index !=null)return index;\r\n\t\t\treturn this._strs[str]=this._length++;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定字符对应的数字。\r\n\t\t*@param str key 字符。\r\n\t\t*@return 此字符对应的数字。\r\n\t\t*/\r\n\t\t__proto.get=function(str){\r\n\t\t\tvar index=this._strs[str];\r\n\t\t\treturn index==null ?-1 :index;\r\n\t\t}\r\n\r\n\t\treturn StringKey;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Timer</code> 是时钟管理类。它是一个单例，可以通过 Laya.timer 访问。\r\n\t*/\r\n\t//class laya.utils.Timer\r\n\tvar Timer=(function(){\r\n\t\tvar TimerHandler;\r\n\t\tfunction Timer(){\r\n\t\t\tthis._delta=0;\r\n\t\t\tthis.scale=1;\r\n\t\t\tthis.currFrame=0;\r\n\t\t\tthis._mid=1;\r\n\t\t\tthis._map=[];\r\n\t\t\tthis._laters=[];\r\n\t\t\tthis._handlers=[];\r\n\t\t\tthis._temp=[];\r\n\t\t\tthis._count=0;\r\n\t\t\tthis.currTimer=Browser.now();\r\n\t\t\tthis._lastTimer=Browser.now();\r\n\t\t\tLaya.timer && Laya.timer.frameLoop(1,this,this._update);\r\n\t\t}\r\n\r\n\t\t__class(Timer,'laya.utils.Timer');\r\n\t\tvar __proto=Timer.prototype;\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*帧循环处理函数。\r\n\t\t*/\r\n\t\t__proto._update=function(){\r\n\t\t\tif (this.scale <=0){\r\n\t\t\t\tthis._lastTimer=Browser.now();\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar frame=this.currFrame=this.currFrame+this.scale;\r\n\t\t\tvar now=Browser.now();\r\n\t\t\tthis._delta=(now-this._lastTimer)*this.scale;\r\n\t\t\tvar timer=this.currTimer=this.currTimer+this._delta;\r\n\t\t\tthis._lastTimer=now;\r\n\t\t\tvar handlers=this._handlers;\r\n\t\t\tthis._count=0;\r\n\t\t\tfor (i=0,n=handlers.length;i < n;i++){\r\n\t\t\t\thandler=handlers[i];\r\n\t\t\t\tif (handler.method!==null){\r\n\t\t\t\t\tvar t=handler.userFrame ? frame :timer;\r\n\t\t\t\t\tif (t >=handler.exeTime){\r\n\t\t\t\t\t\tif (handler.repeat){\r\n\t\t\t\t\t\t\tif (t > handler.exeTime){\r\n\t\t\t\t\t\t\t\thandler.exeTime+=handler.delay;\r\n\t\t\t\t\t\t\t\thandler.run(false);\r\n\t\t\t\t\t\t\t\tif (t > handler.exeTime){\r\n\t\t\t\t\t\t\t\t\thandler.exeTime+=Math.ceil((t-handler.exeTime)/ handler.delay)*handler.delay;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\thandler.run(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._count++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this._count > 30 || frame % 200===0)this._clearHandlers();\r\n\t\t\tvar laters=this._laters;\r\n\t\t\tfor (var i=0,n=laters.length-1;i <=n;i++){\r\n\t\t\t\tvar handler=laters[i];\r\n\t\t\t\thandler.method!==null && handler.run(false);\r\n\t\t\t\tthis._recoverHandler(handler);\r\n\t\t\t\ti===n && (n=laters.length-1);\r\n\t\t\t}\r\n\t\t\tlaters.length=0;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._clearHandlers=function(){\r\n\t\t\tvar handlers=this._handlers;\r\n\t\t\tfor (var i=0,n=handlers.length;i < n;i++){\r\n\t\t\t\tvar handler=handlers[i];\r\n\t\t\t\tif (handler.method!==null)this._temp.push(handler);\r\n\t\t\t\telse this._recoverHandler(handler);\r\n\t\t\t}\r\n\t\t\tthis._handlers=this._temp;\r\n\t\t\tthis._temp=handlers;\r\n\t\t\tthis._temp.length=0;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._recoverHandler=function(handler){\r\n\t\t\tthis._map[handler.key]=null;\r\n\t\t\thandler.clear();\r\n\t\t\tTimer._pool.push(handler);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._create=function(useFrame,repeat,delay,caller,method,args,coverBefore){\r\n\t\t\tif (!delay){\r\n\t\t\t\tmethod.apply(caller,args);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (coverBefore){\r\n\t\t\t\tvar handler=this._getHandler(caller,method);\r\n\t\t\t\tif (handler){\r\n\t\t\t\t\thandler.repeat=repeat;\r\n\t\t\t\t\thandler.userFrame=useFrame;\r\n\t\t\t\t\thandler.delay=delay;\r\n\t\t\t\t\thandler.caller=caller;\r\n\t\t\t\t\thandler.method=method;\r\n\t\t\t\t\thandler.args=args;\r\n\t\t\t\t\thandler.exeTime=delay+(useFrame ? this.currFrame :this.currTimer);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\thandler=Timer._pool.length > 0 ? Timer._pool.pop():new TimerHandler();\r\n\t\t\thandler.repeat=repeat;\r\n\t\t\thandler.userFrame=useFrame;\r\n\t\t\thandler.delay=delay;\r\n\t\t\thandler.caller=caller;\r\n\t\t\thandler.method=method;\r\n\t\t\thandler.args=args;\r\n\t\t\thandler.exeTime=delay+(useFrame ? this.currFrame :this.currTimer);\r\n\t\t\tthis._indexHandler(handler);\r\n\t\t\tthis._handlers.push(handler);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._indexHandler=function(handler){\r\n\t\t\tvar caller=handler.caller;\r\n\t\t\tvar method=handler.method;\r\n\t\t\tvar cid=caller ? caller.$_GID || (caller.$_GID=Utils.getGID()):0;\r\n\t\t\tvar mid=method.$_TID || (method.$_TID=(this._mid++)*100000);\r\n\t\t\thandler.key=cid+mid;\r\n\t\t\tthis._map[handler.key]=handler;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时执行一次。\r\n\t\t*@param delay 延迟时间(单位为毫秒)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。\r\n\t\t*/\r\n\t\t__proto.once=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis._create(false,false,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时重复执行。\r\n\t\t*@param delay 间隔时间(单位毫秒)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。\r\n\t\t*/\r\n\t\t__proto.loop=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis._create(false,true,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时执行一次(基于帧率)。\r\n\t\t*@param delay 延迟几帧(单位为帧)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。\r\n\t\t*/\r\n\t\t__proto.frameOnce=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis._create(true,false,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时重复执行(基于帧率)。\r\n\t\t*@param delay 间隔几帧(单位为帧)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为 true 。\r\n\t\t*/\r\n\t\t__proto.frameLoop=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis._create(true,true,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**返回统计信息。*/\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn \"callLater:\"+this._laters.length+\" handlers:\"+this._handlers.length+\" pool:\"+Timer._pool.length;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理定时器。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*/\r\n\t\t__proto.clear=function(caller,method){\r\n\t\t\tvar handler=this._getHandler(caller,method);\r\n\t\t\tif (handler){\r\n\t\t\t\tthis._map[handler.key]=null;handler.key=0;\r\n\t\t\t\thandler.clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理对象身上的所有定时器。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*/\r\n\t\t__proto.clearAll=function(caller){\r\n\t\t\tfor (var i=0,n=this._handlers.length;i < n;i++){\r\n\t\t\t\tvar handler=this._handlers[i];\r\n\t\t\t\tif (handler.caller===caller){\r\n\t\t\t\t\tthis._map[handler.key]=null;handler.key=0;\r\n\t\t\t\t\thandler.clear();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getHandler=function(caller,method){\r\n\t\t\tvar cid=caller ? caller.$_GID || (caller.$_GID=Utils.getGID()):0;\r\n\t\t\tvar mid=method.$_TID || (method.$_TID=(this._mid++)*100000);\r\n\t\t\treturn this._map[cid+mid];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*延迟执行。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*@param args 回调参数。\r\n\t\t*/\r\n\t\t__proto.callLater=function(caller,method,args){\r\n\t\t\tif (this._getHandler(caller,method)==null){\r\n\t\t\t\tif (Timer._pool.length)\r\n\t\t\t\t\tvar handler=Timer._pool.pop();\r\n\t\t\t\telse handler=new TimerHandler();\r\n\t\t\t\thandler.caller=caller;\r\n\t\t\t\thandler.method=method;\r\n\t\t\t\thandler.args=args;\r\n\t\t\t\tthis._indexHandler(handler);\r\n\t\t\t\tthis._laters.push(handler);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*立即执行 callLater 。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 定时器回调函数。\r\n\t\t*/\r\n\t\t__proto.runCallLater=function(caller,method){\r\n\t\t\tvar handler=this._getHandler(caller,method);\r\n\t\t\tif (handler && handler.method !=null){\r\n\t\t\t\tthis._map[handler.key]=null;\r\n\t\t\t\thandler.run(true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*两帧之间的时间间隔,单位毫秒。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'delta',function(){\r\n\t\t\treturn this._delta;\r\n\t\t});\r\n\r\n\t\tTimer._pool=[];\r\n\t\tTimer.__init$=function(){\r\n\t\t\t/**@private */\r\n\t\t\t//class TimerHandler\r\n\t\t\tTimerHandler=(function(){\r\n\t\t\t\tfunction TimerHandler(){\r\n\t\t\t\t\tthis.key=0;\r\n\t\t\t\t\tthis.repeat=false;\r\n\t\t\t\t\tthis.delay=0;\r\n\t\t\t\t\tthis.userFrame=false;\r\n\t\t\t\t\tthis.exeTime=0;\r\n\t\t\t\t\tthis.caller=null;\r\n\t\t\t\t\tthis.method=null;\r\n\t\t\t\t\tthis.args=null;\r\n\t\t\t\t}\r\n\t\t\t\t__class(TimerHandler,'');\r\n\t\t\t\tvar __proto=TimerHandler.prototype;\r\n\t\t\t\t__proto.clear=function(){\r\n\t\t\t\t\tthis.caller=null;\r\n\t\t\t\t\tthis.method=null;\r\n\t\t\t\t\tthis.args=null;\r\n\t\t\t\t}\r\n\t\t\t\t__proto.run=function(widthClear){\r\n\t\t\t\t\tvar caller=this.caller;\r\n\t\t\t\t\tif (caller && caller.destroyed)return this.clear();\r\n\t\t\t\t\tvar method=this.method;\r\n\t\t\t\t\tvar args=this.args;\r\n\t\t\t\t\twidthClear && this.clear();\r\n\t\t\t\t\tif (method==null)return;\r\n\t\t\t\t\targs ? method.apply(caller,args):method.call(caller);\r\n\t\t\t\t}\r\n\t\t\t\treturn TimerHandler;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn Timer;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Tween</code> 是一个缓动类。使用实现目标对象属性的渐变。\r\n\t*/\r\n\t//class laya.utils.Tween\r\n\tvar Tween=(function(){\r\n\t\tfunction Tween(){\r\n\t\t\t//this._complete=null;\r\n\t\t\t//this._target=null;\r\n\t\t\t//this._ease=null;\r\n\t\t\t//this._props=null;\r\n\t\t\t//this._duration=0;\r\n\t\t\t//this._delay=0;\r\n\t\t\t//this._startTimer=0;\r\n\t\t\t//this._usedTimer=0;\r\n\t\t\t//this._usedPool=false;\r\n\t\t\tthis.gid=0;\r\n\t\t\t//this.update=null;\r\n\t\t}\r\n\r\n\t\t__class(Tween,'laya.utils.Tween');\r\n\t\tvar __proto=Tween.prototype;\r\n\t\t/**\r\n\t\t*缓动对象的props属性到目标值。\r\n\t\t*@param target 目标对象(即将更改属性值的对象)。\r\n\t\t*@param props 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n\t\t*@param duration 花费的时间，单位毫秒。\r\n\t\t*@param ease 缓动类型，默认为匀速运动。\r\n\t\t*@param complete 结束回调函数。\r\n\t\t*@param delay 延迟执行时间。\r\n\t\t*@param coverBefore 是否覆盖之前的缓动。\r\n\t\t*@return 返回Tween对象。\r\n\t\t*/\r\n\t\t__proto.to=function(target,props,duration,ease,complete,delay,coverBefore){\r\n\t\t\t(delay===void 0)&& (delay=0);\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=false);\r\n\t\t\treturn this._create(target,props,duration,ease,complete,delay,coverBefore,true,false,true);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从props属性，缓动到当前状态。\r\n\t\t*@param target 目标对象(即将更改属性值的对象)。\r\n\t\t*@param props 变化的属性列表，比如{x:100,y:20,ease:Ease.backOut,complete:Handler.create(this,onComplete),update:new Handler(this,onComplete)}。\r\n\t\t*@param duration 花费的时间，单位毫秒。\r\n\t\t*@param ease 缓动类型，默认为匀速运动。\r\n\t\t*@param complete 结束回调函数。\r\n\t\t*@param delay 延迟执行时间。\r\n\t\t*@param coverBefore 是否覆盖之前的缓动。\r\n\t\t*@return 返回Tween对象。\r\n\t\t*/\r\n\t\t__proto.from=function(target,props,duration,ease,complete,delay,coverBefore){\r\n\t\t\t(delay===void 0)&& (delay=0);\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=false);\r\n\t\t\treturn this._create(target,props,duration,ease,complete,delay,coverBefore,false,false,true);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._create=function(target,props,duration,ease,complete,delay,coverBefore,isTo,usePool,runNow){\r\n\t\t\tif (!target)throw new Error(\"Tween:target is null\");\r\n\t\t\tthis._target=target;\r\n\t\t\tthis._duration=duration;\r\n\t\t\tthis._ease=ease || props.ease || Tween.easeNone;\r\n\t\t\tthis._complete=complete || props.complete;\r\n\t\t\tthis._delay=delay;\r\n\t\t\tthis._props=[];\r\n\t\t\tthis._usedTimer=0;\r\n\t\t\tthis._startTimer=Browser.now();\r\n\t\t\tthis._usedPool=usePool;\r\n\t\t\tthis.update=props.update;\r\n\t\t\tvar gid=(target.$_GID || (target.$_GID=Utils.getGID()));\r\n\t\t\tif (!Tween.tweenMap[gid]){\r\n\t\t\t\tTween.tweenMap[gid]=[this];\r\n\t\t\t\t}else {\r\n\t\t\t\tif (coverBefore)Tween.clearTween(target);\r\n\t\t\t\tTween.tweenMap[gid].push(this);\r\n\t\t\t}\r\n\t\t\tif (runNow){\r\n\t\t\t\tif (delay <=0)this.firstStart(target,props,isTo);\r\n\t\t\t\telse Laya.timer.once(delay,this,this.firstStart,[target,props,isTo]);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._initProps(target,props,isTo);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.firstStart=function(target,props,isTo){\r\n\t\t\tthis._initProps(target,props,isTo);\r\n\t\t\tthis._beginLoop();\r\n\t\t}\r\n\r\n\t\t__proto._initProps=function(target,props,isTo){\r\n\t\t\tfor (var p in props){\r\n\t\t\t\tif ((typeof (target[p])=='number')){\r\n\t\t\t\t\tvar start=isTo ? target[p] :props[p];\r\n\t\t\t\t\tvar end=isTo ? props[p] :target[p];\r\n\t\t\t\t\tthis._props.push([p,start,end-start]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._beginLoop=function(){\r\n\t\t\tLaya.timer.frameLoop(1,this,this._doEase);\r\n\t\t}\r\n\r\n\t\t/**执行缓动**/\r\n\t\t__proto._doEase=function(){\r\n\t\t\tthis._updateEase(Browser.now());\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._updateEase=function(time){\r\n\t\t\tvar target=this._target;\r\n\t\t\tif (target.destroyed)return Tween.clearTween(target);\r\n\t\t\tvar usedTimer=this._usedTimer=time-this._startTimer-this._delay;\r\n\t\t\tif (usedTimer < 0)return;\r\n\t\t\tif (usedTimer >=this._duration)return this.complete();\r\n\t\t\tvar ratio=usedTimer > 0 ? this._ease(usedTimer,0,1,this._duration):0;\r\n\t\t\tvar props=this._props;\r\n\t\t\tfor (var i=0,n=props.length;i < n;i++){\r\n\t\t\t\tvar prop=props[i];\r\n\t\t\t\ttarget[prop[0]]=prop[1]+(ratio *prop[2]);\r\n\t\t\t}\r\n\t\t\tif (this.update)this.update.run();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*立即结束缓动并到终点。\r\n\t\t*/\r\n\t\t__proto.complete=function(){\r\n\t\t\tif (!this._target)return;\r\n\t\t\tvar target=this._target;\r\n\t\t\tvar props=this._props;\r\n\t\t\tvar handler=this._complete;\r\n\t\t\tfor (var i=0,n=props.length;i < n;i++){\r\n\t\t\t\tvar prop=props[i];\r\n\t\t\t\ttarget[prop[0]]=prop[1]+prop[2];\r\n\t\t\t}\r\n\t\t\tif (this.update)this.update.run();\r\n\t\t\tthis.clear();\r\n\t\t\thandler && handler.run();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*暂停缓动，可以通过resume或restart重新开始。\r\n\t\t*/\r\n\t\t__proto.pause=function(){\r\n\t\t\tLaya.timer.clear(this,this._beginLoop);\r\n\t\t\tLaya.timer.clear(this,this._doEase);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置开始时间。\r\n\t\t*@param startTime 开始时间。\r\n\t\t*/\r\n\t\t__proto.setStartTime=function(startTime){\r\n\t\t\tthis._startTimer=startTime;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止并清理当前缓动。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tif (this._target){\r\n\t\t\t\tthis._remove();\r\n\t\t\t\tthis._clear();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._clear=function(){\r\n\t\t\tthis.pause();\r\n\t\t\tLaya.timer.clear(this,this.firstStart);\r\n\t\t\tthis._complete=null;\r\n\t\t\tthis._target=null;\r\n\t\t\tthis._ease=null;\r\n\t\t\tthis._props=null;\r\n\t\t\tif (this._usedPool){\r\n\t\t\t\tthis.update=null;\r\n\t\t\t\tPool.recover(\"tween\",this);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**回收到对象池。*/\r\n\t\t__proto.recover=function(){\r\n\t\t\tthis._usedPool=true;\r\n\t\t\tthis._clear();\r\n\t\t}\r\n\r\n\t\t__proto._remove=function(){\r\n\t\t\tvar tweens=Tween.tweenMap[this._target.$_GID];\r\n\t\t\tif (tweens){\r\n\t\t\t\tfor (var i=0,n=tweens.length;i < n;i++){\r\n\t\t\t\t\tif (tweens[i]===this){\r\n\t\t\t\t\t\ttweens.splice(i,1);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*重新开始暂停的缓动。\r\n\t\t*/\r\n\t\t__proto.restart=function(){\r\n\t\t\tthis.pause();\r\n\t\t\tthis._usedTimer=0;\r\n\t\t\tthis._startTimer=Browser.now();\r\n\t\t\tvar props=this._props;\r\n\t\t\tfor (var i=0,n=props.length;i < n;i++){\r\n\t\t\t\tvar prop=props[i];\r\n\t\t\t\tthis._target[prop[0]]=prop[1];\r\n\t\t\t}\r\n\t\t\tLaya.timer.once(this._delay,this,this._beginLoop);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*恢复暂停的缓动。\r\n\t\t*/\r\n\t\t__proto.resume=function(){\r\n\t\t\tif (this._usedTimer >=this._duration)return;\r\n\t\t\tthis._startTimer=Browser.now()-this._usedTimer-this._delay;\r\n\t\t\tthis._beginLoop();\r\n\t\t}\r\n\r\n\t\t/**设置当前执行比例**/\r\n\t\t__getset(0,__proto,'progress',null,function(v){\r\n\t\t\tvar uTime=v *this._duration;\r\n\t\t\tthis._startTimer=Browser.now()-this._delay-uTime;\r\n\t\t});\r\n\r\n\t\tTween.to=function(target,props,duration,ease,complete,delay,coverBefore,autoRecover){\r\n\t\t\t(delay===void 0)&& (delay=0);\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=false);\r\n\t\t\t(autoRecover===void 0)&& (autoRecover=true);\r\n\t\t\treturn Pool.getItemByClass(\"tween\",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,true,autoRecover,true);\r\n\t\t}\r\n\r\n\t\tTween.from=function(target,props,duration,ease,complete,delay,coverBefore,autoRecover){\r\n\t\t\t(delay===void 0)&& (delay=0);\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=false);\r\n\t\t\t(autoRecover===void 0)&& (autoRecover=true);\r\n\t\t\treturn Pool.getItemByClass(\"tween\",Tween)._create(target,props,duration,ease,complete,delay,coverBefore,false,autoRecover,true);\r\n\t\t}\r\n\r\n\t\tTween.clearAll=function(target){\r\n\t\t\tif (!target || !target.$_GID)return;\r\n\t\t\tvar tweens=Tween.tweenMap[target.$_GID];\r\n\t\t\tif (tweens){\r\n\t\t\t\tfor (var i=0,n=tweens.length;i < n;i++){\r\n\t\t\t\t\ttweens[i]._clear();\r\n\t\t\t\t}\r\n\t\t\t\ttweens.length=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tTween.clear=function(tween){\r\n\t\t\ttween.clear();\r\n\t\t}\r\n\r\n\t\tTween.clearTween=function(target){\r\n\t\t\tTween.clearAll(target);\r\n\t\t}\r\n\r\n\t\tTween.easeNone=function(t,b,c,d){\r\n\t\t\treturn c *t / d+b;\r\n\t\t}\r\n\r\n\t\tTween.tweenMap={};\r\n\t\treturn Tween;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Utils</code> 是工具类。\r\n\t*/\r\n\t//class laya.utils.Utils\r\n\tvar Utils=(function(){\r\n\t\tfunction Utils(){};\r\n\t\t__class(Utils,'laya.utils.Utils');\r\n\t\tUtils.toRadian=function(angle){\r\n\t\t\treturn angle *Utils._pi2;\r\n\t\t}\r\n\r\n\t\tUtils.toAngle=function(radian){\r\n\t\t\treturn radian *Utils._pi;\r\n\t\t}\r\n\r\n\t\tUtils.toHexColor=function(color){\r\n\t\t\tif (color < 0 || isNaN(color))return null;\r\n\t\t\tvar str=color.toString(16);\r\n\t\t\twhile (str.length < 6)str=\"0\"+str;\r\n\t\t\treturn \"#\"+str;\r\n\t\t}\r\n\r\n\t\tUtils.getGID=function(){\r\n\t\t\treturn Utils._gid++;\r\n\t\t}\r\n\r\n\t\tUtils.concatArray=function(source,array){\r\n\t\t\tif (!array)return source;\r\n\t\t\tif (!source)return array;\r\n\t\t\tvar i=0,len=array.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tsource.push(array[i]);\r\n\t\t\t}\r\n\t\t\treturn source;\r\n\t\t}\r\n\r\n\t\tUtils.clearArray=function(array){\r\n\t\t\tif (!array)return array;\r\n\t\t\tarray.length=0;\r\n\t\t\treturn array;\r\n\t\t}\r\n\r\n\t\tUtils.copyArray=function(source,array){\r\n\t\t\tsource || (source=[]);\r\n\t\t\tif (!array)return source;\r\n\t\t\tsource.length=array.length;\r\n\t\t\tvar i=0,len=array.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tsource[i]=array[i];\r\n\t\t\t}\r\n\t\t\treturn source;\r\n\t\t}\r\n\r\n\t\tUtils.getGlobalRecByPoints=function(sprite,x0,y0,x1,y1){\r\n\t\t\tvar newLTPoint;\r\n\t\t\tnewLTPoint=new Point(x0,y0);\r\n\t\t\tnewLTPoint=sprite.localToGlobal(newLTPoint);\r\n\t\t\tvar newRBPoint;\r\n\t\t\tnewRBPoint=new Point(x1,y1);\r\n\t\t\tnewRBPoint=sprite.localToGlobal(newRBPoint);\r\n\t\t\treturn Rectangle._getWrapRec([newLTPoint.x,newLTPoint.y,newRBPoint.x,newRBPoint.y]);\r\n\t\t}\r\n\r\n\t\tUtils.getGlobalPosAndScale=function(sprite){\r\n\t\t\treturn Utils.getGlobalRecByPoints(sprite,0,0,1,1);\r\n\t\t}\r\n\r\n\t\tUtils.bind=function(fun,scope){\r\n\t\t\tvar rst=fun;\r\n\t\t\t/*__JS__ */rst=fun.bind(scope);;\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tUtils.measureText=function(txt,font){\r\n\t\t\treturn RunDriver.measureText(txt,font);\r\n\t\t}\r\n\r\n\t\tUtils.updateOrder=function(array){\r\n\t\t\tif (!array || array.length < 2)return false;\r\n\t\t\tvar i=1,j=0,len=array.length,key=NaN,c;\r\n\t\t\twhile (i < len){\r\n\t\t\t\tj=i;\r\n\t\t\t\tc=array[j];\r\n\t\t\t\tkey=array[j]._zOrder;\r\n\t\t\t\twhile (--j >-1){\r\n\t\t\t\t\tif (array[j]._zOrder > key)array[j+1]=array[j];\r\n\t\t\t\t\telse break ;\r\n\t\t\t\t}\r\n\t\t\t\tarray[j+1]=c;\r\n\t\t\t\ti++;\r\n\t\t\t};\r\n\t\t\tvar model=c.parent.model;\r\n\t\t\tif (model){\r\n\t\t\t\tif (model.updateZOrder){\r\n\t\t\t\t\tmodel.updateZOrder();\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\t\t\tmodel.removeChild(array[i].model);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\t\t\tmodel.addChildAt(array[i].model,i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tUtils.transPointList=function(points,x,y){\r\n\t\t\tvar i=0,len=points.length;\r\n\t\t\tfor (i=0;i < len;i+=2){\r\n\t\t\t\tpoints[i]+=x;\r\n\t\t\t\tpoints[i+1]+=y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tUtils.parseInt=function(str,radix){\r\n\t\t\t(radix===void 0)&& (radix=0);\r\n\t\t\tvar result=Browser.window.parseInt(str,radix);\r\n\t\t\tif (isNaN(result))return 0;\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tUtils.getFileExtension=function(path){\r\n\t\t\tUtils._extReg.lastIndex=path.lastIndexOf(\".\");\r\n\t\t\tvar result=Utils._extReg.exec(path);\r\n\t\t\tif (result && result.length > 1){\r\n\t\t\t\treturn result[1].toLowerCase();\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tUtils._gid=1;\r\n\t\tUtils._pi=180 / Math.PI;\r\n\t\tUtils._pi2=Math.PI / 180;\r\n\t\tUtils._extReg=/\\.(\\w+)\\??/g;\r\n\t\tUtils.parseXMLFromString=function(value){\r\n\t\t\tvar rst;\r\n\t\t\tvalue=value.replace(/>\\s+</g,'><');\r\n\t\t\t/*__JS__ */rst=(new DOMParser()).parseFromString(value,'text/xml');\r\n\t\t\tif (rst.firstChild.textContent.indexOf(\"This page contains the following errors\")>-1){\r\n\t\t\t\tthrow new Error(rst.firstChild.firstChild.textContent);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\treturn Utils;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.utils.VectorGraphManager\r\n\tvar VectorGraphManager=(function(){\r\n\t\tfunction VectorGraphManager(){\r\n\t\t\tthis.useDic={};\r\n\t\t\tthis.shapeDic={};\r\n\t\t\tthis.shapeLineDic={};\r\n\t\t\tthis._id=0;\r\n\t\t\tthis._checkKey=false;\r\n\t\t\tthis._freeIdArray=[];\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\tCacheManger.regCacheByFunction(Utils.bind(this.startDispose,this),Utils.bind(this.getCacheList,this));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(VectorGraphManager,'laya.utils.VectorGraphManager');\r\n\t\tvar __proto=VectorGraphManager.prototype;\r\n\t\t/**\r\n\t\t*得到个空闲的ID\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getId=function(){\r\n\t\t\treturn this._id++;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*添加一个图形到列表中\r\n\t\t*@param id\r\n\t\t*@param shape\r\n\t\t*/\r\n\t\t__proto.addShape=function(id,shape){\r\n\t\t\tthis.shapeDic[id]=shape;\r\n\t\t\tif (!this.useDic[id]){\r\n\t\t\t\tthis.useDic[id]=true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*添加一个线图形到列表中\r\n\t\t*@param id\r\n\t\t*@param Line\r\n\t\t*/\r\n\t\t__proto.addLine=function(id,Line){\r\n\t\t\tthis.shapeLineDic[id]=Line;\r\n\t\t\tif (!this.shapeLineDic[id]){\r\n\t\t\t\tthis.shapeLineDic[id]=true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测一个对象是否在使用中\r\n\t\t*@param id\r\n\t\t*/\r\n\t\t__proto.getShape=function(id){\r\n\t\t\tif (this._checkKey){\r\n\t\t\t\tif (this.useDic[id] !=null){\r\n\t\t\t\t\tthis.useDic[id]=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*删除一个图形对象\r\n\t\t*@param id\r\n\t\t*/\r\n\t\t__proto.deleteShape=function(id){\r\n\t\t\tif (this.shapeDic[id]){\r\n\t\t\t\tthis.shapeDic[id]=null;\r\n\t\t\t\tdelete this.shapeDic[id];\r\n\t\t\t}\r\n\t\t\tif (this.shapeLineDic[id]){\r\n\t\t\t\tthis.shapeLineDic[id]=null;\r\n\t\t\t\tdelete this.shapeLineDic[id];\r\n\t\t\t}\r\n\t\t\tif (this.useDic[id] !=null){\r\n\t\t\t\tdelete this.useDic[id];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*得到缓存列表\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getCacheList=function(){\r\n\t\t\tvar str;\r\n\t\t\tvar list=[];\r\n\t\t\tfor (str in this.shapeDic){\r\n\t\t\t\tlist.push(this.shapeDic[str]);\r\n\t\t\t}\r\n\t\t\tfor (str in this.shapeLineDic){\r\n\t\t\t\tlist.push(this.shapeLineDic[str]);\r\n\t\t\t}\r\n\t\t\treturn list;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*开始清理状态，准备销毁\r\n\t\t*/\r\n\t\t__proto.startDispose=function(key){\r\n\t\t\tvar str;\r\n\t\t\tfor (str in this.useDic){\r\n\t\t\t\tthis.useDic[str]=false;\r\n\t\t\t}\r\n\t\t\tthis._checkKey=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*确认销毁\r\n\t\t*/\r\n\t\t__proto.endDispose=function(){\r\n\t\t\tif (this._checkKey){\r\n\t\t\t\tvar str;\r\n\t\t\t\tfor (str in this.useDic){\r\n\t\t\t\t\tif (!this.useDic[str]){\r\n\t\t\t\t\t\tthis.deleteShape(str);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._checkKey=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tVectorGraphManager.getInstance=function(){\r\n\t\t\treturn VectorGraphManager.instance=VectorGraphManager.instance|| new VectorGraphManager();\r\n\t\t}\r\n\r\n\t\tVectorGraphManager.instance=null\r\n\t\treturn VectorGraphManager;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.utils.WordText\r\n\tvar WordText=(function(){\r\n\t\tfunction WordText(){\r\n\t\t\tthis.id=NaN;\r\n\t\t\tthis.save=[];\r\n\t\t\tthis.toUpperCase=null;\r\n\t\t\tthis.changed=false;\r\n\t\t\tthis._text=null;\r\n\t\t}\r\n\r\n\t\t__class(WordText,'laya.utils.WordText');\r\n\t\tvar __proto=WordText.prototype;\r\n\t\t__proto.setText=function(txt){\r\n\t\t\tthis.changed=true;\r\n\t\t\tthis._text=txt;\r\n\t\t}\r\n\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this._text;\r\n\t\t}\r\n\r\n\t\t__proto.charCodeAt=function(i){\r\n\t\t\treturn this._text ? this._text.charCodeAt(i):NaN;\r\n\t\t}\r\n\r\n\t\t__proto.charAt=function(i){\r\n\t\t\treturn this._text ? this._text.charAt(i):null;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'length',function(){\r\n\t\t\treturn this._text ? this._text.length :0;\r\n\t\t});\r\n\r\n\t\treturn WordText;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*<code>Node</code> 类用于创建节点对象，节点是最基本的元素。\r\n\t*/\r\n\t//class laya.display.Node extends laya.events.EventDispatcher\r\n\tvar Node=(function(_super){\r\n\t\tfunction Node(){\r\n\t\t\tthis.name=\"\";\r\n\t\t\tthis.destroyed=false;\r\n\t\t\tthis._displayedInStage=false;\r\n\t\t\tthis._parent=null;\r\n\t\t\tthis.model=null;\r\n\t\t\tNode.__super.call(this);\r\n\t\t\tthis._childs=Node.ARRAY_EMPTY;\r\n\t\t\tthis.timer=Laya.timer;\r\n\t\t\tthis._$P=Node.PROP_EMPTY;\r\n\t\t\tthis.model=Render.isConchNode ? /*__JS__ */new ConchNode():null;\r\n\t\t}\r\n\r\n\t\t__class(Node,'laya.display.Node',_super);\r\n\t\tvar __proto=Node.prototype;\r\n\t\t/**\r\n\t\t*<p>销毁此对象。</p>\r\n\t\t*@param destroyChild 是否同时销毁子节点，若值为true,则销毁子节点，否则不销毁子节点。\r\n\t\t*/\r\n\t\t__proto.destroy=function(destroyChild){\r\n\t\t\t(destroyChild===void 0)&& (destroyChild=true);\r\n\t\t\tthis.destroyed=true;\r\n\t\t\tthis._parent && this._parent.removeChild(this);\r\n\t\t\tif (this._childs){\r\n\t\t\t\tif (destroyChild)this.destroyChildren();\r\n\t\t\t\telse this.removeChildren();\r\n\t\t\t}\r\n\t\t\tthis._childs=null;\r\n\t\t\tthis._$P=null;\r\n\t\t\tthis.offAll();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*销毁所有子对象，不销毁自己本身。\r\n\t\t*/\r\n\t\t__proto.destroyChildren=function(){\r\n\t\t\tif (this._childs){\r\n\t\t\t\tfor (var i=this._childs.length-1;i >-1;i--){\r\n\t\t\t\t\tthis._childs[i].destroy(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*添加子节点。\r\n\t\t*@param node 节点对象\r\n\t\t*@return 返回添加的节点\r\n\t\t*/\r\n\t\t__proto.addChild=function(node){\r\n\t\t\tif (this.destroyed || node===this)return node;\r\n\t\t\tif (node._parent===this){\r\n\t\t\t\tthis._childs.splice(this.getChildIndex(node),1);\r\n\t\t\t\tthis._childs.push(node);\r\n\t\t\t\tif (this.model){\r\n\t\t\t\t\tthis.model.removeChild(node.model);\r\n\t\t\t\t\tthis.model.addChildAt(node.model,this._childs.length-1);\r\n\t\t\t\t}\r\n\t\t\t\tthis._childChanged();\r\n\t\t\t\t}else {\r\n\t\t\t\tnode.parent && node.parent.removeChild(node);\r\n\t\t\t\tthis._childs===Node.ARRAY_EMPTY && (this._childs=[]);\r\n\t\t\t\tthis._childs.push(node);\r\n\t\t\t\tthis.model && this.model.addChildAt(node.model,this._childs.length-1);\r\n\t\t\t\tnode.parent=this;\r\n\t\t\t\tthis._childChanged();\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*批量增加子节点\r\n\t\t*@param ...args 无数子节点。\r\n\t\t*/\r\n\t\t__proto.addChildren=function(__args){\r\n\t\t\tvar args=arguments;\r\n\t\t\tvar i=0,n=args.length;\r\n\t\t\twhile (i < n){\r\n\t\t\t\tthis.addChild(args[i++]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*添加子节点到指定的索引位置。\r\n\t\t*@param node 节点对象。\r\n\t\t*@param index 索引位置。\r\n\t\t*@return 返回添加的节点。\r\n\t\t*/\r\n\t\t__proto.addChildAt=function(node,index){\r\n\t\t\tif (this.destroyed || node===this)return node;\r\n\t\t\tif (index >=0 && index <=this._childs.length){\r\n\t\t\t\tif (node._parent===this){\r\n\t\t\t\t\tvar oldIndex=this.getChildIndex(node);\r\n\t\t\t\t\tthis._childs.splice(oldIndex,1);\r\n\t\t\t\t\tthis._childs.splice(index,0,node);\r\n\t\t\t\t\tif (this.model){\r\n\t\t\t\t\t\tthis.model.removeChild(node.model);\r\n\t\t\t\t\t\tthis.model.addChildAt(node.model,index);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._childChanged();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tnode.parent && node.parent.removeChild(node);\r\n\t\t\t\t\tthis._childs===Node.ARRAY_EMPTY && (this._childs=[]);\r\n\t\t\t\t\tthis._childs.splice(index,0,node);\r\n\t\t\t\t\tthis.model && this.model.addChildAt(node.model,index);\r\n\t\t\t\t\tnode.parent=this;\r\n\t\t\t\t}\r\n\t\t\t\treturn node;\r\n\t\t\t\t}else {\r\n\t\t\t\tthrow new Error(\"appendChildAt:The index is out of bounds\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据子节点对象，获取子节点的索引位置。\r\n\t\t*@param node 子节点。\r\n\t\t*@return 子节点所在的索引位置。\r\n\t\t*/\r\n\t\t__proto.getChildIndex=function(node){\r\n\t\t\treturn this._childs.indexOf(node);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据子节点的名字，获取子节点对象。\r\n\t\t*@param name 子节点的名字。\r\n\t\t*@return 节点对象。\r\n\t\t*/\r\n\t\t__proto.getChildByName=function(name){\r\n\t\t\tvar nodes=this._childs;\r\n\t\t\tfor (var i=0,n=nodes.length;i < n;i++){\r\n\t\t\t\tvar node=nodes[i];\r\n\t\t\t\tif (node.name===name)return node;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._get$P=function(key){\r\n\t\t\treturn this._$P[key];\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._set$P=function(key,value){\r\n\t\t\tif (!this.destroyed){\r\n\t\t\t\tthis._$P===Node.PROP_EMPTY && (this._$P={});\r\n\t\t\t\tthis._$P[key]=value;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据子节点的索引位置，获取子节点对象。\r\n\t\t*@param index 索引位置\r\n\t\t*@return 子节点\r\n\t\t*/\r\n\t\t__proto.getChildAt=function(index){\r\n\t\t\treturn this._childs[index];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置子节点的索引位置。\r\n\t\t*@param node 子节点。\r\n\t\t*@param index 新的索引。\r\n\t\t*@return 返回子节点本身。\r\n\t\t*/\r\n\t\t__proto.setChildIndex=function(node,index){\r\n\t\t\tvar childs=this._childs;\r\n\t\t\tif (index < 0 || index >=childs.length){\r\n\t\t\t\tthrow new Error(\"setChildIndex:The index is out of bounds.\");\r\n\t\t\t};\r\n\t\t\tvar oldIndex=this.getChildIndex(node);\r\n\t\t\tif (oldIndex < 0)throw new Error(\"setChildIndex:node is must child of this object.\");\r\n\t\t\tchilds.splice(oldIndex,1);\r\n\t\t\tchilds.splice(index,0,node);\r\n\t\t\tif (this.model){\r\n\t\t\t\tthis.model.removeChild(node.model);\r\n\t\t\t\tthis.model.addChildAt(node.model,index);\r\n\t\t\t}\r\n\t\t\tthis._childChanged();\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*子节点发生改变。\r\n\t\t*@param child 子节点。\r\n\t\t*/\r\n\t\t__proto._childChanged=function(child){}\r\n\t\t/**\r\n\t\t*删除子节点。\r\n\t\t*@param node 子节点\r\n\t\t*@return 被删除的节点\r\n\t\t*/\r\n\t\t__proto.removeChild=function(node){\r\n\t\t\tif (!this._childs)return node;\r\n\t\t\tvar index=this._childs.indexOf(node);\r\n\t\t\treturn this.removeChildAt(index);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从父容器删除自己，如已经被删除不会抛出异常。\r\n\t\t*@return 当前节点（ Node ）对象。\r\n\t\t*/\r\n\t\t__proto.removeSelf=function(){\r\n\t\t\tthis._parent && this._parent.removeChild(this);\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据子节点名字删除对应的子节点对象，如果找不到不会抛出异常。\r\n\t\t*@param name 对象名字。\r\n\t\t*@return 查找到的节点（ Node ）对象。\r\n\t\t*/\r\n\t\t__proto.removeChildByName=function(name){\r\n\t\t\tvar node=this.getChildByName(name);\r\n\t\t\tnode && this.removeChild(node);\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据子节点索引位置，删除对应的子节点对象。\r\n\t\t*@param index 节点索引位置。\r\n\t\t*@return 被删除的节点。\r\n\t\t*/\r\n\t\t__proto.removeChildAt=function(index){\r\n\t\t\tvar node=this.getChildAt(index);\r\n\t\t\tif (node){\r\n\t\t\t\tthis._childs.splice(index,1);\r\n\t\t\t\tthis.model && this.model.removeChild(node.model);\r\n\t\t\t\tnode.parent=null;\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*删除指定索引区间的所有子对象。\r\n\t\t*@param beginIndex 开始索引。\r\n\t\t*@param endIndex 结束索引。\r\n\t\t*@return 当前节点对象。\r\n\t\t*/\r\n\t\t__proto.removeChildren=function(beginIndex,endIndex){\r\n\t\t\t(beginIndex===void 0)&& (beginIndex=0);\r\n\t\t\t(endIndex===void 0)&& (endIndex=0x7fffffff);\r\n\t\t\tif (this._childs && this._childs.length > 0){\r\n\t\t\t\tvar childs=this._childs;\r\n\t\t\t\tif (beginIndex===0 && endIndex >=n){\r\n\t\t\t\t\tvar arr=childs;\r\n\t\t\t\t\tthis._childs=Node.ARRAY_EMPTY;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tarr=childs.splice(beginIndex,endIndex-beginIndex);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i=0,n=arr.length;i < n;i++){\r\n\t\t\t\t\tarr[i].parent=null;\r\n\t\t\t\t\tthis.model && this.model.removeChild(arr[i].model);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*替换子节点。\r\n\t\t*@internal 将传入的新节点对象替换到已有子节点索引位置处。\r\n\t\t*@param newNode 新节点。\r\n\t\t*@param oldNode 老节点。\r\n\t\t*@return 返回新节点。\r\n\t\t*/\r\n\t\t__proto.replaceChild=function(newNode,oldNode){\r\n\t\t\tvar index=this._childs.indexOf(oldNode);\r\n\t\t\tif (index >-1){\r\n\t\t\t\tthis._childs.splice(index,1,newNode);\r\n\t\t\t\tif (this.model){\r\n\t\t\t\t\tthis.model.removeChild(oldNode.model);\r\n\t\t\t\t\tthis.model.addChildAt(newNode.model,index);\r\n\t\t\t\t}\r\n\t\t\t\toldNode.parent=null;\r\n\t\t\t\tnewNode.parent=this;\r\n\t\t\t\treturn newNode;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setDisplay=function(value){\r\n\t\t\tif (this._displayedInStage!==value){\r\n\t\t\t\tthis._displayedInStage=value;\r\n\t\t\t\tif (value)this.event(/*laya.events.Event.DISPLAY*/\"display\");\r\n\t\t\t\telse this.event(/*laya.events.Event.UNDISPLAY*/\"undisplay\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*设置指定节点对象是否可见(是否在渲染列表中)。\r\n\t\t*@param node 节点。\r\n\t\t*@param display 是否可见。\r\n\t\t*/\r\n\t\t__proto._displayChild=function(node,display){\r\n\t\t\tvar childs=node._childs;\r\n\t\t\tif (childs){\r\n\t\t\t\tfor (var i=childs.length-1;i >-1;i--){\r\n\t\t\t\t\tvar child=childs[i];\r\n\t\t\t\t\tchild._setDisplay(display);\r\n\t\t\t\t\tchild._childs.length && this._displayChild(child,display);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnode._setDisplay(display);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*当前容器是否包含 <code>node</code> 节点。\r\n\t\t*@param node 某一个节点 <code>Node</code>。\r\n\t\t*@return 一个布尔值表示是否包含<code>node</code>节点。\r\n\t\t*/\r\n\t\t__proto.contains=function(node){\r\n\t\t\tif (node===this)return true;\r\n\t\t\twhile (node){\r\n\t\t\t\tif (node.parent===this)return true;\r\n\t\t\t\tnode=node.parent;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时重复执行某函数。\r\n\t\t*@param delay 间隔时间(单位毫秒)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 结束时的回调方法。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为true。\r\n\t\t*/\r\n\t\t__proto.timerLoop=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis.timer._create(false,true,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时执行某函数一次。\r\n\t\t*@param delay 延迟时间(单位毫秒)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 结束时的回调方法。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为true。\r\n\t\t*/\r\n\t\t__proto.timerOnce=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis.timer._create(false,false,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时重复执行某函数(基于帧率)。\r\n\t\t*@param delay 间隔几帧(单位为帧)。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 结束时的回调方法。\r\n\t\t*@param args 回调参数。\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为true。\r\n\t\t*/\r\n\t\t__proto.frameLoop=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis.timer._create(true,true,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定时执行一次某函数(基于帧率)。\r\n\t\t*@param delay 延迟几帧(单位为帧)。\r\n\t\t*@param caller 执行域(this)\r\n\t\t*@param method 结束时的回调方法\r\n\t\t*@param args 回调参数\r\n\t\t*@param coverBefore 是否覆盖之前的延迟执行，默认为true\r\n\t\t*/\r\n\t\t__proto.frameOnce=function(delay,caller,method,args,coverBefore){\r\n\t\t\t(coverBefore===void 0)&& (coverBefore=true);\r\n\t\t\tthis.timer._create(true,false,delay,caller,method,args,coverBefore);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理定时器。\r\n\t\t*@param caller 执行域(this)。\r\n\t\t*@param method 结束时的回调方法。\r\n\t\t*/\r\n\t\t__proto.clearTimer=function(caller,method){\r\n\t\t\tthis.timer.clear(caller,method);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*子对象数量。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'numChildren',function(){\r\n\t\t\treturn this._childs.length;\r\n\t\t});\r\n\r\n\t\t/**父节点。*/\r\n\t\t__getset(0,__proto,'parent',function(){\r\n\t\t\treturn this._parent;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._parent!==value){\r\n\t\t\t\tif (value){\r\n\t\t\t\t\tthis._parent=value;\r\n\t\t\t\t\tthis.event(/*laya.events.Event.ADDED*/\"added\");\r\n\t\t\t\t\tvalue.displayedInStage && this._displayChild(this,true);\r\n\t\t\t\t\tvalue._childChanged(this);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis.event(/*laya.events.Event.REMOVED*/\"removed\");\r\n\t\t\t\t\tthis._parent._childChanged();\r\n\t\t\t\t\tthis._displayChild(this,false);\r\n\t\t\t\t\tthis._parent=value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**表示是否在显示列表中显示。是否在显示渲染列表中。*/\r\n\t\t__getset(0,__proto,'displayedInStage',function(){\r\n\t\t\treturn this._displayedInStage;\r\n\t\t});\r\n\r\n\t\tNode.ARRAY_EMPTY=[];\r\n\t\tNode.PROP_EMPTY={};\r\n\t\treturn Node;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>CSSStyle</code> 类是元素CSS样式定义类。\r\n\t*/\r\n\t//class laya.display.css.CSSStyle extends laya.display.css.Style\r\n\tvar CSSStyle=(function(_super){\r\n\t\tfunction CSSStyle(ower){\r\n\t\t\tthis._bgground=null;\r\n\t\t\tthis._border=null;\r\n\t\t\t//this._ower=null;\r\n\t\t\tthis._rect=null;\r\n\t\t\tthis.lineHeight=0;\r\n\t\t\tCSSStyle.__super.call(this);\r\n\t\t\tthis._padding=CSSStyle._PADDING;\r\n\t\t\tthis._spacing=CSSStyle._SPACING;\r\n\t\t\tthis._aligns=CSSStyle._ALIGNS;\r\n\t\t\tthis._font=Font.EMPTY;\r\n\t\t\tthis._ower=ower;\r\n\t\t}\r\n\r\n\t\t__class(CSSStyle,'laya.display.css.CSSStyle',_super);\r\n\t\tvar __proto=CSSStyle.prototype;\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._ower=null;\r\n\t\t\tthis._font=null;\r\n\t\t\tthis._rect=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*复制传入的 CSSStyle 属性值。\r\n\t\t*@param src 待复制的 CSSStyle 对象。\r\n\t\t*/\r\n\t\t__proto.inherit=function(src){\r\n\t\t\tthis._font=src._font;\r\n\t\t\tthis._spacing=src._spacing===CSSStyle._SPACING ? CSSStyle._SPACING :src._spacing.slice();\r\n\t\t\tthis.lineHeight=src.lineHeight;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._widthAuto=function(){\r\n\t\t\treturn (this._type & 0x40000)!==0;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.widthed=function(sprite){\r\n\t\t\treturn (this._type & 0x8)!=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._calculation=function(type,value){\r\n\t\t\tif (value.indexOf('%')< 0)return false;\r\n\t\t\tvar ower=this._ower;\r\n\t\t\tvar parent=ower.parent;\r\n\t\t\tvar rect=this._rect;\r\n\t\t\tfunction getValue (pw,w,nums){\r\n\t\t\t\treturn (pw *nums[0]+w *nums[1]+nums[2]);\r\n\t\t\t}\r\n\t\t\tfunction onParentResize (type){\r\n\t\t\t\tvar pw=parent.width,w=ower.width;\r\n\t\t\t\trect.width && (ower.width=getValue(pw,w,rect.width));\r\n\t\t\t\trect.height && (ower.height=getValue(pw,w,rect.height));\r\n\t\t\t\trect.left && (ower.x=getValue(pw,w,rect.left));\r\n\t\t\t\trect.top && (ower.y=getValue(pw,w,rect.top));\r\n\t\t\t}\r\n\t\t\tif (rect===null){\r\n\t\t\t\tparent._getCSSStyle()._type |=0x80000;\r\n\t\t\t\tparent.on(/*laya.events.Event.RESIZE*/\"resize\",this,onParentResize);\r\n\t\t\t\tthis._rect=rect={input:{}};\r\n\t\t\t};\r\n\t\t\tvar nums=value.split(' ');\r\n\t\t\tnums[0]=parseFloat(nums[0])/ 100;\r\n\t\t\tif (nums.length==1)\r\n\t\t\t\tnums[1]=nums[2]=0;\r\n\t\t\telse {\r\n\t\t\t\tnums[1]=parseFloat(nums[1])/ 100;\r\n\t\t\t\tnums[2]=parseFloat(nums[2]);\r\n\t\t\t}\r\n\t\t\trect[type]=nums;\r\n\t\t\trect.input[type]=value;\r\n\t\t\tonParentResize(type);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*是否已设置高度。\r\n\t\t*@param sprite 显示对象 Sprite。\r\n\t\t*@return 一个Boolean 表示是否已设置高度。\r\n\t\t*/\r\n\t\t__proto.heighted=function(sprite){\r\n\t\t\treturn (this._type & 0x2000)!=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置宽高。\r\n\t\t*@param w 宽度。\r\n\t\t*@param h 高度。\r\n\t\t*/\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tvar ower=this._ower;\r\n\t\t\tvar resize=false;\r\n\t\t\tif (w!==-1 && w !=this._ower.width){\r\n\t\t\t\tthis._type |=0x8;\r\n\t\t\t\tthis._ower.width=w;\r\n\t\t\t\tresize=true;\r\n\t\t\t}\r\n\t\t\tif (h!==-1 && h !=this._ower.height){\r\n\t\t\t\tthis._type |=0x2000;\r\n\t\t\t\tthis._ower.height=h;\r\n\t\t\t\tresize=true;\r\n\t\t\t}\r\n\t\t\tif (resize){\r\n\t\t\t\tower._layoutLater();\r\n\t\t\t\t(this._type & 0x80000)&& ower.event(/*laya.events.Event.RESIZE*/\"resize\",this);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getAlign=function(){\r\n\t\t\treturn this._aligns[0];\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getValign=function(){\r\n\t\t\treturn this._aligns[1];\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getCssFloat=function(){\r\n\t\t\treturn (this._type & 0x8000)!=0 ? 0x8000 :0;\r\n\t\t}\r\n\r\n\t\t__proto._createFont=function(){\r\n\t\t\treturn (this._type & 0x1000)? this._font :(this._type |=0x1000,this._font=new Font(this._font));\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.render=function(sprite,context,x,y){\r\n\t\t\tvar w=sprite.width;\r\n\t\t\tvar h=sprite.height;\r\n\t\t\tx-=sprite.pivotX;\r\n\t\t\ty-=sprite.pivotY;\r\n\t\t\tthis._bgground && this._bgground.color !=null && context.ctx.fillRect(x,y,w,h,this._bgground.color);\r\n\t\t\tthis._border && this._border.color && context.drawRect(x,y,w,h,this._border.color.strColor,this._border.size);\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.getCSSStyle=function(){\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置 CSS 样式字符串。\r\n\t\t*@param text CSS样式字符串。\r\n\t\t*/\r\n\t\t__proto.cssText=function(text){\r\n\t\t\tthis.attrs(CSSStyle.parseOneCSS(text,';'));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据传入的属性名、属性值列表，设置此对象的属性值。\r\n\t\t*@param attrs 属性名与属性值列表。\r\n\t\t*/\r\n\t\t__proto.attrs=function(attrs){\r\n\t\t\tif (attrs){\r\n\t\t\t\tfor (var i=0,n=attrs.length;i < n;i++){\r\n\t\t\t\t\tvar attr=attrs[i];\r\n\t\t\t\t\tthis[attr[0]]=attr[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.setTransform=function(value){\r\n\t\t\t(value==='none')? (this._tf=Style._TF_EMPTY):this.attrs(CSSStyle.parseOneCSS(value,','));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定义 X 轴、Y 轴移动转换。\r\n\t\t*@param x X 轴平移量。\r\n\t\t*@param y Y 轴平移量。\r\n\t\t*/\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.translateX=x;\r\n\t\t\tthis._tf.translateY=y;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*定义 缩放转换。\r\n\t\t*@param x X 轴缩放值。\r\n\t\t*@param y Y 轴缩放值。\r\n\t\t*/\r\n\t\t__proto.scale=function(x,y){\r\n\t\t\tthis._tf===Style._TF_EMPTY && (this._tf=new TransformInfo());\r\n\t\t\tthis._tf.scaleX=x;\r\n\t\t\tthis._tf.scaleY=y;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._enableLayout=function(){\r\n\t\t\treturn (this._type & 0x2)===0 && (this._type & 0x4)===0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*是否显示为块级元素。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'block',_super.prototype._$get_block,function(value){\r\n\t\t\tvalue ? (this._type |=0x1):(this._type &=(~0x1));\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*垂直对齐方式。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'valign',function(){\r\n\t\t\treturn CSSStyle._valigndef[this._aligns[1]];\r\n\t\t\t},function(value){\r\n\t\t\tthis._aligns===CSSStyle._ALIGNS && (this._aligns=[0,0,0]);\r\n\t\t\tthis._aligns[1]=CSSStyle._valigndef[value];\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*高度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',null,function(h){\r\n\t\t\tthis._type |=0x2000;\r\n\t\t\tif ((typeof h=='string')){\r\n\t\t\t\tif (this._calculation(\"height\",h))return;\r\n\t\t\t\th=parseInt(h);\r\n\t\t\t}\r\n\t\t\tthis.size(-1,h);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*宽度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',null,function(w){\r\n\t\t\tthis._type |=0x8;\r\n\t\t\tif ((typeof w=='string')){\r\n\t\t\t\tvar offset=w.indexOf('auto');\r\n\t\t\t\tif (offset >=0){\r\n\t\t\t\t\tthis._type |=0x40000;\r\n\t\t\t\t\tw=w.substr(0,offset);\r\n\t\t\t\t}\r\n\t\t\t\tif (this._calculation(\"width\",w))return;\r\n\t\t\t\tw=parseInt(w);\r\n\t\t\t}\r\n\t\t\tthis.size(w,-1);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字体粗细。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'fontWeight',function(){\r\n\t\t\treturn this._font.weight;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().weight=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示左边距。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'left',null,function(value){\r\n\t\t\tvar ower=this._ower;\r\n\t\t\tif (((typeof value=='string'))){\r\n\t\t\t\tif (value===\"center\")\r\n\t\t\t\t\tvalue=\"50% -50% 0\";\r\n\t\t\t\telse if (value===\"right\")\r\n\t\t\t\tvalue=\"100% -100% 0\";\r\n\t\t\t\tif (this._calculation(\"left\",value))return;\r\n\t\t\t\tvalue=parseInt(value);\r\n\t\t\t}\r\n\t\t\tower.x=value;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'_translate',null,function(value){\r\n\t\t\tthis.translate(value[0],value[1]);\r\n\t\t});\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__getset(0,__proto,'absolute',function(){\r\n\t\t\treturn (this._type & 0x4)!==0;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示上边距。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'top',null,function(value){\r\n\t\t\tvar ower=this._ower;\r\n\t\t\tif (((typeof value=='string'))){\r\n\t\t\t\tif (value===\"middle\")\r\n\t\t\t\t\tvalue=\"50% -50% 0\";\r\n\t\t\t\telse if (value===\"bottom\")\r\n\t\t\t\tvalue=\"100% -100% 0\";\r\n\t\t\t\tif (this._calculation(\"top\",value))return;\r\n\t\t\t\tvalue=parseInt(value);\r\n\t\t\t}\r\n\t\t\tower.y=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*水平对齐方式。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'align',function(){\r\n\t\t\treturn CSSStyle._aligndef[this._aligns[0]];\r\n\t\t\t},function(value){\r\n\t\t\tthis._aligns===CSSStyle._ALIGNS && (this._aligns=[0,0,0]);\r\n\t\t\tthis._aligns[0]=CSSStyle._aligndef[value];\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否加粗。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'bold',function(){\r\n\t\t\treturn this._font.bold;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().bold=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*边距信息。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'padding',function(){\r\n\t\t\treturn this._padding;\r\n\t\t\t},function(value){\r\n\t\t\tthis._padding=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*行间距。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'leading',function(){\r\n\t\t\treturn this._spacing[1];\r\n\t\t\t},function(d){\r\n\t\t\t((typeof d=='string'))&& (d=parseInt(d+\"\"));\r\n\t\t\tthis._spacing===CSSStyle._SPACING && (this._spacing=[0,0]);\r\n\t\t\tthis._spacing[1]=d;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否是行元素。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'lineElement',function(){\r\n\t\t\treturn (this._type & 0x10000)!=0;\r\n\t\t\t},function(value){\r\n\t\t\tvalue ? (this._type |=0x10000):(this._type &=(~0x10000));\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*浮动方向。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'cssFloat',function(){\r\n\t\t\treturn (this._type & 0x8000)!=0 ? \"right\" :\"left\";\r\n\t\t\t},function(value){\r\n\t\t\tthis.lineElement=false;\r\n\t\t\tvalue===\"right\" ? (this._type |=0x8000):(this._type &=(~0x8000));\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*添加到文本的修饰。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'textDecoration',function(){\r\n\t\t\treturn this._font.decoration;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().decoration=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置如何处理元素内的空白。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'whiteSpace',function(){\r\n\t\t\treturn (this._type & 0x20000)? \"nowrap\" :\"\";\r\n\t\t\t},function(type){\r\n\t\t\ttype===\"nowrap\" && (this._type |=0x20000);\r\n\t\t\ttype===\"none\" && (this._type &=~0x20000);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'background',null,function(value){\r\n\t\t\tif (!value){\r\n\t\t\t\tthis._bgground=null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._bgground || (this._bgground={});\r\n\t\t\tthis._bgground.color=value;\r\n\t\t\tthis._ower.model && this._ower.model.bgColor(value);\r\n\t\t\tthis._type |=0x4000;\r\n\t\t\tthis._ower._renderType |=/*laya.renders.RenderSprite.STYLE*/0x80;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否换行。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'wordWrap',function(){\r\n\t\t\treturn (this._type & 0x20000)===0;\r\n\t\t\t},function(value){\r\n\t\t\tvalue ? (this._type &=~0x20000):(this._type |=0x20000);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字体颜色。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'color',function(){\r\n\t\t\treturn this._font.color;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().color=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>指定文本字段是否是密码文本字段。</p>\r\n\t\t*如果此属性的值为 true，则文本字段被视为密码文本字段，并使用星号而不是实际字符来隐藏输入的字符。如果为 false，则不会将文本字段视为密码文本字段。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'password',function(){\r\n\t\t\treturn this._font.password;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().password=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*背景颜色。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'backgroundColor',function(){\r\n\t\t\treturn this._bgground ? this._bgground.color :null;\r\n\t\t\t},function(value){\r\n\t\t\tif (value==='none')this._bgground=null;\r\n\t\t\telse (this._bgground || (this._bgground={}),this._bgground.color=value);\r\n\t\t\tthis._ower.model && this._ower.model.bgColor(value);\r\n\t\t\tthis._ower._renderType |=/*laya.renders.RenderSprite.STYLE*/0x80;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字体信息。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'font',function(){\r\n\t\t\treturn this._font.toString();\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().set(value);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*文本的粗细。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'weight',null,function(value){\r\n\t\t\tthis._createFont().weight=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*间距。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'letterSpacing',function(){\r\n\t\t\treturn this._spacing[0];\r\n\t\t\t},function(d){\r\n\t\t\t((typeof d=='string'))&& (d=parseInt(d+\"\"));\r\n\t\t\tthis._spacing===CSSStyle._SPACING && (this._spacing=[0,0]);\r\n\t\t\tthis._spacing[0]=d;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字体大小。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'fontSize',function(){\r\n\t\t\treturn this._font.size;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().size=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否为斜体。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'italic',function(){\r\n\t\t\treturn this._font.italic;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().italic=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字体系列。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'fontFamily',function(){\r\n\t\t\treturn this._font.family;\r\n\t\t\t},function(value){\r\n\t\t\tthis._createFont().family=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>描边宽度（以像素为单位）。</p>\r\n\t\t*默认值0，表示不描边。\r\n\t\t*@default 0\r\n\t\t*/\r\n\t\t__getset(0,__proto,'stroke',function(){\r\n\t\t\treturn this._font.stroke[0];\r\n\t\t\t},function(value){\r\n\t\t\tif (this._createFont().stroke===Font._STROKE)this._font.stroke=[0,\"#000000\"];\r\n\t\t\tthis._font.stroke[0]=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>描边颜色，以字符串表示。</p>\r\n\t\t*@default \"#000000\";\r\n\t\t*/\r\n\t\t__getset(0,__proto,'strokeColor',function(){\r\n\t\t\treturn this._font.stroke[1];\r\n\t\t\t},function(value){\r\n\t\t\tif (this._createFont().stroke===Font._STROKE)this._font.stroke=[0,\"#000000\"];\r\n\t\t\tthis._font.stroke[1]=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*边框属性，比如border=\"5px solid red\"\r\n\t\t*/\r\n\t\t__getset(0,__proto,'border',function(){\r\n\t\t\treturn this._border ? this._border.value :\"\";\r\n\t\t\t},function(value){\r\n\t\t\tif (value=='none'){\r\n\t\t\t\tthis._border=null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._border || (this._border={});\r\n\t\t\tthis._border.value=value;\r\n\t\t\tvar values=value.split(' ');\r\n\t\t\tthis._border.color=Color.create(values[values.length-1]);\r\n\t\t\tif (values.length==1){\r\n\t\t\t\tthis._border.size=1;\r\n\t\t\t\tthis._border.type='solid';\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar i=0;\r\n\t\t\tif (values[0].indexOf('px')> 0){\r\n\t\t\t\tthis._border.size=parseInt(values[0]);\r\n\t\t\t\ti++;\r\n\t\t\t}else this._border.size=1;\r\n\t\t\tthis._border.type=values[i];\r\n\t\t\tthis._ower._renderType |=/*laya.renders.RenderSprite.STYLE*/0x80;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*边框的颜色。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'borderColor',function(){\r\n\t\t\treturn (this._border && this._border.color)? this._border.color.strColor :null;\r\n\t\t\t},function(value){\r\n\t\t\tif (!value){\r\n\t\t\t\tthis._border=null;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._border || (this._border={size:1,type:'solid'});\r\n\t\t\tthis._border.color=(value==null)? null :Color.create(value);\r\n\t\t\tthis._ower.model && this._ower.model.border(this._border.color.strColor);\r\n\t\t\tthis._ower._renderType |=/*laya.renders.RenderSprite.STYLE*/0x80;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*元素的定位类型。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'position',function(){\r\n\t\t\treturn (this._type & 0x4)? \"absolute\" :\"\";\r\n\t\t\t},function(value){\r\n\t\t\tvalue==\"absolute\" ? (this._type |=0x4):(this._type &=~0x4);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*规定元素应该生成的框的类型。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'display',null,function(value){\r\n\t\t\tswitch (value){\r\n\t\t\t\tcase '':\r\n\t\t\t\t\tthis._type &=~0x2;\r\n\t\t\t\t\tthis.visible=true;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'none':\r\n\t\t\t\t\tthis._type |=0x2;\r\n\t\t\t\t\tthis.visible=false;\r\n\t\t\t\t\tthis._ower._layoutLater();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__getset(0,__proto,'paddingLeft',function(){\r\n\t\t\treturn this.padding[3];\r\n\t\t});\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__getset(0,__proto,'paddingTop',function(){\r\n\t\t\treturn this.padding[0];\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'_scale',null,function(value){\r\n\t\t\tthis._ower.scale(value[0],value[1]);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'_rotate',null,function(value){\r\n\t\t\tthis._ower.rotation=value;\r\n\t\t});\r\n\r\n\t\tCSSStyle.parseOneCSS=function(text,clipWord){\r\n\t\t\tvar out=[];\r\n\t\t\tvar attrs=text.split(clipWord);\r\n\t\t\tvar valueArray;\r\n\t\t\tfor (var i=0,n=attrs.length;i < n;i++){\r\n\t\t\t\tvar attr=attrs[i];\r\n\t\t\t\tvar ofs=attr.indexOf(':');\r\n\t\t\t\tvar name=attr.substr(0,ofs).replace(/^\\s+|\\s+$/g,'');\r\n\t\t\t\tif (name.length==0)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tvar value=attr.substr(ofs+1).replace(/^\\s+|\\s+$/g,'');\r\n\t\t\t\tvar one=[name,value];\r\n\t\t\t\tswitch (name){\r\n\t\t\t\t\tcase 'italic':\r\n\t\t\t\t\tcase 'bold':\r\n\t\t\t\t\t\tone[1]=value==\"true\";\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'line-height':\r\n\t\t\t\t\t\tone[0]='lineHeight';\r\n\t\t\t\t\t\tone[1]=parseInt(value);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'font-size':\r\n\t\t\t\t\t\tone[0]='fontSize';\r\n\t\t\t\t\t\tone[1]=parseInt(value);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'padding':\r\n\t\t\t\t\t\tvalueArray=value.split(' ');\r\n\t\t\t\t\t\tvalueArray.length > 1 || (valueArray[1]=valueArray[2]=valueArray[3]=valueArray[0]);\r\n\t\t\t\t\t\tone[1]=[parseInt(valueArray[0]),parseInt(valueArray[1]),parseInt(valueArray[2]),parseInt(valueArray[3])];\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'rotate':\r\n\t\t\t\t\t\tone[0]=\"_rotate\";\r\n\t\t\t\t\t\tone[1]=parseFloat(value);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'scale':\r\n\t\t\t\t\t\tvalueArray=value.split(' ');\r\n\t\t\t\t\t\tone[0]=\"_scale\";\r\n\t\t\t\t\t\tone[1]=[parseFloat(valueArray[0]),parseFloat(valueArray[1])];\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase 'translate':\r\n\t\t\t\t\t\tvalueArray=value.split(' ');\r\n\t\t\t\t\t\tone[0]=\"_translate\";\r\n\t\t\t\t\t\tone[1]=[parseInt(valueArray[0]),parseInt(valueArray[1])];\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\t(one[0]=CSSStyle._CSSTOVALUE[name])|| (one[0]=name);\r\n\t\t\t\t\t}\r\n\t\t\t\tout.push(one);\r\n\t\t\t}\r\n\t\t\treturn out;\r\n\t\t}\r\n\r\n\t\tCSSStyle.parseCSS=function(text,uri){\r\n\t\t\tvar one;\r\n\t\t\twhile ((one=CSSStyle._parseCSSRegExp.exec(text))!=null){\r\n\t\t\t\tCSSStyle.styleSheets[one[1]]=CSSStyle.parseOneCSS(one[2],';');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tCSSStyle.EMPTY=new CSSStyle(null);\r\n\t\tCSSStyle._CSSTOVALUE={'letter-spacing':'letterSpacing','line-spacing':'lineSpacing','white-space':'whiteSpace','line-height':'lineHeight','scale-x':'scaleX','scale-y':'scaleY','translate-x':'translateX','translate-y':'translateY','font-family':'fontFamily','font-weight':'fontWeight','vertical-align':'valign','text-decoration':'textDecoration','background-color':'backgroundColor','border-color':'borderColor','float':'cssFloat'};\r\n\t\tCSSStyle._parseCSSRegExp=new RegExp(\"([\\.\\#]\\\\w+)\\\\s*{([\\\\s\\\\S]*?)}\",\"g\");\r\n\t\tCSSStyle._aligndef={'left':0,'center':1,'right':2,0:'left',1:'center',2:'right'};\r\n\t\tCSSStyle._valigndef={'top':0,'middle':1,'bottom':2,0:'top',1:'middle',2:'bottom'};\r\n\t\tCSSStyle.styleSheets={};\r\n\t\tCSSStyle.ALIGN_CENTER=1;\r\n\t\tCSSStyle.ALIGN_RIGHT=2;\r\n\t\tCSSStyle.VALIGN_MIDDLE=1;\r\n\t\tCSSStyle.VALIGN_BOTTOM=2;\r\n\t\tCSSStyle._CSS_BLOCK=0x1;\r\n\t\tCSSStyle._DISPLAY_NONE=0x2;\r\n\t\tCSSStyle._ABSOLUTE=0x4;\r\n\t\tCSSStyle._WIDTH_SET=0x8;\r\n\t\tCSSStyle._PADDING=[0,0,0,0];\r\n\t\tCSSStyle._RECT=[-1,-1,-1,-1];\r\n\t\tCSSStyle._SPACING=[0,0];\r\n\t\tCSSStyle._ALIGNS=[0,0,0];\r\n\t\tCSSStyle.ADDLAYOUTED=0x200;\r\n\t\tCSSStyle._NEWFONT=0x1000;\r\n\t\tCSSStyle._HEIGHT_SET=0x2000;\r\n\t\tCSSStyle._BACKGROUND_SET=0x4000;\r\n\t\tCSSStyle._FLOAT_RIGHT=0x8000;\r\n\t\tCSSStyle._LINE_ELEMENT=0x10000;\r\n\t\tCSSStyle._NOWARP=0x20000;\r\n\t\tCSSStyle._WIDTHAUTO=0x40000;\r\n\t\tCSSStyle._LISTERRESZIE=0x80000;\r\n\t\treturn CSSStyle;\r\n\t})(Style)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*使用Audio标签播放声音\r\n\t*/\r\n\t//class laya.media.h5audio.AudioSound extends laya.events.EventDispatcher\r\n\tvar AudioSound=(function(_super){\r\n\t\tfunction AudioSound(){\r\n\t\t\tthis.url=null;\r\n\t\t\tthis.audio=null;\r\n\t\t\tthis.loaded=false;\r\n\t\t\tAudioSound.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(AudioSound,'laya.media.h5audio.AudioSound',_super);\r\n\t\tvar __proto=AudioSound.prototype;\r\n\t\t/**\r\n\t\t*释放声音\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.dispose=function(){\r\n\t\t\tvar ad=AudioSound._audioCache[this.url];\r\n\t\t\tif (ad){\r\n\t\t\t\tad.src=\"\";\r\n\t\t\t\tdelete AudioSound._audioCache[this.url];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载声音\r\n\t\t*@param url\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.load=function(url){\r\n\t\t\tthis.url=url;\r\n\t\t\tvar ad=AudioSound._audioCache[url];\r\n\t\t\tif (ad && ad.readyState >=2){\r\n\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!ad){\r\n\t\t\t\tad=Browser.createElement(\"audio\");\r\n\t\t\t\tad.src=url;\r\n\t\t\t\tAudioSound._audioCache[url]=ad;\r\n\t\t\t}\r\n\t\t\tad.addEventListener(\"canplaythrough\",onLoaded);\r\n\t\t\tad.addEventListener(\"error\",onErr);\r\n\t\t\tvar me=this;\r\n\t\t\tfunction onLoaded (){\r\n\t\t\t\toffs();\r\n\t\t\t\tme.loaded=true;\r\n\t\t\t\tme.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t}\r\n\t\t\tfunction onErr (){\r\n\t\t\t\toffs();\r\n\t\t\t\tme.event(/*laya.events.Event.ERROR*/\"error\");\r\n\t\t\t}\r\n\t\t\tfunction offs (){\r\n\t\t\t\tad.removeEventListener(\"canplaythrough\",onLoaded);\r\n\t\t\t\tad.removeEventListener(\"error\",onErr);\r\n\t\t\t}\r\n\t\t\tthis.audio=ad;\r\n\t\t\tif (ad.load){\r\n\t\t\t\tad.load();\r\n\t\t\t\t}else {\r\n\t\t\t\tonErr();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放声音\r\n\t\t*@param startTime 起始时间\r\n\t\t*@param loops 循环次数\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.play=function(startTime,loops){\r\n\t\t\t(startTime===void 0)&& (startTime=0);\r\n\t\t\t(loops===void 0)&& (loops=0);\r\n\t\t\tif (!this.url)return null;\r\n\t\t\tvar ad;\r\n\t\t\tad=AudioSound._audioCache[this.url];\r\n\t\t\tif (!ad)return null;\r\n\t\t\tvar tAd;\r\n\t\t\ttAd=Pool.getItem(\"audio:\"+this.url);\r\n\t\t\ttAd=tAd?tAd:ad.cloneNode(true);\r\n\t\t\tvar channel=new AudioSoundChannel(tAd);\r\n\t\t\tchannel.url=this.url;\r\n\t\t\tchannel.loops=loops;\r\n\t\t\tchannel.startTime=startTime;\r\n\t\t\tchannel.play();\r\n\t\t\tSoundManager.addChannel(channel);\r\n\t\t\treturn channel;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取总时间。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\tvar ad;\r\n\t\t\tad=AudioSound._audioCache[this.url];\r\n\t\t\tif (!ad)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn ad.duration;\r\n\t\t});\r\n\r\n\t\tAudioSound._audioCache={};\r\n\t\treturn AudioSound;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>SoundChannel</code> 用来控制程序中的声音。\r\n\t*/\r\n\t//class laya.media.SoundChannel extends laya.events.EventDispatcher\r\n\tvar SoundChannel=(function(_super){\r\n\t\tfunction SoundChannel(){\r\n\t\t\tthis.url=null;\r\n\t\t\tthis.loops=0;\r\n\t\t\tthis.startTime=NaN;\r\n\t\t\tthis.isStopped=false;\r\n\t\t\tthis.completeHandler=null;\r\n\t\t\tSoundChannel.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(SoundChannel,'laya.media.SoundChannel',_super);\r\n\t\tvar __proto=SoundChannel.prototype;\r\n\t\t/**\r\n\t\t*播放。\r\n\t\t*/\r\n\t\t__proto.play=function(){}\r\n\t\t/**\r\n\t\t*停止。\r\n\t\t*/\r\n\t\t__proto.stop=function(){}\r\n\t\t/**\r\n\t\t*private\r\n\t\t*/\r\n\t\t__proto.__runComplete=function(handler){\r\n\t\t\tif (handler){\r\n\t\t\t\thandler.run();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*音量。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'volume',function(){\r\n\t\t\treturn 1;\r\n\t\t\t},function(v){\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取当前播放时间。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'position',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取总时间。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\treturn SoundChannel;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>Sound</code> 类是用来播放控制声音的类。\r\n\t*/\r\n\t//class laya.media.Sound extends laya.events.EventDispatcher\r\n\tvar Sound=(function(_super){\r\n\t\tfunction Sound(){Sound.__super.call(this);;\r\n\t\t};\r\n\r\n\t\t__class(Sound,'laya.media.Sound',_super);\r\n\t\tvar __proto=Sound.prototype;\r\n\t\t/**\r\n\t\t*加载声音。\r\n\t\t*@param url 地址。\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.load=function(url){}\r\n\t\t/**\r\n\t\t*播放声音。\r\n\t\t*@param startTime 开始时间,单位秒\r\n\t\t*@param loops 循环次数,0表示一直循环\r\n\t\t*@return 声道 SoundChannel 对象。\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.play=function(startTime,loops){\r\n\t\t\t(startTime===void 0)&& (startTime=0);\r\n\t\t\t(loops===void 0)&& (loops=0);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*释放声音资源。\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.dispose=function(){}\r\n\t\t/**\r\n\t\t*获取总时间。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\treturn Sound;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*web audio api方式播放声音\r\n\t*/\r\n\t//class laya.media.webaudio.WebAudioSound extends laya.events.EventDispatcher\r\n\tvar WebAudioSound=(function(_super){\r\n\t\tfunction WebAudioSound(){\r\n\t\t\tthis.url=null;\r\n\t\t\tthis.loaded=false;\r\n\t\t\tthis.data=null;\r\n\t\t\tthis.audioBuffer=null;\r\n\t\t\tthis.__toPlays=null;\r\n\t\t\tWebAudioSound.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(WebAudioSound,'laya.media.webaudio.WebAudioSound',_super);\r\n\t\tvar __proto=WebAudioSound.prototype;\r\n\t\t/**\r\n\t\t*加载声音\r\n\t\t*@param url\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.load=function(url){\r\n\t\t\tvar me=this;\r\n\t\t\tthis.url=url;\r\n\t\t\tthis.audioBuffer=WebAudioSound._dataCache[url];\r\n\t\t\tif (this.audioBuffer){\r\n\t\t\t\tthis._loaded(this.audioBuffer);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tWebAudioSound.e.on(\"loaded:\"+url,this,this._loaded);\r\n\t\t\tWebAudioSound.e.on(\"err:\"+url,this,this._err);\r\n\t\t\tif (WebAudioSound.__loadingSound[url]){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tWebAudioSound.__loadingSound[url]=true;\r\n\t\t\tvar request=new Browser.window.XMLHttpRequest();\r\n\t\t\trequest.open(\"GET\",url,true);\r\n\t\t\trequest.responseType=\"arraybuffer\";\r\n\t\t\trequest.onload=function (){\r\n\t\t\t\tme.data=request.response;\r\n\t\t\t\tWebAudioSound.buffs.push({\"buffer\":me.data,\"url\":me.url});\r\n\t\t\t\tWebAudioSound.decode();\r\n\t\t\t};\r\n\t\t\trequest.onerror=function (e){\r\n\t\t\t\tme._err();\r\n\t\t\t}\r\n\t\t\trequest.send();\r\n\t\t}\r\n\r\n\t\t__proto._err=function(){\r\n\t\t\tthis._removeLoadEvents();\r\n\t\t\tWebAudioSound.__loadingSound[this.url]=false;\r\n\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\");\r\n\t\t}\r\n\r\n\t\t__proto._loaded=function(audioBuffer){\r\n\t\t\tthis._removeLoadEvents();\r\n\t\t\tthis.audioBuffer=audioBuffer;\r\n\t\t\tWebAudioSound._dataCache[this.url]=this.audioBuffer;\r\n\t\t\tthis.loaded=true;\r\n\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t}\r\n\r\n\t\t__proto._removeLoadEvents=function(){\r\n\t\t\tWebAudioSound.e.off(\"loaded:\"+this.url,this,this._loaded);\r\n\t\t\tWebAudioSound.e.off(\"err:\"+this.url,this,this._err);\r\n\t\t}\r\n\r\n\t\t__proto.__playAfterLoaded=function(){\r\n\t\t\tif (!this.__toPlays)return;\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tvar toPlays;\r\n\t\t\ttoPlays=this.__toPlays;\r\n\t\t\tlen=toPlays.length;\r\n\t\t\tvar tParams;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\ttParams=toPlays[i];\r\n\t\t\t\tif(tParams[2]&&!(tParams [2]).isStopped){\r\n\t\t\t\t\tthis.play(tParams[0],tParams[1],tParams[2]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.__toPlays.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放声音\r\n\t\t*@param startTime 起始时间\r\n\t\t*@param loops 循环次数\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.play=function(startTime,loops,channel){\r\n\t\t\t(startTime===void 0)&& (startTime=0);\r\n\t\t\t(loops===void 0)&& (loops=0);\r\n\t\t\tchannel=channel ? channel :new WebAudioSoundChannel();\r\n\t\t\tif (!this.audioBuffer){\r\n\t\t\t\tif (this.url){\r\n\t\t\t\t\tif (!this.__toPlays)this.__toPlays=[];\r\n\t\t\t\t\tthis.__toPlays.push([startTime,loops,channel]);\r\n\t\t\t\t\tthis.once(/*laya.events.Event.COMPLETE*/\"complete\",this,this.__playAfterLoaded);\r\n\t\t\t\t\tthis.load(this.url);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchannel.url=this.url;\r\n\t\t\tchannel.loops=loops;\r\n\t\t\tchannel[\"audioBuffer\"]=this.audioBuffer;\r\n\t\t\tchannel.startTime=startTime;\r\n\t\t\tchannel.play();\r\n\t\t\tSoundManager.addChannel(channel);\r\n\t\t\treturn channel;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tdelete WebAudioSound._dataCache[this.url];\r\n\t\t\tdelete WebAudioSound.__loadingSound[this.url];\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\tif (this.audioBuffer){\r\n\t\t\t\treturn this.audioBuffer.duration;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\tWebAudioSound.decode=function(){\r\n\t\t\tif (WebAudioSound.buffs.length <=0 || WebAudioSound.isDecoding){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tWebAudioSound.isDecoding=true;\r\n\t\t\tWebAudioSound.tInfo=WebAudioSound.buffs.shift();\r\n\t\t\tWebAudioSound.ctx.decodeAudioData(WebAudioSound.tInfo[\"buffer\"],WebAudioSound._done,WebAudioSound._fail);\r\n\t\t}\r\n\r\n\t\tWebAudioSound._done=function(audioBuffer){\r\n\t\t\tWebAudioSound.e.event(\"loaded:\"+WebAudioSound.tInfo.url,audioBuffer);\r\n\t\t\tWebAudioSound.isDecoding=false;\r\n\t\t\tWebAudioSound.decode();\r\n\t\t}\r\n\r\n\t\tWebAudioSound._fail=function(){\r\n\t\t\tWebAudioSound.e.event(\"err:\"+WebAudioSound.tInfo.url,null);\r\n\t\t\tWebAudioSound.isDecoding=false;\r\n\t\t\tWebAudioSound.decode();\r\n\t\t}\r\n\r\n\t\tWebAudioSound._playEmptySound=function(){\r\n\t\t\tif (WebAudioSound.ctx==null){return;};\r\n\t\t\tvar source=WebAudioSound.ctx.createBufferSource();\r\n\t\t\tsource.buffer=WebAudioSound._miniBuffer;\r\n\t\t\tsource.connect(WebAudioSound.ctx.destination);\r\n\t\t\tsource.start(0,0,0);\r\n\t\t}\r\n\r\n\t\tWebAudioSound._unlock=function(){\r\n\t\t\tif (WebAudioSound._unlocked){return;}\r\n\t\t\t\tWebAudioSound._playEmptySound();\r\n\t\t\tif (WebAudioSound.ctx.state==\"running\"){\r\n\t\t\t\tBrowser.document.removeEventListener(\"mousedown\",WebAudioSound._unlock,true);\r\n\t\t\t\tBrowser.document.removeEventListener(\"touchend\",WebAudioSound._unlock,true);\r\n\t\t\t\tWebAudioSound._unlocked=true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebAudioSound.initWebAudio=function(){\r\n\t\t\tif (WebAudioSound.ctx.state !=\"running\"){\r\n\t\t\t\tWebAudioSound._unlock();\r\n\t\t\t\tBrowser.document.addEventListener(\"mousedown\",WebAudioSound._unlock,true);\r\n\t\t\t\tBrowser.document.addEventListener(\"touchend\",WebAudioSound._unlock,true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebAudioSound._dataCache={};\r\n\t\tWebAudioSound.buffs=[];\r\n\t\tWebAudioSound.isDecoding=false;\r\n\t\tWebAudioSound._unlocked=false;\r\n\t\tWebAudioSound.tInfo=null\r\n\t\tWebAudioSound.__loadingSound={};\r\n\t\t__static(WebAudioSound,\r\n\t\t['window',function(){return this.window=Browser.window;},'webAudioEnabled',function(){return this.webAudioEnabled=WebAudioSound.window[\"AudioContext\"] || WebAudioSound.window[\"webkitAudioContext\"] || WebAudioSound.window[\"mozAudioContext\"];},'ctx',function(){return this.ctx=WebAudioSound.webAudioEnabled ? new (WebAudioSound.window[\"AudioContext\"] || WebAudioSound.window[\"webkitAudioContext\"] || WebAudioSound.window[\"mozAudioContext\"])():undefined;},'_miniBuffer',function(){return this._miniBuffer=WebAudioSound.ctx.createBuffer(1,1,22050);},'e',function(){return this.e=new EventDispatcher();}\r\n\t\t]);\r\n\t\treturn WebAudioSound;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>HttpRequest</code> 通过 HTTP 协议传送或接收 XML 及其他数据。\r\n\t*/\r\n\t//class laya.net.HttpRequest extends laya.events.EventDispatcher\r\n\tvar HttpRequest=(function(_super){\r\n\t\tfunction HttpRequest(){\r\n\t\t\tthis._responseType=null;\r\n\t\t\tthis._data=null;\r\n\t\t\tHttpRequest.__super.call(this);\r\n\t\t\tthis._http=new Browser.window.XMLHttpRequest();\r\n\t\t}\r\n\r\n\t\t__class(HttpRequest,'laya.net.HttpRequest',_super);\r\n\t\tvar __proto=HttpRequest.prototype;\r\n\t\t/**\r\n\t\t*发送请求。\r\n\t\t*@param url 请求的地址。\r\n\t\t*@param data 发送的数据，可选。\r\n\t\t*@param method 发送数据方式，值为“get”或“post”，默认为 “get”方式。\r\n\t\t*@param responseType 返回消息类型，可设置为\"text\"，\"json\"，\"xml\",\"arraybuffer\"。\r\n\t\t*@param headers 头信息，key value数组，比如[\"Content-Type\",\"application/json\"]。\r\n\t\t*/\r\n\t\t__proto.send=function(url,data,method,responseType,headers){\r\n\t\t\t(method===void 0)&& (method=\"get\");\r\n\t\t\t(responseType===void 0)&& (responseType=\"text\");\r\n\t\t\tthis._responseType=responseType;\r\n\t\t\tthis._data=null;\r\n\t\t\tvar _this=this;\r\n\t\t\tvar http=this._http;\r\n\t\t\thttp.open(method,url,true);\r\n\t\t\tif (headers){\r\n\t\t\t\tfor (var i=0;i < headers.length;i++){\r\n\t\t\t\t\thttp.setRequestHeader(headers[i++],headers[i]);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tif (!data || (typeof data=='string'))http.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\r\n\t\t\t\telse http.setRequestHeader(\"Content-Type\",\"application/json\");\r\n\t\t\t}\r\n\t\t\thttp.responseType=responseType!==\"arraybuffer\" ? \"text\" :\"arraybuffer\";\r\n\t\t\thttp.onerror=function (e){\r\n\t\t\t\t_this._onError(e);\r\n\t\t\t}\r\n\t\t\thttp.onabort=function (e){\r\n\t\t\t\t_this._onAbort(e);\r\n\t\t\t}\r\n\t\t\thttp.onprogress=function (e){\r\n\t\t\t\t_this._onProgress(e);\r\n\t\t\t}\r\n\t\t\thttp.onload=function (e){\r\n\t\t\t\t_this._onLoad(e);\r\n\t\t\t}\r\n\t\t\thttp.send(data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求进度的侦听处理函数。\r\n\t\t*@param e 事件对象。\r\n\t\t*/\r\n\t\t__proto._onProgress=function(e){\r\n\t\t\tif (e && e.lengthComputable)this.event(/*laya.events.Event.PROGRESS*/\"progress\",e.loaded / e.total);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求中断的侦听处理函数。\r\n\t\t*@param e 事件对象。\r\n\t\t*/\r\n\t\t__proto._onAbort=function(e){\r\n\t\t\tthis.error(\"Request was aborted by user\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求出错侦的听处理函数。\r\n\t\t*@param e 事件对象。\r\n\t\t*/\r\n\t\t__proto._onError=function(e){\r\n\t\t\tthis.error(\"Request failed Status:\"+this._http.status+\" text:\"+this._http.statusText);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求消息返回的侦听处理函数。\r\n\t\t*@param e 事件对象。\r\n\t\t*/\r\n\t\t__proto._onLoad=function(e){\r\n\t\t\tvar http=this._http;\r\n\t\t\tvar status=http.status!==undefined ? http.status :200;\r\n\t\t\tif (status===200 || status===204 || status===0){\r\n\t\t\t\tthis.complete();\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.error(\"[\"+http.status+\"]\"+http.statusText+\":\"+http.responseURL);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求错误的处理函数。\r\n\t\t*@param message 错误信息。\r\n\t\t*/\r\n\t\t__proto.error=function(message){\r\n\t\t\tthis.clear();\r\n\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\",message);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*请求成功完成的处理函数。\r\n\t\t*/\r\n\t\t__proto.complete=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tvar flag=true;\r\n\t\t\ttry {\r\n\t\t\t\tif (this._responseType===\"json\"){\r\n\t\t\t\t\tthis._data=JSON.parse(this._http.responseText);\r\n\t\t\t\t\t}else if (this._responseType===\"xml\"){\r\n\t\t\t\t\tthis._data=Utils.parseXMLFromString(this._http.responseText);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._data=this._http.response || this._http.responseText;\r\n\t\t\t\t}\r\n\t\t\t\t}catch (e){\r\n\t\t\t\tflag=false;\r\n\t\t\t\tthis.error(e.message);\r\n\t\t\t}\r\n\t\t\tflag && this.event(/*laya.events.Event.COMPLETE*/\"complete\",(this._data instanceof Array)? [this._data] :this._data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*清除当前请求。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tvar http=this._http;\r\n\t\t\thttp.onerror=http.onabort=http.onprogress=http.onload=null;\r\n\t\t}\r\n\r\n\t\t/**请求的地址。*/\r\n\t\t__getset(0,__proto,'url',function(){\r\n\t\t\treturn this._http.responseURL;\r\n\t\t});\r\n\r\n\t\t/**原生XMLHttpRequest引用*/\r\n\t\t__getset(0,__proto,'http',function(){\r\n\t\t\treturn this._http;\r\n\t\t});\r\n\r\n\t\t/**返回的数据。*/\r\n\t\t__getset(0,__proto,'data',function(){\r\n\t\t\treturn this._data;\r\n\t\t});\r\n\r\n\t\treturn HttpRequest;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>Loader</code> 类可用来加载文本、JSON、XML、二进制、图像等资源。\r\n\t*/\r\n\t//class laya.net.Loader extends laya.events.EventDispatcher\r\n\tvar Loader=(function(_super){\r\n\t\tfunction Loader(){\r\n\t\t\tthis._data=null;\r\n\t\t\tthis._url=null;\r\n\t\t\tthis._type=null;\r\n\t\t\tthis._cache=false;\r\n\t\t\tthis._http=null;\r\n\t\t\tLoader.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(Loader,'laya.net.Loader',_super);\r\n\t\tvar __proto=Loader.prototype;\r\n\t\t/**\r\n\t\t*加载资源。\r\n\t\t*@param url 地址\r\n\t\t*@param type 类型，如果为null，则根据文件后缀，自动分析类型。\r\n\t\t*@param cache 是否缓存数据。\r\n\t\t*@param group 分组。\r\n\t\t*@param ignoreCache 是否忽略缓存，强制重新加载\r\n\t\t*/\r\n\t\t__proto.load=function(url,type,cache,group,ignoreCache){\r\n\t\t\t(cache===void 0)&& (cache=true);\r\n\t\t\t(ignoreCache===void 0)&& (ignoreCache=false);\r\n\t\t\tif (url.indexOf(\"data:image\")===0)this._type=\"image\";\r\n\t\t\turl=URL.formatURL(url);\r\n\t\t\tthis._url=url;\r\n\t\t\tthis._type=type || (type=this.getTypeFromUrl(url));\r\n\t\t\tthis._cache=cache;\r\n\t\t\tthis._data=null;\r\n\t\t\tif (!ignoreCache && Loader.loadedMap[url]){\r\n\t\t\t\tthis._data=Loader.loadedMap[url];\r\n\t\t\t\tthis.event(/*laya.events.Event.PROGRESS*/\"progress\",1);\r\n\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\",this._data);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (group)Loader.setGroup(url,group);\r\n\t\t\tif (Loader.parserMap[type] !=null){\r\n\t\t\t\tif (((Loader.parserMap[type])instanceof laya.utils.Handler ))Loader.parserMap[type].runWith(this);\r\n\t\t\t\telse Loader.parserMap[type].call(null,this);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (type===\"image\" || type===\"htmlimage\" || type===\"nativeimage\")return this._loadImage(url);\r\n\t\t\tif (type===\"sound\")return this._loadSound(url);\r\n\t\t\tif (!this._http){\r\n\t\t\t\tthis._http=new HttpRequest();\r\n\t\t\t\tthis._http.on(/*laya.events.Event.PROGRESS*/\"progress\",this,this.onProgress);\r\n\t\t\t\tthis._http.on(/*laya.events.Event.ERROR*/\"error\",this,this.onError);\r\n\t\t\t\tthis._http.on(/*laya.events.Event.COMPLETE*/\"complete\",this,this.onLoaded);\r\n\t\t\t};\r\n\t\t\tvar contentType;\r\n\t\t\tswitch (type){\r\n\t\t\t\tcase \"atlas\":\r\n\t\t\t\t\tcontentType=\"json\";\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"font\":\r\n\t\t\t\t\tcontentType=\"xml\";\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tcontentType=type;\r\n\t\t\t\t}\r\n\t\t\tthis._http.send(url,null,\"get\",contentType);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定资源地址的数据类型。\r\n\t\t*@param url 资源地址。\r\n\t\t*@return 数据类型。\r\n\t\t*/\r\n\t\t__proto.getTypeFromUrl=function(url){\r\n\t\t\tvar type=Utils.getFileExtension(url);\r\n\t\t\tif (type)return Loader.typeMap[type];\r\n\t\t\tconsole.log(\"Not recognize the resources suffix\",url);\r\n\t\t\treturn \"text\";\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*加载图片资源。\r\n\t\t*@param url 资源地址。\r\n\t\t*/\r\n\t\t__proto._loadImage=function(url){\r\n\t\t\tvar _this=this;\r\n\t\t\tvar image;\r\n\t\t\tfunction clear (){\r\n\t\t\t\timage.onload=null;\r\n\t\t\t\timage.onerror=null;\r\n\t\t\t};\r\n\t\t\tvar onload=function (){\r\n\t\t\t\tclear();\r\n\t\t\t\t_this.onLoaded(image);\r\n\t\t\t};\r\n\t\t\tvar onerror=function (){\r\n\t\t\t\tclear();\r\n\t\t\t\t_this.event(/*laya.events.Event.ERROR*/\"error\",\"Load image filed\");\r\n\t\t\t}\r\n\t\t\tif (this._type===\"nativeimage\"){\r\n\t\t\t\timage=new Browser.window.Image();\r\n\t\t\t\timage.crossOrigin=\"\";\r\n\t\t\t\timage.onload=onload;\r\n\t\t\t\timage.onerror=onerror;\r\n\t\t\t\timage.src=url;\r\n\t\t\t\t}else {\r\n\t\t\t\tnew HTMLImage.create(url,{onload:onload,onerror:onerror,onCreate:function (img){\r\n\t\t\t\t\t\timage=img;\r\n\t\t\t\t}});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*加载声音资源。\r\n\t\t*@param url 资源地址。\r\n\t\t*/\r\n\t\t__proto._loadSound=function(url){\r\n\t\t\tvar sound=(new SoundManager._soundClass());\r\n\t\t\tvar _this=this;\r\n\t\t\tsound.on(/*laya.events.Event.COMPLETE*/\"complete\",this,soundOnload);\r\n\t\t\tsound.on(/*laya.events.Event.ERROR*/\"error\",this,soundOnErr);\r\n\t\t\tsound.load(url);\r\n\t\t\tfunction soundOnload (){\r\n\t\t\t\tclear();\r\n\t\t\t\t_this.onLoaded(sound);\r\n\t\t\t}\r\n\t\t\tfunction soundOnErr (){\r\n\t\t\t\tclear();\r\n\t\t\t\t_this.event(/*laya.events.Event.ERROR*/\"error\",\"Load sound filed\");\r\n\t\t\t}\r\n\t\t\tfunction clear (){\r\n\t\t\t\tsound.offAll();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto.onProgress=function(value){\r\n\t\t\tif (this._type===\"atlas\")this.event(/*laya.events.Event.PROGRESS*/\"progress\",value *0.3);\r\n\t\t\telse this.event(/*laya.events.Event.PROGRESS*/\"progress\",value);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto.onError=function(message){\r\n\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\",message);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*资源加载完成的处理函数。\r\n\t\t*@param data 数据。\r\n\t\t*/\r\n\t\t__proto.onLoaded=function(data){\r\n\t\t\tvar type=this._type;\r\n\t\t\tif (type===\"image\"){\r\n\t\t\t\tvar tex=new Texture(data);\r\n\t\t\t\ttex.url=this._url;\r\n\t\t\t\tthis.complete(tex);\r\n\t\t\t\t}else if (type===\"sound\" || type===\"htmlimage\" || type===\"nativeimage\"){\r\n\t\t\t\tthis.complete(data);\r\n\t\t\t\t}else if (type===\"atlas\"){\r\n\t\t\t\tif (!data.src){\r\n\t\t\t\t\tif (!this._data){\r\n\t\t\t\t\t\tthis._data=data;\r\n\t\t\t\t\t\tif (data.meta && data.meta.image){\r\n\t\t\t\t\t\t\tvar toloadPics=data.meta.image.split(\",\");\r\n\t\t\t\t\t\t\tvar split=this._url.indexOf(\"/\")>=0 ? \"/\" :\"\\\\\";\r\n\t\t\t\t\t\t\tvar idx=this._url.lastIndexOf(split);\r\n\t\t\t\t\t\t\tvar folderPath=idx >=0 ? this._url.substr(0,idx+1):\"\";\r\n\t\t\t\t\t\t\tidx=this._url.indexOf(\"?\");\r\n\t\t\t\t\t\t\tvar ver;\r\n\t\t\t\t\t\t\tver=idx >=0 ? this._url.substr(idx):\"\";\r\n\t\t\t\t\t\t\tfor (var i=0,len=toloadPics.length;i < len;i++){\r\n\t\t\t\t\t\t\t\ttoloadPics[i]=folderPath+toloadPics[i]+ver;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\ttoloadPics=[this._url.replace(\".json\",\".png\")];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttoloadPics.reverse();\r\n\t\t\t\t\t\tdata.toLoads=toloadPics;\r\n\t\t\t\t\t\tdata.pics=[];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.event(/*laya.events.Event.PROGRESS*/\"progress\",0.3+1 / toloadPics.length *0.6);\r\n\t\t\t\t\treturn this._loadImage(URL.formatURL(toloadPics.pop()));\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._data.pics.push(data);\r\n\t\t\t\t\tif (this._data.toLoads.length > 0){\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.PROGRESS*/\"progress\",0.3+1 / this._data.toLoads.length *0.6);\r\n\t\t\t\t\t\treturn this._loadImage(URL.formatURL(this._data.toLoads.pop()));\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar frames=this._data.frames;\r\n\t\t\t\t\tvar cleanUrl=this._url.split(\"?\")[0];\r\n\t\t\t\t\tvar directory=(this._data.meta && this._data.meta.prefix)? URL.basePath+this._data.meta.prefix :cleanUrl.substring(0,cleanUrl.lastIndexOf(\".\"))+\"/\";\r\n\t\t\t\t\tvar pics=this._data.pics;\r\n\t\t\t\t\tvar map=Loader.atlasMap[this._url] || (Loader.atlasMap[this._url]=[]);\r\n\t\t\t\t\tmap.dir=directory;\r\n\t\t\t\t\tfor (var name in frames){\r\n\t\t\t\t\t\tvar obj=frames[name];\r\n\t\t\t\t\t\tvar tPic=pics[obj.frame.idx ? obj.frame.idx :0];\r\n\t\t\t\t\t\tvar url=directory+name;\r\n\t\t\t\t\t\tLoader.cacheRes(url,Texture.create(tPic,obj.frame.x,obj.frame.y,obj.frame.w,obj.frame.h,obj.spriteSourceSize.x,obj.spriteSourceSize.y,obj.sourceSize.w,obj.sourceSize.h));\r\n\t\t\t\t\t\tLoader.loadedMap[url].url=url;\r\n\t\t\t\t\t\tmap.push(url);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.complete(this._data);\r\n\t\t\t\t}\r\n\t\t\t\t}else if (type==\"font\"){\r\n\t\t\t\tif (!data.src){\r\n\t\t\t\t\tthis._data=data;\r\n\t\t\t\t\tthis.event(/*laya.events.Event.PROGRESS*/\"progress\",0.5);\r\n\t\t\t\t\treturn this._loadImage(URL.formatURL(this._url.replace(\".fnt\",\".png\")));\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar bFont;\r\n\t\t\t\t\tbFont=new BitmapFont();\r\n\t\t\t\t\tbFont.parseFont(this._data,data);\r\n\t\t\t\t\tvar tArr=this._url.split(\".fnt\")[0].split(\"/\");\r\n\t\t\t\t\tvar fontName=tArr[tArr.length-1];\r\n\t\t\t\t\tText.registerBitmapFont(fontName,bFont);\r\n\t\t\t\t\tthis._data=bFont;\r\n\t\t\t\t\tthis.complete(this._data);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.complete(data);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载完成。\r\n\t\t*@param data 加载的数据。\r\n\t\t*/\r\n\t\t__proto.complete=function(data){\r\n\t\t\tthis._data=data;\r\n\t\t\tLoader._loaders.push(this);\r\n\t\t\tif (!Loader._isWorking)Loader.checkNext();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*结束加载，处理是否缓存及派发完成事件 <code>Event.COMPLETE</code> 。\r\n\t\t*@param content 加载后的数据\r\n\t\t*/\r\n\t\t__proto.endLoad=function(content){\r\n\t\t\tcontent && (this._data=content);\r\n\t\t\tif (this._cache)Loader.cacheRes(this._url,this._data);\r\n\t\t\tthis.event(/*laya.events.Event.PROGRESS*/\"progress\",1);\r\n\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\",(this.data instanceof Array)? [this.data] :this.data);\r\n\t\t}\r\n\r\n\t\t/**加载地址。*/\r\n\t\t__getset(0,__proto,'url',function(){\r\n\t\t\treturn this._url;\r\n\t\t});\r\n\r\n\t\t/**返回的数据。*/\r\n\t\t__getset(0,__proto,'data',function(){\r\n\t\t\treturn this._data;\r\n\t\t});\r\n\r\n\t\t/**是否缓存。*/\r\n\t\t__getset(0,__proto,'cache',function(){\r\n\t\t\treturn this._cache;\r\n\t\t});\r\n\r\n\t\t/**加载类型。*/\r\n\t\t__getset(0,__proto,'type',function(){\r\n\t\t\treturn this._type;\r\n\t\t});\r\n\r\n\t\tLoader.checkNext=function(){\r\n\t\t\tLoader._isWorking=true;\r\n\t\t\tvar startTimer=Browser.now();\r\n\t\t\tvar thisTimer=startTimer;\r\n\t\t\twhile (Loader._startIndex < Loader._loaders.length){\r\n\t\t\t\tthisTimer=Browser.now();\r\n\t\t\t\tLoader._loaders[Loader._startIndex].endLoad();\r\n\t\t\t\tLoader._startIndex++;\r\n\t\t\t\tif (Browser.now()-startTimer > Loader.maxTimeOut){\r\n\t\t\t\t\tconsole.log(\"loader callback cost a long time:\"+(Browser.now()-startTimer)+\" url=\"+Loader._loaders[Loader._startIndex-1].url);\r\n\t\t\t\t\tLaya.timer.frameOnce(1,null,Loader.checkNext);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tLoader._loaders.length=0;\r\n\t\t\tLoader._startIndex=0;\r\n\t\t\tLoader._isWorking=false;\r\n\t\t}\r\n\r\n\t\tLoader.clearRes=function(url,forceDispose){\r\n\t\t\t(forceDispose===void 0)&& (forceDispose=false);\r\n\t\t\turl=URL.formatURL(url);\r\n\t\t\tvar arr=Loader.atlasMap[url];\r\n\t\t\tif (arr){\r\n\t\t\t\tfor (var i=0,n=arr.length;i < n;i++){\r\n\t\t\t\t\tvar resUrl=arr[i];\r\n\t\t\t\t\tvar tex=Loader.getRes(resUrl);\r\n\t\t\t\t\tif (tex)tex.destroy(forceDispose);\r\n\t\t\t\t\tdelete Loader.loadedMap[resUrl];\r\n\t\t\t\t}\r\n\t\t\t\tarr.length=0;\r\n\t\t\t\tdelete Loader.atlasMap[url];\r\n\t\t\t\tdelete Loader.loadedMap[url];\r\n\t\t\t\t}else {\r\n\t\t\t\tvar res=Loader.loadedMap[url];\r\n\t\t\t\tif (res){\r\n\t\t\t\t\tif ((res instanceof laya.resource.Texture )&& res.bitmap)(res).destroy(forceDispose);\r\n\t\t\t\t\tdelete Loader.loadedMap[url];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLoader.getRes=function(url){\r\n\t\t\treturn Loader.loadedMap[URL.formatURL(url)];\r\n\t\t}\r\n\r\n\t\tLoader.getAtlas=function(url){\r\n\t\t\treturn Loader.atlasMap[URL.formatURL(url)];\r\n\t\t}\r\n\r\n\t\tLoader.cacheRes=function(url,data){\r\n\t\t\turl=URL.formatURL(url);\r\n\t\t\tif (Loader.loadedMap[url] !=null){\r\n\t\t\t\tconsole.log(\"Resources already exist,is repeated loading:\",url);\r\n\t\t\t}else {\r\n\t\t\t\tLoader.loadedMap[url]=data;\r\n\t\t\t\tvar pos=url.indexOf('?');\r\n\t\t\t\tif (pos<0) return;\r\n\t\t\t\treturn Loader.loadedMap[url.substr(0, pos)]=data;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tLoader.setGroup=function(url,group){\r\n\t\t\tif (!Loader.groupMap[group])Loader.groupMap[group]=[];\r\n\t\t\tLoader.groupMap[group].push(url);\r\n\t\t}\r\n\r\n\t\tLoader.clearResByGroup=function(group){\r\n\t\t\tif (!Loader.groupMap[group])return;\r\n\t\t\tvar arr=Loader.groupMap[group],i=0,len=arr.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tLoader.clearRes(arr[i]);\r\n\t\t\t}\r\n\t\t\tarr.length=0;\r\n\t\t}\r\n\r\n\t\tLoader.TEXT=\"text\";\r\n\t\tLoader.JSON=\"json\";\r\n\t\tLoader.XML=\"xml\";\r\n\t\tLoader.BUFFER=\"arraybuffer\";\r\n\t\tLoader.IMAGE=\"image\";\r\n\t\tLoader.SOUND=\"sound\";\r\n\t\tLoader.ATLAS=\"atlas\";\r\n\t\tLoader.FONT=\"font\";\r\n\t\tLoader.typeMap={\"png\":\"image\",\"jpg\":\"image\",\"jpeg\":\"image\",\"txt\":\"text\",\"json\":\"json\",\"xml\":\"xml\",\"als\":\"atlas\",\"mp3\":\"sound\",\"ogg\":\"sound\",\"wav\":\"sound\",\"part\":\"json\"};\r\n\t\tLoader.parserMap={};\r\n\t\tLoader.loadedMap={};\r\n\t\tLoader.groupMap={};\r\n\t\tLoader.maxTimeOut=100;\r\n\t\tLoader.atlasMap={};\r\n\t\tLoader._loaders=[];\r\n\t\tLoader._isWorking=false;\r\n\t\tLoader._startIndex=0;\r\n\t\treturn Loader;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<p><code>ColorFilter</code> 是颜色滤镜。</p>\r\n\t*/\r\n\t//class laya.filters.ColorFilter extends laya.filters.Filter\r\n\tvar ColorFilter=(function(_super){\r\n\t\tfunction ColorFilter(mat){\r\n\t\t\t//this._mat=null;\r\n\t\t\t//this._alpha=null;\r\n\t\t\tColorFilter.__super.call(this);\r\n\t\t\tif (!mat){\r\n\t\t\t\tmat=[0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0,0,0,1,0];\r\n\t\t\t}\r\n\t\t\tthis._mat=new Float32Array(16);\r\n\t\t\tthis._alpha=new Float32Array(4);\r\n\t\t\tvar j=0;\r\n\t\t\tvar z=0;\r\n\t\t\tfor (var i=0;i < 20;i++){\r\n\t\t\t\tif (i % 5 !=4){\r\n\t\t\t\t\tthis._mat[j++]=mat[i];\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._alpha[z++]=mat[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._action=RunDriver.createFilterAction(0x20);\r\n\t\t\tthis._action.data=this;\r\n\t\t}\r\n\r\n\t\t__class(ColorFilter,'laya.filters.ColorFilter',_super);\r\n\t\tvar __proto=ColorFilter.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilter\":true})\r\n\t\t/**\r\n\t\t*@private 通知微端\r\n\t\t*/\r\n\t\t__proto.callNative=function(sp){\r\n\t\t\tvar t=sp._$P.cf=this;\r\n\t\t\tsp.model && sp.model.setFilterMatrix&&sp.model.setFilterMatrix(this._mat,this._alpha);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__getset(0,__proto,'type',function(){\r\n\t\t\treturn 0x20;\r\n\t\t});\r\n\r\n\t\t/**@private */\r\n\t\t__getset(0,__proto,'action',function(){\r\n\t\t\treturn this._action;\r\n\t\t});\r\n\r\n\t\t__getset(1,ColorFilter,'DEFAULT',function(){\r\n\t\t\tif (!ColorFilter._DEFAULT){\r\n\t\t\t\tColorFilter._DEFAULT=new ColorFilter([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);\r\n\t\t\t}\r\n\t\t\treturn ColorFilter._DEFAULT;\r\n\t\t},laya.filters.Filter._$SET_DEFAULT);\r\n\r\n\t\t__getset(1,ColorFilter,'GRAY',function(){\r\n\t\t\tif (!ColorFilter._GRAY){\r\n\t\t\t\tColorFilter._GRAY=new ColorFilter([0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0.3,0.59,0.11,0,0,0,0,0,1,0]);\r\n\t\t\t}\r\n\t\t\treturn ColorFilter._GRAY;\r\n\t\t},laya.filters.Filter._$SET_GRAY);\r\n\r\n\t\tColorFilter._DEFAULT=null\r\n\t\tColorFilter._GRAY=null\r\n\t\treturn ColorFilter;\r\n\t})(Filter)\r\n\r\n\r\n\t/**\r\n\t*<p> <code>LoaderManager</code> 类用于用于批量加载资源、数据。</p>\r\n\t*<p>批量加载器，单例，可以通过Laya.loader访问。</p>\r\n\t*多线程(默认5个线程)，5个优先级(0最快，4最慢,默认为1)\r\n\t*某个资源加载失败后，会按照最低优先级重试加载(属性retryNum决定重试几次)，如果重试后失败，则调用complete函数，并返回null\r\n\t*/\r\n\t//class laya.net.LoaderManager extends laya.events.EventDispatcher\r\n\tvar LoaderManager=(function(_super){\r\n\t\tvar ResInfo;\r\n\t\tfunction LoaderManager(){\r\n\t\t\tthis.retryNum=1;\r\n\t\t\tthis.maxLoader=5;\r\n\t\t\tthis._loaders=[];\r\n\t\t\tthis._loaderCount=0;\r\n\t\t\tthis._resInfos=[];\r\n\t\t\tthis._infoPool=[];\r\n\t\t\tthis._maxPriority=5;\r\n\t\t\tthis._failRes={};\r\n\t\t\tLoaderManager.__super.call(this);\r\n\t\t\tfor (var i=0;i < this._maxPriority;i++)this._resInfos[i]=[];\r\n\t\t}\r\n\r\n\t\t__class(LoaderManager,'laya.net.LoaderManager',_super);\r\n\t\tvar __proto=LoaderManager.prototype;\r\n\t\t/**\r\n\t\t*根据clas定义创建一个资源空壳，随后进行异步加载，资源加载完成后，会调用资源类的onAsynLoaded方法回调真正的数据,套嵌资源的子资源会保留资源路径\"?\"后的部分\r\n\t\t*@param url 资源地址或者数组，比如[{url:xx,clas:xx,priority:xx},{url:xx,clas:xx,priority:xx}]\r\n\t\t*@param progress 进度回调，回调参数为当前文件加载的进度信息(0-1)。\r\n\t\t*@param clas 资源类名，比如Texture\r\n\t\t*@param type 资源类型\r\n\t\t*@param priority 优先级\r\n\t\t*@param cache 是否缓存\r\n\t\t*@return 返回资源对象\r\n\t\t*/\r\n\t\t__proto.create=function(url,complete,progress,clas,priority,cache){\r\n\t\t\t(priority===void 0)&& (priority=1);\r\n\t\t\t(cache===void 0)&& (cache=true);\r\n\t\t\tif ((url instanceof Array)){\r\n\t\t\t\tvar items=url;\r\n\t\t\t\tvar itemCount=items.length;\r\n\t\t\t\tvar loadedCount=0;\r\n\t\t\t\tif (progress){\r\n\t\t\t\t\tvar progress2=Handler.create(progress.caller,progress.method,progress.args,false);\r\n\t\t\t\t}\r\n\t\t\t\tfor (var i=0;i < itemCount;i++){\r\n\t\t\t\t\tvar item=items[i];\r\n\t\t\t\t\tif ((typeof item=='string'))item=items[i]={url:item};\r\n\t\t\t\t\titem.progress=0;\r\n\t\t\t\t\tvar progressHandler=progress ? Handler.create(null,onProgress,[item],false):null;\r\n\t\t\t\t\tvar completeHandler=(progress || complete)? Handler.create(null,onComplete,[item]):null;\r\n\t\t\t\t\tthis._create(item.url,completeHandler,progressHandler,item.clas || clas,item.priority || priority,cache);\r\n\t\t\t\t}\r\n\t\t\t\tfunction onComplete (item,content){\r\n\t\t\t\t\tloadedCount++;\r\n\t\t\t\t\titem.progress=1;\r\n\t\t\t\t\tif (loadedCount===itemCount && complete){\r\n\t\t\t\t\t\tcomplete.run();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfunction onProgress (item,value){\r\n\t\t\t\t\titem.progress=value;\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tfor (var j=0;j < itemCount;j++){\r\n\t\t\t\t\t\tvar item1=items[j];\r\n\t\t\t\t\t\tnum+=item1.progress;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar v=num / itemCount;\r\n\t\t\t\t\tprogress2.runWith(v);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}else return this._create(url,complete,progress,clas,priority,cache);\r\n\t\t}\r\n\r\n\t\t__proto._create=function(url,complete,progress,clas,priority,cache){\r\n\t\t\t(priority===void 0)&& (priority=1);\r\n\t\t\t(cache===void 0)&& (cache=true);\r\n\t\t\tvar item=this.getRes(url);\r\n\t\t\tif (!item){\r\n\t\t\t\tvar extension=Utils.getFileExtension(url);\r\n\t\t\t\tvar creatItem=LoaderManager.createMap[extension];\r\n\t\t\t\tif (!clas)clas=creatItem[0];\r\n\t\t\t\tvar type=creatItem[1];\r\n\t\t\t\tif (clas===Texture)type=\"htmlimage\";\r\n\t\t\t\titem=clas ? new clas():null;\r\n\t\t\t\tthis.load(url,Handler.create(null,onLoaded),progress,type,priority,false,null,true);\r\n\t\t\t\tfunction onLoaded (data){\r\n\t\t\t\t\titem && item.onAsynLoaded.call(item,url,data);\r\n\t\t\t\t\tif (complete)complete.run();\r\n\t\t\t\t}\r\n\t\t\t\tif (cache)LoaderManager.cacheRes(url,item);\r\n\t\t\t\t}else {\r\n\t\t\t\tprogress && progress.runWith(1);\r\n\t\t\t\tcomplete && complete.run();\r\n\t\t\t}\r\n\t\t\treturn item;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载资源。\r\n\t\t*@param url 地址，或者资源对象数组(简单数组：[\"a.png\",\"b.png\"]，复杂数组[{url:\"a.png\",type:Loader.IMAGE,size:100,priority:1},{url:\"b.json\",type:Loader.JSON,size:50,priority:1}])。\r\n\t\t*@param complete 结束回调，如果加载失败，则返回 null 。\r\n\t\t*@param progress 进度回调，回调参数为当前文件加载的进度信息(0-1)。\r\n\t\t*@param type 资源类型。\r\n\t\t*@param priority 优先级，0-4，五个优先级，0优先级最高，默认为1。\r\n\t\t*@param cache 是否缓存加载结果。\r\n\t\t*@param group 分组。\r\n\t\t*@param ignoreCache 是否忽略缓存，强制重新加载\r\n\t\t*@return 此 LoaderManager 对象。\r\n\t\t*/\r\n\t\t__proto.load=function(url,complete,progress,type,priority,cache,group,ignoreCache){\r\n\t\t\t(priority===void 0)&& (priority=1);\r\n\t\t\t(cache===void 0)&& (cache=true);\r\n\t\t\t(ignoreCache===void 0)&& (ignoreCache=false);\r\n\t\t\tif ((url instanceof Array))return this._loadAssets(url,complete,progress,type,priority,cache,group);\r\n\t\t\turl=URL.formatURL(url);\r\n\t\t\tvar content=Loader.getRes(url);\r\n\t\t\tif (content !=null){\r\n\t\t\t\tprogress && progress.runWith(1);\r\n\t\t\t\tcomplete && complete.runWith(content);\r\n\t\t\t\tthis._loaderCount || this.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\t}else {\r\n\t\t\t\tvar info=LoaderManager._resMap[url];\r\n\t\t\t\tif (!info){\r\n\t\t\t\t\tinfo=this._infoPool.length ? this._infoPool.pop():new ResInfo();\r\n\t\t\t\t\tinfo.url=url;\r\n\t\t\t\t\tinfo.type=type;\r\n\t\t\t\t\tinfo.cache=cache;\r\n\t\t\t\t\tinfo.group=group;\r\n\t\t\t\t\tinfo.ignoreCache=ignoreCache;\r\n\t\t\t\t\tcomplete && info.on(/*laya.events.Event.COMPLETE*/\"complete\",complete.caller,complete.method,complete.args);\r\n\t\t\t\t\tprogress && info.on(/*laya.events.Event.PROGRESS*/\"progress\",progress.caller,progress.method,progress.args);\r\n\t\t\t\t\tLoaderManager._resMap[url]=info;\r\n\t\t\t\t\tpriority=priority < this._maxPriority ? priority :this._maxPriority-1;\r\n\t\t\t\t\tthis._resInfos[priority].push(info);\r\n\t\t\t\t\tthis._next();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tcomplete && info._createListener(/*laya.events.Event.COMPLETE*/\"complete\",complete.caller,complete.method,complete.args,false,false);\r\n\t\t\t\t\tprogress && info._createListener(/*laya.events.Event.PROGRESS*/\"progress\",progress.caller,progress.method,progress.args,false,false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto._next=function(){\r\n\t\t\tif (this._loaderCount >=this.maxLoader)return;\r\n\t\t\tfor (var i=0;i < this._maxPriority;i++){\r\n\t\t\t\tvar infos=this._resInfos[i];\r\n\t\t\t\tif (infos.length > 0){\r\n\t\t\t\t\tvar info=infos.shift();\r\n\t\t\t\t\tif (info)return this._doLoad(info);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._loaderCount || this.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t}\r\n\r\n\t\t__proto._doLoad=function(resInfo){\r\n\t\t\tthis._loaderCount++;\r\n\t\t\tvar loader=this._loaders.length ? this._loaders.pop():new Loader();\r\n\t\t\tloader.on(/*laya.events.Event.COMPLETE*/\"complete\",null,onLoaded);\r\n\t\t\tloader.on(/*laya.events.Event.PROGRESS*/\"progress\",null,function(num){\r\n\t\t\t\tresInfo.event(/*laya.events.Event.PROGRESS*/\"progress\",num);\r\n\t\t\t});\r\n\t\t\tloader.on(/*laya.events.Event.ERROR*/\"error\",null,function(msg){\r\n\t\t\t\tonLoaded(null);\r\n\t\t\t});\r\n\t\t\tvar _this=this;\r\n\t\t\tfunction onLoaded (data){\r\n\t\t\t\tloader.offAll();\r\n\t\t\t\tloader._data=null;\r\n\t\t\t\t_this._loaders.push(loader);\r\n\t\t\t\t_this._endLoad(resInfo,(data instanceof Array)? [data] :data);\r\n\t\t\t\t_this._loaderCount--;\r\n\t\t\t\t_this._next();\r\n\t\t\t}\r\n\t\t\tloader.load(resInfo.url,resInfo.type,resInfo.cache,resInfo.group,resInfo.ignoreCache);\r\n\t\t}\r\n\r\n\t\t__proto._endLoad=function(resInfo,content){\r\n\t\t\tif (content===null){\r\n\t\t\t\tvar errorCount=this._failRes[resInfo.url] || 0;\r\n\t\t\t\tif (errorCount < this.retryNum){\r\n\t\t\t\t\tconsole.log(\"[warn]Retry to load:\",resInfo.url);\r\n\t\t\t\t\tthis._failRes[resInfo.url]=errorCount+1;\r\n\t\t\t\t\tthis._resInfos[this._maxPriority-1].push(resInfo);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tconsole.log(\"[error]Failed to load:\",resInfo.url);\r\n\t\t\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\",resInfo.url);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdelete LoaderManager._resMap[resInfo.url];\r\n\t\t\tresInfo.event(/*laya.events.Event.COMPLETE*/\"complete\",content);\r\n\t\t\tresInfo.offAll();\r\n\t\t\tthis._infoPool.push(resInfo);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*清理指定资源地址缓存。\r\n\t\t*@param url 资源地址。\r\n\t\t*@param forceDispose 是否强制销毁，有些资源是采用引用计数方式销毁，如果forceDispose=true，则忽略引用计数，直接销毁，比如Texture，默认为false\r\n\t\t*/\r\n\t\t__proto.clearRes=function(url,forceDispose){\r\n\t\t\t(forceDispose===void 0)&& (forceDispose=false);\r\n\t\t\tLoader.clearRes(url,forceDispose);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取指定资源地址的资源。\r\n\t\t*@param url 资源地址。\r\n\t\t*@return 返回资源。\r\n\t\t*/\r\n\t\t__proto.getRes=function(url){\r\n\t\t\treturn Loader.getRes(url);\r\n\t\t}\r\n\r\n\t\t/**清理当前未完成的加载，所有未加载的内容全部停止加载。*/\r\n\t\t__proto.clearUnLoaded=function(){\r\n\t\t\tfor (var i=0;i < this._maxPriority;i++){\r\n\t\t\t\tvar infos=this._resInfos[i];\r\n\t\t\t\tfor (var j=infos.length-1;j >-1;j--){\r\n\t\t\t\t\tvar info=infos[j];\r\n\t\t\t\t\tif (info){\r\n\t\t\t\t\t\tinfo.offAll();\r\n\t\t\t\t\t\tthis._infoPool.push(info);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tinfos.length=0;\r\n\t\t\t}\r\n\t\t\tthis._loaderCount=0;\r\n\t\t\tLoaderManager._resMap={};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据地址集合清理掉未加载的内容\r\n\t\t*@param urls 资源地址集合\r\n\t\t*/\r\n\t\t__proto.cancelLoadByUrls=function(urls){\r\n\t\t\tif (!urls)return;\r\n\t\t\tfor (var i=0,n=urls.length;i < n;i++){\r\n\t\t\t\tthis.cancelLoadByUrl(urls[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据地址清理掉未加载的内容\r\n\t\t*@param url 资源地址\r\n\t\t*/\r\n\t\t__proto.cancelLoadByUrl=function(url){\r\n\t\t\turl=URL.formatURL(url);\r\n\t\t\tfor (var i=0;i < this._maxPriority;i++){\r\n\t\t\t\tvar infos=this._resInfos[i];\r\n\t\t\t\tfor (var j=infos.length-1;j >-1;j--){\r\n\t\t\t\t\tvar info=infos[j];\r\n\t\t\t\t\tif (info && info.url===url){\r\n\t\t\t\t\t\tinfos[j]=null;\r\n\t\t\t\t\t\tinfo.offAll();\r\n\t\t\t\t\t\tthis._infoPool.push(info);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (LoaderManager._resMap[url])delete LoaderManager._resMap[url];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*加载数组里面的资源。\r\n\t\t*@param arr 简单：[\"a.png\",\"b.png\"]，复杂[{url:\"a.png\",type:Loader.IMAGE,size:100,priority:1},{url:\"b.json\",type:Loader.JSON,size:50,priority:1}]*/\r\n\t\t__proto._loadAssets=function(arr,complete,progress,type,priority,cache,group){\r\n\t\t\t(priority===void 0)&& (priority=1);\r\n\t\t\t(cache===void 0)&& (cache=true);\r\n\t\t\tvar itemCount=arr.length;\r\n\t\t\tvar loadedCount=0;\r\n\t\t\tvar totalSize=0;\r\n\t\t\tvar items=[];\r\n\t\t\tvar defaultType=type || /*laya.net.Loader.IMAGE*/\"image\";\r\n\t\t\tfor (var i=0;i < itemCount;i++){\r\n\t\t\t\tvar item=arr[i];\r\n\t\t\t\tif ((typeof item=='string'))item={url:item,type:defaultType,size:1,priority:priority};\r\n\t\t\t\tif (!item.size)item.size=1;\r\n\t\t\t\titem.progress=0;\r\n\t\t\t\ttotalSize+=item.size;\r\n\t\t\t\titems.push(item);\r\n\t\t\t\tvar progressHandler=progress ? Handler.create(null,loadProgress,[item],false):null;\r\n\t\t\t\tvar completeHandler=(complete || progress)? Handler.create(null,loadComplete,[item]):null;\r\n\t\t\t\tthis.load(item.url,completeHandler,progressHandler,item.type,item.priority || 1,cache,item.group || group);\r\n\t\t\t}\r\n\t\t\tfunction loadComplete (item,content){\r\n\t\t\t\tloadedCount++;\r\n\t\t\t\titem.progress=1;\r\n\t\t\t\tif (loadedCount===itemCount && complete){\r\n\t\t\t\t\tcomplete.run();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfunction loadProgress (item,value){\r\n\t\t\t\tif (progress !=null){\r\n\t\t\t\t\titem.progress=value;\r\n\t\t\t\t\tvar num=0;\r\n\t\t\t\t\tfor (var j=0;j < items.length;j++){\r\n\t\t\t\t\t\tvar item1=items[j];\r\n\t\t\t\t\t\tnum+=item1.size *item1.progress;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar v=num / totalSize;\r\n\t\t\t\t\tprogress.runWith(v);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tLoaderManager.cacheRes=function(url,data){\r\n\t\t\tLoader.cacheRes(url,data);\r\n\t\t}\r\n\r\n\t\tLoaderManager._resMap={};\r\n\t\t__static(LoaderManager,\r\n\t\t['createMap',function(){return this.createMap={atlas:[null,/*laya.net.Loader.ATLAS*/\"atlas\"]};}\r\n\t\t]);\r\n\t\tLoaderManager.__init$=function(){\r\n\t\t\t//class ResInfo extends laya.events.EventDispatcher\r\n\t\t\tResInfo=(function(_super){\r\n\t\t\t\tfunction ResInfo(){\r\n\t\t\t\t\tthis.url=null;\r\n\t\t\t\t\tthis.type=null;\r\n\t\t\t\t\tthis.cache=false;\r\n\t\t\t\t\tthis.group=null;\r\n\t\t\t\t\tthis.ignoreCache=false;\r\n\t\t\t\t\tResInfo.__super.call(this);\r\n\t\t\t\t}\r\n\t\t\t\t__class(ResInfo,'',_super);\r\n\t\t\t\treturn ResInfo;\r\n\t\t\t})(EventDispatcher)\r\n\t\t}\r\n\r\n\t\treturn LoaderManager;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>Socket</code> 是一种双向通信协议，在建立连接后，服务器和 Browser/Client Agent 都能主动的向对方发送或接收数据。\r\n\t*/\r\n\t//class laya.net.Socket extends laya.events.EventDispatcher\r\n\tvar Socket=(function(_super){\r\n\t\tfunction Socket(host,port,byteClass){\r\n\t\t\tthis._endian=null;\r\n\t\t\tthis._stamp=NaN;\r\n\t\t\tthis._socket=null;\r\n\t\t\tthis._connected=false;\r\n\t\t\tthis._addInputPosition=0;\r\n\t\t\tthis._input=null;\r\n\t\t\tthis._output=null;\r\n\t\t\tthis.timeout=0;\r\n\t\t\tthis.objectEncoding=0;\r\n\t\t\tthis.disableInput=false;\r\n\t\t\tthis._byteClass=null;\r\n\t\t\t(port===void 0)&& (port=0);\r\n\t\t\tSocket.__super.call(this);\r\n\t\t\tthis._byteClass=byteClass;\r\n\t\t\tthis._byteClass=this._byteClass ? this._byteClass :Byte;\r\n\t\t\tthis.endian=\"bigEndian\";\r\n\t\t\tthis.timeout=20000;\r\n\t\t\tthis._addInputPosition=0;\r\n\t\t\tif (host&&port > 0 && port < 65535)\r\n\t\t\t\tthis.connect(host,port);\r\n\t\t}\r\n\r\n\t\t__class(Socket,'laya.net.Socket',_super);\r\n\t\tvar __proto=Socket.prototype;\r\n\t\t/**\r\n\t\t*连接到指定的主机和端口。\r\n\t\t*@param host 服务器地址。\r\n\t\t*@param port 服务器端口。\r\n\t\t*/\r\n\t\t__proto.connect=function(host,port){\r\n\t\t\tvar url=\"ws://\"+host+\":\"+port;\r\n\t\t\tthis.connectByUrl(url);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*连接到指定的url\r\n\t\t*@param url 连接目标\r\n\t\t*/\r\n\t\t__proto.connectByUrl=function(url){\r\n\t\t\tvar _$this=this;\r\n\t\t\tif (this._socket !=null)\r\n\t\t\t\tthis.close();\r\n\t\t\tthis._socket && this._cleanSocket();\r\n\t\t\tthis._socket=new Browser.window.WebSocket(url);\r\n\t\t\tthis._socket.binaryType=\"arraybuffer\";\r\n\t\t\tthis._output=new this._byteClass();\r\n\t\t\tthis._output.endian=this.endian;\r\n\t\t\tthis._input=new this._byteClass();\r\n\t\t\tthis._input.endian=this.endian;\r\n\t\t\tthis._addInputPosition=0;\r\n\t\t\tthis._socket.onopen=function (e){\r\n\t\t\t\t_$this._onOpen(e);\r\n\t\t\t};\r\n\t\t\tthis._socket.onmessage=function (msg){\r\n\t\t\t\t_$this._onMessage(msg);\r\n\t\t\t};\r\n\t\t\tthis._socket.onclose=function (e){\r\n\t\t\t\t_$this._onClose(e);\r\n\t\t\t};\r\n\t\t\tthis._socket.onerror=function (e){\r\n\t\t\t\t_$this._onError(e);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t__proto._cleanSocket=function(){\r\n\t\t\ttry {\r\n\t\t\t\tthis._socket.close();\r\n\t\t\t}catch (e){}\r\n\t\t\tthis._connected=false;\r\n\t\t\tthis._socket.onopen=null;\r\n\t\t\tthis._socket.onmessage=null;\r\n\t\t\tthis._socket.onclose=null;\r\n\t\t\tthis._socket.onerror=null;\r\n\t\t\tthis._socket=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*关闭连接。\r\n\t\t*/\r\n\t\t__proto.close=function(){\r\n\t\t\tif (this._socket !=null){\r\n\t\t\t\tthis._cleanSocket();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*连接建立成功 。\r\n\t\t*/\r\n\t\t__proto._onOpen=function(e){\r\n\t\t\tthis._connected=true;\r\n\t\t\tthis.event(/*laya.events.Event.OPEN*/\"open\",e);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*接收到数据处理方法。\r\n\t\t*@param msg 数据。\r\n\t\t*/\r\n\t\t__proto._onMessage=function(msg){\r\n\t\t\tif (!msg || !msg.data)return;\r\n\t\t\tvar data=msg.data;\r\n\t\t\tif(this.disableInput&&data){\r\n\t\t\t\tthis.event(/*laya.events.Event.MESSAGE*/\"message\",data);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this._input.length > 0 && this._input.bytesAvailable < 1){\r\n\t\t\t\tthis._input.clear();\r\n\t\t\t\tthis._addInputPosition=0;\r\n\t\t\t};\r\n\t\t\tvar pre=this._input.pos;\r\n\t\t\t!this._addInputPosition && (this._addInputPosition=0);\r\n\t\t\tthis._input.pos=this._addInputPosition;\r\n\t\t\tif (data){\r\n\t\t\t\tif ((typeof data=='string')){\r\n\t\t\t\t\tthis._input.writeUTFBytes(data);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._input.writeArrayBuffer(data);\r\n\t\t\t\t}\r\n\t\t\t\tthis._addInputPosition=this._input.pos;\r\n\t\t\t\tthis._input.pos=pre;\r\n\t\t\t}\r\n\t\t\tthis.event(/*laya.events.Event.MESSAGE*/\"message\",data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*连接被关闭处理方法。\r\n\t\t*/\r\n\t\t__proto._onClose=function(e){\r\n\t\t\tthis._connected=false;\r\n\t\t\tthis.event(/*laya.events.Event.CLOSE*/\"close\",e)\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*出现异常处理方法。\r\n\t\t*/\r\n\t\t__proto._onError=function(e){\r\n\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\",e)\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*发送数据到服务器。\r\n\t\t*@param data 需要发送的数据，可以是String或者ArrayBuffer。\r\n\t\t*/\r\n\t\t__proto.send=function(data){\r\n\t\t\tthis._socket.send(data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*发送缓冲区中的数据到服务器。\r\n\t\t*/\r\n\t\t__proto.flush=function(){\r\n\t\t\tif (this._output && this._output.length > 0){\r\n\t\t\t\tvar evt;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis._socket && this._socket.send(this._output.__getBuffer().slice(0,this._output.length));\r\n\t\t\t\t\t}catch (e){\r\n\t\t\t\t\tevt=e;\r\n\t\t\t\t}\r\n\t\t\t\tthis._output.endian=this.endian;\r\n\t\t\t\tthis._output.clear();\r\n\t\t\t\tif(evt)this.event(/*laya.events.Event.ERROR*/\"error\",evt);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*表示服务端发来的数据。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'input',function(){\r\n\t\t\treturn this._input;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示需要发送至服务端的缓冲区中的数据。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'output',function(){\r\n\t\t\treturn this._output;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示此 Socket 对象目前是否已连接。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'connected',function(){\r\n\t\t\treturn this._connected;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示数据的字节顺序。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'endian',function(){\r\n\t\t\treturn this._endian;\r\n\t\t\t},function(value){\r\n\t\t\tthis._endian=value;\r\n\t\t\tif (this._input !=null)this._input.endian=value;\r\n\t\t\tif (this._output !=null)this._output.endian=value;\r\n\t\t});\r\n\r\n\t\tSocket.LITTLE_ENDIAN=\"littleEndian\";\r\n\t\tSocket.BIG_ENDIAN=\"bigEndian\";\r\n\t\treturn Socket;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>Resource</code> 资源存取类。\r\n\t*/\r\n\t//class laya.resource.Resource extends laya.events.EventDispatcher\r\n\tvar Resource=(function(_super){\r\n\t\tfunction Resource(){\r\n\t\t\tthis._id=0;\r\n\t\t\tthis._lastUseFrameCount=0;\r\n\t\t\tthis._memorySize=0;\r\n\t\t\tthis._name=null;\r\n\t\t\tthis._loaded=false;\r\n\t\t\tthis._released=false;\r\n\t\t\tthis._resourceManager=null;\r\n\t\t\tthis.lock=false;\r\n\t\t\tResource.__super.call(this);\r\n\t\t\tthis._$1__id=++Resource._uniqueIDCounter;\r\n\t\t\tResource._loadedResources.push(this);\r\n\t\t\tResource._isLoadedResourcesSorted=false;\r\n\t\t\tthis._released=true;\r\n\t\t\tthis.lock=false;\r\n\t\t\tthis._memorySize=0;\r\n\t\t\tthis._lastUseFrameCount=-1;\r\n\t\t\t(ResourceManager.currentResourceManager)&& (ResourceManager.currentResourceManager.addResource(this));\r\n\t\t}\r\n\r\n\t\t__class(Resource,'laya.resource.Resource',_super);\r\n\t\tvar __proto=Resource.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.resource.ICreateResource\":true,\"laya.resource.IDispose\":true})\r\n\t\t/**重新创建资源。override it，同时修改memorySize属性、处理startCreate()和compoleteCreate()方法。*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t/**销毁资源，override it,同时修改memorySize属性。*/\r\n\t\t__proto.detoryResource=function(){}\r\n\t\t/**\r\n\t\t*激活资源，使用资源前应先调用此函数激活。\r\n\t\t*@param force 是否强制创建。\r\n\t\t*/\r\n\t\t__proto.activeResource=function(force){\r\n\t\t\t(force===void 0)&& (force=false);\r\n\t\t\tthis._lastUseFrameCount=Stat.loopCount;\r\n\t\t\tif (this._released || force){\r\n\t\t\t\tthis.recreateResource();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*释放资源。\r\n\t\t*@param force 是否强制释放。\r\n\t\t*@return 是否成功释放。\r\n\t\t*/\r\n\t\t__proto.releaseResource=function(force){\r\n\t\t\t(force===void 0)&& (force=false);\r\n\t\t\tif (!force && this.lock)\r\n\t\t\t\treturn false;\r\n\t\t\tif (!this._released || force){\r\n\t\t\t\tthis.detoryResource();\r\n\t\t\t\tthis._released=true;\r\n\t\t\t\tthis._lastUseFrameCount=-1;\r\n\t\t\t\tthis.event(/*laya.events.Event.RELEASED*/\"released\",this);\r\n\t\t\t\treturn true;\r\n\t\t\t\t}else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置唯一名字,如果名字重复则自动加上“-copy”。\r\n\t\t*@param newName 名字。\r\n\t\t*/\r\n\t\t__proto.setUniqueName=function(newName){\r\n\t\t\tvar isUnique=true;\r\n\t\t\tfor (var i=0;i < Resource._loadedResources.length;i++){\r\n\t\t\t\tif (Resource._loadedResources[i]._name!==newName || Resource._loadedResources[i]===this)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tisUnique=false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (isUnique){\r\n\t\t\t\tif (this.name !=newName){\r\n\t\t\t\t\tthis.name=newName;\r\n\t\t\t\t\tResource._isLoadedResourcesSorted=false;\r\n\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\tthis.setUniqueName(newName.concat(\"-copy\"));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto.onAsynLoaded=function(url,data){\r\n\t\t\tthrow new Error(\"Resource: must override this function!\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*<p>彻底清理资源。</p>\r\n\t\t*<p><b>注意：</b>会强制解锁清理。</p>\r\n\t\t*/\r\n\t\t__proto.dispose=function(){\r\n\t\t\tif (this._resourceManager!==null)\r\n\t\t\t\tthrow new Error(\"附属于resourceManager的资源不能独立释放！\");\r\n\t\t\tthis.lock=false;\r\n\t\t\tthis.releaseResource();\r\n\t\t\tvar index=Resource._loadedResources.indexOf(this);\r\n\t\t\tif (index!==-1){\r\n\t\t\t\tResource._loadedResources.splice(index,1);\r\n\t\t\t\tResource._isLoadedResourcesSorted=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**开始资源激活。*/\r\n\t\t__proto.startCreate=function(){\r\n\t\t\tthis.event(/*laya.events.Event.RECOVERING*/\"recovering\",this);\r\n\t\t}\r\n\r\n\t\t/**完成资源激活。*/\r\n\t\t__proto.completeCreate=function(){\r\n\t\t\tthis._released=false;\r\n\t\t\tthis.event(/*laya.events.Event.RECOVERED*/\"recovered\",this);\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'loaded',function(){\r\n\t\t\treturn this._loaded;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取唯一标识ID(通常用于优化或识别)。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'id',function(){\r\n\t\t\treturn this._$1__id;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否已释放。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'released',function(){\r\n\t\t\treturn this._released;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置名字\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取名字。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'name',function(){\r\n\t\t\treturn this._name;\r\n\t\t\t},function(value){\r\n\t\t\tif ((value || value!==\"\")&& this.name!==value){\r\n\t\t\t\tthis._name=value;\r\n\t\t\t\tResource._isLoadedResourcesSorted=false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*距离上次使用帧率。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'lastUseFrameCount',function(){\r\n\t\t\treturn this._lastUseFrameCount;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*资源管理员。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'resourceManager',function(){\r\n\t\t\treturn this._resourceManager;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*占用内存尺寸。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'memorySize',function(){\r\n\t\t\treturn this._memorySize;\r\n\t\t\t},function(value){\r\n\t\t\tvar offsetValue=value-this._memorySize;\r\n\t\t\tthis._memorySize=value;\r\n\t\t\tthis.resourceManager && this.resourceManager.addSize(offsetValue);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*本类型排序后的已载入资源。\r\n\t\t*/\r\n\t\t__getset(1,Resource,'sortedLoadedResourcesByName',function(){\r\n\t\t\tif (!Resource._isLoadedResourcesSorted){\r\n\t\t\t\tResource._isLoadedResourcesSorted=true;\r\n\t\t\t\tResource._loadedResources.sort(Resource.compareResourcesByName);\r\n\t\t\t}\r\n\t\t\treturn Resource._loadedResources;\r\n\t\t},laya.events.EventDispatcher._$SET_sortedLoadedResourcesByName);\r\n\r\n\t\tResource.getLoadedResourceByIndex=function(index){\r\n\t\t\treturn Resource._loadedResources[index];\r\n\t\t}\r\n\r\n\t\tResource.getLoadedResourcesCount=function(){\r\n\t\t\treturn Resource._loadedResources.length;\r\n\t\t}\r\n\r\n\t\tResource.compareResourcesByName=function(left,right){\r\n\t\t\tif (left===right)\r\n\t\t\t\treturn 0;\r\n\t\t\tvar x=left.name;\r\n\t\t\tvar y=right.name;\r\n\t\t\tif (x===null){\r\n\t\t\t\tif (y===null)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\telse\r\n\t\t\t\treturn-1;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (y==null)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar retval=x.localeCompare(y);\r\n\t\t\t\t\tif (retval !=0)\r\n\t\t\t\t\t\treturn retval;\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tright.setUniqueName(y);\r\n\t\t\t\t\t\ty=right.name;\r\n\t\t\t\t\t\treturn x.localeCompare(y);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tResource._uniqueIDCounter=0;\r\n\t\tResource._loadedResources=[];\r\n\t\tResource._isLoadedResourcesSorted=false;\r\n\t\treturn Resource;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>Texture</code> 是一个纹理处理类。\r\n\t*/\r\n\t//class laya.resource.Texture extends laya.events.EventDispatcher\r\n\tvar Texture=(function(_super){\r\n\t\tfunction Texture(bitmap,uv){\r\n\t\t\t//this.bitmap=null;\r\n\t\t\t//this.uv=null;\r\n\t\t\tthis.offsetX=0;\r\n\t\t\tthis.offsetY=0;\r\n\t\t\tthis.sourceWidth=0;\r\n\t\t\tthis.sourceHeight=0;\r\n\t\t\t//this._loaded=false;\r\n\t\t\tthis._w=0;\r\n\t\t\tthis._h=0;\r\n\t\t\t//this.$_GID=NaN;\r\n\t\t\t//this.url=null;\r\n\t\t\tthis._uvID=0;\r\n\t\t\tTexture.__super.call(this);\r\n\t\t\tif (bitmap){\r\n\t\t\t\tbitmap.useNum++;\r\n\t\t\t}\r\n\t\t\tthis.setTo(bitmap,uv);\r\n\t\t}\r\n\r\n\t\t__class(Texture,'laya.resource.Texture',_super);\r\n\t\tvar __proto=Texture.prototype;\r\n\t\t/**\r\n\t\t*设置此对象的位图资源、UV数据信息。\r\n\t\t*@param bitmap 位图资源\r\n\t\t*@param uv UV数据信息\r\n\t\t*/\r\n\t\t__proto.setTo=function(bitmap,uv){\r\n\t\t\tthis.bitmap=bitmap;\r\n\t\t\tthis.uv=uv || Texture.DEF_UV;\r\n\t\t\tif (bitmap){\r\n\t\t\t\tthis._w=bitmap.width;\r\n\t\t\t\tthis._h=bitmap.height;\r\n\t\t\t\tthis.sourceWidth=this.sourceWidth || this._w;\r\n\t\t\t\tthis.sourceHeight=this.sourceHeight || this._h\r\n\t\t\t\tthis._loaded=this._w > 0;\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tif (this._loaded){\r\n\t\t\t\t\tRunDriver.addToAtlas && RunDriver.addToAtlas(_this);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar bm=bitmap;\r\n\t\t\t\t\tif ((bm instanceof laya.resource.HTMLImage )&& bm.image)\r\n\t\t\t\t\t\tbm.image.addEventListener('load',function(e){\r\n\t\t\t\t\t\tRunDriver.addToAtlas && RunDriver.addToAtlas(_this);\r\n\t\t\t\t\t},false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private 激活资源。*/\r\n\t\t__proto.active=function(){\r\n\t\t\tthis.bitmap.activeResource();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*销毁纹理（分直接销毁，跟计数销毁两种）\r\n\t\t*@param forceDispose true为强制销毁主纹理，false是通过计数销毁纹理\r\n\t\t*/\r\n\t\t__proto.destroy=function(forceDispose){\r\n\t\t\t(forceDispose===void 0)&& (forceDispose=false);\r\n\t\t\tif (this.bitmap && (this.bitmap).useNum > 0){\r\n\t\t\t\tif (forceDispose){\r\n\t\t\t\t\tthis.bitmap.dispose();\r\n\t\t\t\t\t(this.bitmap).useNum=0;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t(this.bitmap).useNum--;\r\n\t\t\t\t\tif ((this.bitmap).useNum==0){\r\n\t\t\t\t\t\tthis.bitmap.dispose();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.bitmap=null;\r\n\t\t\t\tif (this.url && this===Laya.loader.getRes(this.url))Laya.loader.clearRes(this.url);\r\n\t\t\t\tthis._loaded=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载指定地址的图片。\r\n\t\t*@param url 图片地址。\r\n\t\t*/\r\n\t\t__proto.load=function(url){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._loaded=false;\r\n\t\t\tvar fileBitmap=(this.bitmap || (this.bitmap=HTMLImage.create(URL.formatURL(url))));\r\n\t\t\tif (fileBitmap)fileBitmap.useNum++;\r\n\t\t\tvar _this=this;\r\n\t\t\tfileBitmap.onload=function (){\r\n\t\t\t\tfileBitmap.onload=null;\r\n\t\t\t\t_this._loaded=true;\r\n\t\t\t\t_$this.sourceWidth=_$this._w=fileBitmap.width;\r\n\t\t\t\t_$this.sourceHeight=_$this._h=fileBitmap.height;\r\n\t\t\t\t_this.event(/*laya.events.Event.LOADED*/\"loaded\",this);\r\n\t\t\t\t(RunDriver.addToAtlas)&& (RunDriver.addToAtlas(_this));\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto.addTextureToAtlas=function(e){\r\n\t\t\tRunDriver.addTextureToAtlas(this);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取Texture上的某个区域的像素点\r\n\t\t*@param x\r\n\t\t*@param y\r\n\t\t*@param width\r\n\t\t*@param height\r\n\t\t*@return 返回像素点集合\r\n\t\t*/\r\n\t\t__proto.getPixels=function(x,y,width,height){\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\treturn RunDriver.getTexturePixels(this,x,y,width,height);\r\n\t\t\t\t}else {\r\n\t\t\t\tBrowser.canvas.size(width,height);\r\n\t\t\t\tBrowser.canvas.clear();\r\n\t\t\t\tBrowser.context.drawTexture(this,-x,-y,this.width,this.height,0,0);\r\n\t\t\t\tvar info=Browser.context.getImageData(0,0,width,height);\r\n\t\t\t}\r\n\t\t\treturn info.data;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto.onAsynLoaded=function(url,bitmap){\r\n\t\t\tif (bitmap)bitmap.useNum++;\r\n\t\t\tthis.setTo(bitmap,this.uv);\r\n\t\t}\r\n\r\n\t\t/**激活并获取资源。*/\r\n\t\t__getset(0,__proto,'source',function(){\r\n\t\t\tthis.bitmap.activeResource();\r\n\t\t\treturn this.bitmap.source;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示是否加载成功，只能表示初次载入成功（通常包含下载和载入）,并不能完全表示资源是否可立即使用（资源管理机制释放影响等）。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'loaded',function(){\r\n\t\t\treturn this._loaded;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示资源是否已释放。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'released',function(){\r\n\t\t\treturn this.bitmap.released;\r\n\t\t});\r\n\r\n\t\t/**实际宽度。*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\tif (this._w)return this._w;\r\n\t\t\treturn (this.uv && this.uv!==Texture.DEF_UV)? (this.uv[2]-this.uv[0])*this.bitmap.width :this.bitmap.width;\r\n\t\t\t},function(value){\r\n\t\t\tthis._w=value;\r\n\t\t\tthis.sourceWidth || (this.sourceWidth=value);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*通过外部设置是否启用纹理平铺(后面要改成在着色器里计算)\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取当前纹理是否启用了纹理平铺\r\n\t\t*/\r\n\t\t__getset(0,__proto,'repeat',function(){\r\n\t\t\tif (Render.isWebGL && this.bitmap){\r\n\t\t\t\treturn this.bitmap.repeat;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t\t},function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tif (Render.isWebGL && this.bitmap){\r\n\t\t\t\t\tthis.bitmap.repeat=value;\r\n\t\t\t\t\tif (value){\r\n\t\t\t\t\t\tthis.bitmap.enableMerageInAtlas=false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**实际高度。*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\tif (this._h)return this._h;\r\n\t\t\treturn (this.uv && this.uv!==Texture.DEF_UV)? (this.uv[5]-this.uv[1])*this.bitmap.height :this.bitmap.height;\r\n\t\t\t},function(value){\r\n\t\t\tthis._h=value;\r\n\t\t\tthis.sourceHeight || (this.sourceHeight=value);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置线性采样的状态（目前只能第一次绘制前设置false生效,来关闭线性采样）\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取当前纹理是否启用了线性采样\r\n\t\t*/\r\n\t\t__getset(0,__proto,'isLinearSampling',function(){\r\n\t\t\treturn Render.isWebGL ? (this.bitmap.minFifter !=0x2600):true;\r\n\t\t\t},function(value){\r\n\t\t\tif (!value && Render.isWebGL){\r\n\t\t\t\tif (!value && (this.bitmap.minFifter==-1)&& (this.bitmap.magFifter==-1)){\r\n\t\t\t\t\tthis.bitmap.minFifter=0x2600;\r\n\t\t\t\t\tthis.bitmap.magFifter=0x2600;\r\n\t\t\t\t\tthis.bitmap.enableMerageInAtlas=false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tTexture.moveUV=function(offsetX,offsetY,uv){\r\n\t\t\tfor (var i=0;i < 8;i+=2){\r\n\t\t\t\tuv[i]+=offsetX;\r\n\t\t\t\tuv[i+1]+=offsetY;\r\n\t\t\t}\r\n\t\t\treturn uv;\r\n\t\t}\r\n\r\n\t\tTexture.create=function(source,x,y,width,height,offsetX,offsetY,sourceWidth,sourceHeight){\r\n\t\t\t(offsetX===void 0)&& (offsetX=0);\r\n\t\t\t(offsetY===void 0)&& (offsetY=0);\r\n\t\t\t(sourceWidth===void 0)&& (sourceWidth=0);\r\n\t\t\t(sourceHeight===void 0)&& (sourceHeight=0);\r\n\t\t\tvar btex=(source instanceof laya.resource.Texture );\r\n\t\t\tvar uv=btex ? source.uv :Texture.DEF_UV;\r\n\t\t\tvar bitmap=btex ? source.bitmap :source;\r\n\t\t\tvar tex=new Texture(bitmap,null);\r\n\t\t\ttex.width=width;\r\n\t\t\ttex.height=height;\r\n\t\t\ttex.offsetX=offsetX;\r\n\t\t\ttex.offsetY=offsetY;\r\n\t\t\ttex.sourceWidth=sourceWidth || width;\r\n\t\t\ttex.sourceHeight=sourceHeight || height;\r\n\t\t\tvar dwidth=1 / bitmap.width;\r\n\t\t\tvar dheight=1 / bitmap.height;\r\n\t\t\tx *=dwidth;\r\n\t\t\ty *=dheight;\r\n\t\t\twidth *=dwidth;\r\n\t\t\theight *=dheight;\r\n\t\t\tvar u1=tex.uv[0],v1=tex.uv[1],u2=tex.uv[4],v2=tex.uv[5];\r\n\t\t\tvar inAltasUVWidth=(u2-u1),inAltasUVHeight=(v2-v1);\r\n\t\t\tvar oriUV=Texture.moveUV(uv[0],uv[1],[x,y,x+width,y,x+width,y+height,x,y+height]);\r\n\t\t\ttex.uv=[u1+oriUV[0] *inAltasUVWidth,v1+oriUV[1] *inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3] *inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6] *inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight];\r\n\t\t\treturn tex;\r\n\t\t}\r\n\r\n\t\tTexture.createFromTexture=function(texture,x,y,width,height){\r\n\t\t\tvar rect=Rectangle.TEMP.setTo(x-texture.offsetX,y-texture.offsetY,width,height);\r\n\t\t\tvar result=rect.intersection(Texture._rect1.setTo(0,0,texture.width,texture.height),Texture._rect2);\r\n\t\t\tif (result)\r\n\t\t\t\tvar tex=Texture.create(texture,result.x,result.y,result.width,result.height,result.x-rect.x,result.y-rect.y,width,height);\r\n\t\t\telse return null;\r\n\t\t\ttex.bitmap.useNum--;\r\n\t\t\treturn tex;\r\n\t\t}\r\n\r\n\t\tTexture.DEF_UV=[0,0,1.0,0,1.0,1.0,0,1.0];\r\n\t\tTexture.INV_UV=[0,1,1.0,1,1.0,0.0,0,0.0];\r\n\t\tTexture._rect1=new Rectangle();\r\n\t\tTexture._rect2=new Rectangle();\r\n\t\treturn Texture;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<code>TimeLine</code> 是一个用来创建时间轴动画的类。\r\n\t*/\r\n\t//class laya.utils.TimeLine extends laya.events.EventDispatcher\r\n\tvar TimeLine=(function(_super){\r\n\t\tvar tweenData;\r\n\t\tfunction TimeLine(){\r\n\t\t\tthis._labelDic=null;\r\n\t\t\tthis._tweenDic={};\r\n\t\t\tthis._tweenDataList=[];\r\n\t\t\tthis._endTweenDataList=null;\r\n\t\t\tthis._currTime=0;\r\n\t\t\tthis._lastTime=0;\r\n\t\t\tthis._startTime=0;\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._gidIndex=0;\r\n\t\t\tthis._firstTweenDic={};\r\n\t\t\tthis._startTimeSort=false;\r\n\t\t\tthis._endTimeSort=false;\r\n\t\t\tthis._loopKey=false;\r\n\t\t\tthis.scale=1;\r\n\t\t\tthis._frameRate=60;\r\n\t\t\tthis._frameIndex=0;\r\n\t\t\tthis._total=0;\r\n\t\t\tTimeLine.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(TimeLine,'laya.utils.TimeLine',_super);\r\n\t\tvar __proto=TimeLine.prototype;\r\n\t\t/**\r\n\t\t*控制一个对象，从当前点移动到目标点。\r\n\t\t*@param target 要控制的对象。\r\n\t\t*@param props 要控制对象的属性。\r\n\t\t*@param duration 对象TWEEN的时间。\r\n\t\t*@param ease 缓动类型\r\n\t\t*@param offset 相对于上一个对象，偏移多长时间（单位：毫秒）。\r\n\t\t*/\r\n\t\t__proto.to=function(target,props,duration,ease,offset){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\treturn this._create(target,props,duration,ease,offset,true);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从 props 属性，缓动到当前状态。\r\n\t\t*@param target target 目标对象(即将更改属性值的对象)\r\n\t\t*@param props 要控制对象的属性\r\n\t\t*@param duration 对象TWEEN的时间\r\n\t\t*@param ease 缓动类型\r\n\t\t*@param offset 相对于上一个对象，偏移多长时间（单位：毫秒）\r\n\t\t*/\r\n\t\t__proto.from=function(target,props,duration,ease,offset){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\treturn this._create(target,props,duration,ease,offset,false);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._create=function(target,props,duration,ease,offset,isTo){\r\n\t\t\tvar tTweenData=new tweenData();\r\n\t\t\ttTweenData.isTo=isTo;\r\n\t\t\ttTweenData.type=0;\r\n\t\t\ttTweenData.target=target;\r\n\t\t\ttTweenData.duration=duration;\r\n\t\t\ttTweenData.data=props;\r\n\t\t\ttTweenData.startTime=this._startTime+offset;\r\n\t\t\ttTweenData.endTime=tTweenData.startTime+tTweenData.duration;\r\n\t\t\ttTweenData.ease=ease;\r\n\t\t\tthis._startTime=Math.max(tTweenData.endTime,this._startTime);\r\n\t\t\tthis._tweenDataList.push(tTweenData);\r\n\t\t\tthis._startTimeSort=true;\r\n\t\t\tthis._endTimeSort=true;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在时间队列中加入一个标签。\r\n\t\t*@param label 标签名称。\r\n\t\t*@param offset 标签相对于上个动画的偏移时间(单位：毫秒)。\r\n\t\t*/\r\n\t\t__proto.addLabel=function(label,offset){\r\n\t\t\tvar tTweenData=new tweenData();\r\n\t\t\ttTweenData.type=1;\r\n\t\t\ttTweenData.data=label;\r\n\t\t\ttTweenData.endTime=tTweenData.startTime=this._startTime+offset;\r\n\t\t\tthis._labelDic || (this._labelDic={});\r\n\t\t\tthis._labelDic[label]=tTweenData;\r\n\t\t\tthis._tweenDataList.push(tTweenData);\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*移除指定的标签\r\n\t\t*@param label\r\n\t\t*/\r\n\t\t__proto.removeLabel=function(label){\r\n\t\t\tif (this._labelDic && this._labelDic[label]){\r\n\t\t\t\tvar tTweenData=this._labelDic[label];\r\n\t\t\t\tif (tTweenData){\r\n\t\t\t\t\tvar tIndex=this._tweenDataList.indexOf(tTweenData);\r\n\t\t\t\t\tif (tIndex >-1){\r\n\t\t\t\t\t\tthis._tweenDataList.splice(tIndex,1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdelete this._labelDic[label];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*动画从整个动画的某一时间开始。\r\n\t\t*@param time(单位：毫秒)。\r\n\t\t*/\r\n\t\t__proto.gotoTime=function(time){\r\n\t\t\tif (this._tweenDataList==null || this._tweenDataList.length==0)return;\r\n\t\t\tvar tTween;\r\n\t\t\tvar tObject;\r\n\t\t\tfor (var p in this._firstTweenDic){\r\n\t\t\t\ttObject=this._firstTweenDic[p];\r\n\t\t\t\tif (tObject){\r\n\t\t\t\t\tfor (var tDataP in tObject){\r\n\t\t\t\t\t\tif (tObject.diyTarget.hasOwnProperty(tDataP)){\r\n\t\t\t\t\t\t\ttObject.diyTarget[tDataP]=tObject[tDataP];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (p in this._tweenDic){\r\n\t\t\t\ttTween=this._tweenDic[p];\r\n\t\t\t\ttTween.clear();\r\n\t\t\t\tdelete this._tweenDic[p];\r\n\t\t\t}\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._gidIndex=0;\r\n\t\t\tthis._currTime=time;\r\n\t\t\tthis._lastTime=Browser.now();\r\n\t\t\tvar tTweenDataCopyList;\r\n\t\t\tif (this._endTweenDataList==null || this._endTimeSort){\r\n\t\t\t\tthis._endTimeSort=false;\r\n\t\t\t\tthis._endTweenDataList=tTweenDataCopyList=this._tweenDataList.concat();\r\n\t\t\t\tfunction Compare (paraA,paraB){\r\n\t\t\t\t\tif (paraA.endTime > paraB.endTime){\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}else if (paraA.endTime < paraB.endTime){\r\n\t\t\t\t\t\treturn-1;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttTweenDataCopyList.sort(Compare);\r\n\t\t\t\t}else {\r\n\t\t\t\ttTweenDataCopyList=this._endTweenDataList\r\n\t\t\t};\r\n\t\t\tvar tTweenData;\r\n\t\t\tfor (var i=0,n=tTweenDataCopyList.length;i < n;i++){\r\n\t\t\t\ttTweenData=tTweenDataCopyList[i];\r\n\t\t\t\tif (tTweenData.type==0){\r\n\t\t\t\t\tif (time >=tTweenData.endTime){\r\n\t\t\t\t\t\tthis._index=Math.max(this._index,i+1);\r\n\t\t\t\t\t\tvar props=tTweenData.data;\r\n\t\t\t\t\t\tfor (var tP in props){\r\n\t\t\t\t\t\t\tif (tTweenData.isTo){\r\n\t\t\t\t\t\t\t\ttTweenData.target[tP]=props[tP];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (i=0,n=this._tweenDataList.length;i < n;i++){\r\n\t\t\t\ttTweenData=this._tweenDataList[i];\r\n\t\t\t\tif (tTweenData.type==0){\r\n\t\t\t\t\tif (time >=tTweenData.startTime && time < tTweenData.endTime){\r\n\t\t\t\t\t\tthis._index=Math.max(this._index,i+1);\r\n\t\t\t\t\t\tthis._gidIndex++;\r\n\t\t\t\t\t\ttTween=Pool.getItemByClass(\"tween\",Tween);\r\n\t\t\t\t\t\ttTween._create(tTweenData.target,tTweenData.data,tTweenData.duration,tTweenData.ease,Handler.create(this,this._animComplete,[this._gidIndex]),0,false,tTweenData.isTo,true,false);\r\n\t\t\t\t\t\ttTween.setStartTime(this._currTime-(time-tTweenData.startTime));\r\n\t\t\t\t\t\ttTween._updateEase(this._currTime);\r\n\t\t\t\t\t\ttTween.gid=this._gidIndex;\r\n\t\t\t\t\t\tthis._tweenDic[this._gidIndex]=tTween;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*从指定的标签开始播。\r\n\t\t*@param Label 标签名。\r\n\t\t*/\r\n\t\t__proto.gotoLabel=function(Label){\r\n\t\t\tif (this._labelDic==null)return;\r\n\t\t\tvar tLabelData=this._labelDic[Label];\r\n\t\t\tif (tLabelData)this.gotoTime(tLabelData.startTime);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*暂停整个动画。\r\n\t\t*/\r\n\t\t__proto.pause=function(){\r\n\t\t\tLaya.timer.clear(this,this._update);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*恢复暂停动画的播放。\r\n\t\t*/\r\n\t\t__proto.resume=function(){\r\n\t\t\tthis.play(this._currTime,this._loopKey);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放动画。\r\n\t\t*@param timeOrLabel 开启播放的时间点或标签名。\r\n\t\t*@param loop 是否循环播放。\r\n\t\t*/\r\n\t\t__proto.play=function(timeOrLabel,loop){\r\n\t\t\t(timeOrLabel===void 0)&& (timeOrLabel=0);\r\n\t\t\t(loop===void 0)&& (loop=false);\r\n\t\t\tif (this._startTimeSort){\r\n\t\t\t\tthis._startTimeSort=false;\r\n\t\t\t\tfunction Compare (paraA,paraB){\r\n\t\t\t\t\tif (paraA.startTime > paraB.startTime){\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}else if (paraA.startTime < paraB.startTime){\r\n\t\t\t\t\t\treturn-1;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._tweenDataList.sort(Compare);\r\n\t\t\t\tfor (var i=0,n=this._tweenDataList.length;i < n;i++){\r\n\t\t\t\t\tvar tTweenData=this._tweenDataList[i];\r\n\t\t\t\t\tif (tTweenData !=null && tTweenData.type==0){\r\n\t\t\t\t\t\tvar tTarget=tTweenData.target;\r\n\t\t\t\t\t\tvar gid=(tTarget.$_GID || (tTarget.$_GID=Utils.getGID()));\r\n\t\t\t\t\t\tvar tSrcData=null;\r\n\t\t\t\t\t\tif (this._firstTweenDic[gid]==null){\r\n\t\t\t\t\t\t\ttSrcData={};\r\n\t\t\t\t\t\t\ttSrcData.diyTarget=tTarget;\r\n\t\t\t\t\t\t\tthis._firstTweenDic[gid]=tSrcData;\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\ttSrcData=this._firstTweenDic[gid];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (var p in tTweenData.data){\r\n\t\t\t\t\t\t\tif (tSrcData[p]==null){\r\n\t\t\t\t\t\t\t\ttSrcData[p]=tTarget[p];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif ((typeof timeOrLabel=='string')){\r\n\t\t\t\tthis.gotoLabel(timeOrLabel);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.gotoTime(timeOrLabel);\r\n\t\t\t}\r\n\t\t\tthis._loopKey=loop;\r\n\t\t\tthis._lastTime=Browser.now();\r\n\t\t\tLaya.timer.frameLoop(1,this,this._update);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*更新当前动画。\r\n\t\t*/\r\n\t\t__proto._update=function(){\r\n\t\t\tif (this._currTime >=this._startTime){\r\n\t\t\t\tif (this._loopKey){\r\n\t\t\t\t\tthis._complete();\r\n\t\t\t\t\tthis.gotoTime(0);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._complete();\r\n\t\t\t\t\tthis.pause();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar tNow=Browser.now();\r\n\t\t\tvar tFrameTime=tNow-this._lastTime;\r\n\t\t\tvar tCurrTime=this._currTime+=tFrameTime *this.scale;\r\n\t\t\tthis._lastTime=tNow;\r\n\t\t\tvar tTween;\r\n\t\t\tif (this._tweenDataList.length !=0 && this._index < this._tweenDataList.length){\r\n\t\t\t\tvar tTweenData=this._tweenDataList[this._index];\r\n\t\t\t\tif (tCurrTime >=tTweenData.startTime){\r\n\t\t\t\t\tthis._index++;\r\n\t\t\t\t\tif (tTweenData.type==0){\r\n\t\t\t\t\t\tthis._gidIndex++;\r\n\t\t\t\t\t\ttTween=Pool.getItemByClass(\"tween\",Tween);\r\n\t\t\t\t\t\ttTween._create(tTweenData.target,tTweenData.data,tTweenData.duration,tTweenData.ease,new Handler(this,this._animComplete,[this._gidIndex]),0,false,tTweenData.isTo,true,false);\r\n\t\t\t\t\t\ttTween.setStartTime(tCurrTime);\r\n\t\t\t\t\t\ttTween.gid=this._gidIndex;\r\n\t\t\t\t\t\tthis._tweenDic[this._gidIndex]=tTween;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.LABEL*/\"label\",tTweenData.data);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var p in this._tweenDic){\r\n\t\t\t\ttTween=this._tweenDic[p];\r\n\t\t\t\ttTween._updateEase(tCurrTime);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*指定的动画索引处的动画播放完成后，把此动画从列表中删除。\r\n\t\t*@param index\r\n\t\t*/\r\n\t\t__proto._animComplete=function(index){\r\n\t\t\tvar tTween=this._tweenDic[index];\r\n\t\t\tif (tTween)delete this._tweenDic[index];\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._complete=function(){\r\n\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*重置所有对象，复用对象的时候使用。\r\n\t\t*/\r\n\t\t__proto.reset=function(){\r\n\t\t\tvar p;\r\n\t\t\tif (this._labelDic){\r\n\t\t\t\tfor (p in this._labelDic){\r\n\t\t\t\t\tdelete this._labelDic[p];\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar tTween;\r\n\t\t\tfor (p in this._tweenDic){\r\n\t\t\t\ttTween=this._tweenDic[p];\r\n\t\t\t\ttTween.clear();\r\n\t\t\t\tdelete this._tweenDic[p];\r\n\t\t\t}\r\n\t\t\tfor (p in this._firstTweenDic){\r\n\t\t\t\tdelete this._firstTweenDic[p];\r\n\t\t\t}\r\n\t\t\tthis._endTweenDataList=null;\r\n\t\t\tthis._tweenDataList.length=0;\r\n\t\t\tthis._currTime=0;\r\n\t\t\tthis._lastTime=0;\r\n\t\t\tthis._startTime=0;\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._gidIndex=0;\r\n\t\t\tthis.scale=1;\r\n\t\t\tLaya.timer.clear(this,this._update);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*彻底销毁此对象。\r\n\t\t*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis.reset();\r\n\t\t\tthis._labelDic=null;\r\n\t\t\tthis._tweenDic=null;\r\n\t\t\tthis._tweenDataList=null;\r\n\t\t\tthis._firstTweenDic=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*设置帧索引\r\n\t\t*/\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*得到帧索引\r\n\t\t*/\r\n\t\t__getset(0,__proto,'index',function(){\r\n\t\t\treturn this._frameIndex;\r\n\t\t\t},function(value){\r\n\t\t\tthis._frameIndex=value;\r\n\t\t\tthis.gotoTime(this._frameIndex / this._frameRate *1000);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*得到总帧数据\r\n\t\t*/\r\n\t\t__getset(0,__proto,'total',function(){\r\n\t\t\tthis._total=Math.floor(this._startTime / 1000 *this._frameRate);\r\n\t\t\treturn this._total;\r\n\t\t});\r\n\r\n\t\tTimeLine.to=function(target,props,duration,ease,offset){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\treturn (new TimeLine()).to(target,props,duration,ease,offset);\r\n\t\t}\r\n\r\n\t\tTimeLine.from=function(target,props,duration,ease,offset){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\treturn (new TimeLine()).from(target,props,duration,ease,offset);\r\n\t\t}\r\n\r\n\t\tTimeLine.__init$=function(){\r\n\t\t\t//class tweenData\r\n\t\t\ttweenData=(function(){\r\n\t\t\t\tfunction tweenData(){\r\n\t\t\t\t\tthis.type=0;\r\n\t\t\t\t\tthis.isTo=true;\r\n\t\t\t\t\tthis.startTime=NaN;\r\n\t\t\t\t\tthis.endTime=NaN;\r\n\t\t\t\t\tthis.target=null;\r\n\t\t\t\t\tthis.duration=NaN;\r\n\t\t\t\t\tthis.ease=null;\r\n\t\t\t\t\tthis.data=null;\r\n\t\t\t\t}\r\n\t\t\t\t__class(tweenData,'');\r\n\t\t\t\treturn tweenData;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn TimeLine;\r\n\t})(EventDispatcher)\r\n\r\n\r\n\t/**\r\n\t*<p> <code>Sprite</code> 类是基本显示列表构造块：一个可显示图形并且也可包含子项的显示列表节点。</p>\r\n\t*\r\n\t*@example 以下示例代码，创建了一个 <code>Text</code> 实例。\r\n\t*<listing version=\"3.0\">\r\n\t*package\r\n\t*{\r\n\t\t*import laya.display.Sprite;\r\n\t\t*import laya.events.Event;\r\n\t\t*\r\n\t\t*public class Sprite_Example\r\n\t\t*{\r\n\t\t\t*private var sprite:Sprite;\r\n\t\t\t*private var shape:Sprite\r\n\t\t\t*public function Sprite_Example()\r\n\t\t\t*{\r\n\t\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t\t*onInit();\r\n\t\t\t\t*}\r\n\t\t\t*private function onInit():void\r\n\t\t\t*{\r\n\t\t\t\t*sprite=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t\t\t*sprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n\t\t\t\t*sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n\t\t\t\t*sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n\t\t\t\t*sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。\r\n\t\t\t\t*sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n\t\t\t\t*Laya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。\r\n\t\t\t\t*sprite.on(Event.CLICK,this,onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\t\t\t*shape=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t\t\t*shape.graphics.drawRect(0,0,100,100,\"#ccff00\",\"#ff0000\",2);//绘制一个有边框的填充矩形。\r\n\t\t\t\t*shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n\t\t\t\t*shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n\t\t\t\t*shape.width=100;//设置 shape 对象的宽度。\r\n\t\t\t\t*shape.height=100;//设置 shape 对象的高度。\r\n\t\t\t\t*shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。\r\n\t\t\t\t*shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。\r\n\t\t\t\t*Laya.stage.addChild(shape);//将此 shape 对象添加到显示列表。\r\n\t\t\t\t*shape.on(Event.CLICK,this,onClickShape);//给 shape 对象添加点击事件侦听。\r\n\t\t\t\t*}\r\n\t\t\t*private function onClickSprite():void\r\n\t\t\t*{\r\n\t\t\t\t*trace(\"点击 sprite 对象。\");\r\n\t\t\t\t*sprite.rotation+=5;//旋转 sprite 对象。\r\n\t\t\t\t*}\r\n\t\t\t*private function onClickShape():void\r\n\t\t\t*{\r\n\t\t\t\t*trace(\"点击 shape 对象。\");\r\n\t\t\t\t*shape.rotation+=5;//旋转 shape 对象。\r\n\t\t\t\t*}\r\n\t\t\t*}\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*var sprite;\r\n\t*var shape;\r\n\t*Sprite_Example();\r\n\t*function Sprite_Example()\r\n\t*{\r\n\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t*onInit();\r\n\t\t*}\r\n\t*function onInit()\r\n\t*{\r\n\t\t*sprite=new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t*sprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n\t\t*sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n\t\t*sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n\t\t*sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。\r\n\t\t*sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n\t\t*Laya.stage.addChild(sprite);//将此 sprite 对象添加到显示列表。\r\n\t\t*sprite.on(Event.CLICK,this,onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\t*shape=new laya.display.Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t*shape.graphics.drawRect(0,0,100,100,\"#ccff00\",\"#ff0000\",2);//绘制一个有边框的填充矩形。\r\n\t\t*shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n\t\t*shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n\t\t*shape.width=100;//设置 shape 对象的宽度。\r\n\t\t*shape.height=100;//设置 shape 对象的高度。\r\n\t\t*shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。\r\n\t\t*shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。\r\n\t\t*Laya.stage.addChild(shape);//将此 shape 对象添加到显示列表。\r\n\t\t*shape.on(laya.events.Event.CLICK,this,onClickShape);//给 shape 对象添加点击事件侦听。\r\n\t\t*}\r\n\t*function onClickSprite()\r\n\t*{\r\n\t\t*console.log(\"点击 sprite 对象。\");\r\n\t\t*sprite.rotation+=5;//旋转 sprite 对象。\r\n\t\t*}\r\n\t*function onClickShape()\r\n\t*{\r\n\t\t*console.log(\"点击 shape 对象。\");\r\n\t\t*shape.rotation+=5;//旋转 shape 对象。\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*import Sprite=laya.display.Sprite;\r\n\t*class Sprite_Example {\r\n\t\t*private sprite:Sprite;\r\n\t\t*private shape:Sprite\r\n\t\t*public Sprite_Example(){\r\n\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t*this.onInit();\r\n\t\t\t*}\r\n\t\t*private onInit():void {\r\n\t\t\t*this.sprite=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t\t*this.sprite.loadImage(\"resource/ui/bg.png\");//加载并显示图片。\r\n\t\t\t*this.sprite.x=200;//设置 sprite 对象相对于父容器的水平方向坐标值。\r\n\t\t\t*this.sprite.y=200;//设置 sprite 对象相对于父容器的垂直方向坐标值。\r\n\t\t\t*this.sprite.pivotX=0;//设置 sprite 对象的水平方法轴心点坐标。\r\n\t\t\t*this.sprite.pivotY=0;//设置 sprite 对象的垂直方法轴心点坐标。\r\n\t\t\t*Laya.stage.addChild(this.sprite);//将此 sprite 对象添加到显示列表。\r\n\t\t\t*this.sprite.on(laya.events.Event.CLICK,this,this.onClickSprite);//给 sprite 对象添加点击事件侦听。\r\n\t\t\t*this.shape=new Sprite();//创建一个 Sprite 类的实例对象 sprite 。\r\n\t\t\t*this.shape.graphics.drawRect(0,0,100,100,\"#ccff00\",\"#ff0000\",2);//绘制一个有边框的填充矩形。\r\n\t\t\t*this.shape.x=400;//设置 shape 对象相对于父容器的水平方向坐标值。\r\n\t\t\t*this.shape.y=200;//设置 shape 对象相对于父容器的垂直方向坐标值。\r\n\t\t\t*this.shape.width=100;//设置 shape 对象的宽度。\r\n\t\t\t*this.shape.height=100;//设置 shape 对象的高度。\r\n\t\t\t*this.shape.pivotX=50;//设置 shape 对象的水平方法轴心点坐标。\r\n\t\t\t*this.shape.pivotY=50;//设置 shape 对象的垂直方法轴心点坐标。\r\n\t\t\t*Laya.stage.addChild(this.shape);//将此 shape 对象添加到显示列表。\r\n\t\t\t*this.shape.on(laya.events.Event.CLICK,this,this.onClickShape);//给 shape 对象添加点击事件侦听。\r\n\t\t\t*}\r\n\t\t*private onClickSprite():void {\r\n\t\t\t*console.log(\"点击 sprite 对象。\");\r\n\t\t\t*this.sprite.rotation+=5;//旋转 sprite 对象。\r\n\t\t\t*}\r\n\t\t*private onClickShape():void {\r\n\t\t\t*console.log(\"点击 shape 对象。\");\r\n\t\t\t*this.shape.rotation+=5;//旋转 shape 对象。\r\n\t\t\t*}\r\n\t\t*}\r\n\t*</listing>\r\n\t*/\r\n\t//class laya.display.Sprite extends laya.display.Node\r\n\tvar Sprite=(function(_super){\r\n\t\tfunction Sprite(){\r\n\t\t\tthis.mouseThrough=false;\r\n\t\t\tthis._transform=null;\r\n\t\t\tthis._tfChanged=false;\r\n\t\t\tthis._x=0;\r\n\t\t\tthis._y=0;\r\n\t\t\tthis._width=0;\r\n\t\t\tthis._height=0;\r\n\t\t\tthis._repaint=1;\r\n\t\t\tthis._changeType=0;\r\n\t\t\tthis._mouseEnableState=0;\r\n\t\t\tthis._zOrder=0;\r\n\t\t\tthis._graphics=null;\r\n\t\t\tthis._renderType=0;\r\n\t\t\tthis.autoSize=false;\r\n\t\t\tthis.hitTestPrior=false;\r\n\t\t\tthis.viewport=null;\r\n\t\t\tthis._optimizeScrollRect=false;\r\n\t\t\tthis._texture=null;\r\n\t\t\tSprite.__super.call(this);\r\n\t\t\tthis._style=Style.EMPTY;\r\n\t\t}\r\n\r\n\t\t__class(Sprite,'laya.display.Sprite',_super);\r\n\t\tvar __proto=Sprite.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.display.ILayout\":true})\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.destroy=function(destroyChild){\r\n\t\t\t(destroyChild===void 0)&& (destroyChild=true);\r\n\t\t\t_super.prototype.destroy.call(this,destroyChild);\r\n\t\t\tthis._style && this._style.destroy();\r\n\t\t\tthis._transform=null;\r\n\t\t\tthis._style=null;\r\n\t\t\tthis._graphics=null;\r\n\t\t}\r\n\r\n\t\t/**根据zOrder进行重新排序。*/\r\n\t\t__proto.updateZOrder=function(){\r\n\t\t\tUtils.updateOrder(this._childs)&& this.repaint();\r\n\t\t}\r\n\r\n\t\t/**在设置cacheAs或staticCache=true的情况下，调用此方法会重新刷新缓存。*/\r\n\t\t__proto.reCache=function(){\r\n\t\t\tif (this._$P.cacheCanvas)this._$P.cacheCanvas.reCache=true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置bounds大小，如果有设置，则不再通过getBounds计算\r\n\t\t*@param bound bounds矩形区域\r\n\t\t*/\r\n\t\t__proto.setBounds=function(bound){\r\n\t\t\tthis._set$P(\"uBounds\",bound);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取本对象在父容器坐标系的矩形显示区域。\r\n\t\t*<p><b>注意：</b>计算量较大，尽量少用。</p>\r\n\t\t*@return 矩形区域。\r\n\t\t*/\r\n\t\t__proto.getBounds=function(){\r\n\t\t\tif (!this._$P.mBounds)this._set$P(\"mBounds\",new Rectangle());\r\n\t\t\treturn Rectangle._getWrapRec(this._boundPointsToParent(),this._$P.mBounds);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取本对象在自己坐标系的矩形显示区域。\r\n\t\t*<p><b>注意：</b>计算量较大，尽量少用。</p>\r\n\t\t*@return 矩形区域。\r\n\t\t*/\r\n\t\t__proto.getSelfBounds=function(){\r\n\t\t\tif (!this._$P.mBounds)this._set$P(\"mBounds\",new Rectangle());\r\n\t\t\treturn Rectangle._getWrapRec(this._getBoundPointsM(false),this._$P.mBounds);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取本对象在父容器坐标系的显示区域多边形顶点列表。\r\n\t\t*当显示对象链中有旋转时，返回多边形顶点列表，无旋转时返回矩形的四个顶点。\r\n\t\t*@param ifRotate 之前的对象链中是否有旋转。\r\n\t\t*@return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。\r\n\t\t*/\r\n\t\t__proto._boundPointsToParent=function(ifRotate){\r\n\t\t\t(ifRotate===void 0)&& (ifRotate=false);\r\n\t\t\tvar pX=0,pY=0;\r\n\t\t\tif (this._style){\r\n\t\t\t\tpX=this._style._tf.translateX;\r\n\t\t\t\tpY=this._style._tf.translateY;\r\n\t\t\t\tifRotate=ifRotate || (this._style._tf.rotate!==0);\r\n\t\t\t\tif (this._style.scrollRect){\r\n\t\t\t\t\tpX+=this._style.scrollRect.x;\r\n\t\t\t\t\tpY+=this._style.scrollRect.y;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar pList=this._getBoundPointsM(ifRotate);\r\n\t\t\tif (!pList || pList.length < 1)return pList;\r\n\t\t\tif (pList.length !=8){\r\n\t\t\t\tpList=ifRotate ? GrahamScan.scanPList(pList):Rectangle._getWrapRec(pList,Rectangle.TEMP)._getBoundPoints();\r\n\t\t\t}\r\n\t\t\tif (!this.transform){\r\n\t\t\t\tUtils.transPointList(pList,this.x-pX,this.y-pY);\r\n\t\t\t\treturn pList;\r\n\t\t\t};\r\n\t\t\tvar tPoint=Point.TEMP;\r\n\t\t\tvar i=0,len=pList.length;\r\n\t\t\tfor (i=0;i < len;i+=2){\r\n\t\t\t\ttPoint.x=pList[i];\r\n\t\t\t\ttPoint.y=pList[i+1];\r\n\t\t\t\tthis.toParentPoint(tPoint);\r\n\t\t\t\tpList[i]=tPoint.x;\r\n\t\t\t\tpList[i+1]=tPoint.y;\r\n\t\t\t}\r\n\t\t\treturn pList;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回此实例中的绘图对象（ <code>Graphics</code> ）的显示区域。\r\n\t\t*@return 一个 Rectangle 对象，表示获取到的显示区域。\r\n\t\t*/\r\n\t\t__proto.getGraphicBounds=function(){\r\n\t\t\tif (!this._graphics)return Rectangle.TEMP.setTo(0,0,0,0);\r\n\t\t\treturn this._graphics.getBounds();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取自己坐标系的显示区域多边形顶点列表\r\n\t\t*@param ifRotate 当前的显示对象链是否由旋转\r\n\t\t*@return 顶点列表。结构：[x1,y1,x2,y2,x3,y3,...]。\r\n\t\t*/\r\n\t\t__proto._getBoundPointsM=function(ifRotate){\r\n\t\t\t(ifRotate===void 0)&& (ifRotate=false);\r\n\t\t\tif (this._$P.uBounds)return this._$P.uBounds._getBoundPoints();\r\n\t\t\tif (!this._$P.temBM)this._set$P(\"temBM\",[]);\r\n\t\t\tif (this.scrollRect){\r\n\t\t\t\tvar rst=Utils.clearArray(this._$P.temBM);\r\n\t\t\t\tvar rec=Rectangle.TEMP;\r\n\t\t\t\trec.copyFrom(this.scrollRect);\r\n\t\t\t\tUtils.concatArray(rst,rec._getBoundPoints());\r\n\t\t\t\treturn rst;\r\n\t\t\t};\r\n\t\t\tvar pList=this._graphics ? this._graphics.getBoundPoints():Utils.clearArray(this._$P.temBM);\r\n\t\t\tvar child;\r\n\t\t\tvar cList;\r\n\t\t\tvar __childs;\r\n\t\t\t__childs=this._childs;\r\n\t\t\tfor (var i=0,n=__childs.length;i < n;i++){\r\n\t\t\t\tchild=__childs [i];\r\n\t\t\t\tif ((child instanceof laya.display.Sprite )&& child.visible==true){\r\n\t\t\t\t\tcList=child._boundPointsToParent(ifRotate);\r\n\t\t\t\t\tif (cList)\r\n\t\t\t\t\t\tpList=pList ? Utils.concatArray(pList,cList):cList;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pList;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取样式。\r\n\t\t*@return 样式 Style 。\r\n\t\t*/\r\n\t\t__proto.getStyle=function(){\r\n\t\t\tthis._style===Style.EMPTY && (this._style=new Style());\r\n\t\t\treturn this._style;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*设置样式。\r\n\t\t*@param value 样式。\r\n\t\t*/\r\n\t\t__proto.setStyle=function(value){\r\n\t\t\tthis._style=value;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._adjustTransform=function(){\r\n\t\t\t'use strict';\r\n\t\t\tthis._tfChanged=false;\r\n\t\t\tvar style=this._style;\r\n\t\t\tvar tf=style._tf;\r\n\t\t\tvar sx=tf.scaleX,sy=tf.scaleY;\r\n\t\t\tvar m;\r\n\t\t\tif (tf.rotate || sx!==1 || sy!==1 || tf.skewX || tf.skewY){\r\n\t\t\t\tm=this._transform || (this._transform=Matrix.create());\r\n\t\t\t\tm.bTransform=true;\r\n\t\t\t\tif (tf.rotate){\r\n\t\t\t\t\tvar angle=tf.rotate *0.0174532922222222;\r\n\t\t\t\t\tvar cos=m.cos=Math.cos(angle);\r\n\t\t\t\t\tvar sin=m.sin=Math.sin(angle);\r\n\t\t\t\t\tm.a=sx *cos;\r\n\t\t\t\t\tm.b=sx *sin;\r\n\t\t\t\t\tm.c=-sy *sin;\r\n\t\t\t\t\tm.d=sy *cos;\r\n\t\t\t\t\tm.tx=m.ty=0;\r\n\t\t\t\t\treturn m;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tm.a=sx;\r\n\t\t\t\t\tm.d=sy;\r\n\t\t\t\t\tm.c=m.b=m.tx=m.ty=0;\r\n\t\t\t\t\tif (tf.skewX || tf.skewY){\r\n\t\t\t\t\t\treturn m.skew(tf.skewX *0.0174532922222222,tf.skewY *0.0174532922222222);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn m;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._transform && this._transform.destroy();\r\n\t\t\t\tthis._transform=null;\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t}\r\n\t\t\treturn m;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置坐标位置。\r\n\t\t*@param x X 轴坐标。\r\n\t\t*@param y Y 轴坐标。\r\n\t\t*@return 返回对象本身。\r\n\t\t*/\r\n\t\t__proto.pos=function(x,y){\r\n\t\t\tif (this._x!==x || this._y!==y){\r\n\t\t\t\tthis.x=x;\r\n\t\t\t\tthis.y=y;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置轴心点。\r\n\t\t*@param x X轴心点。\r\n\t\t*@param y Y轴心点。\r\n\t\t*@return 返回对象本身。\r\n\t\t*/\r\n\t\t__proto.pivot=function(x,y){\r\n\t\t\tthis.pivotX=x;\r\n\t\t\tthis.pivotY=y;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置宽高。\r\n\t\t*@param width 宽度。\r\n\t\t*@param hegiht 高度。\r\n\t\t*@return 返回对象本身。\r\n\t\t*/\r\n\t\t__proto.size=function(width,height){\r\n\t\t\tthis.width=width;\r\n\t\t\tthis.height=height;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置缩放。\r\n\t\t*@param scaleX X轴缩放比例。\r\n\t\t*@param scaleY Y轴缩放比例。\r\n\t\t*@return 返回对象本身。\r\n\t\t*/\r\n\t\t__proto.scale=function(scaleX,scaleY){\r\n\t\t\tthis.scaleX=scaleX;\r\n\t\t\tthis.scaleY=scaleY;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置倾斜角度。\r\n\t\t*@param skewX 水平倾斜角度。\r\n\t\t*@param skewY 垂直倾斜角度。\r\n\t\t*@return 返回对象本身\r\n\t\t*/\r\n\t\t__proto.skew=function(skewX,skewY){\r\n\t\t\tthis.skewX=skewX;\r\n\t\t\tthis.skewY=skewY;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*更新、呈现显示对象。\r\n\t\t*@param context 渲染的上下文引用。\r\n\t\t*@param x X轴坐标。\r\n\t\t*@param y Y轴坐标。\r\n\t\t*/\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tStat.spriteCount++;\r\n\t\t\tRenderSprite.renders[this._renderType]._fun(this,context,x+this._x,y+this._y);\r\n\t\t\tthis._repaint=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制 <code>Sprite</code> 到 <code>canvas</code> 上。\r\n\t\t*@param canvasWidth 画布宽度。\r\n\t\t*@param canvasHeight 画布高度。\r\n\t\t*@param x 绘制的 X 轴偏移量。\r\n\t\t*@param y 绘制的 Y 轴偏移量。\r\n\t\t*@return HTMLCanvas 对象。\r\n\t\t*/\r\n\t\t__proto.drawToCanvas=function(canvasWidth,canvasHeight,offsetX,offsetY){\r\n\t\t\treturn RunDriver.drawToCanvas(this,this._renderType,canvasWidth,canvasHeight,offsetX,offsetY);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*自定义更新、呈现显示对象。\r\n\t\t*<p><b>注意</b>不要在此函数内增加或删除树节点，否则会树节点遍历照成影响。</p>\r\n\t\t*@param context 渲染的上下文引用。\r\n\t\t*@param x X轴坐标。\r\n\t\t*@param y Y轴坐标。\r\n\t\t*/\r\n\t\t__proto.customRender=function(context,x,y){\r\n\t\t\tthis._renderType |=/*laya.renders.RenderSprite.CUSTOM*/0x200;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*应用滤镜。\r\n\t\t*/\r\n\t\t__proto._applyFilters=function(){\r\n\t\t\tif (Render.isWebGL)return;\r\n\t\t\tvar _filters;\r\n\t\t\t_filters=this._$P.filters;\r\n\t\t\tif (!_filters || _filters.length < 1)return;\r\n\t\t\tfor (var i=0,n=_filters.length;i < n;i++){\r\n\t\t\t\t_filters[i].action.apply(this._$P.cacheCanvas);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*查看当前原件中是否包含发光滤镜。\r\n\t\t*@return 一个 Boolean 值，表示当前原件中是否包含发光滤镜。\r\n\t\t*/\r\n\t\t__proto._isHaveGlowFilter=function(){\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tif (this.filters){\r\n\t\t\t\tfor (i=0;i < this.filters.length;i++){\r\n\t\t\t\t\tif (this.filters[i].type==/*laya.filters.Filter.GLOW*/0x08){\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (i=0,len=this._childs.length;i < len;i++){\r\n\t\t\t\tif (this._childs[i]._isHaveGlowFilter()){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*本地坐标转全局坐标。\r\n\t\t*@param point 本地坐标点。\r\n\t\t*@param createNewPoint 用于存储转换后的坐标的点。\r\n\t\t*@return 转换后的坐标的点。\r\n\t\t*/\r\n\t\t__proto.localToGlobal=function(point,createNewPoint){\r\n\t\t\t(createNewPoint===void 0)&& (createNewPoint=false);\r\n\t\t\tif (!this._displayedInStage || !point)return point;\r\n\t\t\tif (createNewPoint===true){\r\n\t\t\t\tpoint=new Point(point.x,point.y);\r\n\t\t\t};\r\n\t\t\tvar ele=this;\r\n\t\t\twhile (ele){\r\n\t\t\t\tif (ele==Laya.stage)break ;\r\n\t\t\t\tpoint=ele.toParentPoint(point);\r\n\t\t\t\tele=ele.parent;\r\n\t\t\t}\r\n\t\t\treturn point;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*全局坐标转本地坐标。\r\n\t\t*@param point 全局坐标点。\r\n\t\t*@param createNewPoint 用于存储转换后的坐标的点。\r\n\t\t*@return 转换后的坐标的点。\r\n\t\t*/\r\n\t\t__proto.globalToLocal=function(point,createNewPoint){\r\n\t\t\t(createNewPoint===void 0)&& (createNewPoint=false);\r\n\t\t\tif (!this._displayedInStage || !point)return point;\r\n\t\t\tif (createNewPoint===true){\r\n\t\t\t\tpoint=new Point(point.x,point.y);\r\n\t\t\t};\r\n\t\t\tvar ele=this;\r\n\t\t\tvar list=[];\r\n\t\t\twhile (ele){\r\n\t\t\t\tif (ele==Laya.stage)break ;\r\n\t\t\t\tlist.push(ele);\r\n\t\t\t\tele=ele.parent;\r\n\t\t\t};\r\n\t\t\tvar i=list.length-1;\r\n\t\t\twhile (i >=0){\r\n\t\t\t\tele=list[i];\r\n\t\t\t\tpoint=ele.fromParentPoint(point);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t\treturn point;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将本地坐标系坐标转换到父容器坐标系。\r\n\t\t*@param point 本地坐标点。\r\n\t\t*@return 转换后的点。\r\n\t\t*/\r\n\t\t__proto.toParentPoint=function(point){\r\n\t\t\tif (!point)return point;\r\n\t\t\tpoint.x-=this.pivotX;\r\n\t\t\tpoint.y-=this.pivotY;\r\n\t\t\tif (this.transform){\r\n\t\t\t\tthis._transform.transformPoint(point);\r\n\t\t\t}\r\n\t\t\tpoint.x+=this._x;\r\n\t\t\tpoint.y+=this._y;\r\n\t\t\tvar scroll=this._style.scrollRect;\r\n\t\t\tif (scroll){\r\n\t\t\t\tpoint.x-=scroll.x;\r\n\t\t\t\tpoint.y-=scroll.y;\r\n\t\t\t}\r\n\t\t\treturn point;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*将父容器坐标系坐标转换到本地坐标系。\r\n\t\t*@param point 父容器坐标点。\r\n\t\t*@return 转换后的点。\r\n\t\t*/\r\n\t\t__proto.fromParentPoint=function(point){\r\n\t\t\tif (!point)return point;\r\n\t\t\tpoint.x-=this._x;\r\n\t\t\tpoint.y-=this._y;\r\n\t\t\tvar scroll=this._style.scrollRect;\r\n\t\t\tif (scroll){\r\n\t\t\t\tpoint.x+=scroll.x;\r\n\t\t\t\tpoint.y+=scroll.y;\r\n\t\t\t}\r\n\t\t\tif (this.transform){\r\n\t\t\t\tthis._transform.invertTransformPoint(point);\r\n\t\t\t}\r\n\t\t\tpoint.x+=this.pivotX;\r\n\t\t\tpoint.y+=this.pivotY;\r\n\t\t\treturn point;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知。\r\n\t\t*如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnable 的值为 true。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@param caller 事件侦听函数的执行域。\r\n\t\t*@param listener 事件侦听函数。\r\n\t\t*@param args 事件侦听函数的回调参数。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.on=function(type,caller,listener,args){\r\n\t\t\tif (this._mouseEnableState!==1 && this.isMouseEvent(type)){\r\n\t\t\t\tif (this._displayedInStage)this._$2__onDisplay();\r\n\t\t\t\telse laya.events.EventDispatcher.prototype.once.call(this,/*laya.events.Event.DISPLAY*/\"display\",this,this._$2__onDisplay);\r\n\t\t\t}\r\n\t\t\treturn laya.events.EventDispatcher.prototype.on.call(this,type,caller,listener,args);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*使用 EventDispatcher 对象注册指定类型的事件侦听器对象，以使侦听器能够接收事件通知，此侦听事件响应一次后自动移除。\r\n\t\t*如果侦听鼠标事件，则会自动设置自己和父亲节点的属性 mouseEnabled 的值为 true(如果父节点mouseEnabled=false，则停止设置父节点mouseEnabled属性)。\r\n\t\t*@param type 事件的类型。\r\n\t\t*@param caller 事件侦听函数的执行域。\r\n\t\t*@param listener 事件侦听函数。\r\n\t\t*@param args 事件侦听函数的回调参数。\r\n\t\t*@return 此 EventDispatcher 对象。\r\n\t\t*/\r\n\t\t__proto.once=function(type,caller,listener,args){\r\n\t\t\tif (this._mouseEnableState!==1 && this.isMouseEvent(type)){\r\n\t\t\t\tif (this._displayedInStage)this._$2__onDisplay();\r\n\t\t\t\telse laya.events.EventDispatcher.prototype.once.call(this,/*laya.events.Event.DISPLAY*/\"display\",this,this._$2__onDisplay);\r\n\t\t\t}\r\n\t\t\treturn laya.events.EventDispatcher.prototype.once.call(this,type,caller,listener,args);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._$2__onDisplay=function(){\r\n\t\t\tif (this._mouseEnableState!==1){\r\n\t\t\t\tvar ele=this;\r\n\t\t\t\twhile (ele && ele._mouseEnableState!==1){\r\n\t\t\t\t\tele.mouseEnabled=true;\r\n\t\t\t\t\tele=ele.parent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载并显示一个图片。功能等同于Graphics.loadImage\r\n\t\t*@param url 图片地址。\r\n\t\t*@param x 显示图片的x位置\r\n\t\t*@param y 显示图片的y位置\r\n\t\t*@param width 显示图片的宽度，设置为0表示使用图片默认宽度\r\n\t\t*@param height 显示图片的高度，设置为0表示使用图片默认高度\r\n\t\t*@param complete 加载完成回调\r\n\t\t*@return 返回精灵对象本身\r\n\t\t*/\r\n\t\t__proto.loadImage=function(url,x,y,width,height,complete){\r\n\t\t\tvar _$this=this;\r\n\t\t\t(x===void 0)&& (x=0);\r\n\t\t\t(y===void 0)&& (y=0);\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\tfunction loaded (tex){\r\n\t\t\t\tif (!_$this.destroyed){\r\n\t\t\t\t\t_$this.size(x+(width || tex.width),y+(height || tex.height));\r\n\t\t\t\t\t_$this.repaint();\r\n\t\t\t\t\tcomplete && complete.runWith(tex);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.graphics.loadImage(url,x,y,width,height,loaded);\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**cacheAs后，设置自己和父对象缓存失效。*/\r\n\t\t__proto.repaint=function(){\r\n\t\t\tthis.model && this.model.repaint && this.model.repaint();\r\n\t\t\t(this._repaint===0)&& (this._repaint=1,this.parentRepaint());\r\n\t\t\tif (this._$P && this._$P.maskParent){\r\n\t\t\t\tthis._$P.maskParent.repaint();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*获取是否重新缓存。\r\n\t\t*@return 如果重新缓存值为 true，否则值为 false。\r\n\t\t*/\r\n\t\t__proto._needRepaint=function(){\r\n\t\t\treturn (this._repaint!==0)&& this._$P.cacheCanvas && this._$P.cacheCanvas.reCache;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto._childChanged=function(child){\r\n\t\t\tif (this._childs.length)this._renderType |=/*laya.renders.RenderSprite.CHILDS*/0x800;\r\n\t\t\telse this._renderType &=~ /*laya.renders.RenderSprite.CHILDS*/0x800;\r\n\t\t\tif (child && (child).zOrder)Laya.timer.callLater(this,this.updateZOrder);\r\n\t\t\tthis.repaint();\r\n\t\t}\r\n\r\n\t\t/**cacheAs时，设置所有父对象缓存失效。 */\r\n\t\t__proto.parentRepaint=function(){\r\n\t\t\tvar p=this._parent;\r\n\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*开始拖动此对象。\r\n\t\t*@param area 拖动区域，此区域为当前对象注册点活动区域（不包括对象宽高），可选。\r\n\t\t*@param hasInertia 鼠标松开后，是否还惯性滑动，默认为false，可选。\r\n\t\t*@param elasticDistance 橡皮筋效果的距离值，0为无橡皮筋效果，默认为0，可选。\r\n\t\t*@param elasticBackTime 橡皮筋回弹时间，单位为毫秒，默认为300毫秒，可选。\r\n\t\t*@param data 拖动事件携带的数据，可选。\r\n\t\t*@param disableMouseEvent 禁用其他对象的鼠标检测，默认为false，设置为true能提高性能\r\n\t\t*@param ratio 惯性阻尼系数\r\n\t\t*/\r\n\t\t__proto.startDrag=function(area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio){\r\n\t\t\t(hasInertia===void 0)&& (hasInertia=false);\r\n\t\t\t(elasticDistance===void 0)&& (elasticDistance=0);\r\n\t\t\t(elasticBackTime===void 0)&& (elasticBackTime=300);\r\n\t\t\t(disableMouseEvent===void 0)&& (disableMouseEvent=false);\r\n\t\t\t(ratio===void 0)&& (ratio=0.92);\r\n\t\t\tthis._$P.dragging || (this._set$P(\"dragging\",new Dragging()));\r\n\t\t\tthis._$P.dragging.start(this,area,hasInertia,elasticDistance,elasticBackTime,data,disableMouseEvent,ratio);\r\n\t\t}\r\n\r\n\t\t/**停止拖动此对象。*/\r\n\t\t__proto.stopDrag=function(){\r\n\t\t\tthis._$P.dragging && this._$P.dragging.stop();\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setDisplay=function(value){\r\n\t\t\tif (!value && this._$P.cacheCanvas && this._$P.cacheCanvas.ctx){\r\n\t\t\t\tPool.recover(\"RenderContext\",this._$P.cacheCanvas.ctx);\r\n\t\t\t\tthis._$P.cacheCanvas.ctx=null;\r\n\t\t\t}\r\n\t\t\tif (!value){\r\n\t\t\t\tvar fc=this._$P._filterCache;\r\n\t\t\t\tif (fc){\r\n\t\t\t\t\tfc.destroy();\r\n\t\t\t\t\tfc.recycle();\r\n\t\t\t\t\tthis._set$P('_filterCache',null);\r\n\t\t\t\t}\r\n\t\t\t\tthis._$P._isHaveGlowFilter && this._set$P('_isHaveGlowFilter',false);\r\n\t\t\t}\r\n\t\t\t_super.prototype._setDisplay.call(this,value);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*检测某个点是否在此对象内。\r\n\t\t*@param x 全局x坐标。\r\n\t\t*@param y 全局y坐标。\r\n\t\t*@return 表示是否在对象内。\r\n\t\t*/\r\n\t\t__proto.hitTestPoint=function(x,y){\r\n\t\t\tvar point=this.globalToLocal(Point.TEMP.setTo(x,y));\r\n\t\t\tvar rect=this._$P.hitArea ? this._$P.hitArea :Rectangle.EMPTY.setTo(0,0,this._width,this._height);\r\n\t\t\treturn rect.contains(point.x,point.y);\r\n\t\t}\r\n\r\n\t\t/**获得相对于本对象上的鼠标坐标信息。*/\r\n\t\t__proto.getMousePoint=function(){\r\n\t\t\treturn this.globalToLocal(Point.TEMP.setTo(Laya.stage.mouseX,Laya.stage.mouseY));\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getWords=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._addChildsToLayout=function(out){\r\n\t\t\tvar words=this._getWords();\r\n\t\t\tif (words==null && this._childs.length==0)return false;\r\n\t\t\tif (words){\r\n\t\t\t\tfor (var i=0,n=words.length;i < n;i++){\r\n\t\t\t\t\tout.push(words[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._childs.forEach(function(o,index,array){\r\n\t\t\t\to._style._enableLayout()&& o._addToLayout(out);\r\n\t\t\t});\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._addToLayout=function(out){\r\n\t\t\tif (this._style.absolute)return;\r\n\t\t\tthis._style.block ? out.push(this):(this._addChildsToLayout(out)&& (this.x=this.y=0));\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._isChar=function(){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getCSSStyle=function(){\r\n\t\t\treturn this._style.getCSSStyle();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*设置指定属性名的属性值。\r\n\t\t*@param name 属性名。\r\n\t\t*@param value 属性值。\r\n\t\t*/\r\n\t\t__proto._setAttributes=function(name,value){\r\n\t\t\tswitch (name){\r\n\t\t\t\tcase 'x':\r\n\t\t\t\t\tthis.x=parseFloat(value);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'y':\r\n\t\t\t\t\tthis.y=parseFloat(value);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'width':\r\n\t\t\t\t\tthis.width=parseFloat(value);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'height':\r\n\t\t\t\t\tthis.height=parseFloat(value);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tthis[name]=value;\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._layoutLater=function(){\r\n\t\t\tthis.parent && (this.parent)._layoutLater();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*<p>指定是否对使用了 scrollRect 的显示对象进行优化处理。</p>\r\n\t\t*<p>默认为false(不优化)。</p>\r\n\t\t*<p>当值为ture时：将对此对象使用了scrollRect 设定的显示区域以外的显示内容不进行渲染，以提高性能。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'optimizeScrollRect',function(){\r\n\t\t\treturn this._optimizeScrollRect;\r\n\t\t\t},function(b){\r\n\t\t\tif (this._optimizeScrollRect !=b){\r\n\t\t\t\tthis._optimizeScrollRect=b;\r\n\t\t\t\tthis.model && this.model.optimizeScrollRect(b);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*开启自定义渲染，只有开启自定义渲染，才能使用customRender函数渲染\r\n\t\t*/\r\n\t\t__getset(0,__proto,'customRenderEnable',null,function(b){\r\n\t\t\tif (b){\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.CUSTOM*/0x200;\r\n\t\t\t\tif (Render.isConchNode){\r\n\t\t\t\t\tlaya.display.Sprite.CustomList.push(this);\r\n\t\t\t\t\tvar canvas=new HTMLCanvas(\"2d\");\r\n\t\t\t\t\tcanvas._setContext(/*__JS__ */new CanvasRenderingContext2D());\r\n\t\t\t\t\t/*__JS__ */this.customContext=new RenderContext(0,0,canvas);\r\n\t\t\t\t\tcanvas.context.setCanvasType && canvas.context.setCanvasType(2);\r\n\t\t\t\t\tthis.model.custom(canvas.context);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*指定显示对象是否缓存为静态图像。功能同cacheAs的normal模式。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'cacheAsBitmap',function(){\r\n\t\t\treturn this.cacheAs!==\"none\";\r\n\t\t\t},function(value){\r\n\t\t\tthis.cacheAs=value ? (this._$P[\"hasFilter\"] ? \"none\" :\"normal\"):\"none\";\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>指定显示对象是否缓存为静态图像，cacheAs时，子对象发生变化，会自动重新缓存，同时也可以手动调用reCache方法更新缓存。</p>\r\n\t\t*建议把不经常变化的复杂内容缓存为静态图像，能极大提高渲染性能，有\"none\"，\"normal\"和\"bitmap\"三个值可选。\r\n\t\t*<li>默认为\"none\"，不做任何缓存。</li>\r\n\t\t*<li>当值为\"normal\"时，canvas下进行画布缓存，webgl模式下进行命令缓存。</li>\r\n\t\t*<li>当值为\"bitmap\"时，canvas下进行依然是画布缓存，webgl模式下使用renderTarget缓存。</li>\r\n\t\t*webgl下renderTarget缓存模式有最大2048大小限制，会额外增加内存开销，不断重绘时开销比较大，但是会减少drawcall，渲染性能最高。\r\n\t\t*webgl下命令缓存模式只会减少节点遍历及命令组织，不会减少drawcall，性能中等。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'cacheAs',function(){\r\n\t\t\treturn this._$P.cacheCanvas==null ? \"none\" :this._$P.cacheCanvas.type;\r\n\t\t\t},function(value){\r\n\t\t\tvar cacheCanvas=this._$P.cacheCanvas;\r\n\t\t\tif (value===(cacheCanvas ? cacheCanvas.type :\"none\"))return;\r\n\t\t\tif (value!==\"none\"){\r\n\t\t\t\tcacheCanvas || (cacheCanvas=this._set$P(\"cacheCanvas\",Pool.getItemByClass(\"cacheCanvas\",Object)));\r\n\t\t\t\tcacheCanvas.type=value;\r\n\t\t\t\tcacheCanvas.reCache=true;\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.CANVAS*/0x08;\r\n\t\t\t\tif (value==\"bitmap\")this.model && this.model.cacheAs(1);\r\n\t\t\t\tthis._set$P(\"cacheForFilters\",false);\r\n\t\t\t\t}else {\r\n\t\t\t\tif (this._$P[\"hasFilter\"]){\r\n\t\t\t\t\tthis._set$P(\"cacheForFilters\",true);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tif (cacheCanvas)Pool.recover(\"cacheCanvas\",cacheCanvas);\r\n\t\t\t\t\tthis._$P.cacheCanvas=null;\r\n\t\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.CANVAS*/0x08;\r\n\t\t\t\t\tthis.model && this.model.cacheAs(0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.repaint();\r\n\t\t});\r\n\r\n\t\t/**z排序，更改此值，按照值的大小进行显示层级排序。*/\r\n\t\t__getset(0,__proto,'zOrder',function(){\r\n\t\t\treturn this._zOrder;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._zOrder !=value){\r\n\t\t\t\tthis._zOrder=value;\r\n\t\t\t\tthis.model && this.model.setZOrder && this.model.setZOrder(value);\r\n\t\t\t\tthis._parent && Laya.timer.callLater(this._parent,this.updateZOrder);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**旋转角度，默认值为0。*/\r\n\t\t__getset(0,__proto,'rotation',function(){\r\n\t\t\treturn this._style._tf.rotate;\r\n\t\t\t},function(value){\r\n\t\t\tvar style=this.getStyle();\r\n\t\t\tif (style._tf.rotate!==value){\r\n\t\t\t\tthis._changeType |=0x10;\r\n\t\t\t\tstyle.setRotate(value);\r\n\t\t\t\tthis._tfChanged=true;\r\n\t\t\t\tthis.model && this.model.rotate(value);\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示显示对象的宽度，以像素为单位。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\tif (!this.autoSize)return this._width;\r\n\t\t\treturn this.getSelfBounds().width;\r\n\t\t\t},function(value){\r\n\t\t\tthis._width!==value && (this._width=value,this.model && this.model.size(value,this._height),this.repaint());\r\n\t\t});\r\n\r\n\t\t/**表示显示对象相对于父容器的水平方向坐标值。*/\r\n\t\t__getset(0,__proto,'x',function(){\r\n\t\t\treturn this._x;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._x!==value){\r\n\t\t\t\tif (this.destroyed)return;\r\n\t\t\t\tthis._x=value;\r\n\t\t\t\tthis.model && this.model.pos(value,this._y);\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t\tthis._$P.maskParent && this._$P.maskParent._repaint===0 && (this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获得全局Y轴缩放值\r\n\t\t*/\r\n\t\t__getset(0,__proto,'globalScaleY',function(){\r\n\t\t\tvar scale=1;\r\n\t\t\tvar ele=this;\r\n\t\t\twhile (ele){\r\n\t\t\t\tif (ele===Laya.stage)break ;\r\n\t\t\t\tscale *=ele.scaleX;\r\n\t\t\t\tele=ele.parent;\r\n\t\t\t}\r\n\t\t\treturn scale;\r\n\t\t});\r\n\r\n\t\t/**手动设置的可点击区域，或者一个HitArea区域。*/\r\n\t\t__getset(0,__proto,'hitArea',function(){\r\n\t\t\treturn this._$P.hitArea;\r\n\t\t\t},function(value){\r\n\t\t\tthis._set$P(\"hitArea\",value);\r\n\t\t});\r\n\r\n\t\t/**设置cacheAs为非空时此值才有效，staticCache=true时，子对象变化时不会自动更新缓存，只能通过调用reCache方法手动刷新。*/\r\n\t\t__getset(0,__proto,'staticCache',function(){\r\n\t\t\treturn this._$P.staticCache;\r\n\t\t\t},function(value){\r\n\t\t\tthis._set$P(\"staticCache\",value);\r\n\t\t\tif (!value && this._$P.cacheCanvas){\r\n\t\t\t\tthis._$P.cacheCanvas.reCache=true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**@private 清理graphics，只显示此texture图片，等同于graphics.clear();graphics.drawTexture()*/\r\n\t\t__getset(0,__proto,'texture',function(){\r\n\t\t\treturn this._texture;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._texture !=value){\r\n\t\t\t\tthis._texture=value;\r\n\t\t\t\tthis.graphics.cleanByTexture(value,0,0);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**表示显示对象相对于父容器的垂直方向坐标值。*/\r\n\t\t__getset(0,__proto,'y',function(){\r\n\t\t\treturn this._y;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._y!==value){\r\n\t\t\t\tif (this.destroyed)return;\r\n\t\t\t\tthis._y=value;\r\n\t\t\t\tthis.model && this.model.pos(this._x,value);\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t\tthis._$P.maskParent && this._$P.maskParent._repaint===0 && (this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示显示对象的高度，以像素为单位。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\tif (!this.autoSize)return this._height;\r\n\t\t\treturn this.getSelfBounds().height;\r\n\t\t\t},function(value){\r\n\t\t\tthis._height!==value && (this._height=value,this.model && this.model.size(this._width,value),this.repaint());\r\n\t\t});\r\n\r\n\t\t/**指定要使用的混合模式。*/\r\n\t\t__getset(0,__proto,'blendMode',function(){\r\n\t\t\treturn this._style.blendMode;\r\n\t\t\t},function(value){\r\n\t\t\tthis.getStyle().blendMode=value;\r\n\t\t\tthis.model && this.model.blendMode(value);\r\n\t\t\tif (value && value !=\"source-over\")this._renderType |=/*laya.renders.RenderSprite.BLEND*/0x20;\r\n\t\t\telse this._renderType &=~ /*laya.renders.RenderSprite.BLEND*/0x20;\r\n\t\t\tthis.parentRepaint();\r\n\t\t});\r\n\r\n\t\t/**X轴缩放值，默认值为1。*/\r\n\t\t__getset(0,__proto,'scaleX',function(){\r\n\t\t\treturn this._style._tf.scaleX;\r\n\t\t\t},function(value){\r\n\t\t\tvar style=this.getStyle();\r\n\t\t\tif (style._tf.scaleX!==value){\r\n\t\t\t\tstyle.setScaleX(value);\r\n\t\t\t\tthis._changeType |=0x10;\r\n\t\t\t\tthis._tfChanged=true;\r\n\t\t\t\tthis.model && this.model.scale(value,style._tf.scaleY);\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**Y轴缩放值，默认值为1。*/\r\n\t\t__getset(0,__proto,'scaleY',function(){\r\n\t\t\treturn this._style._tf.scaleY;\r\n\t\t\t},function(value){\r\n\t\t\tvar style=this.getStyle();\r\n\t\t\tif (style._tf.scaleY!==value){\r\n\t\t\t\tstyle.setScaleY(value);\r\n\t\t\t\tthis._changeType |=0x10;\r\n\t\t\t\tthis._tfChanged=true;\r\n\t\t\t\tthis.model && this.model.scale(style._tf.scaleX,value);\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**对舞台 <code>stage</code> 的引用。*/\r\n\t\t__getset(0,__proto,'stage',function(){\r\n\t\t\treturn Laya.stage;\r\n\t\t});\r\n\r\n\t\t/**水平倾斜角度，默认值为0。*/\r\n\t\t__getset(0,__proto,'skewX',function(){\r\n\t\t\treturn this._style._tf.skewX;\r\n\t\t\t},function(value){\r\n\t\t\tvar style=this.getStyle();\r\n\t\t\tif (style._tf.skewX!==value){\r\n\t\t\t\tstyle.setSkewX(value);\r\n\t\t\t\tthis._tfChanged=true;\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**显示对象的滚动矩形范围。*/\r\n\t\t__getset(0,__proto,'scrollRect',function(){\r\n\t\t\treturn this._style.scrollRect;\r\n\t\t\t},function(value){\r\n\t\t\tthis.getStyle().scrollRect=value;\r\n\t\t\tthis.viewport=value;\r\n\t\t\tthis.repaint();\r\n\t\t\tif (value){\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.CLIP*/0x40;\r\n\t\t\t\tthis.model && this.model.scrollRect(value.x,value.y,value.width,value.height);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.CLIP*/0x40;\r\n\t\t\t\tthis.model && this.model.removeType(/*laya.renders.RenderSprite.CLIP*/0x40);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**垂直倾斜角度，默认值为0。*/\r\n\t\t__getset(0,__proto,'skewY',function(){\r\n\t\t\treturn this._style._tf.skewY;\r\n\t\t\t},function(value){\r\n\t\t\tvar style=this.getStyle();\r\n\t\t\tif (style._tf.skewY!==value){\r\n\t\t\t\tstyle.setSkewY(value);\r\n\t\t\t\tthis._tfChanged=true;\r\n\t\t\t\tthis.model && this.model.skew(style._tf.skewX,value);\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tvar p=this._parent;\r\n\t\t\t\tp && p._repaint===0 && (p._repaint=1,p.parentRepaint());\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*对象的矩阵信息。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'transform',function(){\r\n\t\t\treturn this._tfChanged ? this._adjustTransform():this._transform;\r\n\t\t\t},function(value){\r\n\t\t\tthis._tfChanged=false;\r\n\t\t\tthis._transform=value;\r\n\t\t\tif (value){\r\n\t\t\t\tthis._x=value.tx;\r\n\t\t\t\tthis._y=value.ty;\r\n\t\t\t\tvalue.tx=value.ty=0;\r\n\t\t\t\tthis.model && this.model.transform(value.a,value.b,value.c,value.d,this._x,this._y);\r\n\t\t\t}\r\n\t\t\tif (value)this._renderType |=/*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\telse {\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.TRANSFORM*/0x04;\r\n\t\t\t\tthis.model && this.model.removeType(/*laya.renders.RenderSprite.TRANSFORM*/0x04);\r\n\t\t\t}\r\n\t\t\tthis.parentRepaint();\r\n\t\t});\r\n\r\n\t\t/**X轴 轴心点的位置，单位为像素，默认为0，轴心点会影响对象位置，缩放，旋转。*/\r\n\t\t__getset(0,__proto,'pivotX',function(){\r\n\t\t\treturn this._style._tf.translateX;\r\n\t\t\t},function(value){\r\n\t\t\tthis.getStyle().setTranslateX(value);\r\n\t\t\tthis._changeType |=0x10;\r\n\t\t\tthis.model && this.model.pivot(value,this._style._tf.translateY);\r\n\t\t\tthis.repaint();\r\n\t\t});\r\n\r\n\t\t/**Y轴 轴心点的位置，单位为像素，默认为0，轴心点会影响对象位置，缩放，旋转。*/\r\n\t\t__getset(0,__proto,'pivotY',function(){\r\n\t\t\treturn this._style._tf.translateY;\r\n\t\t\t},function(value){\r\n\t\t\tthis.getStyle().setTranslateY(value);\r\n\t\t\tthis._changeType |=0x10;\r\n\t\t\tthis.model && this.model.pivot(this._style._tf.translateX,value);\r\n\t\t\tthis.repaint();\r\n\t\t});\r\n\r\n\t\t/**透明度，值为0-1，默认值为1，表示不透明。*/\r\n\t\t__getset(0,__proto,'alpha',function(){\r\n\t\t\treturn this._style.alpha;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._style && this._style.alpha!==value){\r\n\t\t\t\tvalue=value < 0 ? 0 :(value > 1 ? 1 :value);\r\n\t\t\t\tthis.getStyle().alpha=value;\r\n\t\t\t\tthis.model && this.model.alpha(value);\r\n\t\t\t\tif (value!==1)this._renderType |=/*laya.renders.RenderSprite.ALPHA*/0x02;\r\n\t\t\t\telse this._renderType &=~ /*laya.renders.RenderSprite.ALPHA*/0x02;\r\n\t\t\t\tthis.parentRepaint();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**表示是否可见，默认为true。*/\r\n\t\t__getset(0,__proto,'visible',function(){\r\n\t\t\treturn this._style.visible;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._style && this._style.visible!==value){\r\n\t\t\t\tthis.getStyle().visible=value;\r\n\t\t\t\tthis.model && this.model.visible(value);\r\n\t\t\t\tthis.parentRepaint();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**绘图对象。*/\r\n\t\t__getset(0,__proto,'graphics',function(){\r\n\t\t\treturn this._graphics || (this.graphics=RunDriver.createGraphics());\r\n\t\t\t},function(value){\r\n\t\t\tif (this._graphics)this._graphics._sp=null;\r\n\t\t\tthis._graphics=value;\r\n\t\t\tif (value){\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.IMAGE*/0x01;\r\n\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.GRAPHICS*/0x100;\r\n\t\t\t\tvalue._sp=this;\r\n\t\t\t\tthis.model && this.model.graphics(this._graphics);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.GRAPHICS*/0x100;\r\n\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.IMAGE*/0x01;\r\n\t\t\t\tthis.model && this.model.removeType(/*laya.renders.RenderSprite.GRAPHICS*/0x100);\r\n\t\t\t}\r\n\t\t\tthis.repaint();\r\n\t\t});\r\n\r\n\t\t/**滤镜集合。*/\r\n\t\t__getset(0,__proto,'filters',function(){\r\n\t\t\treturn this._$P.filters;\r\n\t\t\t},function(value){\r\n\t\t\tvalue && value.length===0 && (value=null);\r\n\t\t\tif (this._$P.filters==value)return;\r\n\t\t\tthis._set$P(\"filters\",value ? value.slice():null);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tthis.model && this.model.removeType(0x10);\r\n\t\t\t\tif (this._$P.filters && this._$P.filters.length==1){\r\n\t\t\t\t\tthis._$P.filters[0].callNative(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Render.isWebGL){\r\n\t\t\t\tif (value && value.length){\r\n\t\t\t\t\tthis._renderType |=/*laya.renders.RenderSprite.FILTERS*/0x10;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis._renderType &=~ /*laya.renders.RenderSprite.FILTERS*/0x10;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (value && value.length > 0){\r\n\t\t\t\tif (!(Render.isWebGL && value.length==1 && (((value[0])instanceof laya.filters.ColorFilter )))){\r\n\t\t\t\t\tif (this.cacheAs !=\"bitmap\"){\r\n\t\t\t\t\t\tif (!Render.isConchNode)this.cacheAs=\"bitmap\";\r\n\t\t\t\t\t\tthis._set$P(\"cacheForFilters\",true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._set$P(\"hasFilter\",true);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._set$P(\"hasFilter\",false);\r\n\t\t\t\tif (this._$P[\"cacheForFilters\"] && this.cacheAs==\"bitmap\"){\r\n\t\t\t\t\tthis.cacheAs=\"none\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.repaint();\r\n\t\t});\r\n\r\n\t\t/**遮罩，可以设置一个对象或者图片，根据对象形状进行遮罩显示。\r\n\t\t*【注意】遮罩对象坐标系是相对遮罩对象本身的，这个和flash机制不同*/\r\n\t\t__getset(0,__proto,'mask',function(){\r\n\t\t\treturn this._$P._mask;\r\n\t\t\t},function(value){\r\n\t\t\tif (value && this.mask && this.mask._$P.maskParent)return;\r\n\t\t\tif (value){\r\n\t\t\t\tthis.cacheAs=\"bitmap\";\r\n\t\t\t\tthis._set$P(\"_mask\",value);\r\n\t\t\t\tvalue._set$P(\"maskParent\",this);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.cacheAs=\"none\";\r\n\t\t\t\tthis.mask && this.mask._set$P(\"maskParent\",null);\r\n\t\t\t\tthis._set$P(\"_mask\",value);\r\n\t\t\t}\r\n\t\t\tthis.model && this.model.mask(value ? value.model :null);\r\n\t\t\tthis._renderType |=/*laya.renders.RenderSprite.BLEND*/0x20;\r\n\t\t\tthis.parentRepaint();\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否接受鼠标事件。\r\n\t\t*默认为false，如果监听鼠标事件，则会自动设置本对象及父节点的属性 mouseEnable 的值都为 true（如果父节点手动设置为false，则不会更改）。\r\n\t\t**/\r\n\t\t__getset(0,__proto,'mouseEnabled',function(){\r\n\t\t\treturn this._mouseEnableState > 1;\r\n\t\t\t},function(value){\r\n\t\t\tthis._mouseEnableState=value ? 2 :1;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获得全局X轴缩放值\r\n\t\t*/\r\n\t\t__getset(0,__proto,'globalScaleX',function(){\r\n\t\t\tvar scale=1;\r\n\t\t\tvar ele=this;\r\n\t\t\twhile (ele){\r\n\t\t\t\tif (ele===Laya.stage)break ;\r\n\t\t\t\tscale *=ele.scaleX;\r\n\t\t\t\tele=ele.parent;\r\n\t\t\t}\r\n\t\t\treturn scale;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示鼠标在此对象上的 X 轴坐标信息。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'mouseX',function(){\r\n\t\t\treturn this.getMousePoint().x;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示鼠标在此对象上的 Y 轴坐标信息。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'mouseY',function(){\r\n\t\t\treturn this.getMousePoint().y;\r\n\t\t});\r\n\r\n\t\tSprite.fromImage=function(url){\r\n\t\t\treturn new Sprite().loadImage(url);\r\n\t\t}\r\n\r\n\t\tSprite.CHG_VIEW=0x10;\r\n\t\tSprite.CHG_SCALE=0x100;\r\n\t\tSprite.CHG_TEXTURE=0x1000;\r\n\t\tSprite.CustomList=[];\r\n\t\treturn Sprite;\r\n\t})(Node)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*audio标签播放声音的音轨控制\r\n\t*/\r\n\t//class laya.media.h5audio.AudioSoundChannel extends laya.media.SoundChannel\r\n\tvar AudioSoundChannel=(function(_super){\r\n\t\tfunction AudioSoundChannel(audio){\r\n\t\t\tthis._audio=null;\r\n\t\t\tthis._onEnd=null;\r\n\t\t\tthis._resumePlay=null;\r\n\t\t\tAudioSoundChannel.__super.call(this);\r\n\t\t\tthis._onEnd=Utils.bind(this.__onEnd,this);\r\n\t\t\tthis._resumePlay=Utils.bind(this.__resumePlay,this);\r\n\t\t\taudio.addEventListener(\"ended\",this._onEnd);\r\n\t\t\tthis._audio=audio;\r\n\t\t}\r\n\r\n\t\t__class(AudioSoundChannel,'laya.media.h5audio.AudioSoundChannel',_super);\r\n\t\tvar __proto=AudioSoundChannel.prototype;\r\n\t\t__proto.__onEnd=function(){\r\n\t\t\tif (this.loops==1){\r\n\t\t\t\tif (this.completeHandler){\r\n\t\t\t\t\tLaya.timer.once(10,this,this.__runComplete,[this.completeHandler],false);\r\n\t\t\t\t\tthis.completeHandler=null;\r\n\t\t\t\t}\r\n\t\t\t\tthis.stop();\r\n\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.loops > 0){\r\n\t\t\t\tthis.loops--;\r\n\t\t\t}\r\n\t\t\tthis.play();\r\n\t\t}\r\n\r\n\t\t__proto.__resumePlay=function(){\r\n\t\t\tif(this._audio)this._audio.removeEventListener(\"canplay\",this._resumePlay);\r\n\t\t\ttry {\r\n\t\t\t\tthis._audio.currentTime=this.startTime;\r\n\t\t\t\tBrowser.container.appendChild(this._audio);\r\n\t\t\t\tthis._audio.play();\r\n\t\t\t\t}catch (e){\r\n\t\t\t\tthis.event(/*laya.events.Event.ERROR*/\"error\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放\r\n\t\t*/\r\n\t\t__proto.play=function(){\r\n\t\t\ttry {\r\n\t\t\t\tthis._audio.currentTime=this.startTime;\r\n\t\t\t\t}catch (e){\r\n\t\t\t\tthis._audio.addEventListener(\"canplay\",this._resumePlay);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tBrowser.container.appendChild(this._audio);\r\n\t\t\tif(\"play\" in this._audio)\r\n\t\t\t\tthis._audio.play();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止播放\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.stop=function(){\r\n\t\t\tthis.isStopped=true;\r\n\t\t\tSoundManager.removeChannel(this);\r\n\t\t\tthis.completeHandler=null;\r\n\t\t\tif (!this._audio)\r\n\t\t\t\treturn;\r\n\t\t\tif(\"pause\" in this._audio)\r\n\t\t\t\tthis._audio.pause();\r\n\t\t\tthis._audio.removeEventListener(\"ended\",this._onEnd);\r\n\t\t\tthis._audio.removeEventListener(\"canplay\",this._resumePlay);\r\n\t\t\tPool.recover(\"audio:\"+this.url,this._audio);\r\n\t\t\tBrowser.removeElement(this._audio);\r\n\t\t\tthis._audio=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*当前播放到的位置\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(0,__proto,'position',function(){\r\n\t\t\tif (!this._audio)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn this._audio.currentTime;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取总时间。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\tif (!this._audio)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn this._audio.duration;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置音量\r\n\t\t*@param v\r\n\t\t*\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取音量\r\n\t\t*@return\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(0,__proto,'volume',function(){\r\n\t\t\tif (!this._audio)return 1;\r\n\t\t\treturn this._audio.volume;\r\n\t\t\t},function(v){\r\n\t\t\tif (!this._audio)return;\r\n\t\t\tthis._audio.volume=v;\r\n\t\t});\r\n\r\n\t\treturn AudioSoundChannel;\r\n\t})(SoundChannel)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*web audio api方式播放声音的音轨控制\r\n\t*/\r\n\t//class laya.media.webaudio.WebAudioSoundChannel extends laya.media.SoundChannel\r\n\tvar WebAudioSoundChannel=(function(_super){\r\n\t\tfunction WebAudioSoundChannel(){\r\n\t\t\tthis.audioBuffer=null;\r\n\t\t\tthis.gain=null;\r\n\t\t\tthis.bufferSource=null;\r\n\t\t\tthis._currentTime=0;\r\n\t\t\tthis._volume=1;\r\n\t\t\tthis._startTime=0;\r\n\t\t\tthis._onPlayEnd=null;\r\n\t\t\tthis.context=WebAudioSound.ctx;\r\n\t\t\tWebAudioSoundChannel.__super.call(this);\r\n\t\t\tthis._onPlayEnd=Utils.bind(this.__onPlayEnd,this);\r\n\t\t\tif (this.context[\"createGain\"]){\r\n\t\t\t\tthis.gain=this.context[\"createGain\"]();\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.gain=this.context[\"createGainNode\"]();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(WebAudioSoundChannel,'laya.media.webaudio.WebAudioSoundChannel',_super);\r\n\t\tvar __proto=WebAudioSoundChannel.prototype;\r\n\t\t/**\r\n\t\t*播放声音\r\n\t\t*/\r\n\t\t__proto.play=function(){\r\n\t\t\tthis._clearBufferSource();\r\n\t\t\tif (!this.audioBuffer)return;\r\n\t\t\tvar context=this.context;\r\n\t\t\tvar gain=this.gain;\r\n\t\t\tvar bufferSource=context.createBufferSource();\r\n\t\t\tthis.bufferSource=bufferSource;\r\n\t\t\tbufferSource.buffer=this.audioBuffer;\r\n\t\t\tbufferSource.connect(gain);\r\n\t\t\tif (gain)\r\n\t\t\t\tgain.disconnect();\r\n\t\t\tgain.connect(context.destination);\r\n\t\t\tbufferSource.onended=this._onPlayEnd;\r\n\t\t\tthis._startTime=Browser.now();\r\n\t\t\tthis.gain.gain.value=this._volume;\r\n\t\t\tif (this.loops==0){\r\n\t\t\t\tbufferSource.loop=true;\r\n\t\t\t}\r\n\t\t\tbufferSource.start(0,this.startTime);\r\n\t\t\tthis._currentTime=0;\r\n\t\t}\r\n\r\n\t\t__proto.__onPlayEnd=function(){\r\n\t\t\tif (this.loops==1){\r\n\t\t\t\tif (this.completeHandler){\r\n\t\t\t\t\tLaya.timer.once(10,this,this.__runComplete,[this.completeHandler],false);\r\n\t\t\t\t\tthis.completeHandler=null;\r\n\t\t\t\t}\r\n\t\t\t\tthis.stop();\r\n\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.loops > 0){\r\n\t\t\t\tthis.loops--;\r\n\t\t\t}\r\n\t\t\tthis.play();\r\n\t\t}\r\n\r\n\t\t__proto._clearBufferSource=function(){\r\n\t\t\tif (this.bufferSource){\r\n\t\t\t\tvar sourceNode=this.bufferSource;\r\n\t\t\t\tif (sourceNode.stop){\r\n\t\t\t\t\tsourceNode.stop(0);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tsourceNode.noteOff(0);\r\n\t\t\t\t}\r\n\t\t\t\tsourceNode.disconnect(0);\r\n\t\t\t\tsourceNode.onended=null;\r\n\t\t\t\tif (!WebAudioSoundChannel._tryCleanFailed)this._tryClearBuffer(sourceNode);\r\n\t\t\t\tthis.bufferSource=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._tryClearBuffer=function(sourceNode){\r\n\t\t\ttry {sourceNode.buffer=WebAudioSound._miniBuffer;}catch (e){WebAudioSoundChannel._tryCleanFailed=true;}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止播放\r\n\t\t*/\r\n\t\t__proto.stop=function(){\r\n\t\t\tthis._clearBufferSource();\r\n\t\t\tthis.audioBuffer=null;\r\n\t\t\tif (this.gain)\r\n\t\t\t\tthis.gain.disconnect();\r\n\t\t\tthis.isStopped=true;\r\n\t\t\tSoundManager.removeChannel(this);\r\n\t\t\tthis.completeHandler=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取当前播放位置\r\n\t\t*/\r\n\t\t__getset(0,__proto,'position',function(){\r\n\t\t\tif (this.bufferSource){\r\n\t\t\t\treturn (Browser.now()-this._startTime)/ 1000+this.startTime;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'duration',function(){\r\n\t\t\tif (this.audioBuffer){\r\n\t\t\t\treturn this.audioBuffer.duration;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置音量\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取音量\r\n\t\t*/\r\n\t\t__getset(0,__proto,'volume',function(){\r\n\t\t\treturn this._volume;\r\n\t\t\t},function(v){\r\n\t\t\tif (this.isStopped){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._volume=v;\r\n\t\t\tthis.gain.gain.value=v;\r\n\t\t});\r\n\r\n\t\tWebAudioSoundChannel._tryCleanFailed=false;\r\n\t\treturn WebAudioSoundChannel;\r\n\t})(SoundChannel)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>Bitmap</code> 是图片资源类。\r\n\t*/\r\n\t//class laya.resource.Bitmap extends laya.resource.Resource\r\n\tvar Bitmap=(function(_super){\r\n\t\tfunction Bitmap(){\r\n\t\t\t//this._source=null;\r\n\t\t\t//this._w=NaN;\r\n\t\t\t//this._h=NaN;\r\n\t\t\tthis.useNum=0;\r\n\t\t\tBitmap.__super.call(this);\r\n\t\t\tthis._w=0;\r\n\t\t\tthis._h=0;\r\n\t\t}\r\n\r\n\t\t__class(Bitmap,'laya.resource.Bitmap',_super);\r\n\t\tvar __proto=Bitmap.prototype;\r\n\t\t/**\r\n\t\t*彻底清理资源。\r\n\t\t*/\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis._resourceManager.removeResource(this);\r\n\t\t\t_super.prototype.dispose.call(this);\r\n\t\t}\r\n\r\n\t\t/***\r\n\t\t*宽度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\treturn this._w;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*高度。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\treturn this._h;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*HTML Image 或 HTML Canvas 或 WebGL Texture 。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'source',function(){\r\n\t\t\treturn this._source;\r\n\t\t});\r\n\r\n\t\treturn Bitmap;\r\n\t})(Resource)\r\n\r\n\r\n\t/**\r\n\t*动画播放控制器\r\n\t*/\r\n\t//class laya.display.AnimationPlayerBase extends laya.display.Sprite\r\n\tvar AnimationPlayerBase=(function(_super){\r\n\t\tfunction AnimationPlayerBase(){\r\n\t\t\tthis.loop=false;\r\n\t\t\tthis.wrapMode=0;\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._count=0;\r\n\t\t\tthis._isPlaying=false;\r\n\t\t\tthis._labels=null;\r\n\t\t\tthis._isReverse=false;\r\n\t\t\tthis._frameRateChanged=false;\r\n\t\t\tthis._controlNode=null;\r\n\t\t\tthis._actionName=null;\r\n\t\t\tAnimationPlayerBase.__super.call(this);\r\n\t\t\tthis._interval=Config.animationInterval;\r\n\t\t}\r\n\r\n\t\t__class(AnimationPlayerBase,'laya.display.AnimationPlayerBase',_super);\r\n\t\tvar __proto=AnimationPlayerBase.prototype;\r\n\t\t/**\r\n\t\t*播放动画。\r\n\t\t*@param start 开始播放的动画索引或label。\r\n\t\t*@param loop 是否循环。\r\n\t\t*@param name 如果name为空(可选)，则播放当前动画，如果不为空，则播放全局缓存动画（如果有）\r\n\t\t*/\r\n\t\t__proto.play=function(start,loop,name){\r\n\t\t\t(start===void 0)&& (start=0);\r\n\t\t\t(loop===void 0)&& (loop=true);\r\n\t\t\t(name===void 0)&& (name=\"\");\r\n\t\t\tthis._isPlaying=true;\r\n\t\t\tthis.index=((typeof start=='string'))? this._getFrameByLabel(start):start;\r\n\t\t\tthis.loop=loop;\r\n\t\t\tthis._actionName=name;\r\n\t\t\tthis._isReverse=this.wrapMode==1;\r\n\t\t\tif (this.interval > 0){\r\n\t\t\t\tthis.timerLoop(this.interval,this,this._frameLoop,null,true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._getFrameByLabel=function(label){\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=0;i < this._count;i++){\r\n\t\t\t\tif (this._labels[i]==label)return i;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._frameLoop=function(){\r\n\t\t\tif (this._isReverse){\r\n\t\t\t\tthis._index--;\r\n\t\t\t\tif (this._index < 0){\r\n\t\t\t\t\tif (this.loop){\r\n\t\t\t\t\t\tif (this.wrapMode==2){\r\n\t\t\t\t\t\t\tthis._index=this._count > 0 ? 1 :0;\r\n\t\t\t\t\t\t\tthis._isReverse=false;\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tthis._index=this._count-1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis._index=0;\r\n\t\t\t\t\t\tthis.stop();\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._index++;\r\n\t\t\t\tif (this._index >=this._count){\r\n\t\t\t\t\tif (this.loop){\r\n\t\t\t\t\t\tif (this.wrapMode==2){\r\n\t\t\t\t\t\t\tthis._index=this._count-2 >=0 ? this._count-2 :0;\r\n\t\t\t\t\t\t\tthis._isReverse=true;\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tthis._index=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tthis._index--;\r\n\t\t\t\t\t\tthis.stop();\r\n\t\t\t\t\t\tthis.event(/*laya.events.Event.COMPLETE*/\"complete\");\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.index=this._index;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setControlNode=function(node){\r\n\t\t\tif (this._controlNode){\r\n\t\t\t\tthis._controlNode.off(/*laya.events.Event.DISPLAY*/\"display\",this,this._$3__onDisplay);\r\n\t\t\t\tthis._controlNode.off(/*laya.events.Event.UNDISPLAY*/\"undisplay\",this,this._$3__onDisplay);\r\n\t\t\t}\r\n\t\t\tthis._controlNode=node;\r\n\t\t\tif (node && node !=this){\r\n\t\t\t\tnode.on(/*laya.events.Event.DISPLAY*/\"display\",this,this._$3__onDisplay);\r\n\t\t\t\tnode.on(/*laya.events.Event.UNDISPLAY*/\"undisplay\",this,this._$3__onDisplay);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setDisplay=function(value){\r\n\t\t\t_super.prototype._setDisplay.call(this,value);\r\n\t\t\tthis._$3__onDisplay();\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._$3__onDisplay=function(){\r\n\t\t\tif (this._isPlaying){\r\n\t\t\t\tif (this._controlNode.displayedInStage)this.play(this._index,this.loop,this._actionName);\r\n\t\t\t\telse this.clearTimer(this,this._frameLoop);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止播放。\r\n\t\t*/\r\n\t\t__proto.stop=function(){\r\n\t\t\tthis._isPlaying=false;\r\n\t\t\tthis.clearTimer(this,this._frameLoop);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*增加一个标签到index帧上，播放到此index后会派发label事件\r\n\t\t*@param label 标签名称\r\n\t\t*@param index 索引位置\r\n\t\t*/\r\n\t\t__proto.addLabel=function(label,index){\r\n\t\t\tif (!this._labels)this._labels={};\r\n\t\t\tthis._labels[index]=label;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*删除某个标签\r\n\t\t*@param label 标签名字，如果label为空，则删除所有Label\r\n\t\t*/\r\n\t\t__proto.removeLabel=function(label){\r\n\t\t\tif (!label)this._labels=null;\r\n\t\t\telse if (this._labels){\r\n\t\t\t\tfor (var name in this._labels){\r\n\t\t\t\t\tif (this._labels[name]===label){\r\n\t\t\t\t\t\tdelete this._labels[name];\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*切换到某帧并停止\r\n\t\t*@param position 帧索引或label\r\n\t\t*/\r\n\t\t__proto.gotoAndStop=function(position){\r\n\t\t\tthis.index=((typeof position=='string'))? this._getFrameByLabel(position):position;\r\n\t\t\tthis.stop();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*显示到某帧\r\n\t\t*@param value 帧索引\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._displayToIndex=function(value){}\r\n\t\t/**清理。方便对象复用。*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.stop();\r\n\t\t\tthis._labels=null;\r\n\t\t}\r\n\r\n\t\t/**播放间隔(单位：毫秒)。*/\r\n\t\t/**播放间隔(单位：毫秒)。*/\r\n\t\t__getset(0,__proto,'interval',function(){\r\n\t\t\treturn this._interval;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._interval !=value){\r\n\t\t\t\tthis._frameRateChanged=true;\r\n\t\t\t\tthis._interval=value;\r\n\t\t\t\tif (this._isPlaying && value > 0){\r\n\t\t\t\t\tthis.timerLoop(value,this,this._frameLoop,null,true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否在播放中\r\n\t\t*/\r\n\t\t__getset(0,__proto,'isPlaying',function(){\r\n\t\t\treturn this._isPlaying;\r\n\t\t});\r\n\r\n\t\t/**当前播放索引。*/\r\n\t\t__getset(0,__proto,'index',function(){\r\n\t\t\treturn this._index;\r\n\t\t\t},function(value){\r\n\t\t\tthis._index=value;\r\n\t\t\tthis._displayToIndex(value);\r\n\t\t\tif (this._labels && this._labels[value])this.event(/*laya.events.Event.LABEL*/\"label\",this._labels[value]);\r\n\t\t});\r\n\r\n\t\t/**动画长度。*/\r\n\t\t__getset(0,__proto,'count',function(){\r\n\t\t\treturn this._count;\r\n\t\t});\r\n\r\n\t\treturn AnimationPlayerBase;\r\n\t})(Sprite)\r\n\r\n\r\n\t/**\r\n\t*<p> <code>Text</code> 类用于创建显示对象以显示文本。</p>\r\n\t*@example 以下示例代码，创建了一个 <code>Text</code> 实例。\r\n\t*<listing version=\"3.0\">\r\n\t*package\r\n\t*{\r\n\t\t*import laya.display.Text;\r\n\t\t*public class Text_Example\r\n\t\t*{\r\n\t\t\t*public function Text_Example()\r\n\t\t\t*{\r\n\t\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t\t*onInit();\r\n\t\t\t\t*}\r\n\t\t\t*private function onInit():void\r\n\t\t\t*{\r\n\t\t\t\t*var text:Text=new Text();//创建一个 Text 类的实例对象 text 。\r\n\t\t\t\t*text.text=\"这个是一个 Text 文本示例。\";\r\n\t\t\t\t*text.color=\"#008fff\";//设置 text 的文本颜色。\r\n\t\t\t\t*text.font=\"Arial\";//设置 text 的文本字体。\r\n\t\t\t\t*text.bold=true;//设置 text 的文本显示为粗体。\r\n\t\t\t\t*text.fontSize=30;//设置 text 的字体大小。\r\n\t\t\t\t*text.wordWrap=true;//设置 text 的文本自动换行。\r\n\t\t\t\t*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n\t\t\t\t*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n\t\t\t\t*text.width=300;//设置 text 的宽度。\r\n\t\t\t\t*text.height=200;//设置 text 的高度。\r\n\t\t\t\t*text.italic=true;//设置 text 的文本显示为斜体。\r\n\t\t\t\t*text.borderColor=\"#fff000\";//设置 text 的文本边框颜色。\r\n\t\t\t\t*Laya.stage.addChild(text);//将 text 添加到显示列表。\r\n\t\t\t\t*}\r\n\t\t\t*}\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*Text_Example();\r\n\t*function Text_Example()\r\n\t*{\r\n\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t*onInit();\r\n\t\t*}\r\n\t*function onInit()\r\n\t*{\r\n\t\t*var text=new laya.display.Text();//创建一个 Text 类的实例对象 text 。\r\n\t\t*text.text=\"这个是一个 Text 文本示例。\";\r\n\t\t*text.color=\"#008fff\";//设置 text 的文本颜色。\r\n\t\t*text.font=\"Arial\";//设置 text 的文本字体。\r\n\t\t*text.bold=true;//设置 text 的文本显示为粗体。\r\n\t\t*text.fontSize=30;//设置 text 的字体大小。\r\n\t\t*text.wordWrap=true;//设置 text 的文本自动换行。\r\n\t\t*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n\t\t*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n\t\t*text.width=300;//设置 text 的宽度。\r\n\t\t*text.height=200;//设置 text 的高度。\r\n\t\t*text.italic=true;//设置 text 的文本显示为斜体。\r\n\t\t*text.borderColor=\"#fff000\";//设置 text 的文本边框颜色。\r\n\t\t*Laya.stage.addChild(text);//将 text 添加到显示列表。\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*class Text_Example {\r\n\t\t*constructor(){\r\n\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t*this.onInit();\r\n\t\t\t*}\r\n\t\t*private onInit():void {\r\n\t\t\t*var text:laya.display.Text=new laya.display.Text();//创建一个 Text 类的实例对象 text 。\r\n\t\t\t*text.text=\"这个是一个 Text 文本示例。\";\r\n\t\t\t*text.color=\"#008fff\";//设置 text 的文本颜色。\r\n\t\t\t*text.font=\"Arial\";//设置 text 的文本字体。\r\n\t\t\t*text.bold=true;//设置 text 的文本显示为粗体。\r\n\t\t\t*text.fontSize=30;//设置 text 的字体大小。\r\n\t\t\t*text.wordWrap=true;//设置 text 的文本自动换行。\r\n\t\t\t*text.x=100;//设置 text 对象的属性 x 的值，用于控制 text 对象的显示位置。\r\n\t\t\t*text.y=100;//设置 text 对象的属性 y 的值，用于控制 text 对象的显示位置。\r\n\t\t\t*text.width=300;//设置 text 的宽度。\r\n\t\t\t*text.height=200;//设置 text 的高度。\r\n\t\t\t*text.italic=true;//设置 text 的文本显示为斜体。\r\n\t\t\t*text.borderColor=\"#fff000\";//设置 text 的文本边框颜色。\r\n\t\t\t*Laya.stage.addChild(text);//将 text 添加到显示列表。\r\n\t\t\t*}\r\n\t\t*}\r\n\t*</listing>\r\n\t*/\r\n\t//class laya.display.Text extends laya.display.Sprite\r\n\tvar Text=(function(_super){\r\n\t\tfunction Text(){\r\n\t\t\tthis._clipPoint=null;\r\n\t\t\tthis._currBitmapFont=null;\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._isChanged=false;\r\n\t\t\tthis._textWidth=0;\r\n\t\t\tthis._textHeight=0;\r\n\t\t\tthis._lines=[];\r\n\t\t\tthis._lineWidths=[];\r\n\t\t\tthis._startX=NaN;\r\n\t\t\tthis._startY=NaN;\r\n\t\t\tthis._lastVisibleLineIndex=-1;\r\n\t\t\tthis._words=null;\r\n\t\t\tthis._charSize={};\r\n\t\t\tthis.underline=false;\r\n\t\t\tthis._underlineColor=null;\r\n\t\t\tText.__super.call(this);\r\n\t\t\tthis.overflow=Text.VISIBLE;\r\n\t\t\tthis._style=new CSSStyle(this);\r\n\t\t\t(this._style).wordWrap=false;\r\n\t\t}\r\n\r\n\t\t__class(Text,'laya.display.Text',_super);\r\n\t\tvar __proto=Text.prototype;\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.destroy=function(destroyChild){\r\n\t\t\t(destroyChild===void 0)&& (destroyChild=true);\r\n\t\t\t_super.prototype.destroy.call(this,destroyChild);\r\n\t\t\tthis._lines=null;\r\n\t\t\tif (this._words){\r\n\t\t\t\tthis._words.length=0;\r\n\t\t\t\tthis._words=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__proto._getBoundPointsM=function(ifRotate){\r\n\t\t\t(ifRotate===void 0)&& (ifRotate=false);\r\n\t\t\tvar rec=Rectangle.TEMP;\r\n\t\t\trec.setTo(0,0,this.width,this.height);\r\n\t\t\treturn rec._getBoundPoints();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__proto.getGraphicBounds=function(){\r\n\t\t\tvar rec=Rectangle.TEMP;\r\n\t\t\trec.setTo(0,0,this.width,this.height);\r\n\t\t\treturn rec;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__proto._getCSSStyle=function(){\r\n\t\t\treturn this._style;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*<p>根据指定的文本，从语言包中取当前语言的文本内容。并对此文本中的{i}文本进行替换。</p>\r\n\t\t*<p>例如：\r\n\t\t*<li>（1）text 的值为“我的名字”，先取到这个文本对应的当前语言版本里的值“My name”，将“My name”设置为当前文本的内容。</li>\r\n\t\t*<li>（2）text 的值为“恭喜你赢得{0}个钻石，{1}经验。”，arg1 的值为100，arg2 的值为200。\r\n\t\t*则先取到这个文本对应的当前语言版本里的值“Congratulations on your winning {0}diamonds,{1}experience.”，\r\n\t\t*然后将文本里的{0}、{1}，依据括号里的数字从0开始替换为 arg1、arg2 的值。\r\n\t\t*将替换处理后的文本“Congratulations on your winning 100 diamonds,200 experience.”设置为当前文本的内容。\r\n\t\t*</li>\r\n\t\t*</p>\r\n\t\t*@param text 文本内容。\r\n\t\t*@param ...args 文本替换参数。\r\n\t\t*/\r\n\t\t__proto.lang=function(text,arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10){\r\n\t\t\ttext=Text.langPacks && Text.langPacks[text] ? Text.langPacks[text] :text;\r\n\t\t\tif (arguments.length < 2){\r\n\t\t\t\tthis._text=text;\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (var i=0,n=arguments.length;i < n;i++){\r\n\t\t\t\t\ttext=text.replace(\"{\"+i+\"}\",arguments[i+1]);\r\n\t\t\t\t}\r\n\t\t\t\tthis._text=text;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*渲染文字。\r\n\t\t*@param begin 开始渲染的行索引。\r\n\t\t*@param visibleLineCount 渲染的行数。\r\n\t\t*/\r\n\t\t__proto.renderText=function(begin,visibleLineCount){\r\n\t\t\tvar graphics=this.graphics;\r\n\t\t\tgraphics.clear();\r\n\t\t\tvar ctxFont=(this.italic ? \"italic \" :\"\")+(this.bold ? \"bold \" :\"\")+this.fontSize+\"px \"+this.font;\r\n\t\t\tBrowser.context.font=ctxFont;\r\n\t\t\tvar padding=this.padding;\r\n\t\t\tvar startX=padding[3];\r\n\t\t\tvar textAlgin=\"left\";\r\n\t\t\tvar lines=this._lines;\r\n\t\t\tvar lineHeight=this.leading+this._charSize.height;\r\n\t\t\tvar tCurrBitmapFont=this._currBitmapFont;\r\n\t\t\tif (tCurrBitmapFont){\r\n\t\t\t\tlineHeight=this.leading+tCurrBitmapFont.getMaxHeight();\r\n\t\t\t};\r\n\t\t\tvar startY=padding[0];\r\n\t\t\tif ((!tCurrBitmapFont)&& this._width > 0 && this._textWidth <=this._width){\r\n\t\t\t\tif (this.align==\"right\"){\r\n\t\t\t\t\ttextAlgin=\"right\";\r\n\t\t\t\t\tstartX=this._width-padding[1];\r\n\t\t\t\t\t}else if (this.align==\"center\"){\r\n\t\t\t\t\ttextAlgin=\"center\";\r\n\t\t\t\t\tstartX=this._width *0.5+padding[3]-padding[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this._height > 0){\r\n\t\t\t\tvar tempVAlign=(this._textHeight > this._height)? \"top\" :this.valign;\r\n\t\t\t\tif (tempVAlign===\"middle\")\r\n\t\t\t\t\tstartY=(this._height-visibleLineCount *lineHeight)*0.5+padding[0]-padding[2];\r\n\t\t\t\telse if (tempVAlign===\"bottom\")\r\n\t\t\t\tstartY=this._height-visibleLineCount *lineHeight-padding[2];\r\n\t\t\t};\r\n\t\t\tvar style=this._style;\r\n\t\t\tif (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){\r\n\t\t\t\tvar bitmapScale=tCurrBitmapFont.fontSize / this.fontSize;\r\n\t\t\t}\r\n\t\t\tif (this._clipPoint){\r\n\t\t\t\tgraphics.save();\r\n\t\t\t\tif (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){\r\n\t\t\t\t\tvar tClipWidth=0;\r\n\t\t\t\t\tvar tClipHeight=0;\r\n\t\t\t\t\tthis._width ? tClipWidth=(this._width-padding[3]-padding[1]):tClipWidth=this._textWidth;\r\n\t\t\t\t\tthis._height ? tClipHeight=(this._height-padding[0]-padding[2]):tClipHeight=this._textHeight;\r\n\t\t\t\t\ttClipWidth *=bitmapScale;\r\n\t\t\t\t\ttClipHeight *=bitmapScale;\r\n\t\t\t\t\tgraphics.clipRect(padding[3],padding[0],tClipWidth,tClipHeight);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tgraphics.clipRect(padding[3],padding[0],this._width ? (this._width-padding[3]-padding[1]):this._textWidth,this._height ? (this._height-padding[0]-padding[2]):this._textHeight);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar password=style.password;\r\n\t\t\tif ((\"prompt\" in this)&& this['prompt']==this._text)\r\n\t\t\t\tpassword=false;\r\n\t\t\tvar x=0,y=0;\r\n\t\t\tvar end=Math.min(this._lines.length,visibleLineCount+begin)|| 1;\r\n\t\t\tfor (var i=begin;i < end;i++){\r\n\t\t\t\tvar word=lines[i];\r\n\t\t\t\tvar _word;\r\n\t\t\t\tif (password){\r\n\t\t\t\t\tvar len=word.length;\r\n\t\t\t\t\tword=\"\";\r\n\t\t\t\t\tfor (var j=len;j > 0;j--){\r\n\t\t\t\t\t\tword+=\"●\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tx=startX-(this._clipPoint ? this._clipPoint.x :0);\r\n\t\t\t\ty=startY+lineHeight *i-(this._clipPoint ? this._clipPoint.y :0);\r\n\t\t\t\tthis.underline && this.drawUnderline(textAlgin,x,y,i);\r\n\t\t\t\tif (tCurrBitmapFont){\r\n\t\t\t\t\tvar tWidth=this.width;\r\n\t\t\t\t\tif (tCurrBitmapFont.autoScaleSize){\r\n\t\t\t\t\t\ttWidth=this.width *bitmapScale;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttCurrBitmapFont.drawText(word,this,x,y,this.align,tWidth);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\t\tthis._words || (this._words=[]);\r\n\t\t\t\t\t\t_word=this._words.length > (i-begin)? this._words[i-begin] :new WordText();\r\n\t\t\t\t\t\t_word.setText(word);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t_word=word;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstyle.stroke ? graphics.fillBorderText(_word,x,y,ctxFont,this.color,style.strokeColor,style.stroke,textAlgin):graphics.fillText(_word,x,y,ctxFont,this.color,textAlgin);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (tCurrBitmapFont && tCurrBitmapFont.autoScaleSize){\r\n\t\t\t\tvar tScale=1 / bitmapScale;\r\n\t\t\t\tthis.scale(tScale,tScale);\r\n\t\t\t}\r\n\t\t\tif (this._clipPoint)\r\n\t\t\t\tgraphics.restore();\r\n\t\t\tthis._startX=startX;\r\n\t\t\tthis._startY=startY;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*绘制下划线\r\n\t\t*@param x 本行坐标\r\n\t\t*@param y 本行坐标\r\n\t\t*@param lineIndex 本行索引\r\n\t\t*/\r\n\t\t__proto.drawUnderline=function(align,x,y,lineIndex){\r\n\t\t\tvar lineWidth=this._lineWidths[lineIndex];\r\n\t\t\tswitch (align){\r\n\t\t\t\tcase 'center':\r\n\t\t\t\t\tx-=lineWidth / 2;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'right':\r\n\t\t\t\t\tx-=lineWidth;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 'left':\r\n\t\t\t\tdefault :\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\ty+=this._charSize.height;\r\n\t\t\tthis._graphics.drawLine(x,y,x+lineWidth,y,this.underlineColor || this.color,1);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*<p>排版文本。</p>\r\n\t\t*<p>进行宽高计算，渲染、重绘文本。</p>\r\n\t\t*/\r\n\t\t__proto.typeset=function(){\r\n\t\t\tthis._isChanged=false;\r\n\t\t\tif (!this._text){\r\n\t\t\t\tthis._clipPoint=null;\r\n\t\t\t\tthis._textWidth=this._textHeight=0;\r\n\t\t\t\tthis.graphics.clear();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tBrowser.context.font=this._getCSSStyle().font;\r\n\t\t\tthis._lines.length=0;\r\n\t\t\tthis._lineWidths.length=0;\r\n\t\t\tthis.parseLines(this._text);\r\n\t\t\tthis.evalTextSize();\r\n\t\t\tif (this.checkEnabledViewportOrNot())\r\n\t\t\t\tthis._clipPoint || (this._clipPoint=new Point(0,0));\r\n\t\t\telse\r\n\t\t\tthis._clipPoint=null;\r\n\t\t\tvar lineCount=this._lines.length;\r\n\t\t\tif (this.overflow !=Text.VISIBLE){\r\n\t\t\t\tvar func=this.overflow==Text.HIDDEN ? Math.floor :Math.ceil;\r\n\t\t\t\tlineCount=Math.min(lineCount,func((this.height-this.padding[0]-this.padding[2])/ (this.leading+this._charSize.height)));\r\n\t\t\t};\r\n\t\t\tvar startLine=this.scrollY / (this._charSize.height+this.leading)| 0;\r\n\t\t\tthis.renderText(startLine,lineCount);\r\n\t\t\tthis.repaint();\r\n\t\t}\r\n\r\n\t\t__proto.evalTextSize=function(){\r\n\t\t\tvar nw=NaN,nh=NaN;\r\n\t\t\tnw=Math.max.apply(this,this._lineWidths);\r\n\t\t\tif (this._currBitmapFont)\r\n\t\t\t\tnh=this._lines.length *(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2];\r\n\t\t\telse\r\n\t\t\tnh=this._lines.length *(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];\r\n\t\t\tif (nw !=this._textWidth || nh !=this._textHeight){\r\n\t\t\t\tthis._textWidth=nw;\r\n\t\t\t\tthis._textHeight=nh;\r\n\t\t\t\tif(!this._width||!this._height)\r\n\t\t\t\t\tthis.model&&this.model.size(this._width||this._textWidth,this._height||this._textHeight);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.checkEnabledViewportOrNot=function(){\r\n\t\t\treturn this.overflow==Text.SCROLL && ((this._width > 0 && this._textWidth > this._width)|| (this._height > 0 && this._textHeight > this._height));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*快速更改显示文本。不进行排版计算，效率较高。\r\n\t\t*<p>如果只更改文字内容，不更改文字样式，建议使用此接口，能提高效率。</p>\r\n\t\t*@param text 文本内容。\r\n\t\t*/\r\n\t\t__proto.changeText=function(text){\r\n\t\t\tif (this._text!==text){\r\n\t\t\t\tthis.lang(text+\"\");\r\n\t\t\t\tif (this._graphics && this._graphics.replaceText(this._text)){\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis.typeset();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*分析文本换行。\r\n\t\t*/\r\n\t\t__proto.parseLines=function(text){\r\n\t\t\tvar needWordWrapOrTruncate=this.wordWrap || this.overflow==Text.HIDDEN;\r\n\t\t\tif (needWordWrapOrTruncate){\r\n\t\t\t\tvar wordWrapWidth=this.getWordWrapWidth();\r\n\t\t\t};\r\n\t\t\tvar measureResult=Browser.context.measureText(\"阳\");\r\n\t\t\tthis._charSize.width=measureResult.width;\r\n\t\t\tthis._charSize.height=(measureResult.height || this.fontSize);\r\n\t\t\tvar lines=text.replace(/\\r\\n/g,\"\\n\").split(\"\\n\");\r\n\t\t\tfor (var i=0,n=lines.length;i < n;i++){\r\n\t\t\t\tif (i < n-1)\r\n\t\t\t\t\tlines[i]+=\"\\n\";\r\n\t\t\t\tvar line=lines[i];\r\n\t\t\t\tif (needWordWrapOrTruncate)\r\n\t\t\t\t\tthis.parseLine(line,wordWrapWidth);\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._lineWidths.push(this.getTextWidth(line));\r\n\t\t\t\t\tthis._lines.push(line);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*解析行文本。\r\n\t\t*@param line 某行的文本。\r\n\t\t*@param wordWrapWidth 文本的显示宽度。\r\n\t\t*/\r\n\t\t__proto.parseLine=function(line,wordWrapWidth){\r\n\t\t\tvar ctx=Browser.context;\r\n\t\t\tvar lines=this._lines;\r\n\t\t\tvar maybeIndex=0;\r\n\t\t\tvar execResult;\r\n\t\t\tvar charsWidth=NaN;\r\n\t\t\tvar wordWidth=NaN;\r\n\t\t\tvar startIndex=0;\r\n\t\t\tcharsWidth=this.getTextWidth(line);\r\n\t\t\tif (charsWidth <=wordWrapWidth){\r\n\t\t\t\tlines.push(line);\r\n\t\t\t\tthis._lineWidths.push(charsWidth);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tcharsWidth=this._currBitmapFont ? this._currBitmapFont.getMaxWidth():this._charSize.width;\r\n\t\t\tmaybeIndex=Math.floor(wordWrapWidth / charsWidth);\r\n\t\t\t(maybeIndex==0)&& (maybeIndex=1);\r\n\t\t\tcharsWidth=this.getTextWidth(line.substring(0,maybeIndex));\r\n\t\t\twordWidth=charsWidth;\r\n\t\t\tfor (var j=maybeIndex,m=line.length;j < m;j++){\r\n\t\t\t\tcharsWidth=this.getTextWidth(line.charAt(j));\r\n\t\t\t\twordWidth+=charsWidth;\r\n\t\t\t\tif (wordWidth > wordWrapWidth){\r\n\t\t\t\t\tif (this.wordWrap){\r\n\t\t\t\t\t\tvar newLine=line.substring(startIndex,j);\r\n\t\t\t\t\t\tif (newLine.charCodeAt(newLine.length-1)< 255){\r\n\t\t\t\t\t\t\texecResult=/[^\\x20-]+$/.exec(newLine);\r\n\t\t\t\t\t\t\tif (execResult){\r\n\t\t\t\t\t\t\t\tj=execResult.index+startIndex;\r\n\t\t\t\t\t\t\t\tif (execResult.index==0)\r\n\t\t\t\t\t\t\t\t\tj+=newLine.length;\r\n\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tnewLine=line.substring(startIndex,j);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlines.push(newLine);\r\n\t\t\t\t\t\tthis._lineWidths.push(wordWidth-charsWidth);\r\n\t\t\t\t\t\tstartIndex=j;\r\n\t\t\t\t\t\tif (j+maybeIndex < m){\r\n\t\t\t\t\t\t\tj+=maybeIndex;\r\n\t\t\t\t\t\t\tcharsWidth=this.getTextWidth(line.substring(startIndex,j));\r\n\t\t\t\t\t\t\twordWidth=charsWidth;\r\n\t\t\t\t\t\t\tj--;\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tlines.push(line.substring(startIndex,m));\r\n\t\t\t\t\t\t\tthis._lineWidths.push(this.getTextWidth(lines[lines.length-1]));\r\n\t\t\t\t\t\t\tstartIndex=-1;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else if (this.overflow==Text.HIDDEN){\r\n\t\t\t\t\t\tlines.push(line.substring(0,j));\r\n\t\t\t\t\t\tthis._lineWidths.push(this.getTextWidth(lines[lines.length-1]));\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.wordWrap && startIndex !=-1){\r\n\t\t\t\tlines.push(line.substring(startIndex,m));\r\n\t\t\t\tthis._lineWidths.push(this.getTextWidth(lines[lines.length-1]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.getTextWidth=function(text){\r\n\t\t\tif (this._currBitmapFont)\r\n\t\t\t\treturn this._currBitmapFont.getTextWidth(text);\r\n\t\t\telse\r\n\t\t\treturn Browser.context.measureText(text).width;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取换行所需的宽度。\r\n\t\t*/\r\n\t\t__proto.getWordWrapWidth=function(){\r\n\t\t\tvar p=this.padding;\r\n\t\t\tvar w=NaN;\r\n\t\t\tif (this._currBitmapFont && this._currBitmapFont.autoScaleSize)\r\n\t\t\t\tw=this._width *(this._currBitmapFont.fontSize / this.fontSize);\r\n\t\t\telse\r\n\t\t\tw=this._width;\r\n\t\t\tif (w <=0){\r\n\t\t\t\tw=this.wordWrap ? 100 :Browser.width;\r\n\t\t\t}\r\n\t\t\tw <=0 && (w=100);\r\n\t\t\treturn w-p[3]-p[1];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回字符的位置信息。\r\n\t\t*@param charIndex 索引位置。\r\n\t\t*@param out 输出的Point引用。\r\n\t\t*@return 返回Point位置信息。\r\n\t\t*/\r\n\t\t__proto.getCharPoint=function(charIndex,out){\r\n\t\t\tthis._isChanged && Laya.timer.runCallLater(this,this.typeset);\r\n\t\t\tvar len=0,lines=this._lines,startIndex=0;\r\n\t\t\tfor (var i=0,n=lines.length;i < n;i++){\r\n\t\t\t\tlen+=lines[i].length;\r\n\t\t\t\tif (charIndex < len){\r\n\t\t\t\t\tvar line=i;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\t\tstartIndex=len;\r\n\t\t\t};\r\n\t\t\tvar ctxFont=(this.italic ? \"italic \" :\"\")+(this.bold ? \"bold \" :\"\")+this.fontSize+\"px \"+this.font;\r\n\t\t\tBrowser.context.font=ctxFont;\r\n\t\t\tvar width=this.getTextWidth(this._text.substring(startIndex,charIndex));\r\n\t\t\tvar point=out || new Point();\r\n\t\t\treturn point.setTo(this._startX+width-(this._clipPoint ? this._clipPoint.x :0),this._startY+line *(this._charSize.height+this.leading)-(this._clipPoint ? this._clipPoint.y :0));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\tif (this._width)\r\n\t\t\t\treturn this._width;\r\n\t\t\treturn this.textWidth+this.padding[1]+this.padding[3];\r\n\t\t\t},function(value){\r\n\t\t\tif (value !=this._width){\r\n\t\t\t\t_super.prototype._$set_width.call(this,value);\r\n\t\t\t\tthis.isChanged=true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本的宽度，以像素为单位。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'textWidth',function(){\r\n\t\t\tthis._isChanged && Laya.timer.runCallLater(this,this.typeset);\r\n\t\t\treturn this._textWidth;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\tif (this._height)return this._height;\r\n\t\t\treturn this.textHeight+this.padding[0]+this.padding[2];\r\n\t\t\t},function(value){\r\n\t\t\tif (value !=this._height){\r\n\t\t\t\t_super.prototype._$set_height.call(this,value);\r\n\t\t\t\tthis.isChanged=true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本的高度，以像素为单位。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'textHeight',function(){\r\n\t\t\tthis._isChanged && Laya.timer.runCallLater(this,this.typeset);\r\n\t\t\treturn this._textHeight;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*边距信息。\r\n\t\t*<p>数据格式：[上边距，右边距，下边距，左边距]（边距以像素为单位）。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'padding',function(){\r\n\t\t\treturn this._getCSSStyle().padding;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().padding=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*指定文本是否为粗体字。\r\n\t\t*<p>默认值为 false，这意味着不使用粗体字。如果值为 true，则文本为粗体字。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'bold',function(){\r\n\t\t\treturn this._getCSSStyle().bold;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().bold=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**当前文本的内容字符串。*/\r\n\t\t__getset(0,__proto,'text',function(){\r\n\t\t\treturn this._text || \"\";\r\n\t\t\t},function(value){\r\n\t\t\tif (this._text!==value){\r\n\t\t\t\tthis.lang(value+\"\");\r\n\t\t\t\tthis.isChanged=true;\r\n\t\t\t\tthis.event(/*laya.events.Event.CHANGE*/\"change\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本的颜色值。可以通过 <code>Text.defaultColor</code> 设置默认颜色。\r\n\t\t*<p>默认值为黑色。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'color',function(){\r\n\t\t\treturn this._getCSSStyle().color;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._getCSSStyle().color !=value){\r\n\t\t\t\tthis._getCSSStyle().color=value;\r\n\t\t\t\tif (!this._isChanged && this._graphics){\r\n\t\t\t\t\tthis._graphics.replaceTextColor(this.color)\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tthis.isChanged=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*文本的字体名称，以字符串形式表示。\r\n\t\t*<p>默认值为：\"Arial\"，可以通过Text.defaultFont设置默认字体。</p> *\r\n\t\t*@see laya.display.css.Font#defaultFamily\r\n\t\t*/\r\n\t\t__getset(0,__proto,'font',function(){\r\n\t\t\treturn this._getCSSStyle().fontFamily;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._currBitmapFont){\r\n\t\t\t\tthis._currBitmapFont=null;\r\n\t\t\t\tthis.scale(1,1);\r\n\t\t\t}\r\n\t\t\tif (Text._bitmapFonts && Text._bitmapFonts[value]){\r\n\t\t\t\tthis._currBitmapFont=Text._bitmapFonts[value];\r\n\t\t\t}\r\n\t\t\tthis._getCSSStyle().fontFamily=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*指定文本的字体大小（以像素为单位）。\r\n\t\t*<p>默认为20像素，可以通过 <code>Text.defaultSize</code> 设置默认大小。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'fontSize',function(){\r\n\t\t\treturn this._getCSSStyle().fontSize;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().fontSize=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示使用此文本格式的文本是否为斜体。\r\n\t\t*<p>默认值为 false，这意味着不使用斜体。如果值为 true，则文本为斜体。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'italic',function(){\r\n\t\t\treturn this._getCSSStyle().italic;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().italic=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本的水平显示方式。\r\n\t\t*<p><b>取值：</b>\r\n\t\t*<li>\"left\"： 居左对齐显示。</li>\r\n\t\t*<li>\"center\"： 居中对齐显示。</li>\r\n\t\t*<li>\"right\"： 居右对齐显示。</li>\r\n\t\t*</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'align',function(){\r\n\t\t\treturn this._getCSSStyle().align;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().align=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本的垂直显示方式。\r\n\t\t*<p><b>取值：</b>\r\n\t\t*<li>\"top\"： 居顶部对齐显示。</li>\r\n\t\t*<li>\"middle\"： 居中对齐显示。</li>\r\n\t\t*<li>\"bottom\"： 居底部对齐显示。</li>\r\n\t\t*</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'valign',function(){\r\n\t\t\treturn this._getCSSStyle().valign;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().valign=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*表示文本是否自动换行，默认为false。\r\n\t\t*<p>若值为true，则自动换行；否则不自动换行。</p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'wordWrap',function(){\r\n\t\t\treturn this._getCSSStyle().wordWrap;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().wordWrap=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*垂直行间距（以像素为单位）。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'leading',function(){\r\n\t\t\treturn this._getCSSStyle().leading;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().leading=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*文本背景颜色，以字符串表示。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'bgColor',function(){\r\n\t\t\treturn this._getCSSStyle().backgroundColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().backgroundColor=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*文本边框背景颜色，以字符串表示。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'borderColor',function(){\r\n\t\t\treturn this._getCSSStyle().borderColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().borderColor=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>描边宽度（以像素为单位）。</p>\r\n\t\t*默认值0，表示不描边。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'stroke',function(){\r\n\t\t\treturn this._getCSSStyle().stroke;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().stroke=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>描边颜色，以字符串表示。</p>\r\n\t\t*默认值为 \"#000000\"（黑色）;\r\n\t\t*/\r\n\t\t__getset(0,__proto,'strokeColor',function(){\r\n\t\t\treturn this._getCSSStyle().strokeColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().strokeColor=value;\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*一个布尔值，表示文本的属性是否有改变。若为true表示有改变。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'isChanged',null,function(value){\r\n\t\t\tif (this._isChanged!==value){\r\n\t\t\t\tthis._isChanged=value;\r\n\t\t\t\tvalue && Laya.timer.callLater(this,this.typeset);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置横向滚动量。\r\n\t\t*<p>即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。</p>\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取横向滚动量。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'scrollX',function(){\r\n\t\t\tif (!this._clipPoint)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn this._clipPoint.x;\r\n\t\t\t},function(value){\r\n\t\t\tif (this.overflow !=Text.SCROLL || (this.textWidth < this._width || !this._clipPoint))\r\n\t\t\t\treturn;\r\n\t\t\tvalue=value < this.padding[3] ? this.padding[3] :value;\r\n\t\t\tvar maxScrollX=this._textWidth-this._width;\r\n\t\t\tvalue=value > maxScrollX ? maxScrollX :value;\r\n\t\t\tvar visibleLineCount=this._height / (this._charSize.height+this.leading)| 0+1;\r\n\t\t\tthis._clipPoint.x=value;\r\n\t\t\tthis.renderText(this._lastVisibleLineIndex,visibleLineCount);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置纵向滚动量（px)。即使设置超出滚动范围的值，也会被自动限制在可能的最大值处。\r\n\t\t*/\r\n\t\t/**\r\n\t\t*获取纵向滚动量。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'scrollY',function(){\r\n\t\t\tif (!this._clipPoint)\r\n\t\t\t\treturn 0;\r\n\t\t\treturn this._clipPoint.y;\r\n\t\t\t},function(value){\r\n\t\t\tif (this.overflow !=Text.SCROLL || (this.textHeight < this._height || !this._clipPoint))\r\n\t\t\t\treturn;\r\n\t\t\tvalue=value < this.padding[0] ? this.padding[0] :value;\r\n\t\t\tvar maxScrollY=this._textHeight-this._height;\r\n\t\t\tvalue=value > maxScrollY ? maxScrollY :value;\r\n\t\t\tvar startLine=value / (this._charSize.height+this.leading)| 0;\r\n\t\t\tthis._lastVisibleLineIndex=startLine;\r\n\t\t\tvar visibleLineCount=(this._height / (this._charSize.height+this.leading)| 0)+1;\r\n\t\t\tthis._clipPoint.y=value;\r\n\t\t\tthis.renderText(startLine,visibleLineCount);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取横向可滚动最大值。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'maxScrollX',function(){\r\n\t\t\treturn (this.textWidth < this._width)? 0 :this._textWidth-this._width;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取纵向可滚动最大值。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'maxScrollY',function(){\r\n\t\t\treturn (this.textHeight < this._height)? 0 :this._textHeight-this._height;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'lines',function(){\r\n\t\t\treturn this._lines;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'underlineColor',function(){\r\n\t\t\treturn this._underlineColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._underlineColor=value;\r\n\t\t\tthis._isChanged=true;\r\n\t\t\tthis.typeset();\r\n\t\t});\r\n\r\n\t\tText.registerBitmapFont=function(name,bitmapFont){\r\n\t\t\tText._bitmapFonts || (Text._bitmapFonts={});\r\n\t\t\tText._bitmapFonts[name]=bitmapFont;\r\n\t\t}\r\n\r\n\t\tText.unregisterBitmapFont=function(name,destroy){\r\n\t\t\t(destroy===void 0)&& (destroy=true);\r\n\t\t\tif (Text._bitmapFonts && Text._bitmapFonts[name]){\r\n\t\t\t\tvar tBitmapFont=Text._bitmapFonts[name];\r\n\t\t\t\tif (destroy){\r\n\t\t\t\t\ttBitmapFont.destroy();\r\n\t\t\t\t}\r\n\t\t\t\tdelete Text._bitmapFonts[name];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tText.langPacks=null\r\n\t\tText.VISIBLE=\"visible\";\r\n\t\tText.SCROLL=\"scroll\";\r\n\t\tText.HIDDEN=\"hidden\";\r\n\t\tText._bitmapFonts=null\r\n\t\treturn Text;\r\n\t})(Sprite)\r\n\r\n\r\n\t/**\r\n\t*<p> <code>Stage</code> 类是显示对象的根节点。</p>\r\n\t*可以通过 Laya.stage 访问。\r\n\t*/\r\n\t//class laya.display.Stage extends laya.display.Sprite\r\n\tvar Stage=(function(_super){\r\n\t\tfunction Stage(){\r\n\t\t\tthis.focus=null;\r\n\t\t\tthis.frameRate=\"fast\";\r\n\t\t\tthis.desginWidth=0;\r\n\t\t\tthis.desginHeight=0;\r\n\t\t\tthis.canvasRotation=false;\r\n\t\t\tthis.canvasDegree=0;\r\n\t\t\tthis.renderingEnabled=true;\r\n\t\t\tthis._screenMode=\"none\";\r\n\t\t\tthis._scaleMode=\"noscale\";\r\n\t\t\tthis._alignV=\"top\";\r\n\t\t\tthis._alignH=\"left\";\r\n\t\t\tthis._bgColor=\"black\";\r\n\t\t\tthis._mouseMoveTime=0;\r\n\t\t\tthis._renderCount=0;\r\n\t\t\tthis._safariOffsetY=0;\r\n\t\t\tthis._frameStartTime=NaN;\r\n\t\t\tthis._previousOrientation=0;\r\n\t\t\tthis._scenes=null;\r\n\t\t\tStage.__super.call(this);\r\n\t\t\tthis.offset=new Point();\r\n\t\t\tthis._canvasTransform=new Matrix();\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._scenes=[];\r\n\t\t\tthis.mouseEnabled=true;\r\n\t\t\tthis.hitTestPrior=true;\r\n\t\t\tthis.autoSize=false;\r\n\t\t\tthis._displayedInStage=true;\r\n\t\t\tvar _this=this;\r\n\t\t\tvar window=Browser.window;\r\n\t\t\twindow.addEventListener(\"focus\",function(){\r\n\t\t\t\t_this.event(/*laya.events.Event.FOCUS*/\"focus\");\r\n\t\t\t});\r\n\t\t\twindow.addEventListener(\"blur\",function(){\r\n\t\t\t\t_this.event(/*laya.events.Event.BLUR*/\"blur\");\r\n\t\t\t\tif (_this._isInputting())Input[\"inputElement\"].target.focus=false;\r\n\t\t\t});\r\n\t\t\tvar hidden=\"hidden\",state=\"visibilityState\",visibilityChange=\"visibilitychange\";\r\n\t\t\tvar document=window.document;\r\n\t\t\tif (typeof document.hidden!==\"undefined\"){\r\n\t\t\t\tvisibilityChange=\"visibilitychange\";\r\n\t\t\t\tstate=\"visibilityState\";\r\n\t\t\t\t}else if (typeof document.mozHidden!==\"undefined\"){\r\n\t\t\t\tvisibilityChange=\"mozvisibilitychange\";\r\n\t\t\t\tstate=\"mozVisibilityState\";\r\n\t\t\t\t}else if (typeof document.msHidden!==\"undefined\"){\r\n\t\t\t\tvisibilityChange=\"msvisibilitychange\";\r\n\t\t\t\tstate=\"msVisibilityState\";\r\n\t\t\t\t}else if (typeof document.webkitHidden!==\"undefined\"){\r\n\t\t\t\tvisibilityChange=\"webkitvisibilitychange\";\r\n\t\t\t\tstate=\"webkitVisibilityState\";\r\n\t\t\t}\r\n\t\t\twindow.document.addEventListener(visibilityChange,visibleChangeFun);\r\n\t\t\tfunction visibleChangeFun (){\r\n\t\t\t\tif (Browser.document[state]==\"hidden\"){\r\n\t\t\t\t\t_this.event(/*laya.events.Event.BLUR*/\"blur\");\r\n\t\t\t\t\tif (_this._isInputting())Input[\"inputElement\"].target.focus=false;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t_this.event(/*laya.events.Event.FOCUS*/\"focus\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\twindow.addEventListener(\"resize\",function(){\r\n\t\t\t\tvar orientation=Browser.window.orientation;\r\n\t\t\t\tif (orientation !=null && orientation !=_$this._previousOrientation && _this._isInputting()){\r\n\t\t\t\t\tInput[\"inputElement\"].target.focus=false;\r\n\t\t\t\t}\r\n\t\t\t\t_$this._previousOrientation=orientation;\r\n\t\t\t\tif (_this._isInputting())return;\r\n\t\t\t\tif (Browser.onSafari)\r\n\t\t\t\t\t_this._safariOffsetY=(Browser.window.__innerHeight || Browser.document.body.clientHeight || Browser.document.documentElement.clientHeight)-Browser.window.innerHeight;\r\n\t\t\t\t_this._resetCanvas();\r\n\t\t\t});\r\n\t\t\twindow.addEventListener(\"orientationchange\",function(e){\r\n\t\t\t\t_this._resetCanvas();\r\n\t\t\t});\r\n\t\t\tthis.on(/*laya.events.Event.MOUSE_MOVE*/\"mousemove\",this,this._onmouseMove);\r\n\t\t\tif (Browser.onMobile)this.on(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",this,this._onmouseMove);\r\n\t\t}\r\n\r\n\t\t__class(Stage,'laya.display.Stage',_super);\r\n\t\tvar __proto=Stage.prototype;\r\n\t\t/**\r\n\t\t*在移动端输入时，输入法弹出期间不进行画布尺寸重置。\r\n\t\t*/\r\n\t\t__proto._isInputting=function(){\r\n\t\t\treturn (Browser.onMobile && Input.isInputting);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._changeCanvasSize=function(){\r\n\t\t\tthis.setScreenSize(Browser.clientWidth *Browser.pixelRatio,Browser.clientHeight *Browser.pixelRatio);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._resetCanvas=function(){\r\n\t\t\tvar canvas=Render._mainCanvas;\r\n\t\t\tvar canvasStyle=canvas.source.style;\r\n\t\t\tcanvas.size(1,1);\r\n\t\t\tcanvasStyle.transform=canvasStyle.webkitTransform=canvasStyle.msTransform=canvasStyle.mozTransform=canvasStyle.oTransform=\"\";\r\n\t\t\tthis._style.visible=false;\r\n\t\t\tLaya.timer.once(100,this,this._changeCanvasSize);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置屏幕大小，场景会根据屏幕大小进行适配。\r\n\t\t*@param screenWidth 屏幕宽度。\r\n\t\t*@param screenHeight 屏幕高度。\r\n\t\t*/\r\n\t\t__proto.setScreenSize=function(screenWidth,screenHeight){\r\n\t\t\tvar rotation=false;\r\n\t\t\tif (this._screenMode!==\"none\"){\r\n\t\t\t\tvar screenType=screenWidth / screenHeight < 1 ? \"vertical\" :\"horizontal\";\r\n\t\t\t\trotation=screenType!==this._screenMode;\r\n\t\t\t\tif (rotation){\r\n\t\t\t\t\tvar temp=screenHeight;\r\n\t\t\t\t\tscreenHeight=screenWidth;\r\n\t\t\t\t\tscreenWidth=temp;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.canvasRotation=rotation;\r\n\t\t\tvar canvas=Render._mainCanvas;\r\n\t\t\tvar canvasStyle=canvas.source.style;\r\n\t\t\tvar mat=this._canvasTransform.identity();\r\n\t\t\tvar scaleMode=this._scaleMode;\r\n\t\t\tvar scaleX=screenWidth / this.desginWidth;\r\n\t\t\tvar scaleY=screenHeight / this.desginHeight;\r\n\t\t\tvar canvasWidth=this.desginWidth;\r\n\t\t\tvar canvasHeight=this.desginHeight;\r\n\t\t\tvar realWidth=screenWidth;\r\n\t\t\tvar realHeight=screenHeight;\r\n\t\t\tvar pixelRatio=Browser.pixelRatio;\r\n\t\t\tthis._width=this.desginWidth;\r\n\t\t\tthis._height=this.desginHeight;\r\n\t\t\tswitch (scaleMode){\r\n\t\t\t\tcase \"noscale\":\r\n\t\t\t\t\tscaleX=scaleY=1;\r\n\t\t\t\t\trealWidth=this.desginWidth;\r\n\t\t\t\t\trealHeight=this.desginHeight;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"showall\":\r\n\t\t\t\t\tscaleX=scaleY=Math.min(scaleX,scaleY);\r\n\t\t\t\t\tcanvasWidth=realWidth=Math.round(this.desginWidth *scaleX);\r\n\t\t\t\t\tcanvasHeight=realHeight=Math.round(this.desginHeight *scaleY);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"noborder\":\r\n\t\t\t\t\tscaleX=scaleY=Math.max(scaleX,scaleY);\r\n\t\t\t\t\trealWidth=Math.round(this.desginWidth *scaleX);\r\n\t\t\t\t\trealHeight=Math.round(this.desginHeight *scaleY);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"full\":\r\n\t\t\t\t\tscaleX=scaleY=1;\r\n\t\t\t\t\tthis._width=canvasWidth=screenWidth;\r\n\t\t\t\t\tthis._height=canvasHeight=screenHeight;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"fixedwidth\":\r\n\t\t\t\t\tscaleY=scaleX;\r\n\t\t\t\t\tthis._height=screenHeight / scaleX;\r\n\t\t\t\t\tcanvasHeight=Math.round(screenHeight / scaleX);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase \"fixedheight\":\r\n\t\t\t\t\tscaleX=scaleY;\r\n\t\t\t\t\tthis._width=screenWidth / scaleY;\r\n\t\t\t\t\tcanvasWidth=Math.round(screenWidth / scaleY);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\tscaleX *=this.scaleX;\r\n\t\t\tscaleY *=this.scaleY;\r\n\t\t\tif (scaleX===1 && scaleY===1){\r\n\t\t\t\tthis.transform && this.transform.identity();\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.transform || (this.transform=new Matrix());\r\n\t\t\t\tthis.transform.a=scaleX / (realWidth / canvasWidth);\r\n\t\t\t\tthis.transform.d=scaleY / (realHeight / canvasHeight);\r\n\t\t\t\tthis.model && this.model.scale(this.transform.a,this.transform.d);\r\n\t\t\t}\r\n\t\t\tcanvas.size(canvasWidth,canvasHeight);\r\n\t\t\tRunDriver.changeWebGLSize(canvasWidth,canvasHeight);\r\n\t\t\tmat.scale(realWidth / canvasWidth / pixelRatio,realHeight / canvasHeight / pixelRatio);\r\n\t\t\tif (this._alignH===\"left\")this.offset.x=0;\r\n\t\t\telse if (this._alignH===\"right\")this.offset.x=screenWidth-realWidth;\r\n\t\t\telse this.offset.x=(screenWidth-realWidth)*0.5 / pixelRatio;\r\n\t\t\tif (this._alignV===\"top\")this.offset.y=0;\r\n\t\t\telse if (this._alignV===\"bottom\")this.offset.y=screenHeight-realHeight;\r\n\t\t\telse this.offset.y=(screenHeight-realHeight)*0.5 / pixelRatio;\r\n\t\t\tthis.offset.x=Math.round(this.offset.x);\r\n\t\t\tthis.offset.y=Math.round(this.offset.y);\r\n\t\t\tmat.translate(this.offset.x,this.offset.y);\r\n\t\t\tif (this._safariOffsetY && parseInt(canvasStyle.top)===0)canvasStyle.top=this._safariOffsetY+\"px\";\r\n\t\t\tthis.canvasDegree=0;\r\n\t\t\tif (rotation){\r\n\t\t\t\tif (this._screenMode===\"horizontal\"){\r\n\t\t\t\t\tmat.rotate(Math.PI / 2);\r\n\t\t\t\t\tmat.translate(screenHeight / pixelRatio,0);\r\n\t\t\t\t\tthis.canvasDegree=90;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tmat.rotate(-Math.PI / 2);\r\n\t\t\t\t\tmat.translate(0,screenWidth / pixelRatio);\r\n\t\t\t\t\tthis.canvasDegree=-90;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (mat.a < 0.00000000000001)mat.a=mat.d=0;\r\n\t\t\tif (mat.tx < 0.00000000000001)mat.tx=0;\r\n\t\t\tif (mat.ty < 0.00000000000001)mat.ty=0;\r\n\t\t\tcanvasStyle.transformOrigin=canvasStyle.webkitTransformOrigin=canvasStyle.msTransformOrigin=canvasStyle.mozTransformOrigin=canvasStyle.oTransformOrigin=\"0px 0px 0px\";\r\n\t\t\tcanvasStyle.transform=canvasStyle.webkitTransform=canvasStyle.msTransform=canvasStyle.mozTransform=canvasStyle.oTransform=\"matrix(\"+mat.toString()+\")\";\r\n\t\t\tmat.translate(parseInt(canvasStyle.left)|| 0,parseInt(canvasStyle.top)|| 0);\r\n\t\t\tthis._style.visible=true;\r\n\t\t\tthis._repaint=1;\r\n\t\t\tthis.event(/*laya.events.Event.RESIZE*/\"resize\");\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.getMousePoint=function(){\r\n\t\t\treturn Point.TEMP.setTo(this.mouseX,this.mouseY);\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.repaint=function(){\r\n\t\t\tthis._repaint=1;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.parentRepaint=function(){}\r\n\t\t/**@private */\r\n\t\t__proto._loop=function(){\r\n\t\t\tthis.render(Render.context,0,0);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._onmouseMove=function(e){\r\n\t\t\tthis._mouseMoveTime=Browser.now();\r\n\t\t}\r\n\r\n\t\t/**获得距当前帧开始后，过了多少时间，单位为毫秒\r\n\t\t*可以用来判断函数内时间消耗，控制每帧函数处理消耗的时间过长，导致帧率下降*/\r\n\t\t__proto.getTimeFromFrameStart=function(){\r\n\t\t\treturn Browser.now()-this._frameStartTime;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tif (this.frameRate===\"sleep\"){\r\n\t\t\t\tvar now=Browser.now();\r\n\t\t\t\tif (now-this._frameStartTime >=1000)this._frameStartTime=now;\r\n\t\t\t\telse return;\r\n\t\t\t}\r\n\t\t\tthis._renderCount++;\r\n\t\t\tRender.isFlash && this.repaint();\r\n\t\t\tif (!this.visible){\r\n\t\t\t\tif (this._renderCount % 5===0){\r\n\t\t\t\t\tStat.loopCount++;\r\n\t\t\t\t\tMouseManager.instance.runEvent();\r\n\t\t\t\t\tLaya.timer._update();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._frameStartTime=Browser.now();\r\n\t\t\tvar frameMode=this.frameRate===\"mouse\" ? (((this._frameStartTime-this._mouseMoveTime)< 2000)? \"fast\" :\"slow\"):this.frameRate;\r\n\t\t\tvar isFastMode=(frameMode!==\"slow\");\r\n\t\t\tvar isDoubleLoop=(this._renderCount % 2===0);\r\n\t\t\tStat.renderSlow=!isFastMode;\r\n\t\t\tif (isFastMode || isDoubleLoop){\r\n\t\t\t\tStat.loopCount++;\r\n\t\t\t\tMouseManager.instance.runEvent();\r\n\t\t\t\tLaya.timer._update();\r\n\t\t\t\tvar i=0,n=0;\r\n\t\t\t\tfor (i=0,n=this._scenes.length;i < n;i++){\r\n\t\t\t\t\tvar scene=this._scenes[i];\r\n\t\t\t\t\t(scene)&& (scene._updateScene());\r\n\t\t\t\t}\r\n\t\t\t\tif (Render.isConchNode){\r\n\t\t\t\t\tvar customList=Sprite.CustomList;\r\n\t\t\t\t\tfor (i=0,n=customList.length;i < n;i++){\r\n\t\t\t\t\t\tvar customItem=customList[i];\r\n\t\t\t\t\t\tcustomItem.customRender(customItem.customContext,0,0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (Render.isWebGL && this.renderingEnabled){\r\n\t\t\t\t\tcontext.clear();\r\n\t\t\t\t\t_super.prototype.render.call(this,context,x,y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (Render.isConchNode)return;\r\n\t\t\tif (this.renderingEnabled && (isFastMode || !isDoubleLoop)){\r\n\t\t\t\tif (Render.isWebGL){\r\n\t\t\t\t\tRunDriver.clear(this._bgColor);\r\n\t\t\t\t\tRunDriver.beginFlush();\r\n\t\t\t\t\tcontext.flush();\r\n\t\t\t\t\tRunDriver.endFinish();\r\n\t\t\t\t\tVectorGraphManager.instance && VectorGraphManager.getInstance().endDispose();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tRunDriver.clear(this._bgColor);\r\n\t\t\t\t\t_super.prototype.render.call(this,context,x,y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._requestFullscreen=function(){\r\n\t\t\tvar element=Browser.document.documentElement;\r\n\t\t\tif (element.requestFullscreen){\r\n\t\t\t\telement.requestFullscreen();\r\n\t\t\t\t}else if (element.mozRequestFullScreen){\r\n\t\t\t\telement.mozRequestFullScreen();\r\n\t\t\t\t}else if (element.webkitRequestFullscreen){\r\n\t\t\t\telement.webkitRequestFullscreen();\r\n\t\t\t\t}else if (element.msRequestFullscreen){\r\n\t\t\t\telement.msRequestFullscreen();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._fullScreenChanged=function(){\r\n\t\t\tLaya.stage.event(/*laya.events.Event.FULL_SCREEN_CHANGE*/\"fullscreenchange\");\r\n\t\t}\r\n\r\n\t\t/**退出全屏*/\r\n\t\t__proto.exitFullscreen=function(){\r\n\t\t\tvar document=Browser.document;\r\n\t\t\tif (document.exitFullscreen){\r\n\t\t\t\tdocument.exitFullscreen();\r\n\t\t\t\t}else if (document.mozCancelFullScreen){\r\n\t\t\t\tdocument.mozCancelFullScreen();\r\n\t\t\t\t}else if (document.webkitExitFullscreen){\r\n\t\t\t\tdocument.webkitExitFullscreen();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**鼠标在 Stage 上的 Y 轴坐标。*/\r\n\t\t__getset(0,__proto,'mouseY',function(){\r\n\t\t\treturn Math.round(MouseManager.instance.mouseY / this.clientScaleY);\r\n\t\t});\r\n\r\n\t\t/**当前视窗由缩放模式导致的 Y 轴缩放系数。*/\r\n\t\t__getset(0,__proto,'clientScaleY',function(){\r\n\t\t\treturn this._transform ? this._transform.getScaleY():1;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'width',_super.prototype._$get_width,function(value){\r\n\t\t\tthis.desginWidth=value;\r\n\t\t\t_super.prototype._$set_width.call(this,value);\r\n\t\t\tLaya.timer.callLater(this,this._changeCanvasSize);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*水平对齐方式。\r\n\t\t*<p><ul>取值范围：\r\n\t\t*<li>\"left\" ：居左对齐；</li>\r\n\t\t*<li>\"center\" ：居中对齐；</li>\r\n\t\t*<li>\"right\" ：居右对齐；</li>\r\n\t\t*</ul></p>\r\n\t\t*默认值为\"left\"。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'alignH',function(){\r\n\t\t\treturn this._alignH;\r\n\t\t\t},function(value){\r\n\t\t\tthis._alignH=value;\r\n\t\t\tLaya.timer.callLater(this,this._changeCanvasSize);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'height',_super.prototype._$get_height,function(value){\r\n\t\t\tthis.desginHeight=value;\r\n\t\t\t_super.prototype._$set_height.call(this,value);\r\n\t\t\tLaya.timer.callLater(this,this._changeCanvasSize);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*<p>缩放模式。</p>\r\n\t\t*<p><ul>取值范围：\r\n\t\t*<li>\"noscale\" ：不缩放；</li>\r\n\t\t*<li>\"exactfit\" ：全屏不等比缩放；</li>\r\n\t\t*<li>\"showall\" ：最小比例缩放；</li>\r\n\t\t*<li>\"noborder\" ：最大比例缩放；</li>\r\n\t\t*<li>\"full\" ：不缩放，stage的宽高等于屏幕宽高；</li>\r\n\t\t*<li>\"fixedwidth\" ：宽度不变，高度根据屏幕比缩放；</li>\r\n\t\t*<li>\"fixedheight\" ：高度不变，宽度根据屏幕比缩放；</li>\r\n\t\t*</ul></p>\r\n\t\t*默认值为 \"noscale\"。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'scaleMode',function(){\r\n\t\t\treturn this._scaleMode;\r\n\t\t\t},function(value){\r\n\t\t\tthis._scaleMode=value;\r\n\t\t\tLaya.timer.callLater(this,this._changeCanvasSize);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*垂直对齐方式。\r\n\t\t*<p><ul>取值范围：\r\n\t\t*<li>\"top\" ：居顶部对齐；</li>\r\n\t\t*<li>\"middle\" ：居中对齐；</li>\r\n\t\t*<li>\"bottom\" ：居底部对齐；</li>\r\n\t\t*</ul></p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'alignV',function(){\r\n\t\t\treturn this._alignV;\r\n\t\t\t},function(value){\r\n\t\t\tthis._alignV=value;\r\n\t\t\tLaya.timer.callLater(this,this._changeCanvasSize);\r\n\t\t});\r\n\r\n\t\t/**舞台的背景颜色，默认为黑色，null为透明。*/\r\n\t\t__getset(0,__proto,'bgColor',function(){\r\n\t\t\treturn this._bgColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._bgColor=value;\r\n\t\t\tthis.model && this.model.bgColor(value);\r\n\t\t\tif (value){\r\n\t\t\t\tRender.canvas.style.background=value;\r\n\t\t\t\t}else {\r\n\t\t\t\tRender.canvas.style.background=\"none\";\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**当前视窗由缩放模式导致的 X 轴缩放系数。*/\r\n\t\t__getset(0,__proto,'clientScaleX',function(){\r\n\t\t\treturn this._transform ? this._transform.getScaleX():1;\r\n\t\t});\r\n\r\n\t\t/**鼠标在 Stage 上的 X 轴坐标。*/\r\n\t\t__getset(0,__proto,'mouseX',function(){\r\n\t\t\treturn Math.round(MouseManager.instance.mouseX / this.clientScaleX);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*场景布局类型。\r\n\t\t*<p><ul>取值范围：\r\n\t\t*<li>\"none\" ：不更改屏幕</li>\r\n\t\t*<li>\"horizontal\" ：自动横屏</li>\r\n\t\t*<li>\"vertical\" ：自动竖屏</li>\r\n\t\t*</ul></p>\r\n\t\t*/\r\n\t\t__getset(0,__proto,'screenMode',function(){\r\n\t\t\treturn this._screenMode;\r\n\t\t\t},function(value){\r\n\t\t\tthis._screenMode=value;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'visible',_super.prototype._$get_visible,function(value){\r\n\t\t\tif (this.visible!==value){\r\n\t\t\t\t_super.prototype._$set_visible.call(this,value);\r\n\t\t\t\tvar style=Render._mainCanvas.source.style;\r\n\t\t\t\tstyle.visibility=value ? \"visible\" :\"hidden\";\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**是否开启全屏，用户点击后进入全屏*/\r\n\t\t__getset(0,__proto,'fullScreenEnabled',null,function(value){\r\n\t\t\tvar document=Browser.document;\r\n\t\t\tvar canvas=Render.canvas;\r\n\t\t\tif (value){\r\n\t\t\t\tcanvas.addEventListener('mousedown',this._requestFullscreen);\r\n\t\t\t\tcanvas.addEventListener('touchstart',this._requestFullscreen);\r\n\t\t\t\tdocument.addEventListener(\"fullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.addEventListener(\"mozfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.addEventListener(\"webkitfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.addEventListener(\"msfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\t}else {\r\n\t\t\t\tcanvas.removeEventListener('mousedown',this._requestFullscreen);\r\n\t\t\t\tcanvas.removeEventListener('touchstart',this._requestFullscreen);\r\n\t\t\t\tdocument.removeEventListener(\"fullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.removeEventListener(\"mozfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.removeEventListener(\"webkitfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t\tdocument.removeEventListener(\"msfullscreenchange\",this._fullScreenChanged);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tStage.SCALE_NOSCALE=\"noscale\";\r\n\t\tStage.SCALE_EXACTFIT=\"exactfit\";\r\n\t\tStage.SCALE_SHOWALL=\"showall\";\r\n\t\tStage.SCALE_NOBORDER=\"noborder\";\r\n\t\tStage.SCALE_FULL=\"full\";\r\n\t\tStage.SCALE_FIXED_WIDTH=\"fixedwidth\";\r\n\t\tStage.SCALE_FIXED_HEIGHT=\"fixedheight\";\r\n\t\tStage.ALIGN_LEFT=\"left\";\r\n\t\tStage.ALIGN_RIGHT=\"right\";\r\n\t\tStage.ALIGN_CENTER=\"center\";\r\n\t\tStage.ALIGN_TOP=\"top\";\r\n\t\tStage.ALIGN_MIDDLE=\"middle\";\r\n\t\tStage.ALIGN_BOTTOM=\"bottom\";\r\n\t\tStage.SCREEN_NONE=\"none\";\r\n\t\tStage.SCREEN_HORIZONTAL=\"horizontal\";\r\n\t\tStage.SCREEN_VERTICAL=\"vertical\";\r\n\t\tStage.FRAME_FAST=\"fast\";\r\n\t\tStage.FRAME_SLOW=\"slow\";\r\n\t\tStage.FRAME_MOUSE=\"mouse\";\r\n\t\tStage.FRAME_SLEEP=\"sleep\";\r\n\t\treturn Stage;\r\n\t})(Sprite)\r\n\r\n\r\n\t//class laya.media.SoundNode extends laya.display.Sprite\r\n\tvar SoundNode=(function(_super){\r\n\t\tfunction SoundNode(){\r\n\t\t\tthis.url=null;\r\n\t\t\tthis._channel=null;\r\n\t\t\tthis._tar=null;\r\n\t\t\tthis._playEvents=null;\r\n\t\t\tthis._stopEvents=null;\r\n\t\t\tSoundNode.__super.call(this);\r\n\t\t\tthis.visible=false;\r\n\t\t\tthis.on(/*laya.events.Event.ADDED*/\"added\",this,this._onParentChange);\r\n\t\t\tthis.on(/*laya.events.Event.REMOVED*/\"removed\",this,this._onParentChange);\r\n\t\t}\r\n\r\n\t\t__class(SoundNode,'laya.media.SoundNode',_super);\r\n\t\tvar __proto=SoundNode.prototype;\r\n\t\t/**@private */\r\n\t\t__proto._onParentChange=function(){\r\n\t\t\tthis.target=this.parent;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放\r\n\t\t*@param loops 循环次数\r\n\t\t*@param complete 完成回调\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.play=function(loops,complete){\r\n\t\t\t(loops===void 0)&& (loops=1);\r\n\t\t\tif (isNaN(loops)){\r\n\t\t\t\tloops=1;\r\n\t\t\t}\r\n\t\t\tif (!this.url)return;\r\n\t\t\tthis.stop();\r\n\t\t\tthis._channel=SoundManager.playSound(this.url,loops,complete);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*停止播放\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto.stop=function(){\r\n\t\t\tif (this._channel && !this._channel.isStopped){\r\n\t\t\t\tthis._channel.stop();\r\n\t\t\t}\r\n\t\t\tthis._channel=null;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setPlayAction=function(tar,event,action,add){\r\n\t\t\t(add===void 0)&& (add=true);\r\n\t\t\tif (!this[action])return;\r\n\t\t\tif (!tar)return;\r\n\t\t\tif (add){\r\n\t\t\t\ttar.on(event,this,this[action]);\r\n\t\t\t\t}else {\r\n\t\t\t\ttar.off(event,this,this[action]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._setPlayActions=function(tar,events,action,add){\r\n\t\t\t(add===void 0)&& (add=true);\r\n\t\t\tif (!tar)return;\r\n\t\t\tif (!events)return;\r\n\t\t\tvar eventArr=events.split(\",\");\r\n\t\t\tvar i=0,len=0;\r\n\t\t\tlen=eventArr.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tthis._setPlayAction(tar,eventArr[i],action,add);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置触发播放的事件\r\n\t\t*@param events\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(0,__proto,'playEvent',null,function(events){\r\n\t\t\tthis._playEvents=events;\r\n\t\t\tif (!events)return;\r\n\t\t\tif (this._tar){\r\n\t\t\t\tthis._setPlayActions(this._tar,events,\"play\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置控制播放的对象\r\n\t\t*@param tar\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(0,__proto,'target',null,function(tar){\r\n\t\t\tif (this._tar){\r\n\t\t\t\tthis._setPlayActions(this._tar,this._playEvents,\"play\",false);\r\n\t\t\t\tthis._setPlayActions(this._tar,this._stopEvents,\"stop\",false);\r\n\t\t\t}\r\n\t\t\tthis._tar=tar;\r\n\t\t\tif (this._tar){\r\n\t\t\t\tthis._setPlayActions(this._tar,this._playEvents,\"play\",true);\r\n\t\t\t\tthis._setPlayActions(this._tar,this._stopEvents,\"stop\",true);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置触发停止的事件\r\n\t\t*@param events\r\n\t\t*\r\n\t\t*/\r\n\t\t__getset(0,__proto,'stopEvent',null,function(events){\r\n\t\t\tthis._stopEvents=events;\r\n\t\t\tif (!events)return;\r\n\t\t\tif (this._tar){\r\n\t\t\t\tthis._setPlayActions(this._tar,events,\"stop\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn SoundNode;\r\n\t})(Sprite)\r\n\r\n\r\n\t//class laya.scene.Scene2D extends laya.display.Sprite\r\n\tvar Scene2D=(function(_super){\r\n\t\tfunction Scene2D(){\r\n\t\t\tScene2D.__super.call(this);\r\n\t\t\tthis.createChildren();\r\n\t\t}\r\n\r\n\t\t__class(Scene2D,'laya.scene.Scene2D',_super);\r\n\t\tvar __proto=Scene2D.prototype;\r\n\t\t/**\r\n\t\t*<p>创建并添加控件子节点。</p>\r\n\t\t*@internal 子类可在此函数内创建并添加子节点。\r\n\t\t*/\r\n\t\t__proto.createChildren=function(){}\r\n\t\t__proto.createView=function(sceneData){\r\n\t\t\tClassUtils.createByJson(sceneData,this,this);\r\n\t\t}\r\n\r\n\t\treturn Scene2D;\r\n\t})(Sprite)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>FileBitmap</code> 是图片文件资源类。\r\n\t*/\r\n\t//class laya.resource.FileBitmap extends laya.resource.Bitmap\r\n\tvar FileBitmap=(function(_super){\r\n\t\tfunction FileBitmap(){\r\n\t\t\tthis._src=null;\r\n\t\t\tthis._onload=null;\r\n\t\t\tthis._onerror=null;\r\n\t\t\tFileBitmap.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(FileBitmap,'laya.resource.FileBitmap',_super);\r\n\t\tvar __proto=FileBitmap.prototype;\r\n\t\t/**\r\n\t\t*文件路径全名。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'src',function(){\r\n\t\t\treturn this._src;\r\n\t\t\t},function(value){\r\n\t\t\tthis._src=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*载入完成处理函数。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onload',null,function(value){\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*错误处理函数。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onerror',null,function(value){\r\n\t\t});\r\n\r\n\t\treturn FileBitmap;\r\n\t})(Bitmap)\r\n\r\n\r\n\t/**\r\n\t*<code>HTMLCanvas</code> 是 Html Canvas 的代理类，封装了 Canvas 的属性和方法。。请不要直接使用 new HTMLCanvas！\r\n\t*/\r\n\t//class laya.resource.HTMLCanvas extends laya.resource.Bitmap\r\n\tvar HTMLCanvas=(function(_super){\r\n\t\tfunction HTMLCanvas(type,canvas){\r\n\t\t\t//this._ctx=null;\r\n\t\t\tthis._is2D=false;\r\n\t\t\tHTMLCanvas.__super.call(this);\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._source=this;\r\n\t\t\tif (type===\"2D\" || (type===\"AUTO\" && !Render.isWebGL)){\r\n\t\t\t\tthis._is2D=true;\r\n\t\t\t\tthis._source=canvas || Browser.createElement(\"canvas\");\r\n\t\t\t\tvar o=this;\r\n\t\t\t\to.getContext=function (contextID,other){\r\n\t\t\t\t\tif (_$this._ctx)return _$this._ctx;\r\n\t\t\t\t\tvar ctx=_$this._ctx=_$this._source.getContext(contextID,other);\r\n\t\t\t\t\tif (ctx){\r\n\t\t\t\t\t\tctx._canvas=o;\r\n\t\t\t\t\t\tif(!Render.isFlash)ctx.size=function (w,h){\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ctx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse this._source={};\r\n\t\t}\r\n\r\n\t\t__class(HTMLCanvas,'laya.resource.HTMLCanvas',_super);\r\n\t\tvar __proto=HTMLCanvas.prototype;\r\n\t\t/**\r\n\t\t*清空画布内容。\r\n\t\t*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._ctx && this._ctx.clear();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*销毁。\r\n\t\t*/\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._ctx && this._ctx.destroy();\r\n\t\t\tthis._ctx=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*释放。\r\n\t\t*/\r\n\t\t__proto.release=function(){}\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*设置 Canvas 渲染上下文。\r\n\t\t*@param context Canvas 渲染上下文。\r\n\t\t*/\r\n\t\t__proto._setContext=function(context){\r\n\t\t\tthis._ctx=context;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取 Canvas 渲染上下文。\r\n\t\t*@param contextID 上下文ID.\r\n\t\t*@param other\r\n\t\t*@return Canvas 渲染上下文 Context 对象。\r\n\t\t*/\r\n\t\t__proto.getContext=function(contextID,other){\r\n\t\t\treturn this._ctx ? this._ctx :(this._ctx=HTMLCanvas._createContext(this));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取内存大小。\r\n\t\t*@return 内存大小。\r\n\t\t*/\r\n\t\t__proto.getMemSize=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*设置宽高。\r\n\t\t*@param w 宽度。\r\n\t\t*@param h 高度。\r\n\t\t*/\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tif (this._w !=w || this._h !=h){\r\n\t\t\t\tthis._w=w;\r\n\t\t\t\tthis._h=h;\r\n\t\t\t\tthis._ctx && this._ctx.size(w,h);\r\n\t\t\t\tthis._source && (this._source.height=h,this._source.width=w);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*Canvas 渲染上下文。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'context',function(){\r\n\t\t\treturn this._ctx;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否当作 Bitmap 对象。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'asBitmap',null,function(value){\r\n\t\t});\r\n\r\n\t\tHTMLCanvas.create=function(type,canvas){\r\n\t\t\treturn new HTMLCanvas(type,canvas);\r\n\t\t}\r\n\r\n\t\tHTMLCanvas.TYPE2D=\"2D\";\r\n\t\tHTMLCanvas.TYPE3D=\"3D\";\r\n\t\tHTMLCanvas.TYPEAUTO=\"AUTO\";\r\n\t\tHTMLCanvas._createContext=null\r\n\t\treturn HTMLCanvas;\r\n\t})(Bitmap)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.resource.HTMLSubImage extends laya.resource.Bitmap\r\n\tvar HTMLSubImage=(function(_super){\r\n\t\t//请不要直接使用new HTMLSubImage\r\n\t\tfunction HTMLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas){\r\n\t\t\tHTMLSubImage.__super.call(this);\r\n\t\t\tthrow new Error(\"不允许new！\");\r\n\t\t}\r\n\r\n\t\t__class(HTMLSubImage,'laya.resource.HTMLSubImage',_super);\r\n\t\tHTMLSubImage.create=function(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas){\r\n\t\t\t(allowMerageInAtlas===void 0)&& (allowMerageInAtlas=false);\r\n\t\t\treturn new HTMLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,allowMerageInAtlas);\r\n\t\t}\r\n\r\n\t\treturn HTMLSubImage;\r\n\t})(Bitmap)\r\n\r\n\r\n\t/**\r\n\t*<p> <code>Animation</code> 类是位图动画,用于创建位图动画。</p>\r\n\t*<p> <code>Animation</code> 类可以加载并显示一组位图图片，并组成动画进行播放。</p>\r\n\t*@example 以下示例代码，创建了一个 <code>Text</code> 实例。\r\n\t*<listing version=\"3.0\">\r\n\t*package\r\n\t*{\r\n\t\t*import laya.display.Animation;\r\n\t\t*import laya.net.Loader;\r\n\t\t*import laya.utils.Handler;\r\n\t\t*public class Animation_Example\r\n\t\t*{\r\n\t\t\t*public function Animation_Example()\r\n\t\t\t*{\r\n\t\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t\t*init();//初始化\r\n\t\t\t\t*}\r\n\t\t\t*private function init():void\r\n\t\t\t*{\r\n\t\t\t\t*var animation:Animation=new Animation();//创建一个 Animation 类的实例对象 animation 。\r\n\t\t\t\t*animation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n\t\t\t\t*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t\t\t*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t\t\t*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n\t\t\t\t*animation.play();//播放动画。\r\n\t\t\t\t*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n\t\t\t\t*}\r\n\t\t\t*}\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*Animation_Example();\r\n\t*function Animation_Example(){\r\n\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t*init();//初始化\r\n\t\t*}\r\n\t*function init()\r\n\t*{\r\n\t\t*var animation=new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。\r\n\t\t*animation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n\t\t*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n\t\t*animation.play();//播放动画。\r\n\t\t*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n\t\t*}\r\n\t*</listing>\r\n\t*<listing version=\"3.0\">\r\n\t*import Animation=laya.display.Animation;\r\n\t*class Animation_Example {\r\n\t\t*constructor(){\r\n\t\t\t*Laya.init(640,800);//设置游戏画布宽高、渲染模式。\r\n\t\t\t*Laya.stage.bgColor=\"#efefef\";//设置画布的背景颜色。\r\n\t\t\t*this.init();\r\n\t\t\t*}\r\n\t\t*private init():void {\r\n\t\t\t*var animation:Animation=new Laya.Animation();//创建一个 Animation 类的实例对象 animation 。\r\n\t\t\t*animation.loadAtlas(\"resource/ani/fighter.json\");//加载图集并播放\r\n\t\t\t*animation.x=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t\t*animation.y=200;//设置 animation 对象的属性 x 的值，用于控制 animation 对象的显示位置。\r\n\t\t\t*animation.interval=50;//设置 animation 对象的动画播放间隔时间，单位：毫秒。\r\n\t\t\t*animation.play();//播放动画。\r\n\t\t\t*Laya.stage.addChild(animation);//将 animation 对象添加到显示列表。\r\n\t\t\t*}\r\n\t\t*}\r\n\t*new Animation_Example();\r\n\t*</listing>\r\n\t*/\r\n\t//class laya.display.Animation extends laya.display.AnimationPlayerBase\r\n\tvar Animation=(function(_super){\r\n\t\tfunction Animation(){\r\n\t\t\tthis._frames=null;\r\n\t\t\tthis._url=null;\r\n\t\t\tAnimation.__super.call(this);\r\n\t\t\tthis._setControlNode(this);\r\n\t\t}\r\n\r\n\t\t__class(Animation,'laya.display.Animation',_super);\r\n\t\tvar __proto=Animation.prototype;\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.destroy=function(destroyChild){\r\n\t\t\t(destroyChild===void 0)&& (destroyChild=true);\r\n\t\t\tthis.stop();\r\n\t\t\tlaya.display.Sprite.prototype.destroy.call(this,destroyChild);\r\n\t\t\tthis._frames=null;\r\n\t\t\tthis._labels=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*播放动画。\r\n\t\t*@param start 开始播放的动画索引或label。\r\n\t\t*@param loop 是否循环。\r\n\t\t*@param name 如果name为空(可选)，则播放当前动画，如果不为空，则播放全局缓存动画（如果有）\r\n\t\t*/\r\n\t\t__proto.play=function(start,loop,name){\r\n\t\t\t(start===void 0)&& (start=0);\r\n\t\t\t(loop===void 0)&& (loop=true);\r\n\t\t\t(name===void 0)&& (name=\"\");\r\n\t\t\tif (name)this._setFramesFromCache(name);\r\n\t\t\tthis._isPlaying=true;\r\n\t\t\tthis.index=((typeof start=='string'))? this._getFrameByLabel(start):start;\r\n\t\t\tthis.loop=loop;\r\n\t\t\tthis._actionName=name;\r\n\t\t\tthis._isReverse=this.wrapMode==1;\r\n\t\t\tif (this._frames && this.interval > 0){\r\n\t\t\t\tthis.timerLoop(this.interval,this,this._frameLoop,null,true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._setFramesFromCache=function(name){\r\n\t\t\tif (this._url)name=this._url+\"#\"+name;\r\n\t\t\tif (name && Animation.framesMap[name]){\r\n\t\t\t\tthis._frames=Animation.framesMap[name];\r\n\t\t\t\tthis._count=this._frames.length;\r\n\t\t\t\tif (!this._frameRateChanged && Animation.framesMap[name+\"$len\"])this._interval=Animation.framesMap[name+\"$len\"];\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto._frameLoop=function(){\r\n\t\t\tif (this._style.visible && this._style.alpha > 0.01){\r\n\t\t\t\t_super.prototype._frameLoop.call(this);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._displayToIndex=function(value){\r\n\t\t\tif (this._frames)this.graphics=this._frames[value];\r\n\t\t}\r\n\r\n\t\t/**清理。方便对象复用。*/\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.stop();\r\n\t\t\tthis.graphics=null;\r\n\t\t\tthis._frames=null;\r\n\t\t\tthis._labels=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载图片集合，组成动画。\r\n\t\t*@param urls 图片地址集合。如：[url1,url2,url3,...]。\r\n\t\t*@param cacheName 缓存为模板的名称，下次可以直接使用play调用，无需重新创建动画模板，设置为空则不缓存\r\n\t\t*@return 返回动画本身。\r\n\t\t*/\r\n\t\t__proto.loadImages=function(urls,cacheName){\r\n\t\t\t(cacheName===void 0)&& (cacheName=\"\");\r\n\t\t\tthis._url=\"\";\r\n\t\t\tif (!this._setFramesFromCache(cacheName)){\r\n\t\t\t\tthis.frames=Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] :Animation.createFrames(urls,cacheName);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载并播放一个图集。\r\n\t\t*@param url 图集地址。\r\n\t\t*@param loaded 加载完毕回调\r\n\t\t*@param cacheName 缓存为模板的名称，下次可以直接使用play调用，无需重新创建动画模板，设置为空则不缓存\r\n\t\t*@return 返回动画本身。\r\n\t\t*/\r\n\t\t__proto.loadAtlas=function(url,loaded,cacheName){\r\n\t\t\t(cacheName===void 0)&& (cacheName=\"\");\r\n\t\t\tthis._url=\"\";\r\n\t\t\tvar _this=this;\r\n\t\t\tif (!_this._setFramesFromCache(cacheName)){\r\n\t\t\t\tfunction onLoaded (loadUrl){\r\n\t\t\t\t\tif (url===loadUrl){\r\n\t\t\t\t\t\t_this.frames=Animation.framesMap[cacheName] ? Animation.framesMap[cacheName] :Animation.createFrames(url,cacheName);\r\n\t\t\t\t\t\tif (loaded)loaded.run();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (Loader.getAtlas(url))onLoaded(url);\r\n\t\t\t\telse Laya.loader.load(url,Handler.create(null,onLoaded,[url]),null,/*laya.net.Loader.ATLAS*/\"atlas\");\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*加载并播放一个由IDE制作的动画，播放的帧率按照IDE设计的帧率\r\n\t\t*@param url 动画地址。\r\n\t\t*@param loaded 加载完毕回调\r\n\t\t*@return 返回动画本身。\r\n\t\t*/\r\n\t\t__proto.loadAnimation=function(url,loaded){\r\n\t\t\tthis._url=url;\r\n\t\t\tvar _this=this;\r\n\t\t\tif (!_this._setFramesFromCache(\"\")){\r\n\t\t\t\tfunction onLoaded (loadUrl){\r\n\t\t\t\t\tif (url===loadUrl){\r\n\t\t\t\t\t\tif (!Animation.framesMap[url+\"#\"]){\r\n\t\t\t\t\t\t\tvar aniData=_this._parseGraphicAnimation(Loader.getRes(url));\r\n\t\t\t\t\t\t\tif (!aniData)return;\r\n\t\t\t\t\t\t\tvar obj=aniData.animationDic;\r\n\t\t\t\t\t\t\tvar flag=true;\r\n\t\t\t\t\t\t\tfor (var name in obj){\r\n\t\t\t\t\t\t\t\tvar info=obj[name];\r\n\t\t\t\t\t\t\t\tif (info.frames.length){\r\n\t\t\t\t\t\t\t\t\tAnimation.framesMap[url+\"#\"+name]=info.frames;\r\n\t\t\t\t\t\t\t\t\tAnimation.framesMap[url+\"#\"+name+\"$len\"]=info.interval;\r\n\t\t\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\t\t\tflag=false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(!_this._frameRateChanged)_this._interval=aniData.animationList[0].interval;\r\n\t\t\t\t\t\t\t_this.frames=aniData.animationList[0].frames;\r\n\t\t\t\t\t\t\tif (flag){\r\n\t\t\t\t\t\t\t\tAnimation.framesMap[url+\"#$len\"]=aniData.animationList[0].interval;\r\n\t\t\t\t\t\t\t\tAnimation.framesMap[url+\"#\"]=_this.frames;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tif(!_this._frameRateChanged)_this._interval=Animation.framesMap[url+\"#$len\"];\r\n\t\t\t\t\t\t\t_this.frames=Animation.framesMap[url+\"#\"];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (loaded)loaded.run();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (Loader.getRes(url))onLoaded(url);\r\n\t\t\t\telse Laya.loader.load(url,Handler.create(null,onLoaded,[url]),null,/*laya.net.Loader.JSON*/\"json\");\r\n\t\t\t\tLoader.clearRes(url);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._parseGraphicAnimation=function(animationData){\r\n\t\t\treturn GraphicAnimation.parseAnimationData(animationData)\r\n\t\t}\r\n\r\n\t\t/**Graphics集合*/\r\n\t\t__getset(0,__proto,'frames',function(){\r\n\t\t\treturn this._frames;\r\n\t\t\t},function(value){\r\n\t\t\tthis._frames=value;\r\n\t\t\tif (value){\r\n\t\t\t\tthis._count=value.length;\r\n\t\t\t\tif (this._isPlaying)this.play(this._index,this.loop,this._actionName);\r\n\t\t\t\telse this.index=this._index;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**是否自动播放*/\r\n\t\t__getset(0,__proto,'autoPlay',null,function(value){\r\n\t\t\tif (value)this.play();\r\n\t\t\telse this.stop();\r\n\t\t});\r\n\r\n\t\t/**图集地址或者图片集合*/\r\n\t\t__getset(0,__proto,'source',null,function(value){\r\n\t\t\tif (value.indexOf(\".ani\")>-1)this.loadAnimation(value);\r\n\t\t\telse if (value.indexOf(\".json\")>-1 || value.indexOf(\"als\")>-1)this.loadAtlas(value);\r\n\t\t\telse this.loadImages(value.split(\",\"));\r\n\t\t});\r\n\r\n\t\tAnimation.createFrames=function(url,name){\r\n\t\t\tvar arr;\r\n\t\t\tif ((typeof url=='string')){\r\n\t\t\t\tvar atlas=Loader.getAtlas(url);\r\n\t\t\t\tif (atlas && atlas.length){\r\n\t\t\t\t\tarr=[];\r\n\t\t\t\t\tfor (var i=0,n=atlas.length;i < n;i++){\r\n\t\t\t\t\t\tvar g=new Graphics();\r\n\t\t\t\t\t\tg.drawTexture(Loader.getRes(atlas[i]),0,0);\r\n\t\t\t\t\t\tarr.push(g);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else if ((url instanceof Array)){\r\n\t\t\t\tarr=[];\r\n\t\t\t\tfor (i=0,n=url.length;i < n;i++){\r\n\t\t\t\t\tg=new Graphics();\r\n\t\t\t\t\tg.loadImage(url[i],0,0);\r\n\t\t\t\t\tarr.push(g);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (name)Animation.framesMap[name]=arr;\r\n\t\t\treturn arr;\r\n\t\t}\r\n\r\n\t\tAnimation.clearCache=function(key){\r\n\t\t\tvar cache=Animation.framesMap;\r\n\t\t\tvar val;\r\n\t\t\tvar key2=key+\"#\";\r\n\t\t\tfor (val in cache){\r\n\t\t\t\tif (val===key || val.indexOf(key2)==0){\r\n\t\t\t\t\tdelete Animation.framesMap[val];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tAnimation.framesMap={};\r\n\t\treturn Animation;\r\n\t})(AnimationPlayerBase)\r\n\r\n\r\n\t/**\r\n\t*关键帧动画播放类\r\n\t*\r\n\t*/\r\n\t//class laya.display.FrameAnimation extends laya.display.AnimationPlayerBase\r\n\tvar FrameAnimation=(function(_super){\r\n\t\tfunction FrameAnimation(){\r\n\t\t\tthis._targetDic=null;\r\n\t\t\tthis._animationData=null;\r\n\t\t\tFrameAnimation.__super.call(this);\r\n\t\t\tif(FrameAnimation._sortIndexFun==null){\r\n\t\t\t\tFrameAnimation._sortIndexFun=MathUtil.sortByKey(\"index\",false,true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(FrameAnimation,'laya.display.FrameAnimation',_super);\r\n\t\tvar __proto=FrameAnimation.prototype;\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*初始化动画数据\r\n\t\t*@param targetDic 对象表\r\n\t\t*@param animationData 动画数据\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._setUp=function(targetDic,animationData){\r\n\t\t\tthis._labels=null;\r\n\t\t\tthis._targetDic=targetDic;\r\n\t\t\tthis._animationData=animationData;\r\n\t\t\tthis.interval=1000 / animationData.frameRate;\r\n\t\t\tif (animationData.parsed){\r\n\t\t\t\tthis._count=animationData.count;\r\n\t\t\t\t}else{\r\n\t\t\t\tthis._calculateDatas();\r\n\t\t\t}\r\n\t\t\tanimationData.parsed=true;\r\n\t\t\tanimationData.count=this._count;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto.clear=function(){\r\n\t\t\t_super.prototype.clear.call(this);\r\n\t\t\tthis._targetDic=null;\r\n\t\t\tthis._animationData=null;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__proto._displayToIndex=function(value){\r\n\t\t\tif(!this._animationData)return;\r\n\t\t\tif(value<0)value=0;\r\n\t\t\tif(value>this._count)value=this._count;\r\n\t\t\tvar nodes=this._animationData.nodes,i=0,len=nodes.length;\r\n\t\t\tfor(i=0;i<len;i++){\r\n\t\t\t\tthis._displayNodeToFrame(nodes[i],value);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*将节点设置到某一帧的状态\r\n\t\t*@param node 节点ID\r\n\t\t*@param frame\r\n\t\t*@param targetDic 节点表\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._displayNodeToFrame=function(node,frame,targetDic){\r\n\t\t\tif(!targetDic)targetDic=this._targetDic;\r\n\t\t\tvar target=targetDic[node.target];\r\n\t\t\tif(!target){\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar frames=node.frames,key,propFrames,value;\r\n\t\t\tvar keys=node.keys,i=0,len=keys.length;\r\n\t\t\tfor(i=0;i<len;i++){\r\n\t\t\t\tkey=keys[i];\r\n\t\t\t\tpropFrames=frames[key];\r\n\t\t\t\tif(propFrames.length>frame){\r\n\t\t\t\t\tvalue=propFrames[frame];\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\tvalue=propFrames[propFrames.length-1];\r\n\t\t\t\t}\r\n\t\t\t\ttarget[key]=value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*计算帧数据\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._calculateDatas=function(){\r\n\t\t\tif(!this._animationData)return;\r\n\t\t\tvar nodes=this._animationData.nodes,i=0,len=nodes.length,tNode;\r\n\t\t\tthis._count=0;\r\n\t\t\tfor(i=0;i<len;i++){\r\n\t\t\t\ttNode=nodes[i];\r\n\t\t\t\tthis._calculateNodeKeyFrames(tNode);\r\n\t\t\t}\r\n\t\t\tthis._count+=1;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*计算某个节点的帧数据\r\n\t\t*@param node\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._calculateNodeKeyFrames=function(node){\r\n\t\t\tvar keyFrames=node.keyframes,key,tKeyFrames,target=node.target;\r\n\t\t\tif(!node.frames){\r\n\t\t\t\tnode.frames={};\r\n\t\t\t}\r\n\t\t\tif(!node.keys){\r\n\t\t\t\tnode.keys=[];\r\n\t\t\t\t}else{\r\n\t\t\t\tnode.keys.length=0;\r\n\t\t\t}\r\n\t\t\tfor(key in keyFrames){\r\n\t\t\t\ttKeyFrames=keyFrames[key];\r\n\t\t\t\tif(!node.frames[key]){\r\n\t\t\t\t\tnode.frames[key]=[];\r\n\t\t\t\t}\r\n\t\t\t\ttKeyFrames.sort(FrameAnimation._sortIndexFun);\r\n\t\t\t\tnode.keys.push(key);\r\n\t\t\t\tthis._calculateNodePropFrames(tKeyFrames,node.frames[key],key,target);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*计算节点某个属性的帧数据\r\n\t\t*@param keyframes\r\n\t\t*@param frames\r\n\t\t*@param key\r\n\t\t*@param target\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._calculateNodePropFrames=function(keyframes,frames,key,target){\r\n\t\t\tvar i=0,len=keyframes.length-1;\r\n\t\t\tframes.length=keyframes[len].index+1;\r\n\t\t\tfor(i=0;i<len;i++){\r\n\t\t\t\tthis._dealKeyFrame(keyframes[i]);\r\n\t\t\t\tthis._calculateFrameValues(keyframes[i],keyframes[i+1],frames);\r\n\t\t\t}\r\n\t\t\tif(len==0){\r\n\t\t\t\tframes[0]=keyframes[0].value;\r\n\t\t\t}\r\n\t\t\tthis._dealKeyFrame(keyframes[i]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._dealKeyFrame=function(keyFrame){\r\n\t\t\tif (keyFrame.label&&keyFrame.label !=\"\")this.addLabel(keyFrame.label,keyFrame.index);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*计算两个关键帧直接的帧数据\r\n\t\t*@param startFrame\r\n\t\t*@param endFrame\r\n\t\t*@param result\r\n\t\t*\r\n\t\t*/\r\n\t\t__proto._calculateFrameValues=function(startFrame,endFrame,result){\r\n\t\t\tvar i=0,easeFun;\r\n\t\t\tvar start=startFrame.index,end=endFrame.index;\r\n\t\t\tvar startValue=startFrame.value;\r\n\t\t\tvar dValue=endFrame.value-startFrame.value;\r\n\t\t\tvar dLen=end-start;\r\n\t\t\tif(end>this._count)this._count=end;\r\n\t\t\tif(startFrame.tween){\r\n\t\t\t\teaseFun=Ease[startFrame.tweenMethod];\r\n\t\t\t\tif(easeFun==null){\r\n\t\t\t\t\teaseFun=Ease.linearNone;\r\n\t\t\t\t}\r\n\t\t\t\tfor(i=start;i<end;i++){\r\n\t\t\t\t\tresult[i]=easeFun(i-start,startValue,dValue,dLen);\r\n\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\tfor(i=start;i<end;i++){\r\n\t\t\t\t\tresult[i]=startValue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tresult[endFrame.index]=endFrame.value;\r\n\t\t}\r\n\r\n\t\tFrameAnimation._sortIndexFun=null\r\n\t\treturn FrameAnimation;\r\n\t})(AnimationPlayerBase)\r\n\r\n\r\n\t/**\r\n\t*<p><code>Input</code> 类用于创建显示对象以显示和输入文本。</p>\r\n\t*/\r\n\t//class laya.display.Input extends laya.display.Text\r\n\tvar Input=(function(_super){\r\n\t\tfunction Input(){\r\n\t\t\tthis._focus=false;\r\n\t\t\tthis._multiline=false;\r\n\t\t\tthis._editable=true;\r\n\t\t\tthis._restrictPattern=null;\r\n\t\t\tthis._type=\"text\";\r\n\t\t\tthis._prompt='';\r\n\t\t\tthis._promptColor=\"#A9A9A9\";\r\n\t\t\tthis._originColor=\"#000000\";\r\n\t\t\tthis._content='';\r\n\t\t\tInput.__super.call(this);\r\n\t\t\tthis._maxChars=1E5;\r\n\t\t\tthis._width=100;\r\n\t\t\tthis._height=20;\r\n\t\t\tthis.multiline=false;\r\n\t\t\tthis.overflow=Text.SCROLL;\r\n\t\t\tthis.on(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",this,this._onMouseDown);\r\n\t\t\tthis.on(/*laya.events.Event.UNDISPLAY*/\"undisplay\",this,this._onUnDisplay);\r\n\t\t}\r\n\r\n\t\t__class(Input,'laya.display.Input',_super);\r\n\t\tvar __proto=Input.prototype;\r\n\t\t/**\r\n\t\t*设置光标位置和选取字符。\r\n\t\t*@param startIndex 光标起始位置。\r\n\t\t*@param endIndex 光标结束位置。\r\n\t\t*/\r\n\t\t__proto.setSelection=function(startIndex,endIndex){\r\n\t\t\tlaya.display.Input.inputElement.selectionStart=startIndex;\r\n\t\t\tlaya.display.Input.inputElement.selectionEnd=endIndex;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._onUnDisplay=function(e){\r\n\t\t\tthis.focus=false;\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._onMouseDown=function(e){\r\n\t\t\tthis.focus=true;\r\n\t\t\tLaya.stage.on(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",this,this._checkBlur);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._checkBlur=function(e){\r\n\t\t\tif (e.nativeEvent.target !=laya.display.Input.input && e.nativeEvent.target !=laya.display.Input.area && e.target !=this)\r\n\t\t\t\tthis.focus=false;\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc*/\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tlaya.display.Sprite.prototype.render.call(this,context,x,y);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*在输入期间，如果 Input 实例的位置改变，调用该方法同步输入框的位置。\r\n\t\t*/\r\n\t\t__proto._syncInputTransform=function(){\r\n\t\t\tvar style=this.nativeInput.style;\r\n\t\t\tvar stage=Laya.stage;\r\n\t\t\tvar rec;\r\n\t\t\trec=Utils.getGlobalPosAndScale(this);\r\n\t\t\tvar m=stage._canvasTransform.clone();\r\n\t\t\tvar tm=m.clone();\r\n\t\t\ttm.rotate(-Math.PI / 180 *Laya.stage.canvasDegree);\r\n\t\t\ttm.scale(Laya.stage.clientScaleX,Laya.stage.clientScaleY);\r\n\t\t\tvar perpendicular=(Laya.stage.canvasDegree % 180 !=0);\r\n\t\t\tvar sx=perpendicular ? tm.d :tm.a;\r\n\t\t\tvar sy=perpendicular ? tm.a :tm.d;\r\n\t\t\ttm.destroy();\r\n\t\t\tvar tx=this.padding[3];\r\n\t\t\tvar ty=this.padding[0];\r\n\t\t\tif (Laya.stage.canvasDegree==0){\r\n\t\t\t\ttx+=rec.x;\r\n\t\t\t\tty+=rec.y;\r\n\t\t\t\ttx *=sx;\r\n\t\t\t\tty *=sy;\r\n\t\t\t\ttx+=m.tx;\r\n\t\t\t\tty+=m.ty;\r\n\t\t\t\t}else if (Laya.stage.canvasDegree==90){\r\n\t\t\t\ttx+=rec.y;\r\n\t\t\t\tty+=rec.x;\r\n\t\t\t\ttx *=sx;\r\n\t\t\t\tty *=sy;\r\n\t\t\t\ttx=m.tx-tx;\r\n\t\t\t\tty+=m.ty;\r\n\t\t\t\t}else{\r\n\t\t\t\ttx+=rec.y;\r\n\t\t\t\tty+=rec.x;\r\n\t\t\t\ttx *=sx;\r\n\t\t\t\tty *=sy;\r\n\t\t\t\ttx+=m.tx;\r\n\t\t\t\tty=m.ty-ty;\r\n\t\t\t};\r\n\t\t\tvar quarter=0.785;\r\n\t\t\tvar r=Math.atan2(rec.height,rec.width)-quarter;\r\n\t\t\tvar sin=Math.sin(r),cos=Math.cos(r);\r\n\t\t\tvar tsx=cos *rec.width+sin *rec.height;\r\n\t\t\tvar tsy=cos *rec.height-sin *rec.width;\r\n\t\t\tsx *=(perpendicular ? tsy :tsx);\r\n\t\t\tsy *=(perpendicular ? tsx :tsy);\r\n\t\t\tm.tx=0;\r\n\t\t\tm.ty=0;\r\n\t\t\tr *=180 / 3.1415;\r\n\t\t\tInput.inputContainer.style.transform=\"scale(\"+sx+\",\"+sy+\") rotate(\"+(Laya.stage.canvasDegree+r)+\"deg)\";\r\n\t\t\tInput.inputContainer.style.webkitTransform=\"scale(\"+sx+\",\"+sy+\") rotate(\"+(Laya.stage.canvasDegree+r)+\"deg)\";\r\n\t\t\tInput.inputContainer.setPos(tx,ty);\r\n\t\t\tm.destroy();\r\n\t\t\tvar inputWid=this._width-this.padding[1]-this.padding[3];\r\n\t\t\tvar inputHei=this._height-this.padding[0]-this.padding[2];\r\n\t\t\tthis.nativeInput.setSize(inputWid,inputHei);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tthis.nativeInput.setPos(tx,ty);\r\n\t\t\t\tthis.nativeInput.setScale(sx,sy);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**选中所有文本。*/\r\n\t\t__proto.select=function(){\r\n\t\t\tthis.nativeInput.select();\r\n\t\t}\r\n\r\n\t\t/**@private 设置输入法（textarea或input）*/\r\n\t\t__proto._setInputMethod=function(){\r\n\t\t\tInput.input.parentElement && (Input.inputContainer.removeChild(Input.input));\r\n\t\t\tInput.area.parentElement && (Input.inputContainer.removeChild(Input.area));\r\n\t\t\tInput.inputElement=(this._multiline ? Input.area :Input.input);\r\n\t\t\tInput.inputContainer.appendChild(Input.inputElement);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._focusIn=function(){\r\n\t\t\tlaya.display.Input.isInputting=true;\r\n\t\t\tvar input=this.nativeInput;\r\n\t\t\tthis._focus=true;\r\n\t\t\tvar cssStyle=input.style;\r\n\t\t\tcssStyle.whiteSpace=(this.wordWrap ? \"pre-wrap\" :\"nowrap\");\r\n\t\t\tthis._setPromptColor();\r\n\t\t\tinput.readOnly=!this._editable;\r\n\t\t\tinput.maxLength=this._maxChars;\r\n\t\t\tvar padding=this.padding;\r\n\t\t\tinput.type=this._type;\r\n\t\t\tinput.value=this._content;\r\n\t\t\tinput.placeholder=this._prompt;\r\n\t\t\tLaya.stage.off(/*laya.events.Event.KEY_DOWN*/\"keydown\",this,this._onKeyDown);\r\n\t\t\tLaya.stage.on(/*laya.events.Event.KEY_DOWN*/\"keydown\",this,this._onKeyDown);\r\n\t\t\tLaya.stage.focus=this;\r\n\t\t\tthis.event(/*laya.events.Event.FOCUS*/\"focus\");\r\n\t\t\tif (Browser.onPC)input.focus();\r\n\t\t\tvar temp=this._text;\r\n\t\t\tthis._text=null;\r\n\t\t\tthis.typeset();\r\n\t\t\tinput.setColor(this._originColor);\r\n\t\t\tinput.setFontSize(this.fontSize);\r\n\t\t\tinput.setFontFace(this.font);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tinput.setMultiAble && input.setMultiAble(this._multiline);\r\n\t\t\t}\r\n\t\t\tcssStyle.lineHeight=(this.leading+this.fontSize)+\"px\";\r\n\t\t\tcssStyle.fontStyle=(this.italic ? \"italic\" :\"normal\");\r\n\t\t\tcssStyle.fontWeight=(this.bold ? \"bold\" :\"normal\");\r\n\t\t\tcssStyle.textAlign=this.align;\r\n\t\t\tcssStyle.padding=\"0 0\";\r\n\t\t\tthis._syncInputTransform();\r\n\t\t\tif (!Render.isConchApp && Browser.onPC)\r\n\t\t\t\tLaya.timer.frameLoop(1,this,this._syncInputTransform);\r\n\t\t}\r\n\r\n\t\t// 设置DOM输入框提示符颜色。\r\n\t\t__proto._setPromptColor=function(){\r\n\t\t\tInput.promptStyleDOM=Browser.getElementById(\"promptStyle\");\r\n\t\t\tif (!Input.promptStyleDOM){\r\n\t\t\t\tInput.promptStyleDOM=Browser.createElement(\"style\");\r\n\t\t\t\tBrowser.document.head.appendChild(Input.promptStyleDOM);\r\n\t\t\t}\r\n\t\t\tInput.promptStyleDOM.innerText=\"input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {\"+\"color:\"+this._promptColor+\"}\"+\"input:-moz-placeholder, textarea:-moz-placeholder {\"+\"color:\"+this._promptColor+\"}\"+\"input::-moz-placeholder, textarea::-moz-placeholder {\"+\"color:\"+this._promptColor+\"}\"+\"input:-ms-input-placeholder, textarea:-ms-input-placeholder {\"+\"color:\"+this._promptColor+\"}\";\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._focusOut=function(){\r\n\t\t\tlaya.display.Input.isInputting=false;\r\n\t\t\tthis._focus=false;\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._content=this.nativeInput.value;\r\n\t\t\tif (!this._content){\r\n\t\t\t\t_super.prototype._$set_text.call(this,this._prompt);\r\n\t\t\t\t_super.prototype._$set_color.call(this,this._promptColor);\r\n\t\t\t\t}else {\r\n\t\t\t\t_super.prototype._$set_text.call(this,this._content);\r\n\t\t\t\t_super.prototype._$set_color.call(this,this._originColor);\r\n\t\t\t}\r\n\t\t\tLaya.stage.off(/*laya.events.Event.KEY_DOWN*/\"keydown\",this,this._onKeyDown);\r\n\t\t\tLaya.stage.focus=null;\r\n\t\t\tthis.event(/*laya.events.Event.BLUR*/\"blur\");\r\n\t\t\tif (Render.isConchApp)this.nativeInput.blur();\r\n\t\t\tBrowser.onPC && Laya.timer.clear(this,this._syncInputTransform);\r\n\t\t\tLaya.stage.off(/*laya.events.Event.MOUSE_DOWN*/\"mousedown\",this,this._checkBlur);\r\n\t\t}\r\n\r\n\t\t/**@private */\r\n\t\t__proto._onKeyDown=function(e){\r\n\t\t\tif (e.keyCode===13){\r\n\t\t\t\tif (Browser.onMobile && !this._multiline)\r\n\t\t\t\t\tthis.focus=false;\r\n\t\t\t\tthis.event(/*laya.events.Event.ENTER*/\"enter\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.changeText=function(text){\r\n\t\t\tthis._content=text;\r\n\t\t\tif (this._focus){\r\n\t\t\t\tthis.nativeInput.value=text || '';\r\n\t\t\t\tthis.event(/*laya.events.Event.CHANGE*/\"change\");\r\n\t\t\t}else\r\n\t\t\t_super.prototype.changeText.call(this,text);\r\n\t\t}\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__getset(0,__proto,'color',_super.prototype._$get_color,function(value){\r\n\t\t\tif (this._focus)\r\n\t\t\t\tthis.nativeInput.setColor(value);\r\n\t\t\t_super.prototype._$set_color.call(this,this._content?value:this._promptColor);\r\n\t\t\tthis._originColor=value;\r\n\t\t});\r\n\r\n\t\t//[Deprecated]\r\n\t\t__getset(0,__proto,'inputElementYAdjuster',function(){\r\n\t\t\tconsole.warn(\"deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。\");\r\n\t\t\treturn 0;\r\n\t\t\t},function(value){\r\n\t\t\tconsole.warn(\"deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。\");\r\n\t\t});\r\n\r\n\t\t/**表示是否是多行输入框。*/\r\n\t\t__getset(0,__proto,'multiline',function(){\r\n\t\t\treturn this._multiline;\r\n\t\t\t},function(value){\r\n\t\t\tthis._multiline=value;\r\n\t\t\tthis.valign=value ? \"top\" :\"middle\";\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*字符数量限制，默认为10000。\r\n\t\t*设置字符数量限制时，小于等于0的值将会限制字符数量为10000。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'maxChars',function(){\r\n\t\t\treturn this._maxChars;\r\n\t\t\t},function(value){\r\n\t\t\tif (value <=0)\r\n\t\t\t\tvalue=1E5;\r\n\t\t\tthis._maxChars=value;\r\n\t\t});\r\n\r\n\t\t/**@inheritDoc */\r\n\t\t__getset(0,__proto,'text',function(){\r\n\t\t\tif (this._focus)\r\n\t\t\t\treturn this.nativeInput.value;\r\n\t\t\telse\r\n\t\t\treturn this._content || \"\";\r\n\t\t\t},function(value){\r\n\t\t\t_super.prototype._$set_color.call(this,this._originColor);\r\n\t\t\tvalue+='';\r\n\t\t\tif (this._focus){\r\n\t\t\t\tthis.nativeInput.value=value || '';\r\n\t\t\t\tthis.event(/*laya.events.Event.CHANGE*/\"change\");\r\n\t\t\t\t}else {\r\n\t\t\t\tif (!this._multiline)\r\n\t\t\t\t\tvalue=value.replace(/\\r?\\n/g,'');\r\n\t\t\t\tthis._content=value;\r\n\t\t\t\tif (value)\r\n\t\t\t\t\t_super.prototype._$set_text.call(this,value);\r\n\t\t\t\telse {\r\n\t\t\t\t\t_super.prototype._$set_text.call(this,this._prompt);\r\n\t\t\t\t\t_super.prototype._$set_color.call(this,this.promptColor);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取对输入框的引用实例。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'nativeInput',function(){\r\n\t\t\treturn this._multiline ? Input.area :Input.input;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置输入提示符。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'prompt',function(){\r\n\t\t\treturn this._prompt;\r\n\t\t\t},function(value){\r\n\t\t\tif (!this._text && value)\r\n\t\t\t\t_super.prototype._$set_color.call(this,this._promptColor);\r\n\t\t\tthis.promptColor=this._promptColor;\r\n\t\t\tif (this._text)\r\n\t\t\t\t_super.prototype._$set_text.call(this,(this._text==this._prompt)?value:this._text);\r\n\t\t\telse\r\n\t\t\t_super.prototype._$set_text.call(this,value);\r\n\t\t\tthis._prompt=value;\r\n\t\t});\r\n\r\n\t\t// 因此 调用focus接口是无法都在移动平台立刻弹出键盘的\r\n\t\t/**\r\n\t\t*表示焦点是否在显示对象上。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'focus',function(){\r\n\t\t\treturn this._focus;\r\n\t\t\t},function(value){\r\n\t\t\tvar input=this.nativeInput;\r\n\t\t\tif (this._focus!==value){\r\n\t\t\t\tif (value){\r\n\t\t\t\t\tinput.target && (input.target.focus=false);\r\n\t\t\t\t\tinput.target=this;\r\n\t\t\t\t\tthis._setInputMethod();\r\n\t\t\t\t\tthis._focusIn();\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tinput.target=null;\r\n\t\t\t\t\tthis._focusOut();\r\n\t\t\t\t\tinput.blur();\r\n\t\t\t\t\tif (Render.isConchApp){\r\n\t\t\t\t\t\tinput.setPos(-10000,-10000);\r\n\t\t\t\t\t}else if (Input.inputContainer.contains(input))\r\n\t\t\t\t\tInput.inputContainer.removeChild(input);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/**限制输入的字符。*/\r\n\t\t__getset(0,__proto,'restrict',function(){\r\n\t\t\tif (this._restrictPattern){\r\n\t\t\t\treturn this._restrictPattern.source;\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t\t},function(pattern){\r\n\t\t\tif (pattern){\r\n\t\t\t\tpattern=\"[^\"+pattern+\"]\";\r\n\t\t\t\tif (pattern.indexOf(\"^^\")>-1)\r\n\t\t\t\t\tpattern=pattern.replace(\"^^\",\"\");\r\n\t\t\t\tthis._restrictPattern=new RegExp(pattern,\"g\");\r\n\t\t\t}else\r\n\t\t\tthis._restrictPattern=null;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否可编辑。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'editable',function(){\r\n\t\t\treturn this._editable;\r\n\t\t\t},function(value){\r\n\t\t\tthis._editable=value;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*设置输入提示符颜色。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'promptColor',function(){\r\n\t\t\treturn this._promptColor;\r\n\t\t\t},function(value){\r\n\t\t\tthis._promptColor=value;\r\n\t\t\tif (!this._content)_super.prototype._$set_color.call(this,value);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*输入框类型为Input静态常量之一。\r\n\t\t*平台兼容性参见http://www.w3school.com.cn/html5/html_5_form_input_types.asp。\r\n\t\t*/\r\n\t\t__getset(0,__proto,'type',function(){\r\n\t\t\treturn this._type;\r\n\t\t\t},function(value){\r\n\t\t\tif (value==\"password\")\r\n\t\t\t\tthis._getCSSStyle().password=true;\r\n\t\t\telse\r\n\t\t\tthis._getCSSStyle().password=false;\r\n\t\t\tthis._type=value;\r\n\t\t});\r\n\r\n\t\t//[Deprecated]\r\n\t\t__getset(0,__proto,'inputElementXAdjuster',function(){\r\n\t\t\tconsole.warn(\"deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。\");\r\n\t\t\treturn 0;\r\n\t\t\t},function(value){\r\n\t\t\tconsole.warn(\"deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。\");\r\n\t\t});\r\n\r\n\t\t//[Deprecated(replacement=\"Input.type\")]\r\n\t\t__getset(0,__proto,'asPassword',function(){\r\n\t\t\treturn this._getCSSStyle().password;\r\n\t\t\t},function(value){\r\n\t\t\tthis._getCSSStyle().password=value;\r\n\t\t\tthis._type=/*CLASS CONST:laya.display.Input.TYPE_PASSWORD*/\"password\";\r\n\t\t\tconsole.warn(\"deprecated: 使用type=\\\"password\\\"替代设置asPassword, asPassword将在下次重大更新时删去\");\r\n\t\t\tthis.isChanged=true;\r\n\t\t});\r\n\r\n\t\tInput.__init__=function(){\r\n\t\t\tInput._createInputElement();\r\n\t\t\tif (Browser.onMobile)\r\n\t\t\t\tRender.canvas.addEventListener(Input.IOS_IFRAME ? \"click\" :\"touchend\",Input._popupInputMethod);\r\n\t\t}\r\n\r\n\t\tInput._popupInputMethod=function(e){\r\n\t\t\tif (!laya.display.Input.isInputting)return;\r\n\t\t\tvar input=laya.display.Input.inputElement;\r\n\t\t\tinput.focus();\r\n\t\t}\r\n\r\n\t\tInput._createInputElement=function(){\r\n\t\t\tInput._initInput(Input.area=Browser.createElement(\"textarea\"));\r\n\t\t\tInput._initInput(Input.input=Browser.createElement(\"input\"));\r\n\t\t\tInput.inputContainer=Browser.createElement(\"div\");\r\n\t\t\tInput.inputContainer.style.position=\"absolute\";\r\n\t\t\tInput.inputContainer.style.zIndex=1E5;\r\n\t\t\tBrowser.container.appendChild(Input.inputContainer);\r\n\t\t\tInput.inputContainer.setPos=function (x,y){Input.inputContainer.style.left=x+'px';Input.inputContainer.style.top=y+'px';};\r\n\t\t}\r\n\r\n\t\tInput._initInput=function(input){\r\n\t\t\tvar style=input.style;\r\n\t\t\tstyle.cssText=\"position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;\";\r\n\t\t\tstyle.resize='none';\r\n\t\t\tstyle.backgroundColor='transparent';\r\n\t\t\tstyle.border='none';\r\n\t\t\tstyle.outline='none';\r\n\t\t\tstyle.zIndex=1;\r\n\t\t\tinput.addEventListener('input',Input._processInputting);\r\n\t\t\tinput.addEventListener('mousemove',Input._stopEvent);\r\n\t\t\tinput.addEventListener('mousedown',Input._stopEvent);\r\n\t\t\tinput.addEventListener('touchmove',Input._stopEvent);\r\n\t\t\tif(!Render.isConchApp){\r\n\t\t\t\tinput.setColor=function (color){input.style.color=color;};\r\n\t\t\t\tinput.setFontSize=function (fontSize){input.style.fontSize=fontSize+'px';};\r\n\t\t\t\tinput.setSize=function (w,h){input.style.width=w+'px';input.style.height=h+'px';};\r\n\t\t\t}\r\n\t\t\tinput.setFontFace=function (fontFace){input.style.fontFamily=fontFace;};\r\n\t\t}\r\n\r\n\t\tInput._processInputting=function(e){\r\n\t\t\tvar input=laya.display.Input.inputElement.target;\r\n\t\t\tif (!input)return;\r\n\t\t\tvar value=laya.display.Input.inputElement.value;\r\n\t\t\tif (input._restrictPattern){\r\n\t\t\t\tvalue=value.replace(/\\u2006|\\x27/g,\"\");\r\n\t\t\t\tif (input._restrictPattern.test(value)){\r\n\t\t\t\t\tvalue=value.replace(input._restrictPattern,\"\");\r\n\t\t\t\t\tlaya.display.Input.inputElement.value=value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tinput._text=value;\r\n\t\t\tinput.event(/*laya.events.Event.INPUT*/\"input\");\r\n\t\t}\r\n\r\n\t\tInput._stopEvent=function(e){\r\n\t\t\tif (e.type=='touchmove')\r\n\t\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation && e.stopPropagation();\r\n\t\t}\r\n\r\n\t\tInput.TYPE_TEXT=\"text\";\r\n\t\tInput.TYPE_PASSWORD=\"password\";\r\n\t\tInput.TYPE_EMAIL=\"email\";\r\n\t\tInput.TYPE_URL=\"url\";\r\n\t\tInput.TYPE_NUMBER=\"number\";\r\n\t\tInput.TYPE_RANGE=\"range\";\r\n\t\tInput.TYPE_DATE=\"date\";\r\n\t\tInput.TYPE_MONTH=\"month\";\r\n\t\tInput.TYPE_WEEK=\"week\";\r\n\t\tInput.TYPE_TIME=\"time\";\r\n\t\tInput.TYPE_DATE_TIME=\"datetime\";\r\n\t\tInput.TYPE_DATE_TIME_LOCAL=\"datetime-local\";\r\n\t\tInput.TYPE_SEARCH=\"search\";\r\n\t\tInput.input=null\r\n\t\tInput.area=null\r\n\t\tInput.inputElement=null\r\n\t\tInput.inputContainer=null\r\n\t\tInput.confirmButton=null\r\n\t\tInput.promptStyleDOM=null\r\n\t\tInput.inputHeight=45;\r\n\t\tInput.isInputting=false;\r\n\t\t__static(Input,\r\n\t\t['IOS_IFRAME',function(){return this.IOS_IFRAME=(Browser.onIOS && Browser.window.top !=Browser.window.self);}\r\n\t\t]);\r\n\t\treturn Input;\r\n\t})(Text)\r\n\r\n\r\n\t/**\r\n\t*<code>HTMLImage</code> 用于创建 HTML Image 元素。\r\n\t*@private\r\n\t*/\r\n\t//class laya.resource.HTMLImage extends laya.resource.FileBitmap\r\n\tvar HTMLImage=(function(_super){\r\n\t\tfunction HTMLImage(src,def){\r\n\t\t\tthis._recreateLock=false;\r\n\t\t\tthis._needReleaseAgain=false;\r\n\t\t\tHTMLImage.__super.call(this);\r\n\t\t\tthis._init_(src,def);\r\n\t\t}\r\n\r\n\t\t__class(HTMLImage,'laya.resource.HTMLImage',_super);\r\n\t\tvar __proto=HTMLImage.prototype;\r\n\t\t__proto._init_=function(src,def){\r\n\t\t\tthis._src=src;\r\n\t\t\tthis._source=new Browser.window.Image();\r\n\t\t\tif (def){\r\n\t\t\t\tdef.onload && (this.onload=def.onload);\r\n\t\t\t\tdef.onerror && (this.onerror=def.onerror);\r\n\t\t\t\tdef.onCreate && def.onCreate(this);\r\n\t\t\t}\r\n\t\t\tif (src.indexOf(\"data:image\")!=0)this._source.crossOrigin=\"\";\r\n\t\t\t(src)&& (this._source.src=src);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tvar _$this=this;\r\n\t\t\tif (this._src===\"\")\r\n\t\t\t\tthrow new Error(\"src no null！\");\r\n\t\t\tthis._needReleaseAgain=false;\r\n\t\t\tif (!this._source){\r\n\t\t\t\tthis._recreateLock=true;\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tthis._source=new Browser.window.Image();\r\n\t\t\t\tthis._source.crossOrigin=\"\";\r\n\t\t\t\tthis._source.onload=function (){\r\n\t\t\t\t\tif (_this._needReleaseAgain){\r\n\t\t\t\t\t\t_this._needReleaseAgain=false;\r\n\t\t\t\t\t\t_this._source.onload=null;\r\n\t\t\t\t\t\t_this._source=null;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_this._source.onload=null;\r\n\t\t\t\t\t_this.memorySize=_$this._w *_$this._h *4;\r\n\t\t\t\t\t_this._recreateLock=false;\r\n\t\t\t\t\t_this.completeCreate();\r\n\t\t\t\t};\r\n\t\t\t\tthis._source.src=this._src;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (this._recreateLock)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\t\tthis._recreateLock=false;\r\n\t\t\t\tthis.completeCreate();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._recreateLock)\r\n\t\t\t\tthis._needReleaseAgain=true;\r\n\t\t\t(this._source)&& (this._source=null,this.memorySize=0);\r\n\t\t}\r\n\r\n\t\t/***调整尺寸。*/\r\n\t\t__proto.onresize=function(){\r\n\t\t\tthis._w=this._source.width;\r\n\t\t\tthis._h=this._source.height;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onload',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onload=value;\r\n\t\t\tthis._source && (this._source.onload=this._onload !=null ? (function(){\r\n\t\t\t\t_$this.onresize();\r\n\t\t\t\t_$this._onload();\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*@inheritDoc\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onerror',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onerror=value;\r\n\t\t\tthis._source && (this._source.onerror=this._onerror !=null ? (function(){\r\n\t\t\t\t_$this._onerror()\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\tHTMLImage.create=function(src,def){\r\n\t\t\treturn new HTMLImage(src,def);\r\n\t\t}\r\n\r\n\t\treturn HTMLImage;\r\n\t})(FileBitmap)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.display.GraphicAnimation extends laya.display.FrameAnimation\r\n\tvar GraphicAnimation=(function(_super){\r\n\t\tfunction GraphicAnimation(){\r\n\t\t\tthis.animationList=null;\r\n\t\t\tthis.animationDic=null;\r\n\t\t\tthis._nodeList=null;\r\n\t\t\tthis._nodeDefaultProps=null;\r\n\t\t\tthis._gList=null;\r\n\t\t\tthis._nodeIDAniDic={};\r\n\t\t\tGraphicAnimation.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(GraphicAnimation,'laya.display.GraphicAnimation',_super);\r\n\t\tvar __proto=GraphicAnimation.prototype;\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._parseNodeList=function(uiView){\r\n\t\t\tif (!this._nodeList){\r\n\t\t\t\tthis._nodeList=[];\r\n\t\t\t}\r\n\t\t\tthis._nodeDefaultProps[uiView.compId]=uiView.props;\r\n\t\t\tif (uiView.compId)\r\n\t\t\t\tthis._nodeList.push(uiView.compId);\r\n\t\t\tvar childs=uiView.child;\r\n\t\t\tif (childs){\r\n\t\t\t\tvar i=0,len=childs.length;\r\n\t\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\t\tthis._parseNodeList(childs[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._calGraphicData=function(aniData){\r\n\t\t\tthis._setUp(null,aniData);\r\n\t\t\tthis._createGraphicData();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._createGraphicData=function(){\r\n\t\t\tvar gList=[];\r\n\t\t\tvar i=0,len=this.count;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\tgList.push(this._createFrameGraphic(i));\r\n\t\t\t}\r\n\t\t\tthis._gList=gList;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._createFrameGraphic=function(frame){\r\n\t\t\tvar g=new Graphics();\r\n\t\t\tvar i=0,len=this._nodeList.length;\r\n\t\t\tvar tNode=0;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\ttNode=this._nodeList[i];\r\n\t\t\t\tthis._addNodeGraphic(tNode,g,frame);\r\n\t\t\t}\r\n\t\t\treturn g;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._calculateNodeKeyFrames=function(node){\r\n\t\t\t_super.prototype._calculateNodeKeyFrames.call(this,node);\r\n\t\t\tthis._nodeIDAniDic[node.target]=node;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto.getNodeDataByID=function(nodeID){\r\n\t\t\treturn this._nodeIDAniDic[nodeID];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._getParams=function(obj,params,frame,obj2){\r\n\t\t\tvar rst=GraphicAnimation._temParam;\r\n\t\t\trst.length=params.length;\r\n\t\t\tvar i=0,len=params.length;\r\n\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\trst[i]=this._getObjVar(obj,params[i][0],frame,params[i][1],obj2);\r\n\t\t\t}\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._getObjVar=function(obj,key,frame,noValue,obj2){\r\n\t\t\tif (obj.hasOwnProperty(key)){\r\n\t\t\t\tvar vArr=obj[key];\r\n\t\t\t\tif (frame >=vArr.length)\r\n\t\t\t\t\tframe=vArr.length-1;\r\n\t\t\t\treturn obj[key][frame];\r\n\t\t\t}\r\n\t\t\tif (obj2.hasOwnProperty(key)){\r\n\t\t\t\treturn obj2[key];\r\n\t\t\t}\r\n\t\t\treturn noValue;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._addNodeGraphic=function(nodeID,g,frame){\r\n\t\t\tvar node=this.getNodeDataByID(nodeID);\r\n\t\t\tif (!node)\r\n\t\t\t\treturn;\r\n\t\t\tvar frameData=node.frames;\r\n\t\t\tvar params=this._getParams(frameData,GraphicAnimation._drawTextureCmd,frame,this._nodeDefaultProps[nodeID]);\r\n\t\t\tvar url=params[0];\r\n\t\t\tif (!url)return;\r\n\t\t\tparams[0]=this._getTextureByUrl(url);\r\n\t\t\tif (!params[0]){\r\n\t\t\t\tconsole.log(\"lost:\",url);\r\n\t\t\t\tthrow new Error(\"texture not loaded:\"+url);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar m;\r\n\t\t\tvar px=params[5],py=params[6];\r\n\t\t\tif (px !=0 || py !=0){\r\n\t\t\t\tm=m || new Matrix();\r\n\t\t\t\tm.translate(-px,-py);\r\n\t\t\t};\r\n\t\t\tvar sx=params[7],sy=params[8];\r\n\t\t\tvar rotate=params[9];\r\n\t\t\tif (sx !=1 || sy !=1 || rotate !=0){\r\n\t\t\t\tm=m || new Matrix();\r\n\t\t\t\tm.scale(sx,sy);\r\n\t\t\t\tm.rotate(rotate *0.0174532922222222);\r\n\t\t\t}\r\n\t\t\tif (m){\r\n\t\t\t\tm.translate(params[1],params[2]);\r\n\t\t\t\tparams[1]=params[2]=0;\r\n\t\t\t}\r\n\t\t\tg.drawTexture(params[0],params[1],params[2],params[3],params[4],m,params[10]);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._getTextureByUrl=function(url){\r\n\t\t\treturn Loader.getRes(url);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto.setAniData=function(uiView){\r\n\t\t\tif (uiView.animations){\r\n\t\t\t\tthis._nodeDefaultProps={};\r\n\t\t\t\tif (this._nodeList)this._nodeList.length=0;\r\n\t\t\t\tthis._parseNodeList(uiView);\r\n\t\t\t\tvar aniDic={};\r\n\t\t\t\tvar anilist=[];\r\n\t\t\t\tvar animations=uiView.animations;\r\n\t\t\t\tvar i=0,len=animations.length;\r\n\t\t\t\tvar tAniO;\r\n\t\t\t\tfor (i=0;i < len;i++){\r\n\t\t\t\t\ttAniO=animations[i];\r\n\t\t\t\t\tif (!tAniO)continue ;\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tthis._calGraphicData(tAniO);\r\n\t\t\t\t\t\t}catch (e){\r\n\t\t\t\t\t\tconsole.log(\"parse animation fail:\"+tAniO.name+\",empty animation created\");\r\n\t\t\t\t\t\tthis._gList=[];\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar frameO={};\r\n\t\t\t\t\tframeO.interval=1000 / tAniO[\"frameRate\"];\r\n\t\t\t\t\tframeO.frames=this._gList;\r\n\t\t\t\t\tanilist.push(frameO);\r\n\t\t\t\t\taniDic[tAniO.name]=frameO;\r\n\t\t\t\t}\r\n\t\t\t\tthis.animationList=anilist;\r\n\t\t\t\tthis.animationDic=aniDic;\r\n\t\t\t}\r\n\t\t\tGraphicAnimation._temParam.length=0;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto._clear=function(){\r\n\t\t\tthis.animationList=null;\r\n\t\t\tthis.animationDic=null;\r\n\t\t\tthis._gList=null;\r\n\t\t}\r\n\r\n\t\tGraphicAnimation.parseAnimationData=function(aniData){\r\n\t\t\tif (!GraphicAnimation._I)\r\n\t\t\t\tGraphicAnimation._I=new GraphicAnimation();\r\n\t\t\tGraphicAnimation._I.setAniData(aniData);\r\n\t\t\tvar rst;\r\n\t\t\trst={};\r\n\t\t\trst.animationList=GraphicAnimation._I.animationList;\r\n\t\t\trst.animationDic=GraphicAnimation._I.animationDic;\r\n\t\t\tGraphicAnimation._I._clear();\r\n\t\t\treturn rst;\r\n\t\t}\r\n\r\n\t\tGraphicAnimation._temParam=[];\r\n\t\tGraphicAnimation._I=null\r\n\t\t__static(GraphicAnimation,\r\n\t\t['_drawTextureCmd',function(){return this._drawTextureCmd=[[\"skin\",null],[\"x\",0],[\"y\",0],[\"width\",0],[\"height\",0],[\"pivotX\",0],[\"pivotY\",0],[\"scaleX\",1],[\"scaleY\",1],[\"rotation\",0],[\"alpha\",1]];}\r\n\t\t]);\r\n\t\treturn GraphicAnimation;\r\n\t})(FrameAnimation)\r\n\r\n\r\n\tLaya.__init([EventDispatcher,LoaderManager,Render,Browser,Timer,LocalStorage,TimeLine]);\r\n})(window,document,Laya);\r\n\r\n(function(window,document,Laya){\r\n\tvar __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;\r\n\r\n\tvar Arith=laya.maths.Arith,Bezier=laya.maths.Bezier,Bitmap=laya.resource.Bitmap,Browser=laya.utils.Browser;\r\n\tvar Color=laya.utils.Color,ColorFilter=laya.filters.ColorFilter,Config=Laya.Config,Context=laya.resource.Context;\r\n\tvar Event=laya.events.Event,Filter=laya.filters.Filter,Graphics=laya.display.Graphics,HTMLCanvas=laya.resource.HTMLCanvas;\r\n\tvar HTMLChar=laya.utils.HTMLChar,HTMLImage=laya.resource.HTMLImage,Handler=laya.utils.Handler,Matrix=laya.maths.Matrix;\r\n\tvar Point=laya.maths.Point,Rectangle=laya.maths.Rectangle,Render=laya.renders.Render,RenderContext=laya.renders.RenderContext;\r\n\tvar RenderSprite=laya.renders.RenderSprite,Resource=laya.resource.Resource,ResourceManager=laya.resource.ResourceManager;\r\n\tvar RunDriver=laya.utils.RunDriver,Sprite=laya.display.Sprite,Stat=laya.utils.Stat,StringKey=laya.utils.StringKey;\r\n\tvar Style=laya.display.css.Style,System=laya.system.System,Texture=laya.resource.Texture,Utils=laya.utils.Utils;\r\n\tvar VectorGraphManager=laya.utils.VectorGraphManager,WordText=laya.utils.WordText;\r\n\tLaya.interface('laya.webgl.shapes.IShape');\r\n\tLaya.interface('laya.webgl.submit.ISubmit');\r\n\tLaya.interface('laya.webgl.text.ICharSegment');\r\n\tLaya.interface('laya.webgl.canvas.save.ISaveData');\r\n\tLaya.interface('laya.webgl.resource.IMergeAtlasBitmap');\r\n\tLaya.interface('laya.filters.IFilterActionGL','laya.filters.IFilterAction');\r\n\t//class LayaMain\r\n\tvar LayaMain=(function(){\r\n\t\t/*[COMPILER OPTIONS:normal]*/\r\n\t\tfunction LayaMain(){}\r\n\t\t__class(LayaMain,'LayaMain');\r\n\t\treturn LayaMain;\r\n\t})()\r\n\r\n\r\n\t//class laya.filters.webgl.FilterActionGL\r\n\tvar FilterActionGL=(function(){\r\n\t\tfunction FilterActionGL(){}\r\n\t\t__class(FilterActionGL,'laya.filters.webgl.FilterActionGL');\r\n\t\tvar __proto=FilterActionGL.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilterActionGL\":true})\r\n\t\t__proto.setValue=function(shader){}\r\n\t\t__proto.setValueMix=function(shader){}\r\n\t\t__proto.apply3d=function(scope,sprite,context,x,y){return null;}\r\n\t\t__proto.apply=function(srcCanvas){return null;}\r\n\t\t__getset(0,__proto,'typeMix',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\treturn FilterActionGL;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.ShaderValue\r\n\tvar ShaderValue=(function(){\r\n\t\tfunction ShaderValue(){}\r\n\t\t__class(ShaderValue,'laya.webgl.shader.ShaderValue');\r\n\t\treturn ShaderValue;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasGrid\r\n\tvar AtlasGrid=(function(){\r\n\t\tvar TexRowInfo,TexMergeTexSize;\r\n\t\tfunction AtlasGrid(width,height,atlasID){\r\n\t\t\tthis._atlasID=0;\r\n\t\t\tthis._width=0;\r\n\t\t\tthis._height=0;\r\n\t\t\tthis._texCount=0;\r\n\t\t\tthis._rowInfo=null;\r\n\t\t\tthis._cells=null;\r\n\t\t\tthis._failSize=new TexMergeTexSize();\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t(atlasID===void 0)&& (atlasID=0);\r\n\t\t\tthis._cells=null;\r\n\t\t\tthis._rowInfo=null;\r\n\t\t\tthis._init(width,height);\r\n\t\t\tthis._atlasID=atlasID;\r\n\t\t}\r\n\r\n\t\t__class(AtlasGrid,'laya.webgl.atlas.AtlasGrid');\r\n\t\tvar __proto=AtlasGrid.prototype;\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto.getAltasID=function(){\r\n\t\t\treturn this._atlasID;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto.setAltasID=function(atlasID){\r\n\t\t\tif (atlasID >=0){\r\n\t\t\t\tthis._atlasID=atlasID;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto.addTex=function(type,width,height){\r\n\t\t\tvar result=this._get(width,height);\r\n\t\t\tif (result.ret==false){\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tthis._fill(result.x,result.y,width,height,type);\r\n\t\t\tthis._texCount++;\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto._release=function(){\r\n\t\t\tif (this._cells !=null){\r\n\t\t\t\tthis._cells.length=0;\r\n\t\t\t\tthis._cells=null;\r\n\t\t\t}\r\n\t\t\tif (this._rowInfo){\r\n\t\t\t\tthis._rowInfo.length=0;\r\n\t\t\t\tthis._rowInfo=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto._init=function(width,height){\r\n\t\t\tthis._width=width;\r\n\t\t\tthis._height=height;\r\n\t\t\tthis._release();\r\n\t\t\tif (this._width==0)return false;\r\n\t\t\tthis._cells=new Uint8Array(this._width *this._height*3);\r\n\t\t\tthis._rowInfo=__newvec(this._height);\r\n\t\t\tfor (var i=0;i < this._height;i++){\r\n\t\t\t\tthis._rowInfo[i]=new TexRowInfo();\r\n\t\t\t}\r\n\t\t\tthis._clear();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._get=function(width,height){\r\n\t\t\tvar pFillInfo=new MergeFillInfo();\r\n\t\t\tif (width >=this._failSize.width && height >=this._failSize.height){\r\n\t\t\t\treturn pFillInfo;\r\n\t\t\t};\r\n\t\t\tvar rx=-1;\r\n\t\t\tvar ry=-1;\r\n\t\t\tvar nWidth=this._width;\r\n\t\t\tvar nHeight=this._height;\r\n\t\t\tvar pCellBox=this._cells;\r\n\t\t\tfor (var y=0;y < nHeight;y++){\r\n\t\t\t\tif (this._rowInfo[y].spaceCount < width)continue ;\r\n\t\t\t\tfor (var x=0;x < nWidth;){\r\n\t\t\t\t\tvar tm=(y *nWidth+x)*3;\r\n\t\t\t\t\tif (pCellBox[tm] !=0 || pCellBox[tm+1] < width || pCellBox[tm+2] < height){\r\n\t\t\t\t\t\tx+=pCellBox[tm+1];\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\trx=x;\r\n\t\t\t\t\try=y;\r\n\t\t\t\t\tfor (var xx=0;xx < width;xx++){\r\n\t\t\t\t\t\tif (pCellBox[3*xx+tm+2] < height){\r\n\t\t\t\t\t\t\trx=-1;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (rx < 0){\r\n\t\t\t\t\t\tx+=pCellBox[tm+1];\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpFillInfo.ret=true;\r\n\t\t\t\t\tpFillInfo.x=rx;\r\n\t\t\t\t\tpFillInfo.y=ry;\r\n\t\t\t\t\treturn pFillInfo;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pFillInfo;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._fill=function(x,y,w,h,type){\r\n\t\t\tvar nWidth=this._width;\r\n\t\t\tvar nHeghit=this._height;\r\n\t\t\tthis._check((x+w)<=nWidth && (y+h)<=nHeghit);\r\n\t\t\tfor (var yy=y;yy < (h+y);++yy){\r\n\t\t\t\tthis._check(this._rowInfo[yy].spaceCount >=w);\r\n\t\t\t\tthis._rowInfo[yy].spaceCount-=w;\r\n\t\t\t\tfor (var xx=0;xx < w;xx++){\r\n\t\t\t\t\tvar tm=(x+yy *nWidth+xx)*3;\r\n\t\t\t\t\tthis._check(this._cells[tm]==0);\r\n\t\t\t\t\tthis._cells[tm]=type;\r\n\t\t\t\t\tthis._cells[tm+1]=w;\r\n\t\t\t\t\tthis._cells[tm+2]=h;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (x > 0){\r\n\t\t\t\tfor (yy=0;yy < h;++yy){\r\n\t\t\t\t\tvar s=0;\r\n\t\t\t\t\tfor (xx=x-1;xx >=0;--xx,++s){\r\n\t\t\t\t\t\tif (this._cells[((y+yy)*nWidth+xx)*3] !=0)break ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (xx=s;xx > 0;--xx){\r\n\t\t\t\t\t\tthis._cells[((y+yy)*nWidth+x-xx)*3+1]=xx;\r\n\t\t\t\t\t\tthis._check(xx > 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (y > 0){\r\n\t\t\t\tfor (xx=x;xx < (x+w);++xx){\r\n\t\t\t\t\ts=0;\r\n\t\t\t\t\tfor (yy=y-1;yy >=0;--yy,s++){\r\n\t\t\t\t\t\tif (this._cells[(xx+yy *nWidth)*3] !=0)break ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (yy=s;yy > 0;--yy){\r\n\t\t\t\t\t\tthis._cells[(xx+(y-yy)*nWidth)*3+2]=yy;\r\n\t\t\t\t\t\tthis._check(yy > 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._check=function(ret){\r\n\t\t\tif (ret==false){\r\n\t\t\t\tconsole.log(\"xtexMerger 错误啦\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._clear=function(){\r\n\t\t\tthis._texCount=0;\r\n\t\t\tfor (var y=0;y < this._height;y++){\r\n\t\t\t\tthis._rowInfo[y].spaceCount=this._width;\r\n\t\t\t}\r\n\t\t\tfor (var i=0;i < this._height;i++){\r\n\t\t\t\tfor (var j=0;j < this._width;j++){\r\n\t\t\t\t\tvar tm=(i *this._width+j)*3;\r\n\t\t\t\t\tthis._cells[tm]=0;\r\n\t\t\t\t\tthis._cells[tm+1]=this._width-j;\r\n\t\t\t\t\tthis._cells[tm+2]=this._width-i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._failSize.width=this._width+1;\r\n\t\t\tthis._failSize.height=this._height+1;\r\n\t\t}\r\n\r\n\t\tAtlasGrid.__init$=function(){\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t//class TexRowInfo\r\n\t\t\tTexRowInfo=(function(){\r\n\t\t\t\tfunction TexRowInfo(){\r\n\t\t\t\t\tthis.spaceCount=0;\r\n\t\t\t\t}\r\n\t\t\t\t__class(TexRowInfo,'');\r\n\t\t\t\treturn TexRowInfo;\r\n\t\t\t})()\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t//class TexMergeTexSize\r\n\t\t\tTexMergeTexSize=(function(){\r\n\t\t\t\tfunction TexMergeTexSize(){\r\n\t\t\t\t\tthis.width=0;\r\n\t\t\t\t\tthis.height=0;\r\n\t\t\t\t}\r\n\t\t\t\t__class(TexMergeTexSize,'');\r\n\t\t\t\treturn TexMergeTexSize;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn AtlasGrid;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasResourceManager\r\n\tvar AtlasResourceManager=(function(){\r\n\t\tfunction AtlasResourceManager(width,height,gridSize,maxTexNum){\r\n\t\t\tthis._currentAtlasCount=0;\r\n\t\t\tthis._maxAtlaserCount=0;\r\n\t\t\tthis._width=0;\r\n\t\t\tthis._height=0;\r\n\t\t\tthis._gridSize=0;\r\n\t\t\tthis._gridNumX=0;\r\n\t\t\tthis._gridNumY=0;\r\n\t\t\tthis._init=false;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t\tthis._setAtlasParam=false;\r\n\t\t\tthis._atlaserArray=null;\r\n\t\t\tthis._needGC=false;\r\n\t\t\tthis._setAtlasParam=true;\r\n\t\t\tthis._width=width;\r\n\t\t\tthis._height=height;\r\n\t\t\tthis._gridSize=gridSize;\r\n\t\t\tthis._maxAtlaserCount=maxTexNum;\r\n\t\t\tthis._gridNumX=width / gridSize;\r\n\t\t\tthis._gridNumY=height / gridSize;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t\tthis._atlaserArray=[];\r\n\t\t}\r\n\r\n\t\t__class(AtlasResourceManager,'laya.webgl.atlas.AtlasResourceManager');\r\n\t\tvar __proto=AtlasResourceManager.prototype;\r\n\t\t__proto.setAtlasParam=function(width,height,gridSize,maxTexNum){\r\n\t\t\tif (this._setAtlasParam==true){\r\n\t\t\t\tAtlasResourceManager._sid_=0;\r\n\t\t\t\tthis._width=width;\r\n\t\t\t\tthis._height=height;\r\n\t\t\t\tthis._gridSize=gridSize;\r\n\t\t\t\tthis._maxAtlaserCount=maxTexNum;\r\n\t\t\t\tthis._gridNumX=width / gridSize;\r\n\t\t\t\tthis._gridNumY=height / gridSize;\r\n\t\t\t\tthis._curAtlasIndex=0;\r\n\t\t\t\tthis.freeAll();\r\n\t\t\t\treturn true;\r\n\t\t\t\t}else {\r\n\t\t\t\tconsole.log(\"设置大图合集参数错误，只能在开始页面设置各种参数\");\r\n\t\t\t\tthrow-1;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t//添加 图片到大图集\r\n\t\t__proto.pushData=function(texture){\r\n\t\t\tvar tex=texture;\r\n\t\t\tthis._setAtlasParam=false;\r\n\t\t\tvar bFound=false;\r\n\t\t\tvar nImageGridX=(Math.ceil((texture.bitmap.width+2)/ this._gridSize));\r\n\t\t\tvar nImageGridY=(Math.ceil((texture.bitmap.height+2)/ this._gridSize));\r\n\t\t\tvar bSuccess=false;\r\n\t\t\tfor (var k=0;k < 2;k++){\r\n\t\t\t\tvar maxAtlaserCount=this._maxAtlaserCount;\r\n\t\t\t\tfor (var i=0;i < maxAtlaserCount;i++){\r\n\t\t\t\t\tvar altasIndex=(this._curAtlasIndex+i)% maxAtlaserCount;\r\n\t\t\t\t\t(this._atlaserArray.length-1>=altasIndex)|| (this._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++)));\r\n\t\t\t\t\tvar atlas=this._atlaserArray[altasIndex];\r\n\t\t\t\t\tvar bitmap=texture.bitmap;\r\n\t\t\t\t\tvar webGLImageIndex=atlas.inAtlasWebGLImagesKey.indexOf(bitmap);\r\n\t\t\t\t\tvar offsetX=0,offsetY=0;\r\n\t\t\t\t\tif (webGLImageIndex==-1){\r\n\t\t\t\t\t\tvar fillInfo=atlas.addTex(1,nImageGridX,nImageGridY);\r\n\t\t\t\t\t\tif (fillInfo.ret){\r\n\t\t\t\t\t\t\toffsetX=fillInfo.x *this._gridSize+1;\r\n\t\t\t\t\t\t\toffsetY=fillInfo.y *this._gridSize+1;\r\n\t\t\t\t\t\t\tbitmap.lock=true;\r\n\t\t\t\t\t\t\tatlas.addToAtlasTexture((bitmap),offsetX,offsetY);\r\n\t\t\t\t\t\t\tatlas.addToAtlas(texture,offsetX,offsetY);\r\n\t\t\t\t\t\t\tbSuccess=true;\r\n\t\t\t\t\t\t\tthis._curAtlasIndex=altasIndex;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvar offset=atlas.InAtlasWebGLImagesOffsetValue[webGLImageIndex];\r\n\t\t\t\t\t\toffsetX=offset[0];\r\n\t\t\t\t\t\toffsetY=offset[1];\r\n\t\t\t\t\t\tatlas.addToAtlas(texture,offsetX,offsetY);\r\n\t\t\t\t\t\tbSuccess=true;\r\n\t\t\t\t\t\tthis._curAtlasIndex=altasIndex;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (bSuccess)\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tthis._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++));\r\n\t\t\t\tthis._needGC=true;\r\n\t\t\t\tthis.garbageCollection();\r\n\t\t\t\tthis._curAtlasIndex=this._atlaserArray.length-1;\r\n\t\t\t}\r\n\t\t\tif (!bSuccess){\r\n\t\t\t\tconsole.log(\">>>AtlasManager pushData error\");\r\n\t\t\t}\r\n\t\t\treturn bSuccess;\r\n\t\t}\r\n\r\n\t\t__proto.addToAtlas=function(tex){\r\n\t\t\tlaya.webgl.atlas.AtlasResourceManager.instance.pushData(tex);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*回收大图合集,不建议手动调用\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.garbageCollection=function(){\r\n\t\t\tif (this._needGC===true){\r\n\t\t\t\tvar n=this._atlaserArray.length-this._maxAtlaserCount;\r\n\t\t\t\tfor (var i=0;i < n;i++)\r\n\t\t\t\tthis._atlaserArray[i].dispose();\r\n\t\t\t\tthis._atlaserArray.splice(0,n);\r\n\t\t\t\tthis._needGC=false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.freeAll=function(){\r\n\t\t\tfor (var i=0,n=this._atlaserArray.length;i < n;i++){\r\n\t\t\t\tthis._atlaserArray[i].dispose();\r\n\t\t\t}\r\n\t\t\tthis._atlaserArray.length=0;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t}\r\n\r\n\t\t__proto.getAtlaserCount=function(){\r\n\t\t\treturn this._atlaserArray.length;\r\n\t\t}\r\n\r\n\t\t__proto.getAtlaserByIndex=function(index){\r\n\t\t\treturn this._atlaserArray[index];\r\n\t\t}\r\n\r\n\t\t__getset(1,AtlasResourceManager,'instance',function(){\r\n\t\t\tif (!AtlasResourceManager._Instance){\r\n\t\t\t\tAtlasResourceManager._Instance=new AtlasResourceManager(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,/*CLASS CONST:laya.webgl.atlas.AtlasResourceManager.gridSize*/16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount);\r\n\t\t\t}\r\n\t\t\treturn AtlasResourceManager._Instance;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'enabled',function(){\r\n\t\t\treturn AtlasResourceManager._enabled;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'atlasLimitWidth',function(){\r\n\t\t\treturn AtlasResourceManager._atlasLimitWidth;\r\n\t\t\t},function(value){\r\n\t\t\tAtlasResourceManager._atlasLimitWidth=value;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'atlasLimitHeight',function(){\r\n\t\t\treturn AtlasResourceManager._atlasLimitHeight;\r\n\t\t\t},function(value){\r\n\t\t\tAtlasResourceManager._atlasLimitHeight=value;\r\n\t\t});\r\n\r\n\t\tAtlasResourceManager._enable=function(){\r\n\t\t\tAtlasResourceManager._enabled=true;\r\n\t\t\tConfig.atlasEnable=true;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager._disable=function(){\r\n\t\t\tAtlasResourceManager._enabled=false;\r\n\t\t\tConfig.atlasEnable=false;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager.__init__=function(){\r\n\t\t\tAtlasResourceManager.atlasTextureWidth=2048;\r\n\t\t\tAtlasResourceManager.atlasTextureHeight=2048;\r\n\t\t\tAtlasResourceManager.maxTextureCount=6;\r\n\t\t\tAtlasResourceManager.atlasLimitWidth=512;\r\n\t\t\tAtlasResourceManager.atlasLimitHeight=512;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager._enabled=false;\r\n\t\tAtlasResourceManager._atlasLimitWidth=0;\r\n\t\tAtlasResourceManager._atlasLimitHeight=0;\r\n\t\tAtlasResourceManager.gridSize=16;\r\n\t\tAtlasResourceManager.atlasTextureWidth=0;\r\n\t\tAtlasResourceManager.atlasTextureHeight=0;\r\n\t\tAtlasResourceManager.maxTextureCount=0;\r\n\t\tAtlasResourceManager._atlasRestore=0;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_NO=0;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_RIGHT=1;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_LEFT=2;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_BOTTOM=4;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_TOP=8;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_ALL=15;\r\n\t\tAtlasResourceManager._sid_=0;\r\n\t\tAtlasResourceManager._Instance=null;\r\n\t\treturn AtlasResourceManager;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.MergeFillInfo\r\n\tvar MergeFillInfo=(function(){\r\n\t\tfunction MergeFillInfo(){\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t\tthis.ret=false;\r\n\t\t\tthis.ret=false;\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t}\r\n\r\n\t\t__class(MergeFillInfo,'laya.webgl.atlas.MergeFillInfo');\r\n\t\treturn MergeFillInfo;\r\n\t})()\r\n\r\n\r\n\t;\r\n\t//class laya.webgl.canvas.BlendMode\r\n\tvar BlendMode=(function(){\r\n\t\tfunction BlendMode(){};\r\n\t\t__class(BlendMode,'laya.webgl.canvas.BlendMode');\r\n\t\tBlendMode._init_=function(gl){\r\n\t\t\tBlendMode.fns=[BlendMode.BlendNormal,BlendMode.BlendAdd,BlendMode.BlendMultiply,BlendMode.BlendScreen,BlendMode.BlendOverlay,BlendMode.BlendLight,BlendMode.BlendMask,BlendMode.BlendDestinationOut];\r\n\t\t\tBlendMode.targetFns=[BlendMode.BlendNormalTarget,BlendMode.BlendAddTarget,BlendMode.BlendMultiplyTarget,BlendMode.BlendScreenTarget,BlendMode.BlendOverlayTarget,BlendMode.BlendLightTarget,BlendMode.BlendMask,BlendMode.BlendDestinationOut];\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendNormal=function(gl){\r\n\t\t\tgl.blendFuncSeparate(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303,/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendAdd=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.DST_ALPHA*/0x0304);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMultiply=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.DST_COLOR*/0x0306,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendScreen=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendOverlay=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_COLOR*/0x0301);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendLight=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendNormalTarget=function(gl){\r\n\t\t\tgl.blendFuncSeparate(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303,/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendAddTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.DST_ALPHA*/0x0304);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMultiplyTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.DST_COLOR*/0x0306,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendScreenTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendOverlayTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_COLOR*/0x0301);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendLightTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMask=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ZERO*/0,/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendDestinationOut=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ZERO*/0,/*laya.webgl.WebGLContext.ZERO*/0);\r\n\t\t}\r\n\r\n\t\tBlendMode.activeBlendFunction=null;\r\n\t\tBlendMode.NAMES=[\"normal\",\"add\",\"multiply\",\"screen\",\"overlay\",\"light\",\"mask\",\"destination-out\"];\r\n\t\tBlendMode.TOINT={\"normal\":0,\"add\":1,\"multiply\":2,\"screen\":3 ,\"lighter\":1,\"overlay\":4,\"light\":5,\"mask\":6,\"destination-out\":7};\r\n\t\tBlendMode.NORMAL=\"normal\";\r\n\t\tBlendMode.ADD=\"add\";\r\n\t\tBlendMode.MULTIPLY=\"multiply\";\r\n\t\tBlendMode.SCREEN=\"screen\";\r\n\t\tBlendMode.LIGHT=\"light\";\r\n\t\tBlendMode.OVERLAY=\"overlay\";\r\n\t\tBlendMode.DESTINATIONOUT=\"destination-out\";\r\n\t\tBlendMode.fns=[];\r\n\t\tBlendMode.targetFns=[];\r\n\t\treturn BlendMode;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.DrawStyle\r\n\tvar DrawStyle=(function(){\r\n\t\tfunction DrawStyle(value){\r\n\t\t\tthis._color=Color.create(\"black\");\r\n\t\t\tthis.setValue(value);\r\n\t\t}\r\n\r\n\t\t__class(DrawStyle,'laya.webgl.canvas.DrawStyle');\r\n\t\tvar __proto=DrawStyle.prototype;\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tif ((typeof value=='string')){\r\n\t\t\t\t\tthis._color=Color.create(value);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ((value instanceof laya.utils.Color )){\r\n\t\t\t\t\tthis._color=value;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis._color=Color.create(\"black\");\r\n\t\t}\r\n\r\n\t\t__proto.equal=function(value){\r\n\t\t\tif ((typeof value=='string'))return this._color.strColor===value;\r\n\t\t\tif ((value instanceof laya.utils.Color ))return this._color.numColor===(value).numColor;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto.toColorStr=function(){\r\n\t\t\treturn this._color.strColor;\r\n\t\t}\r\n\r\n\t\tDrawStyle.create=function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tvar color;\r\n\t\t\t\tif ((typeof value=='string'))color=Color.create(value);\r\n\t\t\t\telse if ((value instanceof laya.utils.Color ))color=value;\r\n\t\t\t\tif (color){\r\n\t\t\t\t\treturn color._drawStyle || (color._drawStyle=new DrawStyle(value));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tDrawStyle.DEFAULT=new DrawStyle(\"#000000\");\r\n\t\treturn DrawStyle;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.Path\r\n\tvar Path=(function(){\r\n\t\tfunction Path(){\r\n\t\t\tthis._x=0;\r\n\t\t\tthis._y=0;\r\n\t\t\t//this._rect=null;\r\n\t\t\t//this.ib=null;\r\n\t\t\t//this.vb=null;\r\n\t\t\tthis.dirty=false;\r\n\t\t\t//this.geomatrys=null;\r\n\t\t\t//this._curGeomatry=null;\r\n\t\t\tthis.offset=0;\r\n\t\t\tthis.count=0;\r\n\t\t\tthis.geoStart=0;\r\n\t\t\tthis.tempArray=[];\r\n\t\t\tthis.closePath=false;\r\n\t\t\tthis.geomatrys=[];\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\tthis.vb=VertexBuffer2D.create(5);\r\n\t\t}\r\n\r\n\t\t__class(Path,'laya.webgl.canvas.Path');\r\n\t\tvar __proto=Path.prototype;\r\n\t\t__proto.addPoint=function(pointX,pointY){\r\n\t\t\tthis.tempArray.push(pointX,pointY);\r\n\t\t}\r\n\r\n\t\t__proto.getEndPointX=function(){\r\n\t\t\treturn this.tempArray[this.tempArray.length-2];\r\n\t\t}\r\n\r\n\t\t__proto.getEndPointY=function(){\r\n\t\t\treturn this.tempArray[this.tempArray.length-1];\r\n\t\t}\r\n\r\n\t\t__proto.polygon=function(x,y,points,color,borderWidth,borderColor){\r\n\t\t\tvar geo;\r\n\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new Polygon(x,y,points,color,borderWidth,borderColor));\r\n\t\t\tif (!color)geo.fill=false;\r\n\t\t\tif (borderColor==undefined)geo.borderWidth=0;\r\n\t\t\treturn geo;\r\n\t\t}\r\n\r\n\t\t__proto.setGeomtry=function(shape){\r\n\t\t\tthis.geomatrys.push(this._curGeomatry=shape);\r\n\t\t}\r\n\r\n\t\t__proto.drawLine=function(x,y,points,width,color){\r\n\t\t\tvar geo;\r\n\t\t\tif (this.closePath){\r\n\t\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new LoopLine(x,y,points,width,color));\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new Line(x,y,points,width,color));\r\n\t\t\t}\r\n\t\t\tgeo.fill=false;\r\n\t\t\treturn geo;\r\n\t\t}\r\n\r\n\t\t__proto.update=function(){\r\n\t\t\tvar si=this.ib.byteLength;\r\n\t\t\tvar len=this.geomatrys.length;\r\n\t\t\tthis.offset=si;\r\n\t\t\tfor (var i=this.geoStart;i < len;i++){\r\n\t\t\t\tthis.geomatrys[i].getData(this.ib,this.vb,this.vb.byteLength / 20);\r\n\t\t\t}\r\n\t\t\tthis.geoStart=len;\r\n\t\t\tthis.count=(this.ib.byteLength-si)/ CONST3D2D.BYTES_PIDX;\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis.vb.clear();\r\n\t\t\tthis.ib.clear();\r\n\t\t\tthis.offset=this.count=this.geoStart=0;\r\n\t\t\tthis.geomatrys.length=0;\r\n\t\t}\r\n\r\n\t\treturn Path;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveBase\r\n\tvar SaveBase=(function(){\r\n\t\tfunction SaveBase(){\r\n\t\t\t//this._valueName=null;\r\n\t\t\t//this._value=null;\r\n\t\t\t//this._dataObj=null;\r\n\t\t\t//this._newSubmit=false;\r\n\t\t}\r\n\r\n\t\t__class(SaveBase,'laya.webgl.canvas.save.SaveBase');\r\n\t\tvar __proto=SaveBase.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tthis._dataObj[this._valueName]=this._value;\r\n\t\t\tSaveBase._cache[SaveBase._cache._length++]=this;\r\n\t\t\tthis._newSubmit && (context._curSubmit=Submit.RENDERBASE,context._renderKey=0);\r\n\t\t}\r\n\r\n\t\tSaveBase._createArray=function(){\r\n\t\t\tvar value=[];\r\n\t\t\tvalue._length=0;\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tSaveBase._init=function(){\r\n\t\t\tvar namemap=SaveBase._namemap={};\r\n\t\t\tnamemap[0x1]=\"ALPHA\";\r\n\t\t\tnamemap[0x2]=\"fillStyle\";\r\n\t\t\tnamemap[0x8]=\"font\";\r\n\t\t\tnamemap[0x100]=\"lineWidth\";\r\n\t\t\tnamemap[0x200]=\"strokeStyle\";\r\n\t\t\tnamemap[0x2000]=\"_mergeID\";\r\n\t\t\tnamemap[0x400]=namemap[0x800]=namemap[0x1000]=[];\r\n\t\t\tnamemap[0x4000]=\"textBaseline\";\r\n\t\t\tnamemap[0x8000]=\"textAlign\";\r\n\t\t\tnamemap[0x10000]=\"_nBlendType\";\r\n\t\t\tnamemap[0x80000]=\"shader\";\r\n\t\t\tnamemap[0x100000]=\"filters\";\r\n\t\t\treturn namemap;\r\n\t\t}\r\n\r\n\t\tSaveBase.save=function(context,type,dataObj,newSubmit){\r\n\t\t\tif ((context._saveMark._saveuse & type)!==type){\r\n\t\t\t\tcontext._saveMark._saveuse |=type;\r\n\t\t\t\tvar cache=SaveBase._cache;\r\n\t\t\t\tvar o=cache._length > 0 ? cache[--cache._length] :(new SaveBase());\r\n\t\t\t\to._value=dataObj[o._valueName=SaveBase._namemap[type]];\r\n\t\t\t\to._dataObj=dataObj;\r\n\t\t\t\to._newSubmit=newSubmit;\r\n\t\t\t\tvar _save=context._save;\r\n\t\t\t\t_save[_save._length++]=o;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSaveBase._cache=laya.webgl.canvas.save.SaveBase._createArray();\r\n\t\tSaveBase._namemap=SaveBase._init();\r\n\t\treturn SaveBase;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveClipRect\r\n\tvar SaveClipRect=(function(){\r\n\t\tfunction SaveClipRect(){\r\n\t\t\t//this._clipSaveRect=null;\r\n\t\t\t//this._submitScissor=null;\r\n\t\t\tthis._clipRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(SaveClipRect,'laya.webgl.canvas.save.SaveClipRect');\r\n\t\tvar __proto=SaveClipRect.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._clipRect=this._clipSaveRect;\r\n\t\t\tSaveClipRect._cache[SaveClipRect._cache._length++]=this;\r\n\t\t\tthis._submitScissor.submitLength=context._submits._length-this._submitScissor.submitIndex;\r\n\t\t\tcontext._curSubmit=Submit.RENDERBASE;\r\n\t\t\tcontext._renderKey=0;\r\n\t\t}\r\n\r\n\t\tSaveClipRect.save=function(context,submitScissor){\r\n\t\t\tif ((context._saveMark._saveuse & /*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000)==/*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000)return;\r\n\t\t\tcontext._saveMark._saveuse |=/*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000;\r\n\t\t\tvar cache=SaveClipRect._cache;\r\n\t\t\tvar o=cache._length > 0 ? cache[--cache._length] :(new SaveClipRect());\r\n\t\t\to._clipSaveRect=context._clipRect;\r\n\t\t\tcontext._clipRect=o._clipRect.copyFrom(context._clipRect);\r\n\t\t\to._submitScissor=submitScissor;\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveClipRect._cache=SaveBase._createArray();\r\n\t\treturn SaveClipRect;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveMark\r\n\tvar SaveMark=(function(){\r\n\t\tfunction SaveMark(){\r\n\t\t\tthis._saveuse=0;\r\n\t\t\t//this._preSaveMark=null;\r\n\t\t\t;\r\n\t\t}\r\n\r\n\t\t__class(SaveMark,'laya.webgl.canvas.save.SaveMark');\r\n\t\tvar __proto=SaveMark.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._saveMark=this._preSaveMark;\r\n\t\t\tSaveMark._no[SaveMark._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveMark.Create=function(context){\r\n\t\t\tvar no=SaveMark._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveMark());\r\n\t\t\to._saveuse=0;\r\n\t\t\to._preSaveMark=context._saveMark;\r\n\t\t\tcontext._saveMark=o;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSaveMark._no=SaveBase._createArray();\r\n\t\treturn SaveMark;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveTransform\r\n\tvar SaveTransform=(function(){\r\n\t\tfunction SaveTransform(){\r\n\t\t\t//this._savematrix=null;\r\n\t\t\tthis._matrix=new Matrix();\r\n\t\t}\r\n\r\n\t\t__class(SaveTransform,'laya.webgl.canvas.save.SaveTransform');\r\n\t\tvar __proto=SaveTransform.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._curMat=this._savematrix;\r\n\t\t\tSaveTransform._no[SaveTransform._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveTransform.save=function(context){\r\n\t\t\tvar _saveMark=context._saveMark;\r\n\t\t\tif ((_saveMark._saveuse & /*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800)===/*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800)return;\r\n\t\t\t_saveMark._saveuse |=/*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800;\r\n\t\t\tvar no=SaveTransform._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveTransform());\r\n\t\t\to._savematrix=context._curMat;\r\n\t\t\tcontext._curMat=context._curMat.copyTo(o._matrix);\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveTransform._no=SaveBase._createArray();\r\n\t\treturn SaveTransform;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveTranslate\r\n\tvar SaveTranslate=(function(){\r\n\t\tfunction SaveTranslate(){\r\n\t\t\t//this._x=NaN;\r\n\t\t\t//this._y=NaN;\r\n\t\t}\r\n\r\n\t\t__class(SaveTranslate,'laya.webgl.canvas.save.SaveTranslate');\r\n\t\tvar __proto=SaveTranslate.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tvar mat=context._curMat;\r\n\t\t\tcontext._x=this._x;\r\n\t\t\tcontext._y=this._y;\r\n\t\t\tSaveTranslate._no[SaveTranslate._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveTranslate.save=function(context){\r\n\t\t\tvar no=SaveTranslate._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveTranslate());\r\n\t\t\to._x=context._x;\r\n\t\t\to._y=context._y;\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveTranslate._no=SaveBase._createArray();\r\n\t\treturn SaveTranslate;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.resource.RenderTargetMAX\r\n\tvar RenderTargetMAX=(function(){\r\n\t\tvar OneTarget;\r\n\t\tfunction RenderTargetMAX(){\r\n\t\t\tthis.targets=null;\r\n\t\t\tthis.oneTargets=null;\r\n\t\t\tthis.repaint=false;\r\n\t\t\tthis._width=NaN;\r\n\t\t\tthis._height=NaN;\r\n\t\t\tthis._clipRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(RenderTargetMAX,'laya.webgl.resource.RenderTargetMAX');\r\n\t\tvar __proto=RenderTargetMAX.prototype;\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tif (this._width===w && this._height===h)return;\r\n\t\t\tthis.repaint=true;\r\n\t\t\tthis._width=w;\r\n\t\t\tthis._height=h;\r\n\t\t\tif (!this.oneTargets)\r\n\t\t\t\tthis.oneTargets=new OneTarget(w,h);\r\n\t\t\telse\r\n\t\t\tthis.oneTargets.target.size(w,h);\r\n\t\t}\r\n\r\n\t\t__proto._flushToTarget=function(context,target){\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tvar preworldClipRect=RenderState2D.worldClipRect;\r\n\t\t\tRenderState2D.worldClipRect=this._clipRect;\r\n\t\t\tthis._clipRect.x=this._clipRect.y=0;\r\n\t\t\tthis._clipRect.width=this._width;\r\n\t\t\tthis._clipRect.height=this._height;\r\n\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tvar preAlpha=RenderState2D.worldAlpha;\r\n\t\t\tvar preMatrix4=RenderState2D.worldMatrix4;\r\n\t\t\tvar preMatrix=RenderState2D.worldMatrix;\r\n\t\t\tvar preFilters=RenderState2D.worldFilters;\r\n\t\t\tvar preShaderDefines=RenderState2D.worldShaderDefines;\r\n\t\t\tRenderState2D.worldMatrix=RenderTargetMAX._matrixDefault;\r\n\t\t\tRenderState2D.restoreTempArray();\r\n\t\t\tRenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;\r\n\t\t\tRenderState2D.worldAlpha=1;\r\n\t\t\tRenderState2D.worldFilters=null;\r\n\t\t\tRenderState2D.worldShaderDefines=null;\r\n\t\t\tShader.activeShader=null;\r\n\t\t\ttarget.start();\r\n\t\t\tConfig.showCanvasMark ? target.clear(0,1,0,0.3):target.clear(0,0,0,0);\r\n\t\t\tcontext.flush();\r\n\t\t\ttarget.end();\r\n\t\t\tShader.activeShader=null;\r\n\t\t\tRenderState2D.worldAlpha=preAlpha;\r\n\t\t\tRenderState2D.worldMatrix4=preMatrix4;\r\n\t\t\tRenderState2D.worldMatrix=preMatrix;\r\n\t\t\tRenderState2D.worldFilters=preFilters;\r\n\t\t\tRenderState2D.worldShaderDefines=preShaderDefines;\r\n\t\t\tRenderState2D.worldScissorTest=worldScissorTest\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\tvar y=RenderState2D.height-preworldClipRect.y-preworldClipRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(preworldClipRect.x,y,preworldClipRect.width,preworldClipRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\tRenderState2D.worldClipRect=preworldClipRect;\r\n\t\t}\r\n\r\n\t\t__proto.flush=function(context){\r\n\t\t\tif (this.repaint){\r\n\t\t\t\tthis._flushToTarget(context,this.oneTargets.target);\r\n\t\t\t\tthis.repaint=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTo=function(context,x,y,width,height){\r\n\t\t\tcontext.drawTexture(this.oneTargets.target.getTexture(),x,y,width,height,0,0);\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tif (this.oneTargets){\r\n\t\t\t\tthis.oneTargets.target.destroy();\r\n\t\t\t\tthis.oneTargets.target=null;\r\n\t\t\t\tthis.oneTargets=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__static(RenderTargetMAX,\r\n\t\t['_matrixDefault',function(){return this._matrixDefault=new Matrix();}\r\n\t\t]);\r\n\t\tRenderTargetMAX.__init$=function(){\r\n\t\t\t//class OneTarget\r\n\t\t\tOneTarget=(function(){\r\n\t\t\t\tfunction OneTarget(w,h){\r\n\t\t\t\t\t//this.x=NaN;\r\n\t\t\t\t\t//this.width=NaN;\r\n\t\t\t\t\t//this.height=NaN;\r\n\t\t\t\t\t//this.target=null;\r\n\t\t\t\t\tthis.width=w;\r\n\t\t\t\t\tthis.height=h;\r\n\t\t\t\t\tthis.target=RenderTarget2D.create(w,h);\r\n\t\t\t\t}\r\n\t\t\t\t__class(OneTarget,'');\r\n\t\t\t\treturn OneTarget;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn RenderTargetMAX;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.d2.Shader2D\r\n\tvar Shader2D=(function(){\r\n\t\tfunction Shader2D(){\r\n\t\t\tthis.ALPHA=1;\r\n\t\t\t//this.glTexture=null;\r\n\t\t\t//this.shader=null;\r\n\t\t\t//this.filters=null;\r\n\t\t\tthis.shaderType=0;\r\n\t\t\t//this.colorAdd=null;\r\n\t\t\t//this.strokeStyle=null;\r\n\t\t\t//this.fillStyle=null;\r\n\t\t\tthis.defines=new ShaderDefines2D();\r\n\t\t}\r\n\r\n\t\t__class(Shader2D,'laya.webgl.shader.d2.Shader2D');\r\n\t\tShader2D.__init__=function(){\r\n\t\t\tShader.addInclude(\"parts/ColorFilter_ps_uniform.glsl\",\"uniform vec4 colorAlpha;\\nuniform mat4 colorMat;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorFilter_ps_logic.glsl\",\"gl_FragColor = gl_FragColor * colorMat + colorAlpha/255.0;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/GlowFilter_ps_uniform.glsl\",\"uniform vec4 u_color;\\nuniform float u_strength;\\nuniform float u_blurX;\\nuniform float u_blurY;\\nuniform float u_offsetX;\\nuniform float u_offsetY;\\nuniform float u_textW;\\nuniform float u_textH;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/GlowFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/GlowFilter_ps_logic.glsl\",\"const float c_IterationTime = 10.0;\\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\\nfloat maxNum = u_blurX * u_blurY;\\nvec2 vec2Off = vec2(0.0,0.0);\\nfloat floatOff = c_IterationTime/2.0;\\nfor(float i = 0.0;i<=c_IterationTime; ++i){\\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\\n\t\tvec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\\n\t}\\n}\\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/GlowFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_ps_logic.glsl\",\"gl_FragColor=vec4(0.0);\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 0])*0.004431848411938341;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 1])*0.05399096651318985;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 2])*0.2419707245191454;\\ngl_FragColor += texture2D(texture, v_texcoord        )*0.3989422804014327;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 3])*0.2419707245191454;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 4])*0.05399096651318985;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 5])*0.004431848411938341;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_ps_uniform.glsl\",\"varying vec2 vBlurTexCoords[6];\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_vs_uniform.glsl\",\"uniform float strength;\\nvarying vec2 vBlurTexCoords[6];\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_vs_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_vs_logic.glsl\",\"\\nvBlurTexCoords[ 0] = v_texcoord + vec2(-0.012 * strength, 0.0);\\nvBlurTexCoords[ 1] = v_texcoord + vec2(-0.008 * strength, 0.0);\\nvBlurTexCoords[ 2] = v_texcoord + vec2(-0.004 * strength, 0.0);\\nvBlurTexCoords[ 3] = v_texcoord + vec2( 0.004 * strength, 0.0);\\nvBlurTexCoords[ 4] = v_texcoord + vec2( 0.008 * strength, 0.0);\\nvBlurTexCoords[ 5] = v_texcoord + vec2( 0.012 * strength, 0.0);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_vs_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorAdd_ps_uniform.glsl\",\"uniform vec4 colorAdd;\\n\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorAdd_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorAdd_ps_logic.glsl\",\"gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorAdd_ps_logic.glsl*/);\r\n\t\t\tvar vs,ps;\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec2 texcoord;\\nuniform vec2 size;\\n\\n#ifdef WORLDMAT\\nuniform mat4 mmat;\\n#endif\\nvarying vec2 v_texcoord;\\n\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_vs_uniform.glsl\\\";\\nvoid main() {\\n  #ifdef WORLDMAT\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  #else\\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\\n  #endif\\n  \\n  v_texcoord = texcoord;\\n  #include?BLUR_FILTER  \\\"parts/BlurFilter_vs_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/texture.vs*/;\r\n\t\t\tps=\"precision mediump float;\\n//precision highp float;\\nvarying vec2 v_texcoord;\\nuniform sampler2D texture;\\nuniform float alpha;\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_ps_uniform.glsl\\\";\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\n#include?GLOW_FILTER \\\"parts/GlowFilter_ps_uniform.glsl\\\";\\n#include?COLOR_ADD \\\"parts/ColorAdd_ps_uniform.glsl\\\";\\n\\nvoid main() {\\n   vec4 color= texture2D(texture, v_texcoord);\\n   color.a*=alpha;\\n   gl_FragColor=color;\\n   #include?COLOR_ADD \\\"parts/ColorAdd_ps_logic.glsl\\\";   \\n   #include?BLUR_FILTER  \\\"parts/BlurFilter_ps_logic.glsl\\\";\\n   #include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n   #include?GLOW_FILTER \\\"parts/GlowFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/texture.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nuniform vec2 size;\\nuniform mat4 mmat;\\nvoid main() {\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/line.vs*/;\r\n\t\t\tps=\"precision mediump float;\\nuniform vec4 color;\\nuniform float alpha;\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\nvoid main() {\\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\\n\ta.w = alpha;\\n\tgl_FragColor = a;\\n\t#include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/line.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec3 a_color;\\nuniform mat4 mmat;\\nuniform mat4 u_mmat2;\\nuniform vec2 u_pos;\\nuniform vec2 size;\\nvarying vec3 color;\\nvoid main(){\\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\\n  vec4 pos=mmat*u_mmat2*tPos;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  color=a_color;\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/primitive.vs*/;\r\n\t\t\tps=\"precision mediump float;\\n//precision mediump float;\\nvarying vec3 color;\\nuniform float alpha;\\nvoid main(){\\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\\n\t//a.a*=alpha;\\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/primitive.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec2 texcoord;\\nuniform vec2 size;\\n\\n#ifdef WORLDMAT\\nuniform mat4 mmat;\\n#endif\\nvarying vec2 v_texcoord;\\n\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_vs_uniform.glsl\\\";\\nvoid main() {\\n  #ifdef WORLDMAT\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  #else\\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\\n  #endif\\n  \\n  v_texcoord = texcoord;\\n  #include?BLUR_FILTER  \\\"parts/BlurFilter_vs_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/texture.vs*/;\r\n\t\t\tps=\"precision mediump float;\\n//precision highp float;\\nvarying vec2 v_texcoord;\\nuniform sampler2D texture;\\nuniform float alpha;\\nuniform vec4 u_TexRange;\\nuniform vec2 u_offset;\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_ps_uniform.glsl\\\";\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\n#include?GLOW_FILTER \\\"parts/GlowFilter_ps_uniform.glsl\\\";\\n#include?COLOR_ADD \\\"parts/ColorAdd_ps_uniform.glsl\\\";\\n\\nvoid main() {\\n   vec2 newTexCoord;\\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\\n   vec4 color= texture2D(texture, newTexCoord);\\n   color.a*=alpha;\\n   gl_FragColor=color;\\n   #include?COLOR_ADD \\\"parts/ColorAdd_ps_logic.glsl\\\";   \\n   #include?BLUR_FILTER  \\\"parts/BlurFilter_ps_logic.glsl\\\";\\n   #include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n   #include?GLOW_FILTER \\\"parts/GlowFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/files/fillTextureShader.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,vs,ps,null);\r\n\t\t\tvs=\"attribute vec2 position;\\nattribute vec2 texcoord;\\nattribute vec4 color;\\nuniform vec2 size;\\nuniform float offsetX;\\nuniform float offsetY;\\nuniform mat4 mmat;\\nuniform mat4 u_mmat2;\\nvarying vec2 v_texcoord;\\nvarying vec4 v_color;\\nvoid main() {\\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  v_color = color;\\n  v_texcoord = texcoord;  \\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/skinAnishader/skinShader.vs*/;\r\n\t\t\tps=\"precision mediump float;\\nvarying vec2 v_texcoord;\\nvarying vec4 v_color;\\nuniform sampler2D texture;\\nuniform float alpha;\\nvoid main() {\\n\tvec4 t_color = texture2D(texture, v_texcoord);\\n\tgl_FragColor = t_color.rgba * v_color;\\n\tgl_FragColor.a = gl_FragColor.a * alpha;\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/src/webGL/src/laya/webgl/shader/d2/skinAnishader/skinShader.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,vs,ps,null);\r\n\t\t}\r\n\r\n\t\treturn Shader2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.ShaderDefines\r\n\tvar ShaderDefines=(function(){\r\n\t\tfunction ShaderDefines(name2int,int2name,int2nameMap){\r\n\t\t\tthis._value=0;\r\n\t\t\t//this._name2int=null;\r\n\t\t\t//this._int2name=null;\r\n\t\t\t//this._int2nameMap=null;\r\n\t\t\tthis._name2int=name2int;\r\n\t\t\tthis._int2name=int2name;\r\n\t\t\tthis._int2nameMap=int2nameMap;\r\n\t\t}\r\n\r\n\t\t__class(ShaderDefines,'laya.webgl.shader.ShaderDefines');\r\n\t\tvar __proto=ShaderDefines.prototype;\r\n\t\t__proto.add=function(value){\r\n\t\t\tif ((typeof value=='string'))value=this._name2int[value];\r\n\t\t\tthis._value |=value;\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.addInt=function(value){\r\n\t\t\tthis._value |=value;\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.remove=function(value){\r\n\t\t\tif ((typeof value=='string'))value=this._name2int[value];\r\n\t\t\tthis._value &=(~value);\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.isDefine=function(def){\r\n\t\t\treturn (this._value & def)===def;\r\n\t\t}\r\n\r\n\t\t__proto.getValue=function(){\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tthis._value=value;\r\n\t\t}\r\n\r\n\t\t__proto.toNameDic=function(){\r\n\t\t\tvar r=this._int2nameMap[this._value];\r\n\t\t\treturn r ? r :ShaderDefines._toText(this._value,this._int2name,this._int2nameMap);\r\n\t\t}\r\n\r\n\t\tShaderDefines._reg=function(name,value,_name2int,_int2name){\r\n\t\t\t_name2int[name]=value;\r\n\t\t\t_int2name[value]=name;\r\n\t\t}\r\n\r\n\t\tShaderDefines._toText=function(value,_int2name,_int2nameMap){\r\n\t\t\tvar r=_int2nameMap[value];\r\n\t\t\tif (r)return r;\r\n\t\t\tvar o={};\r\n\t\t\tvar d=1;\r\n\t\t\tfor (var i=0;i < 32;i++){\r\n\t\t\t\td=1 << i;\r\n\t\t\t\tif (d > value)break ;\r\n\t\t\t\tif (value & d){\r\n\t\t\t\t\tvar name=_int2name[d];\r\n\t\t\t\t\tname && (o[name]=\"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_int2nameMap[value]=o;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tShaderDefines._toInt=function(names,_name2int){\r\n\t\t\tvar words=names.split('.');\r\n\t\t\tvar num=0;\r\n\t\t\tfor (var i=0,n=words.length;i < n;i++){\r\n\t\t\t\tvar value=_name2int[words[i]];\r\n\t\t\t\tif (!value)throw new Error(\"Defines to int err:\"+names+\"/\"+words[i]);\r\n\t\t\t\tnum |=value;\r\n\t\t\t}\r\n\t\t\treturn num;\r\n\t\t}\r\n\r\n\t\treturn ShaderDefines;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*这里销毁的问题，后面待确认\r\n\t*/\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinMesh\r\n\tvar SkinMesh=(function(){\r\n\t\tfunction SkinMesh(){\r\n\t\t\tthis.mVBBuffer=null;\r\n\t\t\tthis.mIBBuffer=null;\r\n\t\t\tthis.mVBData=null;\r\n\t\t\tthis.mIBData=null;\r\n\t\t\tthis.mEleNum=0;\r\n\t\t\tthis.mTexture=null;\r\n\t\t\tthis.transform=null;\r\n\t\t\tthis._vs=null;\r\n\t\t\tthis._ps=null;\r\n\t\t\tthis._resultPs=null;\r\n\t\t\tthis._start=-1;\r\n\t\t\tthis._indexStart=-1;\r\n\t\t\tthis._tempMatrix=new Matrix();\r\n\t\t}\r\n\r\n\t\t__class(SkinMesh,'laya.webgl.shader.d2.skinAnishader.SkinMesh');\r\n\t\tvar __proto=SkinMesh.prototype;\r\n\t\t__proto.init=function(texture,vs,ps){\r\n\t\t\tif (vs){\r\n\t\t\t\tthis._vs=vs;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._vs=[];\r\n\t\t\t\tvar tWidth=texture.width;\r\n\t\t\t\tvar tHeight=texture.height;\r\n\t\t\t\tvar tRed=1;\r\n\t\t\t\tvar tGreed=1;\r\n\t\t\t\tvar tBlue=1;\r\n\t\t\t\tvar tAlpha=1;\r\n\t\t\t\tthis._vs.push(0,0,0,0,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(tWidth,0,1,0,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(tWidth,tHeight,1,1,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(0,tHeight,0,1,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t}\r\n\t\t\tif (ps){\r\n\t\t\t\tthis._ps=ps;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ps=[];\r\n\t\t\t\tthis._ps.push(0,1,3,3,1,2);\r\n\t\t\t}\r\n\t\t\tthis.mVBData=new Float32Array(this._vs);\r\n\t\t\tthis.mEleNum=this._ps.length;\r\n\t\t\tthis.mTexture=texture;\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(vb,ib,start){\r\n\t\t\tthis.mVBBuffer=vb;\r\n\t\t\tthis.mIBBuffer=ib;\r\n\t\t\tvb.append(this.mVBData);\r\n\t\t\tthis._start=start;\r\n\t\t\tthis._indexStart=ib.byteLength;\r\n\t\t\tif (this._resultPs==null)this._resultPs=[];\r\n\t\t\tthis._resultPs.length=0;\r\n\t\t\tfor (var i=0,n=this._ps.length;i < n;i++){\r\n\t\t\t\tthis._resultPs.push(this._ps[i]+start);\r\n\t\t\t}\r\n\t\t\tthis.mIBData=new Uint16Array(this._resultPs);\r\n\t\t\tib.append(this.mIBData);\r\n\t\t}\r\n\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tif (Render.isWebGL && this.mTexture){\r\n\t\t\t\tcontext._renderKey=0;\r\n\t\t\t\tcontext._shader2D.glTexture=null;\r\n\t\t\t\tSkinMeshBuffer.getInstance().addSkinMesh(this);\r\n\t\t\t\tvar tempSubmit=Submit.createShape(context,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,0));\r\n\t\t\t\tthis.transform || (this.transform=Matrix.EMPTY);\r\n\t\t\t\tthis.transform.translate(x,y);\r\n\t\t\t\tMatrix.mul(this.transform,context._curMat,this._tempMatrix);\r\n\t\t\t\tthis.transform.translate(-x,-y);\r\n\t\t\t\tvar tArray=RenderState2D.getMatrArray();\r\n\t\t\t\tRenderState2D.mat2MatArray(this._tempMatrix,tArray);\r\n\t\t\t\tvar tShaderValue=tempSubmit.shaderValue;\r\n\t\t\t\ttShaderValue.textureHost=this.mTexture;\r\n\t\t\t\ttShaderValue.offsetX=0;\r\n\t\t\t\ttShaderValue.offsetY=0;\r\n\t\t\t\ttShaderValue.u_mmat2=tArray;\r\n\t\t\t\ttShaderValue.ALPHA=context._shader2D.ALPHA;\r\n\t\t\t\tcontext._submits[context._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t\telse if (Render.isConchApp&&this.mTexture){\r\n\t\t\t\tthis.transform || (this.transform=Matrix.EMPTY);\r\n\t\t\t\tcontext.setSkinMesh&&context.setSkinMesh(x,y,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn SkinMesh;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer\r\n\tvar SkinMeshBuffer=(function(){\r\n\t\tfunction SkinMeshBuffer(){\r\n\t\t\tthis.ib=null;\r\n\t\t\tthis.vb=null;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\tthis.vb=VertexBuffer2D.create(8);\r\n\t\t}\r\n\r\n\t\t__class(SkinMeshBuffer,'laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer');\r\n\t\tvar __proto=SkinMeshBuffer.prototype;\r\n\t\t__proto.addSkinMesh=function(skinMesh){\r\n\t\t\tskinMesh.getData(this.vb,this.ib,this.vb.byteLength / 32);\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis.vb.clear();\r\n\t\t\tthis.ib.clear();\r\n\t\t}\r\n\r\n\t\tSkinMeshBuffer.getInstance=function(){\r\n\t\t\treturn SkinMeshBuffer.instance=SkinMeshBuffer.instance|| new SkinMeshBuffer();\r\n\t\t}\r\n\r\n\t\tSkinMeshBuffer.instance=null\r\n\t\treturn SkinMeshBuffer;\r\n\t})()\r\n\r\n\r\n\t//此类可以减少代码\r\n\t//class laya.webgl.shapes.BasePoly\r\n\tvar BasePoly=(function(){\r\n\t\tfunction BasePoly(x,y,width,height,edges,color,borderWidth,borderColor,round){\r\n\t\t\t//this.x=NaN;\r\n\t\t\t//this.y=NaN;\r\n\t\t\t//this.r=NaN;\r\n\t\t\t//this.width=NaN;\r\n\t\t\t//this.height=NaN;\r\n\t\t\t//this.edges=NaN;\r\n\t\t\tthis.r0=0\r\n\t\t\t//this.color=0;\r\n\t\t\t//this.borderColor=NaN;\r\n\t\t\t//this.borderWidth=NaN;\r\n\t\t\t//this.round=0;\r\n\t\t\tthis.fill=true;\r\n\t\t\tthis.r1=Math.PI / 2;\r\n\t\t\t(round===void 0)&& (round=0);\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t\tthis.width=width;\r\n\t\t\tthis.height=height;\r\n\t\t\tthis.edges=edges;\r\n\t\t\tthis.color=color;\r\n\t\t\tthis.borderWidth=borderWidth;\r\n\t\t\tthis.borderColor=borderColor;\r\n\t\t}\r\n\r\n\t\t__class(BasePoly,'laya.webgl.shapes.BasePoly');\r\n\t\tvar __proto=BasePoly.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.shapes.IShape\":true})\r\n\t\t__proto.getData=function(ib,vb,start){}\r\n\t\t__proto.sector=function(outVert,outIndex,start){\r\n\t\t\tvar x=this.x,y=this.y,edges=this.edges,seg=(this.r1-this.r0)/ edges;\r\n\t\t\tvar w=this.width,h=this.height,color=this.color;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\toutVert.push(x,y,r,g,b);\r\n\t\t\tfor (var i=0;i < edges+1;i++){\r\n\t\t\t\toutVert.push(x+Math.sin(seg *i+this.r0)*w,y+Math.cos(seg *i+this.r0)*h);\r\n\t\t\t\toutVert.push(r,g,b);\r\n\t\t\t}\r\n\t\t\tfor (i=0;i < edges;i++){\r\n\t\t\t\toutIndex.push(start,start+i+1,start+i+2);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//用于画线\r\n\t\t__proto.createLine2=function(p,indices,lineWidth,len,outVertex,indexCount){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tvar length=points.length / 2;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[2];\r\n\t\t\tp2y=points[3];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx+this.x,p1y-perpy+this.y,r,g,b,p1x+perpx+this.x,p1y+perpy+this.y,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*2];\r\n\t\t\t\tp1y=points[(i-1)*2+1];\r\n\t\t\t\tp2x=points[(i)*2];\r\n\t\t\t\tp2y=points[(i)*2+1];\r\n\t\t\t\tp3x=points[(i+1)*2];\r\n\t\t\t\tp3y=points[(i+1)*2+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px+this.x,py+this.y,r,g,b,p2x-(px-p2x)+this.x,p2y-(py-p2y)+this.y,r,g,b);\r\n\t\t\t}\r\n\t\t\tp1x=points[points.length-4];\r\n\t\t\tp1y=points[points.length-3];\r\n\t\t\tp2x=points[points.length-2];\r\n\t\t\tp2y=points[points.length-1];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);\r\n\t\t\tvar groupLen=indexCount;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//用于比如 扇形 不带两直线\r\n\t\t__proto.createLine=function(p,indices,lineWidth,len){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tpoints.splice(0,5);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tp1x=points[points.length-10];\r\n\t\t\tp1y=points[points.length-9];\r\n\t\t\tp2x=points[points.length-5];\r\n\t\t\tp2y=points[points.length-4];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//闭合路径\r\n\t\t__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex ? outVertex :p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tpoints.splice(0,5);\r\n\t\t\tvar firstPoint=[points[0],points[1]];\r\n\t\t\tvar lastPoint=[points[points.length-5],points[points.length-4]];\r\n\t\t\tvar midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;\r\n\t\t\tvar midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;\r\n\t\t\tpoints.unshift(midPointX,midPointY,0,0,0);\r\n\t\t\tpoints.push(midPointX,midPointY,0,0,0);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tif (outIndex){\r\n\t\t\t\tindices=outIndex;\r\n\t\t\t};\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\treturn BasePoly;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shapes.GeometryData\r\n\tvar GeometryData=(function(){\r\n\t\tfunction GeometryData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,shape){\r\n\t\t\t//this.lineWidth=NaN;\r\n\t\t\t//this.lineColor=NaN;\r\n\t\t\t//this.lineAlpha=NaN;\r\n\t\t\t//this.fillColor=NaN;\r\n\t\t\t//this.fillAlpha=NaN;\r\n\t\t\t//this.shape=null;\r\n\t\t\t//this.fill=false;\r\n\t\t\tthis.lineWidth=lineWidth;\r\n\t\t\tthis.lineColor=lineColor;\r\n\t\t\tthis.lineAlpha=lineAlpha;\r\n\t\t\tthis.fillColor=fillColor;\r\n\t\t\tthis.fillAlpha=fillAlpha;\r\n\t\t\tthis.shape=shape;\r\n\t\t\tthis.fill=fill;\r\n\t\t}\r\n\r\n\t\t__class(GeometryData,'laya.webgl.shapes.GeometryData');\r\n\t\tvar __proto=GeometryData.prototype;\r\n\t\t__proto.clone=function(){\r\n\t\t\treturn new GeometryData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape);\r\n\t\t}\r\n\r\n\t\t__proto.getIndexData=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.getVertexData=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis.shape=null;\r\n\t\t}\r\n\r\n\t\treturn GeometryData;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shapes.Vertex\r\n\tvar Vertex=(function(){\r\n\t\tfunction Vertex(p){\r\n\t\t\t//this.points=null;\r\n\t\t\tif((p instanceof Float32Array))\r\n\t\t\t\tthis.points=p;\r\n\t\t\telse if((p instanceof Array)){\r\n\t\t\t\tvar len=p.length;\r\n\t\t\t\tthis.points=new Float32Array(p);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(Vertex,'laya.webgl.shapes.Vertex');\r\n\t\tvar __proto=Vertex.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.shapes.IShape\":true})\r\n\t\t__proto.getData=function(ib,vb,start){}\r\n\t\treturn Vertex;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.Submit\r\n\tvar Submit=(function(){\r\n\t\tfunction Submit(renderType){\r\n\t\t\t//this._selfVb=null;\r\n\t\t\t//this._ib=null;\r\n\t\t\t//this._blendFn=null;\r\n\t\t\t//this._renderType=0;\r\n\t\t\t//this._vb=null;\r\n\t\t\t//this._startIdx=0;\r\n\t\t\t//this._numEle=0;\r\n\t\t\t//this.shaderValue=null;\r\n\t\t\t(renderType===void 0)&& (renderType=10000);\r\n\t\t\tthis._renderType=renderType;\r\n\t\t}\r\n\r\n\t\t__class(Submit,'laya.webgl.submit.Submit');\r\n\t\tvar __proto=Submit.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=Submit._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.shaderValue.release();\r\n\t\t\tthis._vb=null;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn this._renderType;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._numEle===0)return 1;\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tthis.shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.shaderValue.upload();\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmit.__init__=function(){\r\n\t\t\tvar s=Submit.RENDERBASE=new Submit(-1);\r\n\t\t\ts.shaderValue=new Value2D(0,0);\r\n\t\t\ts.shaderValue.ALPHA=-1234;\r\n\t\t}\r\n\r\n\t\tSubmit.create=function(context,ib,vb,pos,sv){\r\n\t\t\tvar o=Submit._cache._length ? Submit._cache[--Submit._cache._length] :new Submit();\r\n\t\t\tif (vb==null){\r\n\t\t\t\tvb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));\r\n\t\t\t\tvb.clear();\r\n\t\t\t\tpos=0;\r\n\t\t\t}\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\tvar filters=context._shader2D.filters;\r\n\t\t\tfilters && o.shaderValue.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmit.createShape=function(ctx,ib,vb,numEle,offset,sv){\r\n\t\t\tvar o=(!Submit._cache._length)? (new Submit()):Submit._cache[--Submit._cache._length];\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._numEle=numEle;\r\n\t\t\to._startIdx=offset;\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(ctx._shader2D);\r\n\t\t\tvar blendType=ctx._nBlendType;\r\n\t\t\to._blendFn=ctx._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmit.TYPE_2D=10000;\r\n\t\tSubmit.TYPE_CANVAS=10003;\r\n\t\tSubmit.TYPE_CMDSETRT=10004;\r\n\t\tSubmit.TYPE_CUSTOM=10005;\r\n\t\tSubmit.TYPE_BLURRT=10006;\r\n\t\tSubmit.TYPE_CMDDESTORYPRERT=10007;\r\n\t\tSubmit.TYPE_DISABLESTENCIL=10008;\r\n\t\tSubmit.TYPE_OTHERIBVB=10009;\r\n\t\tSubmit.TYPE_PRIMITIVE=10010;\r\n\t\tSubmit.TYPE_RT=10011;\r\n\t\tSubmit.TYPE_BLUR_RT=10012;\r\n\t\tSubmit.TYPE_TARGET=10013;\r\n\t\tSubmit.TYPE_CHANGE_VALUE=10014;\r\n\t\tSubmit.TYPE_SHAPE=10015;\r\n\t\tSubmit.TYPE_TEXTURE=10016;\r\n\t\tSubmit.RENDERBASE=null\r\n\t\tSubmit._cache=(Submit._cache=[],Submit._cache._length=0,Submit._cache);\r\n\t\treturn Submit;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCMD\r\n\tvar SubmitCMD=(function(){\r\n\t\tfunction SubmitCMD(){\r\n\t\t\tthis.fun=null;\r\n\t\t\tthis.args=null;\r\n\t\t}\r\n\r\n\t\t__class(SubmitCMD,'laya.webgl.submit.SubmitCMD');\r\n\t\tvar __proto=SubmitCMD.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis.fun.apply(null,this.args);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitCMD._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\tSubmitCMD.create=function(args,fun){\r\n\t\t\tvar o=SubmitCMD._cache._length?SubmitCMD._cache[--SubmitCMD._cache._length]:new SubmitCMD();\r\n\t\t\to.fun=fun;\r\n\t\t\to.args=args;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitCMD._cache=(SubmitCMD._cache=[],SubmitCMD._cache._length=0,SubmitCMD._cache);\r\n\t\treturn SubmitCMD;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCMDScope\r\n\tvar SubmitCMDScope=(function(){\r\n\t\tfunction SubmitCMDScope(){\r\n\t\t\tthis.variables={};\r\n\t\t}\r\n\r\n\t\t__class(SubmitCMDScope,'laya.webgl.submit.SubmitCMDScope');\r\n\t\tvar __proto=SubmitCMDScope.prototype;\r\n\t\t__proto.getValue=function(name){\r\n\t\t\treturn this.variables[name];\r\n\t\t}\r\n\r\n\t\t__proto.addValue=function(name,value){\r\n\t\t\treturn this.variables[name]=value;\r\n\t\t}\r\n\r\n\t\t__proto.setValue=function(name,value){\r\n\t\t\tif(this.variables.hasOwnProperty(name)){\r\n\t\t\t\treturn this.variables[name]=value;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tfor(var key in this.variables){\r\n\t\t\t\tdelete this.variables[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.recycle=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tSubmitCMDScope.POOL.push(this);\r\n\t\t}\r\n\r\n\t\tSubmitCMDScope.create=function(){\r\n\t\t\tvar scope=SubmitCMDScope.POOL.pop();\r\n\t\t\tscope||(scope=new SubmitCMDScope());\r\n\t\t\treturn scope;\r\n\t\t}\r\n\r\n\t\tSubmitCMDScope.POOL=[];\r\n\t\treturn SubmitCMDScope;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitOtherIBVB\r\n\tvar SubmitOtherIBVB=(function(){\r\n\t\tfunction SubmitOtherIBVB(){\r\n\t\t\tthis.offset=0;\r\n\t\t\t//this._vb=null;\r\n\t\t\t//this._ib=null;\r\n\t\t\t//this._blendFn=null;\r\n\t\t\t//this._mat=null;\r\n\t\t\t//this._shader=null;\r\n\t\t\t//this._shaderValue=null;\r\n\t\t\t//this._numEle=0;\r\n\t\t\tthis.startIndex=0;\r\n\t\t\t;\r\n\t\t\tthis._mat=Matrix.create();\r\n\t\t}\r\n\r\n\t\t__class(SubmitOtherIBVB,'laya.webgl.submit.SubmitOtherIBVB');\r\n\t\tvar __proto=SubmitOtherIBVB.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitOtherIBVB._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn /*laya.webgl.submit.Submit.TYPE_OTHERIBVB*/10009;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tvar _tex=this._shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tthis._shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar w=RenderState2D.worldMatrix4;\r\n\t\t\tvar wmat=Matrix.TEMP;\r\n\t\t\tMatrix.mulPre(this._mat,w[0],w[1],w[4],w[5],w[12],w[13],wmat);\r\n\t\t\tvar tmp=RenderState2D.worldMatrix4=SubmitOtherIBVB.tempMatrix4;\r\n\t\t\ttmp[0]=wmat.a;\r\n\t\t\ttmp[1]=wmat.b;\r\n\t\t\ttmp[4]=wmat.c;\r\n\t\t\ttmp[5]=wmat.d;\r\n\t\t\ttmp[12]=wmat.tx;\r\n\t\t\ttmp[13]=wmat.ty;\r\n\t\t\tthis._shader._offset=this.offset;\r\n\t\t\tthis._shaderValue.refresh();\r\n\t\t\tthis._shader.upload(this._shaderValue);\r\n\t\t\tthis._shader._offset=0;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this.startIndex);\r\n\t\t\tRenderState2D.worldMatrix4=w;\r\n\t\t\tShader.activeShader=null;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmitOtherIBVB.create=function(context,vb,ib,numElement,shader,shaderValue,startIndex,offset,type){\r\n\t\t\t(type===void 0)&& (type=0);\r\n\t\t\tvar o=(!SubmitOtherIBVB._cache._length)? (new SubmitOtherIBVB()):SubmitOtherIBVB._cache[--SubmitOtherIBVB._cache._length];\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._numEle=numElement;\r\n\t\t\to._shader=shader;\r\n\t\t\to._shaderValue=shaderValue;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\tswitch(type){\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\to.offset=0;\r\n\t\t\t\t\to.startIndex=offset / (CONST3D2D.BYTES_PE *vb.vertexStride)*1.5;\r\n\t\t\t\t\to.startIndex *=CONST3D2D.BYTES_PIDX;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\to.startIndex=startIndex;\r\n\t\t\t\t\to.offset=offset;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitOtherIBVB._cache=(SubmitOtherIBVB._cache=[],SubmitOtherIBVB._cache._length=0,SubmitOtherIBVB._cache);\r\n\t\tSubmitOtherIBVB.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,];\r\n\t\treturn SubmitOtherIBVB;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitScissor\r\n\tvar SubmitScissor=(function(){\r\n\t\tfunction SubmitScissor(){\r\n\t\t\tthis.submitIndex=0;\r\n\t\t\tthis.submitLength=0;\r\n\t\t\tthis.context=null;\r\n\t\t\tthis.clipRect=new Rectangle();\r\n\t\t\tthis.screenRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(SubmitScissor,'laya.webgl.submit.SubmitScissor');\r\n\t\tvar __proto=SubmitScissor.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto._scissor=function(x,y,w,h){\r\n\t\t\tvar m=RenderState2D.worldMatrix4;\r\n\t\t\tvar a=m[0],d=m[5],tx=m[12],ty=m[13];\r\n\t\t\tx=x *a+tx;\r\n\t\t\ty=y *d+ty;\r\n\t\t\tw *=a;\r\n\t\t\th *=d;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar r=x+w;\r\n\t\t\tvar b=y+h;\r\n\t\t\tx < 0 && (x=0,w=r-x);\r\n\t\t\ty < 0 && (y=0,h=b-y);\r\n\t\t\tvar screen=RenderState2D.worldClipRect;\r\n\t\t\tx=Math.max(x,screen.x);\r\n\t\t\ty=Math.max(y,screen.y);\r\n\t\t\tw=Math.min(r,screen.right)-x;\r\n\t\t\th=Math.min(b,screen.bottom)-y;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tthis.screenRect.copyFrom(screen);\r\n\t\t\tscreen.x=x;\r\n\t\t\tscreen.y=y;\r\n\t\t\tscreen.width=w;\r\n\t\t\tscreen.height=h;\r\n\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\ty=RenderState2D.height-y-h;\r\n\t\t\tWebGL.mainContext.scissor(x,y,w,h);\r\n\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tthis.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\ty=RenderState2D.height-this.screenRect.y-this.screenRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t}\r\n\t\t\tscreen.copyFrom(this.screenRect);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._scissorWithTagart=function(x,y,w,h){\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar r=x+w;\r\n\t\t\tvar b=y+h;\r\n\t\t\tx < 0 && (x=0,w=r-x);\r\n\t\t\ty < 0 && (y=0,h=b-y);\r\n\t\t\tvar screen=RenderState2D.worldClipRect;\r\n\t\t\tx=Math.max(x,screen.x);\r\n\t\t\ty=Math.max(y,screen.y);\r\n\t\t\tw=Math.min(r,screen.right)-x;\r\n\t\t\th=Math.min(b,screen.bottom)-y;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tthis.screenRect.copyFrom(screen);\r\n\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\tscreen.x=x;\r\n\t\t\tscreen.y=y;\r\n\t\t\tscreen.width=w;\r\n\t\t\tscreen.height=h;\r\n\t\t\ty=RenderState2D.height-y-h;\r\n\t\t\tWebGL.mainContext.scissor(x,y,w,h);\r\n\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tthis.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\ty=RenderState2D.height-this.screenRect.y-this.screenRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t}\r\n\t\t\tscreen.copyFrom(this.screenRect);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis.submitLength=Math.min(this.context._submits._length-1,this.submitLength);\r\n\t\t\tif (this.submitLength < 1 || this.clipRect.width < 1 || this.clipRect.height < 1)\r\n\t\t\t\treturn this.submitLength+1;\r\n\t\t\tif (this.context._targets)\r\n\t\t\t\tthis._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);\r\n\t\t\telse this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);\r\n\t\t\treturn this.submitLength+1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitScissor._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.context=null;\r\n\t\t}\r\n\r\n\t\tSubmitScissor.create=function(context){\r\n\t\t\tvar o=SubmitScissor._cache._length?SubmitScissor._cache[--SubmitScissor._cache._length]:new SubmitScissor();\r\n\t\t\to.context=context;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitScissor._cache=(SubmitScissor._cache=[],SubmitScissor._cache._length=0,SubmitScissor._cache);\r\n\t\treturn SubmitScissor;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitStencil\r\n\tvar SubmitStencil=(function(){\r\n\t\tfunction SubmitStencil(){\r\n\t\t\tthis.step=0;\r\n\t\t\tthis.blendMode=null;\r\n\t\t\tthis.level=0;\r\n\t\t}\r\n\r\n\t\t__class(SubmitStencil,'laya.webgl.submit.SubmitStencil');\r\n\t\tvar __proto=SubmitStencil.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tswitch(this.step){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tthis.do1();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tthis.do2();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tthis.do3();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tthis.do4();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\tthis.do5();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 6:\r\n\t\t\t\t\tthis.do6();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitStencil._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.do1=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.colorMask(false,false,false,false);\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,this.level,0xFF);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.INCR*/0x1E02);\r\n\t\t}\r\n\r\n\t\t//gl.stencilOp(WebGLContext.KEEP,WebGLContext.KEEP,WebGLContext.INVERT);//测试通过给模版缓冲 写入值 一开始是0 现在是 0xFF (模版缓冲中不知道是多少位的数据)\r\n\t\t__proto.do2=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,this.level+1,0xFF);\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t}\r\n\r\n\t\t__proto.do3=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.disable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t}\r\n\r\n\t\t__proto.do4=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.colorMask(false,false,false,false);\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.ALWAYS*/0x0207,this.level,0xFF);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.INVERT*/0x150A);\r\n\t\t}\r\n\r\n\t\t__proto.do5=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,0xff,0xFF);\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t}\r\n\r\n\t\t__proto.do6=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tBlendMode.targetFns[BlendMode.TOINT[this.blendMode]](gl);\r\n\t\t}\r\n\r\n\t\tSubmitStencil.create=function(step){\r\n\t\t\tvar o=SubmitStencil._cache._length?SubmitStencil._cache[--SubmitStencil._cache._length]:new SubmitStencil();\r\n\t\t\to.step=step;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitStencil._cache=(SubmitStencil._cache=[],SubmitStencil._cache._length=0,SubmitStencil._cache);\r\n\t\treturn SubmitStencil;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitTarget\r\n\tvar SubmitTarget=(function(){\r\n\t\tfunction SubmitTarget(){\r\n\t\t\tthis._renderType=0;\r\n\t\t\tthis._vb=null;\r\n\t\t\tthis._ib=null;\r\n\t\t\tthis._startIdx=0;\r\n\t\t\tthis._numEle=0;\r\n\t\t\tthis.shaderValue=null;\r\n\t\t\tthis.blendType=0;\r\n\t\t\tthis.proName=null;\r\n\t\t\tthis.scope=null;\r\n\t\t}\r\n\r\n\t\t__class(SubmitTarget,'laya.webgl.submit.SubmitTarget');\r\n\t\tvar __proto=SubmitTarget.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar target=this.scope.getValue(this.proName);\r\n\t\t\tif (target){\r\n\t\t\t\tthis.shaderValue.texture=target.source;\r\n\t\t\t\tthis.shaderValue.upload();\r\n\t\t\t\tthis.blend();\r\n\t\t\t\tStat.drawCall++;\r\n\t\t\t\tStat.trianglesFaces+=this._numEle/3;\r\n\t\t\t\tWebGL.mainContext.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.blend=function(){\r\n\t\t\tif (BlendMode.activeBlendFunction!==BlendMode.fns[this.blendType]){\r\n\t\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tBlendMode.fns[this.blendType](gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=BlendMode.fns[this.blendType];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitTarget._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\tSubmitTarget.create=function(context,ib,vb,pos,sv,proName){\r\n\t\t\tvar o=SubmitTarget._cache._length?SubmitTarget._cache[--SubmitTarget._cache._length]:new SubmitTarget();\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to.proName=proName;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\to.blendType=context._nBlendType;\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitTarget._cache=(SubmitTarget._cache=[],SubmitTarget._cache._length=0,SubmitTarget._cache);\r\n\t\treturn SubmitTarget;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*...特殊的字符，如泰文，必须重新实现这个类\r\n\t*/\r\n\t//class laya.webgl.text.CharSegment\r\n\tvar CharSegment=(function(){\r\n\t\tfunction CharSegment(){\r\n\t\t\tthis._sourceStr=null;\r\n\t\t}\r\n\r\n\t\t__class(CharSegment,'laya.webgl.text.CharSegment');\r\n\t\tvar __proto=CharSegment.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.text.ICharSegment\":true})\r\n\t\t__proto.textToSpit=function(str){\r\n\t\t\tthis._sourceStr=str;\r\n\t\t}\r\n\r\n\t\t__proto.getChar=function(i){\r\n\t\t\treturn this._sourceStr.charAt(i);\r\n\t\t}\r\n\r\n\t\t__proto.getCharCode=function(i){\r\n\t\t\treturn this._sourceStr.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\t__proto.length=function(){\r\n\t\t\treturn this._sourceStr.length;\r\n\t\t}\r\n\r\n\t\treturn CharSegment;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.DrawText\r\n\tvar DrawText=(function(){\r\n\t\tvar CharValue;\r\n\t\tfunction DrawText(){};\r\n\t\t__class(DrawText,'laya.webgl.text.DrawText');\r\n\t\tDrawText.__init__=function(){\r\n\t\t\tDrawText._charsTemp=new Array;\r\n\t\t\tDrawText._drawValue=new CharValue();\r\n\t\t\tDrawText._charSeg=new CharSegment();\r\n\t\t}\r\n\r\n\t\tDrawText.customCharSeg=function(charseg){\r\n\t\t\tDrawText._charSeg=charseg;\r\n\t\t}\r\n\r\n\t\tDrawText.getChar=function(char,id,drawValue){\r\n\t\t\treturn DrawText._charsCache[id]=DrawTextChar.createOneChar(char,drawValue);\r\n\t\t}\r\n\r\n\t\tDrawText._drawSlow=function(save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy){\r\n\t\t\tvar drawValue=DrawText._drawValue.value(font,fillColor,borderColor,lineWidth,sx,sy);\r\n\t\t\tvar i=0,n=0;\r\n\t\t\tvar chars=DrawText._charsTemp;\r\n\t\t\tvar width=0,oneChar,htmlWord,id=NaN;\r\n\t\t\tif (words){\r\n\t\t\t\tchars.length=words.length;\r\n\t\t\t\tfor (i=0,n=words.length;i < n;i++){\r\n\t\t\t\t\thtmlWord=words[i];\r\n\t\t\t\t\tid=htmlWord.charNum+drawValue.txtID;\r\n\t\t\t\t\tchars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(htmlWord.char,id,drawValue);\r\n\t\t\t\t\toneChar.active();\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tif ((txt instanceof laya.utils.WordText ))\r\n\t\t\t\t\tDrawText._charSeg.textToSpit((txt).toString());\r\n\t\t\t\telse\r\n\t\t\t\tDrawText._charSeg.textToSpit(txt);\r\n\t\t\t\tvar len=/*if err,please use iflash.method.xmlLength()*/DrawText._charSeg.length();\r\n\t\t\t\tchars.length=len;\r\n\t\t\t\tfor (i=0,n=len;i < n;i++){\r\n\t\t\t\t\tid=DrawText._charSeg.getCharCode(i)+drawValue.txtID;\r\n\t\t\t\t\tchars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(DrawText._charSeg.getChar(i),id,drawValue);\r\n\t\t\t\t\toneChar.active();\r\n\t\t\t\t\twidth+=oneChar.width;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar dx=0;\r\n\t\t\tif (textAlign!==null && textAlign!==\"left\")\r\n\t\t\t\tdx=-(textAlign==\"center\" ? (width / 2):width);\r\n\t\t\tvar uv,bdSz=NaN,texture,value,saveLength=0;\r\n\t\t\tif (words){\r\n\t\t\t\tfor (i=0,n=chars.length;i < n;i++){\r\n\t\t\t\t\toneChar=chars[i];\r\n\t\t\t\t\tif (!oneChar.isSpace){\r\n\t\t\t\t\t\thtmlWord=words[i];\r\n\t\t\t\t\t\tbdSz=oneChar.borderSize;\r\n\t\t\t\t\t\ttexture=oneChar.texture;\r\n\t\t\t\t\t\tctx._drawText(texture,x+dx+htmlWord.x *sx-bdSz,y+htmlWord.y *sy-bdSz,texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (i=0,n=chars.length;i < n;i++){\r\n\t\t\t\t\toneChar=chars[i];\r\n\t\t\t\t\tif (!oneChar.isSpace){\r\n\t\t\t\t\t\tbdSz=oneChar.borderSize;\r\n\t\t\t\t\t\ttexture=oneChar.texture;\r\n\t\t\t\t\t\tctx._drawText(texture,x+dx-bdSz,y-bdSz,texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t\t\t\tsave && (value=save[saveLength++],value || (value=save[saveLength-1]=[]),value[0]=texture,value[1]=dx-bdSz,value[2]=-bdSz);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdx+=oneChar.width;\r\n\t\t\t\t}\r\n\t\t\t\tsave && (save.length=saveLength);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText._drawFast=function(save,ctx,curMat,x,y){\r\n\t\t\tvar texture,value;\r\n\t\t\tfor (var i=0,n=save.length;i < n;i++){\r\n\t\t\t\tvalue=save[i];\r\n\t\t\t\ttexture=value[0];\r\n\t\t\t\ttexture.active();\r\n\t\t\t\tctx._drawText(texture,x+value[1],y+value[2],texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText.drawText=function(ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y){\r\n\t\t\tif ((txt && txt.length===0)|| (words && words.length===0))\r\n\t\t\t\treturn;\r\n\t\t\tvar sx=curMat.a,sy=curMat.d;\r\n\t\t\t(curMat.b!==0 || curMat.c!==0)&& (sx=sy=1);\r\n\t\t\tvar scale=sx!==1 || sy!==1;\r\n\t\t\tif (scale && Laya.stage.transform){\r\n\t\t\t\tvar t=Laya.stage.transform;\r\n\t\t\t\tscale=t.a===sx && t.d===sy;\r\n\t\t\t}else scale=false;\r\n\t\t\tif (scale){\r\n\t\t\t\tcurMat=curMat.copyTo(WebGLContext2D._tmpMatrix);\r\n\t\t\t\tcurMat.scale(1 / sx,1 / sy);\r\n\t\t\t\tcurMat._checkTransform();\r\n\t\t\t\tx *=sx;\r\n\t\t\t\ty *=sy;\r\n\t\t\t}else sx=sy=1;\r\n\t\t\tif (words){\r\n\t\t\t\tDrawText._drawSlow(null,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t}else {\r\n\t\t\t\tif (txt.toUpperCase===null){\r\n\t\t\t\t\tvar idNum=sx+sy *100000;\r\n\t\t\t\t\tvar myCache=txt;\r\n\t\t\t\t\tif (!myCache.changed && myCache.id===idNum){\r\n\t\t\t\t\t\tDrawText._drawFast(myCache.save,ctx,curMat,x,y);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tmyCache.id=idNum;\r\n\t\t\t\t\t\tmyCache.changed=false;\r\n\t\t\t\t\t\tDrawText._drawSlow(myCache.save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t};\r\n\t\t\t\tvar id=txt+font.toString()+fillColor+borderColor+lineWidth+sx+sy+textAlign;\r\n\t\t\t\tvar cache=DrawText._textsCache[id];\r\n\t\t\t\tif (cache){\r\n\t\t\t\t\tDrawText._drawFast(cache,ctx,curMat,x,y);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tDrawText._textsCache.__length || (DrawText._textsCache.__length=0);\r\n\t\t\t\t\tif (DrawText._textsCache.__length > Config.WebGLTextCacheCount){\r\n\t\t\t\t\t\tDrawText._textsCache={};\r\n\t\t\t\t\t\tDrawText._textsCache.__length=0;\r\n\t\t\t\t\t\tDrawText._curPoolIndex=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tDrawText._textCachesPool[DrawText._curPoolIndex] ? (cache=DrawText._textsCache[id]=DrawText._textCachesPool[DrawText._curPoolIndex],cache.length=0):(DrawText._textCachesPool[DrawText._curPoolIndex]=cache=DrawText._textsCache[id]=[]);\r\n\t\t\t\t\tDrawText._textsCache.__length++\r\n\t\t\t\t\tDrawText._curPoolIndex++;\r\n\t\t\t\t\tDrawText._drawSlow(cache,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText._charsTemp=null\r\n\t\tDrawText._textCachesPool=[];\r\n\t\tDrawText._curPoolIndex=0;\r\n\t\tDrawText._charsCache={};\r\n\t\tDrawText._textsCache={};\r\n\t\tDrawText._drawValue=null\r\n\t\tDrawText.d=[];\r\n\t\tDrawText._charSeg=null;\r\n\t\tDrawText.__init$=function(){\r\n\t\t\t//class CharValue\r\n\t\t\tCharValue=(function(){\r\n\t\t\t\tfunction CharValue(){\r\n\t\t\t\t\t//this.txtID=NaN;\r\n\t\t\t\t\t//this.font=null;\r\n\t\t\t\t\t//this.fillColor=null;\r\n\t\t\t\t\t//this.borderColor=null;\r\n\t\t\t\t\t//this.lineWidth=0;\r\n\t\t\t\t\t//this.scaleX=NaN;\r\n\t\t\t\t\t//this.scaleY=NaN;\r\n\t\t\t\t}\r\n\t\t\t\t__class(CharValue,'');\r\n\t\t\t\tvar __proto=CharValue.prototype;\r\n\t\t\t\t__proto.value=function(font,fillColor,borderColor,lineWidth,scaleX,scaleY){\r\n\t\t\t\t\tthis.font=font;\r\n\t\t\t\t\tthis.fillColor=fillColor;\r\n\t\t\t\t\tthis.borderColor=borderColor;\r\n\t\t\t\t\tthis.lineWidth=lineWidth;\r\n\t\t\t\t\tthis.scaleX=scaleX;\r\n\t\t\t\t\tthis.scaleY=scaleY;\r\n\t\t\t\t\tvar key=font.toString()+scaleX+scaleY+lineWidth+fillColor+borderColor;\r\n\t\t\t\t\tthis.txtID=CharValue._keymap[key];\r\n\t\t\t\t\tif (!this.txtID){\r\n\t\t\t\t\t\tthis.txtID=(++CharValue._keymapCount)*0.0000001;\r\n\t\t\t\t\t\tCharValue._keymap[key]=this.txtID;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\tCharValue.clear=function(){\r\n\t\t\t\t\tCharValue._keymap={};\r\n\t\t\t\t\tCharValue._keymapCount=1;\r\n\t\t\t\t}\r\n\t\t\t\tCharValue._keymap={};\r\n\t\t\t\tCharValue._keymapCount=1;\r\n\t\t\t\treturn CharValue;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn DrawText;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.DrawTextChar\r\n\tvar DrawTextChar=(function(){\r\n\t\tfunction DrawTextChar(content,drawValue){\r\n\t\t\t//this.xs=NaN;\r\n\t\t\t//this.ys=NaN;\r\n\t\t\t//this.width=0;\r\n\t\t\t//this.height=0;\r\n\t\t\t//this.char=null;\r\n\t\t\t//this.fillColor=null;\r\n\t\t\t//this.borderColor=null;\r\n\t\t\t//this.borderSize=0;\r\n\t\t\t//this.font=null;\r\n\t\t\t//this.fontSize=0;\r\n\t\t\t//this.texture=null;\r\n\t\t\t//this.lineWidth=0;\r\n\t\t\t//this.UV=null;\r\n\t\t\t//this.isSpace=false;\r\n\t\t\tthis.char=content;\r\n\t\t\tthis.isSpace=content===' ';\r\n\t\t\tthis.xs=drawValue.scaleX;\r\n\t\t\tthis.ys=drawValue.scaleY;\r\n\t\t\tthis.font=drawValue.font.toString();\r\n\t\t\tthis.fontSize=drawValue.font.size;\r\n\t\t\tthis.fillColor=drawValue.fillColor;\r\n\t\t\tthis.borderColor=drawValue.borderColor;\r\n\t\t\tthis.lineWidth=drawValue.lineWidth;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\t/*__JS__ */var pCanvas=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */pCanvas._source=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */pCanvas._source.canvas=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */this.texture=new Texture(new WebGLCharImage(pCanvas,this));\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.texture=new Texture(new WebGLCharImage(Browser.canvas.source,this));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(DrawTextChar,'laya.webgl.text.DrawTextChar');\r\n\t\tvar __proto=DrawTextChar.prototype;\r\n\t\t__proto.active=function(){\r\n\t\t\tthis.texture.active();\r\n\t\t}\r\n\r\n\t\tDrawTextChar.createOneChar=function(content,drawValue){\r\n\t\t\tvar char=new DrawTextChar(content,drawValue);\r\n\t\t\treturn char;\r\n\t\t}\r\n\r\n\t\treturn DrawTextChar;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.FontInContext\r\n\tvar FontInContext=(function(){\r\n\t\tfunction FontInContext(font){\r\n\t\t\t//this._text=null;\r\n\t\t\t//this._words=null;\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._size=14;\r\n\t\t\tthis._italic=-2;\r\n\t\t\tthis.setFont(font || \"14px Arial\");\r\n\t\t}\r\n\r\n\t\t__class(FontInContext,'laya.webgl.text.FontInContext');\r\n\t\tvar __proto=FontInContext.prototype;\r\n\t\t__proto.setFont=function(value){\r\n\t\t\tthis._words=value.split(' ');\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++){\r\n\t\t\t\tif (this._words[i].indexOf('px')> 0){\r\n\t\t\t\t\tthis._index=i;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._size=parseInt(this._words[this._index]);\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._italic=-2;\r\n\t\t}\r\n\r\n\t\t__proto.getItalic=function(){\r\n\t\t\tthis._italic===-2 && (this._italic=this.hasType(\"italic\"));\r\n\t\t\treturn this._italic;\r\n\t\t}\r\n\r\n\t\t__proto.hasType=function(name){\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++)\r\n\t\t\tif (this._words[i]===name)return i;\r\n\t\t\treturn-1;\r\n\t\t}\r\n\r\n\t\t__proto.removeType=function(name){\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++)\r\n\t\t\tif (this._words[i]===name){\r\n\t\t\t\tthis._words.splice(i,1);\r\n\t\t\t\tif (this._index > i)this._index--;\r\n\t\t\t\tbreak ;\r\n\t\t\t}\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._italic=-2;\r\n\t\t}\r\n\r\n\t\t__proto.copyTo=function(dec){\r\n\t\t\tdec._text=this._text;\r\n\t\t\tdec._size=this._size;\r\n\t\t\tdec._index=this._index;\r\n\t\t\tdec._words=this._words.slice();\r\n\t\t\tdec._italic=-2;\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this._text ? this._text :(this._text=this._words.join(' '));\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'size',function(){\r\n\t\t\treturn this._size;\r\n\t\t\t},function(value){\r\n\t\t\tthis._size=value;\r\n\t\t\tthis._words[this._index]=value+\"px\";\r\n\t\t\tthis._text=null;\r\n\t\t});\r\n\r\n\t\tFontInContext.create=function(font){\r\n\t\t\tvar r=FontInContext._cache[font];\r\n\t\t\tif (r)return r;\r\n\t\t\tr=FontInContext._cache[font]=new FontInContext(font);\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\tFontInContext.EMPTY=new FontInContext();\r\n\t\tFontInContext._cache={};\r\n\t\treturn FontInContext;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.CONST3D2D\r\n\tvar CONST3D2D=(function(){\r\n\t\tfunction CONST3D2D(){};\r\n\t\t__class(CONST3D2D,'laya.webgl.utils.CONST3D2D');\r\n\t\tCONST3D2D.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tCONST3D2D.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tCONST3D2D.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];\r\n\t\tCONST3D2D._TMPARRAY=[];\r\n\t\tCONST3D2D._OFFSETX=0;\r\n\t\tCONST3D2D._OFFSETY=0;\r\n\t\t__static(CONST3D2D,\r\n\t\t['BYTES_PE',function(){return this.BYTES_PE=/*__JS__ */Float32Array.BYTES_PER_ELEMENT;},'BYTES_PIDX',function(){return this.BYTES_PIDX=/*__JS__ */Uint16Array.BYTES_PER_ELEMENT;}\r\n\t\t]);\r\n\t\treturn CONST3D2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.GlUtils\r\n\tvar GlUtils=(function(){\r\n\t\tfunction GlUtils(){};\r\n\t\t__class(GlUtils,'laya.webgl.utils.GlUtils');\r\n\t\tGlUtils.make2DProjection=function(width,height,depth){\r\n\t\t\treturn [2.0 / width,0,0,0,0,-2.0 / height,0,0,0,0,2.0 / depth,0,-1,1,0,1,];\r\n\t\t}\r\n\r\n\t\tGlUtils.fillIBQuadrangle=function(buffer,count){\r\n\t\t\tif (count > 65535 / 4){\r\n\t\t\t\tthrow Error(\"IBQuadrangle count:\"+count+\" must<:\"+Math.floor(65535 / 4));\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tcount=Math.floor(count);\r\n\t\t\tbuffer._resizeBuffer((count+1)*6 */*laya.webgl.utils.Buffer2D.SHORT*/2,false);\r\n\t\t\tbuffer.byteLength=buffer.bufferLength;\r\n\t\t\tvar bufferData=buffer.getUint16Array();\r\n\t\t\tvar idx=0;\r\n\t\t\tfor (var i=0;i < count;i++){\r\n\t\t\t\tbufferData[idx++]=i *4;\r\n\t\t\t\tbufferData[idx++]=i *4+2;\r\n\t\t\t\tbufferData[idx++]=i *4+1;\r\n\t\t\t\tbufferData[idx++]=i *4;\r\n\t\t\t\tbufferData[idx++]=i *4+3;\r\n\t\t\t\tbufferData[idx++]=i *4+2;\r\n\t\t\t}\r\n\t\t\tbuffer.setNeedUpload();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.expandIBQuadrangle=function(buffer,count){\r\n\t\t\tbuffer.bufferLength >=(count *6 */*laya.webgl.utils.Buffer2D.SHORT*/2)|| GlUtils.fillIBQuadrangle(buffer,count);\r\n\t\t}\r\n\r\n\t\tGlUtils.mathCeilPowerOfTwo=function(value){\r\n\t\t\tvalue--;\r\n\t\t\tvalue |=value >> 1;\r\n\t\t\tvalue |=value >> 2;\r\n\t\t\tvalue |=value >> 4;\r\n\t\t\tvalue |=value >> 8;\r\n\t\t\tvalue |=value >> 16;\r\n\t\t\tvalue++;\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillQuadrangleImgVb=function(vb,x,y,point4,uv,m,_x,_y){\r\n\t\t\t'use strict';\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvpos-=/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvbdata[vpos+2]=uv[0];\r\n\t\t\tvbdata[vpos+3]=uv[1];\r\n\t\t\tvbdata[vpos+6]=uv[2];\r\n\t\t\tvbdata[vpos+7]=uv[3];\r\n\t\t\tvbdata[vpos+10]=uv[4];\r\n\t\t\tvbdata[vpos+11]=uv[5];\r\n\t\t\tvbdata[vpos+14]=uv[6];\r\n\t\t\tvbdata[vpos+15]=uv[7];\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\tm.bTransform=true;\r\n\t\t\t\tvar tx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\tvbdata[vpos]=(point4[0]+x)*a+(point4[1]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+1]=(point4[0]+x)*b+(point4[1]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+4]=(point4[2]+x)*a+(point4[3]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+5]=(point4[2]+x)*b+(point4[3]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+8]=(point4[4]+x)*a+(point4[5]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+9]=(point4[4]+x)*b+(point4[5]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+12]=(point4[6]+x)*a+(point4[7]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+13]=(point4[6]+x)*b+(point4[7]+y)*d+ty;\r\n\t\t\t\t}else {\r\n\t\t\t\tm.bTransform=false;\r\n\t\t\t\tx+=m.tx+_x;\r\n\t\t\t\ty+=m.ty+_y;\r\n\t\t\t\tvbdata[vpos]=x+point4[0];\r\n\t\t\t\tvbdata[vpos+1]=y+point4[1];\r\n\t\t\t\tvbdata[vpos+4]=x+point4[2];\r\n\t\t\t\tvbdata[vpos+5]=y+point4[3];\r\n\t\t\t\tvbdata[vpos+8]=x+point4[4];\r\n\t\t\t\tvbdata[vpos+9]=y+point4[5];\r\n\t\t\t\tvbdata[vpos+12]=x+point4[6];\r\n\t\t\t\tvbdata[vpos+13]=y+point4[7];\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillTranglesVB=function(vb,x,y,points,m,_x,_y){\r\n\t\t\t'use strict';\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+points.length;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvpos-=points.length;\r\n\t\t\tvar len=points.length;\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tfor (var i=0;i < len;i+=4){\r\n\t\t\t\tvbdata[vpos+i+2]=points[i+2];\r\n\t\t\t\tvbdata[vpos+i+3]=points[i+3];\r\n\t\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\t\tm.bTransform=true;\r\n\t\t\t\t\tvar tx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\tvbdata[vpos+i]=(points[i]+x)*a+(points[i+1]+y)*c+tx;\r\n\t\t\t\t\tvbdata[vpos+i+1]=(points[i]+x)*b+(points[i+1]+y)*d+ty;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tm.bTransform=false;\r\n\t\t\t\t\tx+=m.tx+_x;\r\n\t\t\t\t\ty+=m.ty+_y;\r\n\t\t\t\t\tvbdata[vpos+i]=x+points[i];\r\n\t\t\t\t\tvbdata[vpos+i+1]=y+points[i+1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.copyPreImgVb=function(vb,dx,dy){\r\n\t\t\tvar vpos=(vb._byteLength >> 2);\r\n\t\t\tvb.byteLength=((vpos+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tfor (var i=0,ci=vpos-16;i < 4;i++){\r\n\t\t\t\tvbdata[vpos]=vbdata[ci]+dx;++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci]+dy;++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci];++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci];++vpos;++ci;\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillRectImgVb=function(vb,clip,x,y,width,height,uv,m,_x,_y,dx,dy,round){\r\n\t\t\t(round===void 0)&& (round=false);\r\n\t\t\t'use strict';\r\n\t\t\tvar mType=1;\r\n\t\t\tvar toBx,toBy,toEx,toEy;\r\n\t\t\tvar cBx,cBy,cEx,cEy;\r\n\t\t\tvar w0,h0,tx,ty;\r\n\t\t\tvar finalX,finalY,offsetX,offsetY;\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tvar useClip=clip.width < /*laya.webgl.canvas.WebGLContext2D._MAXSIZE*/99999999;\r\n\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\tm.bTransform=true;\r\n\t\t\t\tif (b===0 && c===0){\r\n\t\t\t\t\tmType=23;\r\n\t\t\t\t\tw0=width+x,h0=height+y;\r\n\t\t\t\t\ttx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\ttoBx=a *x+tx;\r\n\t\t\t\t\ttoEx=a *w0+tx;\r\n\t\t\t\t\ttoBy=d *y+ty;\r\n\t\t\t\t\ttoEy=d *h0+ty;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tmType=23;\r\n\t\t\t\tm.bTransform=false;\r\n\t\t\t\ttoBx=x+m.tx+_x;\r\n\t\t\t\ttoEx=toBx+width;\r\n\t\t\t\ttoBy=y+m.ty+_y;\r\n\t\t\t\ttoEy=toBy+height;\r\n\t\t\t}\r\n\t\t\tif (useClip){\r\n\t\t\t\tcBx=clip.x,cBy=clip.y,cEx=clip.width+cBx,cEy=clip.height+cBy;\r\n\t\t\t}\r\n\t\t\tif (mType!==1 && (toBx >=cEx || toBy >=cEy || toEx <=cBx || toEy <=cBy))\r\n\t\t\t\treturn false;\r\n\t\t\tvar vpos=(vb._byteLength >> 2);\r\n\t\t\tvb.byteLength=((vpos+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvbdata[vpos+2]=uv[0];\r\n\t\t\tvbdata[vpos+3]=uv[1];\r\n\t\t\tvbdata[vpos+6]=uv[2];\r\n\t\t\tvbdata[vpos+7]=uv[3];\r\n\t\t\tvbdata[vpos+10]=uv[4];\r\n\t\t\tvbdata[vpos+11]=uv[5];\r\n\t\t\tvbdata[vpos+14]=uv[6];\r\n\t\t\tvbdata[vpos+15]=uv[7];\r\n\t\t\tswitch (mType){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\ttx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\tw0=width+x,h0=height+y;\r\n\t\t\t\t\tvar w1=x,h1=y;\r\n\t\t\t\t\tvar aw1=a *w1,ch1=c *h1,dh1=d *h1,bw1=b *w1;\r\n\t\t\t\t\tvar aw0=a *w0,ch0=c *h0,dh0=d *h0,bw0=b *w0;\r\n\t\t\t\t\tif (round){\r\n\t\t\t\t\t\tfinalX=aw1+ch1+tx;\r\n\t\t\t\t\t\toffsetX=Math.round(finalX)-finalX;\r\n\t\t\t\t\t\tfinalY=dh1+bw1+ty;\r\n\t\t\t\t\t\toffsetY=Math.round(finalY)-finalY;\r\n\t\t\t\t\t\tvbdata[vpos]=finalX+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+1]=finalY+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+4]=aw0+ch1+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+5]=dh1+bw0+ty+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+8]=aw0+ch0+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+9]=dh0+bw0+ty+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+12]=aw1+ch0+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+13]=dh0+bw1+ty+offsetY;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvbdata[vpos]=aw1+ch1+tx;\r\n\t\t\t\t\t\tvbdata[vpos+1]=dh1+bw1+ty;\r\n\t\t\t\t\t\tvbdata[vpos+4]=aw0+ch1+tx;\r\n\t\t\t\t\t\tvbdata[vpos+5]=dh1+bw0+ty;\r\n\t\t\t\t\t\tvbdata[vpos+8]=aw0+ch0+tx;\r\n\t\t\t\t\t\tvbdata[vpos+9]=dh0+bw0+ty;\r\n\t\t\t\t\t\tvbdata[vpos+12]=aw1+ch0+tx;\r\n\t\t\t\t\t\tvbdata[vpos+13]=dh0+bw1+ty;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 23:\r\n\t\t\t\t\tif (round){\r\n\t\t\t\t\t\tfinalX=toBx+dx;\r\n\t\t\t\t\t\toffsetX=Math.round(finalX)-finalX;\r\n\t\t\t\t\t\tfinalY=toBy;\r\n\t\t\t\t\t\toffsetY=Math.round(finalY)-finalY;\r\n\t\t\t\t\t\tvbdata[vpos]=finalX+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+1]=finalY+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+4]=toEx+dx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+5]=toBy+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+8]=toEx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+9]=toEy+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+12]=toBx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+13]=toEy+offsetY;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvbdata[vpos]=toBx+dx;\r\n\t\t\t\t\t\tvbdata[vpos+1]=toBy;\r\n\t\t\t\t\t\tvbdata[vpos+4]=toEx+dx;\r\n\t\t\t\t\t\tvbdata[vpos+5]=toBy;\r\n\t\t\t\t\t\tvbdata[vpos+8]=toEx;\r\n\t\t\t\t\t\tvbdata[vpos+9]=toEy;\r\n\t\t\t\t\t\tvbdata[vpos+12]=toBx;\r\n\t\t\t\t\t\tvbdata[vpos+13]=toEy;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillLineVb=function(vb,clip,fx,fy,tx,ty,width,mat){\r\n\t\t\t'use strict';\r\n\t\t\tvar linew=width *.5;\r\n\t\t\tvar data=GlUtils._fillLineArray;\r\n\t\t\tvar perpx=-(fy-ty),perpy=fx-tx;\r\n\t\t\tvar dist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx /=dist,perpy /=dist,perpx *=linew,perpy *=linew;\r\n\t\t\tdata[0]=fx-perpx,data[1]=fy-perpy,data[4]=fx+perpx,data[5]=fy+perpy,data[8]=tx+perpx,data[9]=ty+perpy,data[12]=tx-perpx,data[13]=ty-perpy;\r\n\t\t\tmat && mat.transformPointArray(data,data);\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvb.insertData(data,vpos-/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils._fillLineArray=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];\r\n\t\treturn GlUtils;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.MatirxArray\r\n\tvar MatirxArray=(function(){\r\n\t\tfunction MatirxArray(){};\r\n\t\t__class(MatirxArray,'laya.webgl.utils.MatirxArray');\r\n\t\tMatirxArray.ArrayMul=function(a,b,o){\r\n\t\t\tif (!a){\r\n\t\t\t\tMatirxArray.copyArray(b,o);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!b){\r\n\t\t\t\tMatirxArray.copyArray(a,o);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar ai0=NaN,ai1=NaN,ai2=NaN,ai3=NaN;\r\n\t\t\tfor (var i=0;i < 4;i++){\r\n\t\t\t\tai0=a[i];\r\n\t\t\t\tai1=a[i+4];\r\n\t\t\t\tai2=a[i+8];\r\n\t\t\t\tai3=a[i+12];\r\n\t\t\t\to[i]=ai0 *b[0]+ai1 *b[1]+ai2 *b[2]+ai3 *b[3];\r\n\t\t\t\to[i+4]=ai0 *b[4]+ai1 *b[5]+ai2 *b[6]+ai3 *b[7];\r\n\t\t\t\to[i+8]=ai0 *b[8]+ai1 *b[9]+ai2 *b[10]+ai3 *b[11];\r\n\t\t\t\to[i+12]=ai0 *b[12]+ai1 *b[13]+ai2 *b[14]+ai3 *b[15];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tMatirxArray.copyArray=function(f,t){\r\n\t\t\tif (!f)return;\r\n\t\t\tif (!t)return;\r\n\t\t\tfor (var i=0;i < f.length;i++){\r\n\t\t\t\tt[i]=f[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn MatirxArray;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.RenderState2D\r\n\tvar RenderState2D=(function(){\r\n\t\tfunction RenderState2D(){};\r\n\t\t__class(RenderState2D,'laya.webgl.utils.RenderState2D');\r\n\t\tRenderState2D.getMatrArray=function(){\r\n\t\t\treturn [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\t}\r\n\r\n\t\tRenderState2D.mat2MatArray=function(mat,matArray){\r\n\t\t\tvar m=mat;\r\n\t\t\tvar m4=matArray;\r\n\t\t\tm4[0]=m.a;\r\n\t\t\tm4[1]=m.b;\r\n\t\t\tm4[4]=m.c;\r\n\t\t\tm4[5]=m.d;\r\n\t\t\tm4[12]=m.tx;\r\n\t\t\tm4[13]=m.ty;\r\n\t\t\treturn matArray;\r\n\t\t}\r\n\r\n\t\tRenderState2D.restoreTempArray=function(){\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[0]=1;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[1]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[4]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[5]=1;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[12]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[13]=0;\r\n\t\t}\r\n\r\n\t\tRenderState2D.clear=function(){\r\n\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\tRenderState2D.worldShaderDefines=null;\r\n\t\t\tRenderState2D.worldFilters=null;\r\n\t\t\tRenderState2D.worldAlpha=1;\r\n\t\t\tRenderState2D.worldClipRect.x=RenderState2D.worldClipRect.y=0;\r\n\t\t\tRenderState2D.worldClipRect.width=RenderState2D.width;\r\n\t\t\tRenderState2D.worldClipRect.height=RenderState2D.height;\r\n\t\t\tRenderState2D.curRenderTarget=null;\r\n\t\t}\r\n\r\n\t\tRenderState2D._MAXSIZE=99999999;\r\n\t\tRenderState2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tRenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;\r\n\t\tRenderState2D.worldAlpha=1.0;\r\n\t\tRenderState2D.worldScissorTest=false;\r\n\t\tRenderState2D.worldFilters=null\r\n\t\tRenderState2D.worldShaderDefines=null\r\n\t\tRenderState2D.worldClipRect=new Rectangle(0,0,99999999,99999999);\r\n\t\tRenderState2D.curRenderTarget=null\r\n\t\tRenderState2D.width=0;\r\n\t\tRenderState2D.height=0;\r\n\t\t__static(RenderState2D,\r\n\t\t['worldMatrix',function(){return this.worldMatrix=new Matrix();}\r\n\t\t]);\r\n\t\treturn RenderState2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.ShaderCompile\r\n\tvar ShaderCompile=(function(){\r\n\t\tvar ShaderScriptBlock;\r\n\t\tfunction ShaderCompile(name,vs,ps,nameMap,includeFiles){\r\n\t\t\t//this._VS=null;\r\n\t\t\t//this._PS=null;\r\n\t\t\t//this._VSTXT=null;\r\n\t\t\t//this._PSTXT=null;\r\n\t\t\t//this._nameMap=null;\r\n\t\t\tthis._VSTXT=vs;\r\n\t\t\tthis._PSTXT=ps;\r\n\t\t\tfunction split (str){\r\n\t\t\t\tvar words=str.split(' ');\r\n\t\t\t\tvar out=[];\r\n\t\t\t\tfor (var i=0;i < words.length;i++)\r\n\t\t\t\twords[i].length > 0 && out.push(words[i]);\r\n\t\t\t\treturn out;\r\n\t\t\t}\r\n\t\t\tfunction c (script){\r\n\t\t\t\tvar i=0,n=0,ofs=0,words,condition;\r\n\t\t\t\tvar top=new ShaderScriptBlock(0,null,null,null);\r\n\t\t\t\tvar parent=top;\r\n\t\t\t\tvar lines=script.split('\\n');\r\n\t\t\t\tfor (i=0,n=lines.length;i < n;i++){\r\n\t\t\t\t\tvar line=lines[i];\r\n\t\t\t\t\tif (line.indexOf(\"#ifdef\")>=0){\r\n\t\t\t\t\t\twords=split(line);\r\n\t\t\t\t\t\tparent=new ShaderScriptBlock(1,words[1],\"\",parent);\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#else\")>=0){\r\n\t\t\t\t\t\tcondition=parent.condition;\r\n\t\t\t\t\t\tparent=new ShaderScriptBlock(2,null,\"\",parent.parent);\r\n\t\t\t\t\t\tparent.condition=condition;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#endif\")>=0){\r\n\t\t\t\t\t\tparent=parent.parent;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#include\")>=0){\r\n\t\t\t\t\t\twords=split(line);\r\n\t\t\t\t\t\tvar fname=words[1];\r\n\t\t\t\t\t\tvar chr=fname.charAt(0);\r\n\t\t\t\t\t\tif (chr==='\"' || chr===\"'\"){\r\n\t\t\t\t\t\t\tfname=fname.substr(1,fname.length-2);\r\n\t\t\t\t\t\t\tofs=fname.lastIndexOf(chr);\r\n\t\t\t\t\t\t\tif (ofs > 0)fname=fname.substr(0,ofs);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tofs=words[0].indexOf('?');\r\n\t\t\t\t\t\tvar str=ofs > 0 ? words[0].substr(ofs+1):words[0];\r\n\t\t\t\t\t\tnew ShaderScriptBlock(1,str,includeFiles[fname],parent);\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (parent.childs.length > 0 && parent.childs[parent.childs.length-1].type===0){\r\n\t\t\t\t\t\tparent.childs[parent.childs.length-1].text+=\"\\n\"+line;\r\n\t\t\t\t\t}else new ShaderScriptBlock(0,null,line,parent);\r\n\t\t\t\t}\r\n\t\t\t\treturn top;\r\n\t\t\t}\r\n\t\t\tthis._VS=c(vs);\r\n\t\t\tthis._PS=c(ps);\r\n\t\t\tthis._nameMap=nameMap;\r\n\t\t}\r\n\r\n\t\t__class(ShaderCompile,'laya.webgl.utils.ShaderCompile');\r\n\t\tvar __proto=ShaderCompile.prototype;\r\n\t\t__proto.createShader=function(define,shaderName,createShader){\r\n\t\t\tvar defMap={};\r\n\t\t\tvar defineStr=\"\";\r\n\t\t\tif (define){\r\n\t\t\t\tfor (var i in define){\r\n\t\t\t\t\tdefineStr+=\"#define \"+i+\"\\n\";\r\n\t\t\t\t\tdefMap[i]=true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar vs=this._VS.toscript(defMap,[]);\r\n\t\t\tvar ps=this._PS.toscript(defMap,[]);\r\n\t\t\treturn (createShader || Shader.create)(defineStr+vs.join('\\n'),defineStr+ps.join('\\n'),shaderName,this._nameMap);\r\n\t\t}\r\n\r\n\t\tShaderCompile.IFDEF_NO=0;\r\n\t\tShaderCompile.IFDEF_YES=1;\r\n\t\tShaderCompile.IFDEF_ELSE=2;\r\n\t\tShaderCompile.__init$=function(){\r\n\t\t\t//class ShaderScriptBlock\r\n\t\t\tShaderScriptBlock=(function(){\r\n\t\t\t\tfunction ShaderScriptBlock(type,condition,text,parent){\r\n\t\t\t\t\t//this.type=0;\r\n\t\t\t\t\t//this.condition=null;\r\n\t\t\t\t\t//this.text=null;\r\n\t\t\t\t\t//this.parent=null;\r\n\t\t\t\t\tthis.childs=new Array;\r\n\t\t\t\t\tthis.type=type;\r\n\t\t\t\t\tthis.text=text;\r\n\t\t\t\t\tthis.parent=parent;\r\n\t\t\t\t\tparent && parent.childs.push(this);\r\n\t\t\t\t\tif (!condition)return;\r\n\t\t\t\t\tvar newcondition=\"\";\r\n\t\t\t\t\tvar preIsParam=false,isParam=false;\r\n\t\t\t\t\tfor (var i=0,n=condition.length;i < n;i++){\r\n\t\t\t\t\t\tvar c=condition.charAt(i);\r\n\t\t\t\t\t\tisParam=\"!&|() \\t\".indexOf(c)< 0;\r\n\t\t\t\t\t\tif (preIsParam !=isParam){\r\n\t\t\t\t\t\t\tisParam && (newcondition+=\"this.\");\r\n\t\t\t\t\t\t\tpreIsParam=isParam;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewcondition+=c;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.condition=RunDriver.createShaderCondition(newcondition);\r\n\t\t\t\t}\r\n\t\t\t\t__class(ShaderScriptBlock,'');\r\n\t\t\t\tvar __proto=ShaderScriptBlock.prototype;\r\n\t\t\t\t__proto.toscript=function(def,out){\r\n\t\t\t\t\tif (this.type===/*laya.webgl.utils.ShaderCompile.IFDEF_NO*/0){\r\n\t\t\t\t\t\tthis.text && out.push(this.text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.childs.length < 1 && !this.text)return out;\r\n\t\t\t\t\tif (this.type!==/*laya.webgl.utils.ShaderCompile.IFDEF_NO*/0){\r\n\t\t\t\t\t\tvar ifdef=!!this.condition.call(def);\r\n\t\t\t\t\t\tthis.type===/*laya.webgl.utils.ShaderCompile.IFDEF_ELSE*/2 && (ifdef=!ifdef);\r\n\t\t\t\t\t\tif (!ifdef)return out;\r\n\t\t\t\t\t\tthis.text && out.push(this.text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.childs.length > 0 && this.childs.forEach(function(o,index,arr){\r\n\t\t\t\t\t\to.toscript(def,out)\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn out;\r\n\t\t\t\t}\r\n\t\t\t\treturn ShaderScriptBlock;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn ShaderCompile;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*<code>Shader3D</code> 主要用数组的方式保存shader变量定义，后期合并ShaderValue不使用for in，性能较高。\r\n\t*/\r\n\t//class laya.webgl.utils.ValusArray\r\n\tvar ValusArray=(function(){\r\n\t\tfunction ValusArray(){\r\n\t\t\tthis._data=[];\r\n\t\t\tthis._length=0;\r\n\t\t\tthis._data._length=0;\r\n\t\t}\r\n\r\n\t\t__class(ValusArray,'laya.webgl.utils.ValusArray');\r\n\t\tvar __proto=ValusArray.prototype;\r\n\t\t__proto.pushValue=function(name,value){\r\n\t\t\tthis.setValue(this._length,name,value);\r\n\t\t\tthis._length+=2;\r\n\t\t}\r\n\r\n\t\t__proto.setValue=function(index,name,value){\r\n\t\t\tthis._data[index++]=name;\r\n\t\t\tthis._data[index]=value;\r\n\t\t}\r\n\r\n\t\t__proto.pushArray=function(value){\r\n\t\t\tvar data=this._data;\r\n\t\t\tvar len=this._length;\r\n\t\t\tvar inData=value._data;\r\n\t\t\tvar dec;\r\n\t\t\tfor (var i=0,n=value.length;i < n;i++,len++){\r\n\t\t\t\tdata[len++]=inData[i++];\r\n\t\t\t\tdata[len]=inData[i];\r\n\t\t\t}\r\n\t\t\tthis._length=len;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'data',function(){\r\n\t\t\treturn this._data;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'length',function(){\r\n\t\t\treturn this._length;\r\n\t\t\t},function(value){\r\n\t\t\tthis._length=value;\r\n\t\t});\r\n\r\n\t\treturn ValusArray;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.webgl.WebGL\r\n\tvar WebGL=(function(){\r\n\t\tfunction WebGL(){};\r\n\t\t__class(WebGL,'laya.webgl.WebGL');\r\n\t\tWebGL._float32ArraySlice=function(){\r\n\t\t\tvar _this=/*__JS__ */this;\r\n\t\t\tvar sz=_this.length;\r\n\t\t\tvar dec=new Float32Array(_this.length);\r\n\t\t\tfor (var i=0;i < sz;i++)dec[i]=_this[i];\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\tWebGL._uint16ArraySlice=function(__arg){\r\n\t\t\tvar arg=arguments;\r\n\t\t\tvar _this=/*__JS__ */this;\r\n\t\t\tvar sz=0;\r\n\t\t\tvar dec;\r\n\t\t\tvar i=0;\r\n\t\t\tif (arg.length===0){\r\n\t\t\t\tsz=_this.length;\r\n\t\t\t\tdec=new Uint16Array(sz);\r\n\t\t\t\tfor (i=0;i < sz;i++)\r\n\t\t\t\tdec[i]=_this[i];\r\n\t\t\t\t}else if (arg.length===2){\r\n\t\t\t\tvar start=arg[0];\r\n\t\t\t\tvar end=arg[1];\r\n\t\t\t\tif (end > start){\r\n\t\t\t\t\tsz=end-start;\r\n\t\t\t\t\tdec=new Uint16Array(sz);\r\n\t\t\t\t\tfor (i=start;i < end;i++)\r\n\t\t\t\t\tdec[i-start]=_this[i];\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tdec=new Uint16Array(0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\tWebGL.expandContext=function(){\r\n\t\t\tvar from=Context.prototype;\r\n\t\t\tvar to=/*__JS__ */CanvasRenderingContext2D.prototype;\r\n\t\t\tto.fillTrangles=from.fillTrangles;\r\n\t\t\tBuffer2D.__int__(null);\r\n\t\t\tto.setIBVB=function (x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset){\r\n\t\t\t\t(startIndex===void 0)&& (startIndex=0);\r\n\t\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t\tif (ib===null){\r\n\t\t\t\t\tthis._ib=this._ib || IndexBuffer2D.QuadrangleIB;\r\n\t\t\t\t\tib=this._ib;\r\n\t\t\t\t\tGlUtils.expandIBQuadrangle(ib,(vb.byteLength / (4 *16)+8));\r\n\t\t\t\t}\r\n\t\t\t\tthis._setIBVB(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset);\r\n\t\t\t};\r\n\t\t\tto.fillTrangles=function (tex,x,y,points,m){\r\n\t\t\t\tthis._curMat=this._curMat || Matrix.create();\r\n\t\t\t\tthis._vb=this._vb || VertexBuffer2D.create();\r\n\t\t\t\tif (!this._ib){\r\n\t\t\t\t\tthis._ib=IndexBuffer2D.create();\r\n\t\t\t\t\tGlUtils.fillIBQuadrangle(this._ib,length / 4);\r\n\t\t\t\t};\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar length=points.length >> 4;\r\n\t\t\t\tGlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,0,0);\r\n\t\t\t\tGlUtils.expandIBQuadrangle(this._ib,(vb.byteLength / (4 *16)+8));\r\n\t\t\t\tvar shaderValues=new Value2D(0x01,0);\r\n\t\t\t\tshaderValues.textureHost=tex;\r\n\t\t\t\tvar sd=new Shader2X(\"attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }\",\"precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}\");\r\n\t\t\t\t/*__JS__ */vb._vertType=3;\r\n\t\t\t\tthis._setIBVB(x,y,this._ib,vb,length *6,m,sd,shaderValues,0,0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.enable=function(){\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tif (!Render.isConchWebGL){\r\n\t\t\t\t\tRunDriver.skinAniSprite=function (){\r\n\t\t\t\t\t\tvar tSkinSprite=new SkinMesh()\r\n\t\t\t\t\t\treturn tSkinSprite;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tWebGL.expandContext();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!WebGL.isWebGLSupported())return false;\r\n\t\t\tif (Render.isWebGL)return true;\r\n\t\t\tHTMLImage.create=function (src,def){\r\n\t\t\t\treturn new WebGLImage(src,def);\r\n\t\t\t}\r\n\t\t\tRender.WebGL=WebGL;\r\n\t\t\tRender.isWebGL=true;\r\n\t\t\tDrawText.__init__();\r\n\t\t\tRunDriver.createRenderSprite=function (type,next){\r\n\t\t\t\treturn new RenderSprite3D(type,next);\r\n\t\t\t}\r\n\t\t\tRunDriver.createWebGLContext2D=function (c){\r\n\t\t\t\treturn new WebGLContext2D(c);\r\n\t\t\t}\r\n\t\t\tRunDriver.changeWebGLSize=function (width,height){\r\n\t\t\t\tlaya.webgl.WebGL.onStageResize(width,height);\r\n\t\t\t}\r\n\t\t\tRunDriver.createGraphics=function (){\r\n\t\t\t\treturn new GraphicsGL();\r\n\t\t\t};\r\n\t\t\tvar action=RunDriver.createFilterAction;\r\n\t\t\tRunDriver.createFilterAction=action ? action :function (type){\r\n\t\t\t\treturn new ColorFilterActionGL()\r\n\t\t\t}\r\n\t\t\tRunDriver.clear=function (color){\r\n\t\t\t\tRenderState2D.worldScissorTest && laya.webgl.WebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tif (color==null){\r\n\t\t\t\t\tRender.context.ctx.clearBG(0,0,0,0);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar c=Color.create(color)._color;\r\n\t\t\t\t\tRender.context.ctx.clearBG(c[0],c[1],c[2],c[3]);\r\n\t\t\t\t}\r\n\t\t\t\tRenderState2D.clear();\r\n\t\t\t}\r\n\t\t\tRunDriver.addToAtlas=function (texture,force){\r\n\t\t\t\t(force===void 0)&& (force=false);\r\n\t\t\t\tvar bitmap=texture.bitmap;\r\n\t\t\t\tif (!Render.optimizeTextureMemory(texture.url,texture)){\r\n\t\t\t\t\t(bitmap).enableMerageInAtlas=false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ((Laya.__typeof(bitmap,'laya.webgl.resource.IMergeAtlasBitmap'))&& ((bitmap).allowMerageInAtlas)){\r\n\t\t\t\t\tbitmap.on(/*laya.events.Event.RECOVERED*/\"recovered\",texture,texture.addTextureToAtlas);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tAtlasResourceManager._enable();\r\n\t\t\tRunDriver.beginFlush=function (){\r\n\t\t\t\tvar atlasResourceManager=AtlasResourceManager.instance;\r\n\t\t\t\tvar count=atlasResourceManager.getAtlaserCount();\r\n\t\t\t\tfor (var i=0;i < count;i++){\r\n\t\t\t\t\tvar atlerCanvas=atlasResourceManager.getAtlaserByIndex(i).texture;\r\n\t\t\t\t\t(atlerCanvas._flashCacheImageNeedFlush)&& (RunDriver.flashFlushImage(atlerCanvas));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tRunDriver.drawToCanvas=function (sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){\r\n\t\t\t\tvar renderTarget=new RenderTarget2D(canvasWidth,canvasHeight,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,0,false);\r\n\t\t\t\trenderTarget.start();\r\n\t\t\t\trenderTarget.clear(1.0,0.0,0.0,1.0);\r\n\t\t\t\tsprite.render(Render.context,-offsetX,RenderState2D.height-canvasHeight-offsetY);\r\n\t\t\t\tRender.context.flush();\r\n\t\t\t\trenderTarget.end();\r\n\t\t\t\tvar pixels=renderTarget.getData(0,0,renderTarget.width,renderTarget.height);\r\n\t\t\t\trenderTarget.dispose();\r\n\t\t\t\treturn pixels;\r\n\t\t\t}\r\n\t\t\tRunDriver.createFilterAction=function (type){\r\n\t\t\t\tvar action;\r\n\t\t\t\tswitch (type){\r\n\t\t\t\t\tcase /*laya.filters.Filter.COLOR*/0x20:\r\n\t\t\t\t\t\taction=new ColorFilterActionGL();\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\treturn action;\r\n\t\t\t}\r\n\t\t\tRunDriver.addTextureToAtlas=function (texture){\r\n\t\t\t\ttexture._uvID++;\r\n\t\t\t\tAtlasResourceManager._atlasRestore++;\r\n\t\t\t\t((texture.bitmap).enableMerageInAtlas)&& (AtlasResourceManager.instance.addToAtlas(texture));\r\n\t\t\t}\r\n\t\t\tRunDriver.getTexturePixels=function (value,x,y,width,height){\r\n\t\t\t\t(Render.context.ctx).clear();\r\n\t\t\t\tvar tSprite=new Sprite();\r\n\t\t\t\ttSprite.graphics.drawTexture(value,-x,-y);\r\n\t\t\t\tvar tRenderTarget=RenderTarget2D.create(width,height);\r\n\t\t\t\ttRenderTarget.start();\r\n\t\t\t\ttRenderTarget.clear(0,0,0,0);\r\n\t\t\t\ttSprite.render(Render.context,0,0);\r\n\t\t\t\t(Render.context.ctx).flush();\r\n\t\t\t\ttRenderTarget.end();\r\n\t\t\t\tvar tUint8Array=tRenderTarget.getData(0,0,width,height);\r\n\t\t\t\tvar tArray=[];\r\n\t\t\t\tvar tIndex=0;\r\n\t\t\t\tfor (var i=height-1;i >=0;i--){\r\n\t\t\t\t\tfor (var j=0;j < width;j++){\r\n\t\t\t\t\t\ttIndex=(i *width+j)*4;\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+1]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+2]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+3]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn tArray;\r\n\t\t\t}\r\n\t\t\tRunDriver.skinAniSprite=function (){\r\n\t\t\t\tvar tSkinSprite=new SkinMesh()\r\n\t\t\t\treturn tSkinSprite;\r\n\t\t\t}\r\n\t\t\tFilter._filterStart=function (scope,sprite,context,x,y){\r\n\t\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\t\tvar source=RenderTarget2D.create(b.width,b.height);\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t\tscope.addValue(\"src\",source);\r\n\t\t\t\tscope.addValue(\"ScissorTest\",RenderState2D.worldScissorTest);\r\n\t\t\t\tif (RenderState2D.worldScissorTest){\r\n\t\t\t\t\tvar tClilpRect=new Rectangle();\r\n\t\t\t\t\ttClilpRect.copyFrom((context.ctx)._clipRect)\r\n\t\t\t\t\tscope.addValue(\"clipRect\",tClilpRect);\r\n\t\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t\t\tlaya.webgl.WebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFilter._filterEnd=function (scope,sprite,context,x,y){\r\n\t\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tvar out=RenderTarget2D.create(b.width,b.height);\r\n\t\t\t\tout.start();\r\n\t\t\t\tout.clear(0,0,0,0);\r\n\t\t\t\tscope.addValue(\"out\",out);\r\n\t\t\t\tsprite._set$P('_filterCache',out);\r\n\t\t\t\tsprite._set$P('_isHaveGlowFilter',scope.getValue(\"_isHaveGlowFilter\"));\r\n\t\t\t}\r\n\t\t\tFilter._EndTarget=function (scope,context){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.recycle();\r\n\t\t\t\tvar out=scope.getValue(\"out\");\r\n\t\t\t\tout.end();\r\n\t\t\t\tvar b=scope.getValue(\"ScissorTest\");\r\n\t\t\t\tif (b){\r\n\t\t\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\t\t\tlaya.webgl.WebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\tvar tClipRect=scope.getValue(\"clipRect\");\r\n\t\t\t\t\t(context.ctx).clipRect(tClipRect.x,tClipRect.y,tClipRect.width,tClipRect.height);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFilter._useSrc=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"out\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tsource=scope.getValue(\"src\");\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t}\r\n\t\t\tFilter._endSrc=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t}\r\n\t\t\tFilter._useOut=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tsource=scope.getValue(\"out\");\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t}\r\n\t\t\tFilter._endOut=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"out\");\r\n\t\t\t\tsource.end();\r\n\t\t\t}\r\n\t\t\tFilter._recycleScope=function (scope){\r\n\t\t\t\tscope.recycle();\r\n\t\t\t}\r\n\t\t\tFilter._filter=function (sprite,context,x,y){\r\n\t\t\t\tvar next=this._next;\r\n\t\t\t\tif (next){\r\n\t\t\t\t\tvar filters=sprite.filters,len=filters.length;\r\n\t\t\t\t\tif (len==1 && (filters[0].type==/*laya.filters.Filter.COLOR*/0x20)){\r\n\t\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\t\tcontext.ctx.setFilters([filters[0]]);\r\n\t\t\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\t\t\tcontext.ctx.restore();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar shaderValue;\r\n\t\t\t\t\tvar b;\r\n\t\t\t\t\tvar scope=SubmitCMDScope.create();\r\n\t\t\t\t\tvar p=Point.TEMP;\r\n\t\t\t\t\tvar tMatrix=context.ctx._getTransformMatrix();\r\n\t\t\t\t\tvar mat=Matrix.create();\r\n\t\t\t\t\ttMatrix.copyTo(mat);\r\n\t\t\t\t\tvar tPadding=0;\r\n\t\t\t\t\tvar tHalfPadding=0;\r\n\t\t\t\t\tvar tIsHaveGlowFilter=false;\r\n\t\t\t\t\tvar out=sprite._$P._filterCache ? sprite._$P._filterCache :null;\r\n\t\t\t\t\tif (!out || sprite._repaint){\r\n\t\t\t\t\t\ttIsHaveGlowFilter=sprite._isHaveGlowFilter();\r\n\t\t\t\t\t\tscope.addValue(\"_isHaveGlowFilter\",tIsHaveGlowFilter);\r\n\t\t\t\t\t\tif (tIsHaveGlowFilter){\r\n\t\t\t\t\t\t\ttPadding=50;\r\n\t\t\t\t\t\t\ttHalfPadding=25;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb=new Rectangle();\r\n\t\t\t\t\t\tb.copyFrom((sprite).getBounds());\r\n\t\t\t\t\t\tvar tSX=b.x;\r\n\t\t\t\t\t\tvar tSY=b.y;\r\n\t\t\t\t\t\tb.width+=tPadding;\r\n\t\t\t\t\t\tb.height+=tPadding;\r\n\t\t\t\t\t\tp.x=b.x *mat.a+b.y *mat.c;\r\n\t\t\t\t\t\tp.y=b.y *mat.d+b.x *mat.b;\r\n\t\t\t\t\t\tb.x=p.x;\r\n\t\t\t\t\t\tb.y=p.y;\r\n\t\t\t\t\t\tp.x=b.width *mat.a+b.height *mat.c;\r\n\t\t\t\t\t\tp.y=b.height *mat.d+b.width *mat.b;\r\n\t\t\t\t\t\tb.width=p.x;\r\n\t\t\t\t\t\tb.height=p.y;\r\n\t\t\t\t\t\tif (b.width <=0 || b.height <=0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tout && out.recycle();\r\n\t\t\t\t\t\tscope.addValue(\"bounds\",b);\r\n\t\t\t\t\t\tvar submit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterStart);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t(context.ctx)._renderKey=0;\r\n\t\t\t\t\t\t(context.ctx)._shader2D.glTexture=null;\r\n\t\t\t\t\t\tvar tX=sprite.x-tSX+tHalfPadding;\r\n\t\t\t\t\t\tvar tY=sprite.y-tSY+tHalfPadding;\r\n\t\t\t\t\t\tnext._fun.call(next,sprite,context,tX,tY);\r\n\t\t\t\t\t\tsubmit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterEnd);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\tfor (var i=0;i < len;i++){\r\n\t\t\t\t\t\t\tif (i !=0){\r\n\t\t\t\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._useSrc);\r\n\t\t\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t\t\tshaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\t\t\t\tcontext.ctx.drawTarget(scope,0,0,b.width,b.height,Matrix.TEMP,\"out\",shaderValue,null,BlendMode.TOINT.overlay);\r\n\t\t\t\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._useOut);\r\n\t\t\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tvar fil=filters[i];\r\n\t\t\t\t\t\t\tfil.action.apply3d(scope,sprite,context,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubmit=SubmitCMD.create([scope,context],Filter._EndTarget);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\ttIsHaveGlowFilter=sprite._$P._isHaveGlowFilter ? sprite._$P._isHaveGlowFilter :false;\r\n\t\t\t\t\t\tif (tIsHaveGlowFilter){\r\n\t\t\t\t\t\t\ttPadding=50;\r\n\t\t\t\t\t\t\ttHalfPadding=25;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb=sprite.getBounds();\r\n\t\t\t\t\t\tif (b.width <=0 || b.height <=0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb.width+=tPadding;\r\n\t\t\t\t\t\tb.height+=tPadding;\r\n\t\t\t\t\t\tp.x=b.x *mat.a+b.y *mat.c;\r\n\t\t\t\t\t\tp.y=b.y *mat.d+b.x *mat.b;\r\n\t\t\t\t\t\tb.x=p.x;\r\n\t\t\t\t\t\tb.y=p.y;\r\n\t\t\t\t\t\tp.x=b.width *mat.a+b.height *mat.c;\r\n\t\t\t\t\t\tp.y=b.height *mat.d+b.width *mat.b;\r\n\t\t\t\t\t\tb.width=p.x;\r\n\t\t\t\t\t\tb.height=p.y;\r\n\t\t\t\t\t\tscope.addValue(\"out\",out);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx=x-tHalfPadding-sprite.x;\r\n\t\t\t\t\ty=y-tHalfPadding-sprite.y;\r\n\t\t\t\t\tp.setTo(x,y);\r\n\t\t\t\t\tmat.transformPoint(p);\r\n\t\t\t\t\tx=p.x+b.x;\r\n\t\t\t\t\ty=p.y+b.y;\r\n\t\t\t\t\tshaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\t(context.ctx).drawTarget(scope,x,y,b.width,b.height,Matrix.TEMP,\"out\",shaderValue,null,BlendMode.TOINT.overlay);\r\n\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._recycleScope);\r\n\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\tmat.destroy();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFloat32Array.prototype.slice || (Float32Array.prototype.slice=WebGL._float32ArraySlice);\r\n\t\t\tUint16Array.prototype.slice || (Uint16Array.prototype.slice=WebGL._uint16ArraySlice);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tWebGL.isWebGLSupported=function(){\r\n\t\t\tvar canvas=Browser.createElement('canvas');\r\n\t\t\tvar gl;\r\n\t\t\tvar names=[\"webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"];\r\n\t\t\tfor (var i=0;i < names.length;i++){\r\n\t\t\t\ttry {\r\n\t\t\t\t\tgl=canvas.getContext(names[i]);\r\n\t\t\t\t}catch (e){}\r\n\t\t\t\tif (gl)return names[i];\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tWebGL.onStageResize=function(width,height){\r\n\t\t\tWebGL.mainContext.viewport(0,0,width,height);\r\n\t\t\tRenderState2D.width=width;\r\n\t\t\tRenderState2D.height=height;\r\n\t\t}\r\n\r\n\t\tWebGL.isExperimentalWebgl=function(){\r\n\t\t\treturn WebGL._isExperimentalWebgl;\r\n\t\t}\r\n\r\n\t\tWebGL.addRenderFinish=function(){\r\n\t\t\tif (WebGL._isExperimentalWebgl || Render.isFlash){\r\n\t\t\t\tRunDriver.endFinish=function (){\r\n\t\t\t\t\tRender.context.ctx.finish();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.removeRenderFinish=function(){\r\n\t\t\tif (WebGL._isExperimentalWebgl){\r\n\t\t\t\tRunDriver.endFinish=function (){}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.onInvalidGLRes=function(){\r\n\t\t\tAtlasResourceManager.instance.freeAll();\r\n\t\t\tResourceManager.releaseContentManagers(true);\r\n\t\t\tWebGL.doNodeRepaint(Laya.stage);\r\n\t\t\tWebGL.mainContext.viewport(0,0,RenderState2D.width,RenderState2D.height);\r\n\t\t\tLaya.stage.event(/*laya.events.Event.DEVICE_LOST*/\"devicelost\");\r\n\t\t}\r\n\r\n\t\tWebGL.doNodeRepaint=function(sprite){\r\n\t\t\t(sprite.numChildren==0)&& (sprite.repaint());\r\n\t\t\tfor (var i=0;i < sprite.numChildren;i++)\r\n\t\t\tWebGL.doNodeRepaint(sprite.getChildAt(i));\r\n\t\t}\r\n\r\n\t\tWebGL.init=function(canvas,width,height){\r\n\t\t\tWebGL.mainCanvas=canvas;\r\n\t\t\tHTMLCanvas._createContext=function (canvas){\r\n\t\t\t\treturn new WebGLContext2D(canvas);\r\n\t\t\t};\r\n\t\t\tvar webGLName=WebGL.isWebGLSupported();\r\n\t\t\tvar gl=WebGL.mainContext=RunDriver.newWebGLContext(canvas,webGLName);\r\n\t\t\tWebGL._isExperimentalWebgl=(webGLName !=\"webgl\" && (Browser.onWeiXin || Browser.onMQQBrowser));\r\n\t\t\tWebGL.frameShaderHighPrecision=false;\r\n\t\t\ttry {\r\n\t\t\t\tvar precisionFormat=laya.webgl.WebGL.mainContext.getShaderPrecisionFormat(/*laya.webgl.WebGLContext.FRAGMENT_SHADER*/0x8B30,/*laya.webgl.WebGLContext.HIGH_FLOAT*/0x8DF2);\r\n\t\t\t\tprecisionFormat.precision ? WebGL.frameShaderHighPrecision=true :WebGL.frameShaderHighPrecision=false;\r\n\t\t\t}catch (e){}\r\n\t\t\tBrowser.window.SetupWebglContext && Browser.window.SetupWebglContext(gl);\r\n\t\t\tWebGL.onStageResize(width,height);\r\n\t\t\tif (WebGL.mainContext==null)\r\n\t\t\t\tthrow new Error(\"webGL getContext err!\");\r\n\t\t\tSystem.__init__();\r\n\t\t\tAtlasResourceManager.__init__();\r\n\t\t\tShaderDefines2D.__init__();\r\n\t\t\tSubmit.__init__();\r\n\t\t\tWebGLContext2D.__init__();\r\n\t\t\tValue2D.__init__();\r\n\t\t\tShader2D.__init__();\r\n\t\t\tBuffer2D.__int__(gl);\r\n\t\t\tBlendMode._init_(gl);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\t/*__JS__ */conch.setOnInvalidGLRes(WebGL.onInvalidGLRes);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.mainCanvas=null\r\n\t\tWebGL.mainContext=null\r\n\t\tWebGL.antialias=true;\r\n\t\tWebGL.frameShaderHighPrecision=false;\r\n\t\tWebGL._bg_null=[0,0,0,0];\r\n\t\tWebGL._isExperimentalWebgl=false;\r\n\t\treturn WebGL;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.WebGLContext\r\n\tvar WebGLContext=(function(){\r\n\t\tfunction WebGLContext(){};\r\n\t\t__class(WebGLContext,'laya.webgl.WebGLContext');\r\n\t\tWebGLContext.UseProgram=function(program){\r\n\t\t\tif (WebGLContext._useProgram===program)return false;\r\n\t\t\tWebGL.mainContext.useProgram(program);\r\n\t\t\tWebGLContext._useProgram=program;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthTest=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthTest && (WebGLContext._depthTest=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.DEPTH_TEST*/0x0B71):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.DEPTH_TEST*/0x0B71));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthMask=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthMask && (WebGLContext._depthMask=value,gl.depthMask(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthFunc=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthFunc && (WebGLContext._depthFunc=value,gl.depthFunc(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setBlend=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._blend && (WebGLContext._blend=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.BLEND*/0x0BE2):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.BLEND*/0x0BE2));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setBlendFunc=function(gl,sFactor,dFactor){\r\n\t\t\t(sFactor!==WebGLContext._sFactor||dFactor!==WebGLContext._dFactor)&& (WebGLContext._sFactor=sFactor,WebGLContext._dFactor=dFactor,gl.blendFunc(sFactor,dFactor));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setCullFace=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._cullFace && (WebGLContext._cullFace=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.CULL_FACE*/0x0B44):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.CULL_FACE*/0x0B44));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setFrontFaceCCW=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._frontFace && (WebGLContext._frontFace=value,gl.frontFace(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.bindTexture=function(gl,target,texture){\r\n\t\t\tgl.bindTexture(target,texture);\r\n\t\t\tWebGLContext.curBindTexTarget=target;\r\n\t\t\tWebGLContext.curBindTexValue=texture;\r\n\t\t}\r\n\r\n\t\tWebGLContext._useProgram=null;\r\n\t\tWebGLContext._depthTest=true;\r\n\t\tWebGLContext._depthMask=1;\r\n\t\tWebGLContext._blend=false;\r\n\t\tWebGLContext._cullFace=false;\r\n\t\tWebGLContext.curBindTexTarget=null\r\n\t\tWebGLContext.curBindTexValue=null\r\n\t\t__static(WebGLContext,\r\n\t\t['_depthFunc',function(){return this._depthFunc=/*CLASS CONST:laya.webgl.WebGLContext.LESS*/0x0201;},'_sFactor',function(){return this._sFactor=/*CLASS CONST:laya.webgl.WebGLContext.ONE*/1;},'_dFactor',function(){return this._dFactor=/*CLASS CONST:laya.webgl.WebGLContext.ZERO*/0;},'_frontFace',function(){return this._frontFace=/*CLASS CONST:laya.webgl.WebGLContext.CCW*/0x0901;}\r\n\t\t]);\r\n\t\tWebGLContext.__init$=function(){\r\n\t\t\t;\r\n\t\t}\r\n\r\n\t\treturn WebGLContext;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.display.GraphicsGL extends laya.display.Graphics\r\n\tvar GraphicsGL=(function(_super){\r\n\t\tfunction GraphicsGL(){\r\n\t\t\tGraphicsGL.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(GraphicsGL,'laya.webgl.display.GraphicsGL',_super);\r\n\t\tvar __proto=GraphicsGL.prototype;\r\n\t\t__proto.setShader=function(shader){\r\n\t\t\tthis._saveToCmd(Render.context._setShader,[shader]);\r\n\t\t}\r\n\r\n\t\t__proto.setIBVB=function(x,y,ib,vb,numElement,shader){\r\n\t\t\tthis._saveToCmd(Render.context._setIBVB,[x,y,ib,vb,numElement,shader]);\r\n\t\t}\r\n\r\n\t\t__proto.drawParticle=function(x,y,ps){\r\n\t\t\tvar pt=RunDriver.createParticleTemplate2D(ps);\r\n\t\t\tpt.x=x;\r\n\t\t\tpt.y=y;\r\n\t\t\tthis._saveToCmd(Render.context._drawParticle,[pt]);\r\n\t\t}\r\n\r\n\t\treturn GraphicsGL;\r\n\t})(Graphics)\r\n\r\n\r\n\t//class laya.webgl.canvas.WebGLContext2D extends laya.resource.Context\r\n\tvar WebGLContext2D=(function(_super){\r\n\t\tvar ContextParams;\r\n\t\tfunction WebGLContext2D(c){\r\n\t\t\tthis._x=0;\r\n\t\t\tthis._y=0;\r\n\t\t\tthis._id=++WebGLContext2D._COUNT;\r\n\t\t\t//this._other=null;\r\n\t\t\tthis._path=null;\r\n\t\t\t//this._primitiveValue2D=null;\r\n\t\t\tthis._drawCount=1;\r\n\t\t\tthis._maxNumEle=0;\r\n\t\t\tthis._clear=false;\r\n\t\t\tthis._isMain=false;\r\n\t\t\tthis._atlasResourceChange=0;\r\n\t\t\tthis._submits=[];\r\n\t\t\tthis._curSubmit=null;\r\n\t\t\tthis._ib=null;\r\n\t\t\tthis._vb=null;\r\n\t\t\t//this._curMat=null;\r\n\t\t\tthis._nBlendType=0;\r\n\t\t\t//this._save=null;\r\n\t\t\t//this._targets=null;\r\n\t\t\t//this._renderKey=NaN;\r\n\t\t\tthis._saveMark=null;\r\n\t\t\t//this.sprite=null;\r\n\t\t\tthis.mId=-1;\r\n\t\t\tthis.mHaveKey=false;\r\n\t\t\tthis.mHaveLineKey=false;\r\n\t\t\tthis.mX=0;\r\n\t\t\tthis.mY=0;\r\n\t\t\tWebGLContext2D.__super.call(this);\r\n\t\t\tthis._width=99999999;\r\n\t\t\tthis._height=99999999;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tthis._shader2D=new Shader2D();\r\n\t\t\tthis.mOutPoint\r\n\t\t\tthis._canvas=c;\r\n\t\t\tthis._curMat=Matrix.create();\r\n\t\t\tif (Render.isFlash){\r\n\t\t\t\tthis._ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\t\tGlUtils.fillIBQuadrangle(this._ib,16);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tthis._ib=IndexBuffer2D.QuadrangleIB;\r\n\t\t\tthis._vb=VertexBuffer2D.create(-1);\r\n\t\t\tthis._other=ContextParams.DEFAULT;\r\n\t\t\tthis._save=[SaveMark.Create(this)];\r\n\t\t\tthis._save.length=10;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__class(WebGLContext2D,'laya.webgl.canvas.WebGLContext2D',_super);\r\n\t\tvar __proto=WebGLContext2D.prototype;\r\n\t\t__proto.setIsMainContext=function(){\r\n\t\t\tthis._isMain=true;\r\n\t\t}\r\n\r\n\t\t__proto.clearBG=function(r,g,b,a){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.clearColor(r,g,b,a);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.COLOR_BUFFER_BIT*/0x00004000 | /*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100);\r\n\t\t}\r\n\r\n\t\t__proto._getSubmits=function(){\r\n\t\t\treturn this._submits;\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._curMat && this._curMat.destroy();\r\n\t\t\tthis._targets && this._targets.destroy();\r\n\t\t\tthis._vb && this._vb.releaseResource();\r\n\t\t\tthis._ib && (this._ib !=IndexBuffer2D.QuadrangleIB)&& this._ib.releaseResource();\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._vb.clear();\r\n\t\t\tthis._targets && (this._targets.repaint=true);\r\n\t\t\tthis._other=ContextParams.DEFAULT;\r\n\t\t\tthis._clear=true;\r\n\t\t\tthis._repaint=false;\r\n\t\t\tthis._drawCount=1;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._other.lineWidth=this._shader2D.ALPHA=1.0;\r\n\t\t\tthis._nBlendType=0;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tthis._shader2D.fillStyle=this._shader2D.strokeStyle=DrawStyle.DEFAULT;\r\n\t\t\tfor (var i=0,n=this._submits._length;i < n;i++)\r\n\t\t\tthis._submits[i].releaseRender();\r\n\t\t\tthis._submits._length=0;\r\n\t\t\tthis._curMat.identity();\r\n\t\t\tthis._other.clear();\r\n\t\t\tthis._saveMark=this._save[0];\r\n\t\t\tthis._save._length=1;\r\n\t\t}\r\n\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tthis._width=w;\r\n\t\t\tthis._height=h;\r\n\t\t\tthis._targets && (this._targets.size(w,h));\r\n\t\t}\r\n\r\n\t\t__proto._getTransformMatrix=function(){\r\n\t\t\treturn this._curMat;\r\n\t\t}\r\n\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tif (x!==0 || y!==0){\r\n\t\t\t\tSaveTranslate.save(this);\r\n\t\t\t\tif (this._curMat.bTransform){\r\n\t\t\t\t\tSaveTransform.save(this);\r\n\t\t\t\t\tthis._curMat.transformPoint(Point.TEMP.setTo(x,y));\r\n\t\t\t\t\tx=Point.TEMP.x;\r\n\t\t\t\t\ty=Point.TEMP.y;\r\n\t\t\t\t}\r\n\t\t\t\tthis._x+=x;\r\n\t\t\t\tthis._y+=y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.save=function(){\r\n\t\t\tthis._save[this._save._length++]=SaveMark.Create(this);\r\n\t\t}\r\n\r\n\t\t__proto.restore=function(){\r\n\t\t\tvar sz=this._save._length;\r\n\t\t\tif (sz < 1)\r\n\t\t\t\treturn;\r\n\t\t\tfor (var i=sz-1;i >=0;i--){\r\n\t\t\t\tvar o=this._save[i];\r\n\t\t\t\to.restore(this);\r\n\t\t\t\tif (o.isSaveMark()){\r\n\t\t\t\t\tthis._save._length=i;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.measureText=function(text){\r\n\t\t\treturn RunDriver.measureText(text,this._other.font.toString());\r\n\t\t}\r\n\r\n\t\t__proto._fillText=function(txt,words,x,y,fontStr,color,textAlign){\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tvar font=fontStr ? FontInContext.create(fontStr):this._other.font;\r\n\t\t\tif (AtlasResourceManager.enabled){\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA)\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\tDrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,null,-1,x,y);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tvar preDef=this._shader2D.defines.getValue();\r\n\t\t\t\tvar colorAdd=color ? Color.create(color)._color :shader.colorAdd;\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA || colorAdd!==shader.colorAdd || curShader.colorAdd!==shader.colorAdd){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tshader.colorAdd=colorAdd;\r\n\t\t\t\t}\r\n\t\t\t\tDrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,null,-1,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//shader.defines.setValue(preDef);\r\n\t\t__proto.fillWords=function(words,x,y,fontStr,color){\r\n\t\t\twords.length > 0 && this._fillText(null,words,x,y,fontStr,color,null);\r\n\t\t}\r\n\r\n\t\t__proto.fillText=function(txt,x,y,fontStr,color,textAlign){\r\n\t\t\ttxt.length > 0 && this._fillText(txt,null,x,y,fontStr,color,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto.strokeText=function(txt,x,y,fontStr,color,lineWidth,textAlign){\r\n\t\t\tif (txt.length===0)\r\n\t\t\t\treturn;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tvar font=fontStr ? (WebGLContext2D._fontTemp.setFont(fontStr),WebGLContext2D._fontTemp):this._other.font;\r\n\t\t\tif (AtlasResourceManager.enabled){\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t}\r\n\t\t\t\tDrawText.drawText(this,txt,null,this._curMat,font,textAlign || this._other.textAlign,null,color,lineWidth || 1,x,y);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tvar preDef=this._shader2D.defines.getValue();\r\n\t\t\t\tvar colorAdd=color ? Color.create(color)._color :shader.colorAdd;\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA || colorAdd!==shader.colorAdd || curShader.colorAdd!==shader.colorAdd){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tshader.colorAdd=colorAdd;\r\n\t\t\t\t}\r\n\t\t\t\tDrawText.drawText(this,txt,null,this._curMat,font,textAlign || this._other.textAlign,null,color,lineWidth || 1,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//shader.defines.setValue(preDef);\r\n\t\t__proto.fillBorderText=function(txt,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign){\r\n\t\t\tif (txt.length===0)\r\n\t\t\t\treturn;\r\n\t\t\tif (!AtlasResourceManager.enabled){\r\n\t\t\t\tthis.strokeText(txt,x,y,fontStr,borderColor,lineWidth,textAlign);\r\n\t\t\t\tthis.fillText(txt,x,y,fontStr,fillColor,textAlign);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tif (shader.ALPHA!==curShader.ALPHA)\r\n\t\t\t\tshader.glTexture=null;\r\n\t\t\tvar font=fontStr ? (WebGLContext2D._fontTemp.setFont(fontStr),WebGLContext2D._fontTemp):this._other.font;\r\n\t\t\tDrawText.drawText(this,txt,null,this._curMat,font,textAlign || this._other.textAlign,fillColor,borderColor,lineWidth || 1,x,y);\r\n\t\t}\r\n\r\n\t\t__proto.fillRect=function(x,y,width,height,fillStyle){\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,Texture.DEF_UV,this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar pre=this._shader2D.fillStyle;\r\n\t\t\t\tfillStyle && (this._shader2D.fillStyle=DrawStyle.create(fillStyle));\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tif (shader.fillStyle!==curShader.fillStyle || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tvar submit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.color=shader.fillStyle._color._color;\r\n\t\t\t\t\tsubmit.shaderValue.ALPHA=shader.ALPHA;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._shader2D.fillStyle=pre;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.fillTexture=function(texture,x,y,width,height,type,offset,other){\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar w=texture.bitmap.width,h=texture.bitmap.height,uv=texture.uv;\r\n\t\t\tif (w!=other.w||h!=other.h){\r\n\t\t\t\tswitch(type){\r\n\t\t\t\t\tcase \"repeat\":\r\n\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"repeat-x\":\r\n\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\tother.height=texture.height > height?height:texture.height;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase \"repeat-y\":\r\n\t\t\t\t\t\tother.width=texture.width > width?width:texture.width;\r\n\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\tother.w=w;\r\n\t\t\t\tother.h=h;\r\n\t\t\t\tother.uv=[0,0,other.width / w,0,other.width / w,other.height / h,0,other.height / h];\r\n\t\t\t}\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,other.width,other.height,other.uv,this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar submit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,0));\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tvar shaderValue=submit.shaderValue;\r\n\t\t\t\tshaderValue.textureHost=texture;\r\n\t\t\t\tvar tTextureX=uv[0] *w;\r\n\t\t\t\tvar tTextureY=uv[1] *h;\r\n\t\t\t\tvar tTextureW=(uv[2]-uv[0])*w;\r\n\t\t\t\tvar tTextureH=(uv[5]-uv[3])*h;\r\n\t\t\t\tvar tx=-offset.x / w;\r\n\t\t\t\tvar ty=-offset.y / h;\r\n\t\t\t\tshaderValue.u_TexRange[0]=tTextureX / w;\r\n\t\t\t\tshaderValue.u_TexRange[1]=tTextureW / w;\r\n\t\t\t\tshaderValue.u_TexRange[2]=tTextureY / h;\r\n\t\t\t\tshaderValue.u_TexRange[3]=tTextureH / h;\r\n\t\t\t\tshaderValue.u_offset[0]=tx;\r\n\t\t\t\tshaderValue.u_offset[1]=ty;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.setShader=function(shader){\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_SHADER*/0x80000,this._shader2D,true);\r\n\t\t\tthis._shader2D.shader=shader;\r\n\t\t}\r\n\r\n\t\t__proto.setFilters=function(value){\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FILTERS*/0x100000,this._shader2D,true);\r\n\t\t\tthis._shader2D.filters=value;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._drawCount++;\r\n\t\t}\r\n\r\n\t\t__proto.drawTexture=function(tex,x,y,width,height,tx,ty){\r\n\t\t\tthis._drawTextureM(tex,x,y,width,height,tx,ty,null,1);\r\n\t\t}\r\n\r\n\t\t__proto.addTextureVb=function(invb,x,y){\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar vpos=(finalVB._byteLength >> 2);\r\n\t\t\tfinalVB.byteLength=((vpos+/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=finalVB.getFloat32Array();\r\n\t\t\tfor (var i=0,ci=0;i < 16;i+=4){\r\n\t\t\t\tvbdata[vpos++]=invb[i]+x;\r\n\t\t\t\tvbdata[vpos++]=invb[i+1]+y;\r\n\t\t\t\tvbdata[vpos++]=invb[i+2];\r\n\t\t\t\tvbdata[vpos++]=invb[i+3];\r\n\t\t\t}\r\n\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\tfinalVB._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.willDrawTexture=function(tex,alpha){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tif (this.sprite){\r\n\t\t\t\t\tLaya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t};\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA*alpha+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid==this._renderKey)return rid;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar preAlpha=shader.ALPHA;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tshader.ALPHA *=alpha;\r\n\t\t\tthis._renderKey=rid;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tshader.glTexture=webGLImg;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar submit=null;\r\n\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\tthis._curSubmit=submit;\r\n\t\t\tshader.ALPHA=preAlpha;\r\n\t\t\treturn rid;\r\n\t\t}\r\n\r\n\t\t__proto.drawTextures=function(tex,pos,tx,ty){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tthis.sprite && Laya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar pre=this._clipRect;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tif (!this._drawTextureM(tex,pos[0],pos[1],tex.width,tex.height,tx,ty,null,1)){\r\n\t\t\t\talert(\"drawTextures err\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._clipRect=pre;\r\n\t\t\tStat.drawCall+=pos.length / 2;\r\n\t\t\tif (pos.length < 4)\r\n\t\t\t\treturn;\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar sx=this._curMat.a,sy=this._curMat.d;\r\n\t\t\tfor (var i=2,sz=pos.length;i < sz;i+=2){\r\n\t\t\t\tGlUtils.copyPreImgVb(finalVB,(pos[i]-pos[i-2])*sx,(pos[i+1]-pos[i-1])*sy);\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t}\r\n\r\n\t\t__proto._drawTextureM=function(tex,x,y,width,height,tx,ty,m,alpha){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tif (this.sprite){\r\n\t\t\t\t\tLaya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tx+=tx;\r\n\t\t\ty+=ty;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA *alpha+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid!=this._renderKey){\r\n\t\t\t\tthis._renderKey=rid;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar alphaBack=shader.ALPHA;\r\n\t\t\t\tshader.ALPHA *=alpha;\r\n\t\t\t\tshader.glTexture=webGLImg;\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar submit=null;\r\n\t\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\t\tthis._curSubmit=submit;\r\n\t\t\t\tfinalVB=this._curSubmit._vb || this._vb;\r\n\t\t\t\tshader.ALPHA=alphaBack;\r\n\t\t\t}\r\n\t\t\tif (GlUtils.fillRectImgVb(finalVB,this._clipRect,x,y,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tif (AtlasResourceManager.enabled && !this._isMain)\r\n\t\t\t\t\t(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto._repaintSprite=function(){\r\n\t\t\tthis.sprite.repaint();\r\n\t\t}\r\n\r\n\t\t//}\r\n\t\t__proto._drawText=function(tex,x,y,width,height,m,tx,ty,dx,dy){\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid!=this._renderKey){\r\n\t\t\t\tthis._renderKey=rid;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tshader.glTexture=webGLImg;\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar submit=null;\r\n\t\t\t\tvar submitID=NaN;\r\n\t\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\t\tif (AtlasResourceManager.enabled){\r\n\t\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,TextSV.create());\r\n\t\t\t\t}\r\n\t\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\t\tthis._curSubmit=submit;\r\n\t\t\t}\r\n\t\t\ttex.active();\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(finalVB,this._clipRect,x+tx,y+ty,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,dx,dy,true)){\r\n\t\t\t\tif (AtlasResourceManager.enabled && !this._isMain){\r\n\t\t\t\t\t(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\t\t}\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTextureWithTransform=function(tex,x,y,width,height,transform,tx,ty,alpha){\r\n\t\t\tvar curMat=this._curMat;\r\n\t\t\t(tx!==0 || ty!==0)&& (this._x=tx *curMat.a+ty *curMat.c,this._y=ty *curMat.d+tx *curMat.b);\r\n\t\t\tif (transform && curMat.bTransform){\r\n\t\t\t\tMatrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);\r\n\t\t\t\ttransform=WebGLContext2D._tmpMatrix;\r\n\t\t\t\ttransform._checkTransform();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis._x+=curMat.tx;\r\n\t\t\t\tthis._y+=curMat.ty;\r\n\t\t\t}\r\n\t\t\tthis._drawTextureM(tex,x,y,width,height,0,0,transform,alpha);\r\n\t\t\tthis._x=this._y=0;\r\n\t\t}\r\n\r\n\t\t__proto.fillQuadrangle=function(tex,x,y,point4,m){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (tex.bitmap){\r\n\t\t\t\tvar t_tex=tex.bitmap;\r\n\t\t\t\tif (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=t_tex;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\t\tsubmit.shaderValue.glTexture=t_tex;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.fillQuadrangleImgVb(vb,x,y,point4,tex.uv,m || this._curMat,this._x,this._y);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (!submit.shaderValue.fillStyle || !submit.shaderValue.fillStyle.equal(tex)|| shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02);\r\n\t\t\t\t\tsubmit.shaderValue.fillStyle=DrawStyle.create(tex);\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.fillQuadrangleImgVb(vb,x,y,point4,Texture.DEF_UV,m || this._curMat,this._x,this._y);\r\n\t\t\t}\r\n\t\t\tsubmit._numEle+=6;\r\n\t\t}\r\n\r\n\t\t__proto.drawTexture2=function(x,y,pivotX,pivotY,transform,alpha,blendMode,args){\r\n\t\t\tvar curMat=this._curMat;\r\n\t\t\tthis._x=x *curMat.a+y *curMat.c;\r\n\t\t\tthis._y=y *curMat.d+x *curMat.b;\r\n\t\t\tif (transform){\r\n\t\t\t\tif (curMat.bTransform || transform.bTransform){\r\n\t\t\t\t\tMatrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);\r\n\t\t\t\t\ttransform=WebGLContext2D._tmpMatrix;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis._x+=transform.tx+curMat.tx;\r\n\t\t\t\t\tthis._y+=transform.ty+curMat.ty;\r\n\t\t\t\t\ttransform=Matrix.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (alpha===1 && !blendMode)\r\n\t\t\t\tthis._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);\r\n\t\t\telse{\r\n\t\t\t\tvar preAlpha=this._shader2D.ALPHA;\r\n\t\t\t\tvar preblendType=this._nBlendType;\r\n\t\t\t\tthis._shader2D.ALPHA=alpha;\r\n\t\t\t\tblendMode && (this._nBlendType=BlendMode.TOINT(blendMode));\r\n\t\t\t\tthis._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);\r\n\t\t\t\tthis._shader2D.ALPHA=preAlpha;\r\n\t\t\t\tthis._nBlendType=preblendType;\r\n\t\t\t}\r\n\t\t\tthis._x=this._y=0;\r\n\t\t}\r\n\r\n\t\t__proto.drawCanvas=function(canvas,x,y,width,height){\r\n\t\t\tvar src=canvas.context;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (src._targets){\r\n\t\t\t\tthis._submits[this._submits._length++]=SubmitCanvas.create(src,0,null);\r\n\t\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\t\tsrc._targets.drawTo(this,x,y,width,height);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tvar submit=this._submits[this._submits._length++]=SubmitCanvas.create(src,this._shader2D.ALPHA,this._shader2D.filters);\r\n\t\t\t\tvar sx=width / canvas.width;\r\n\t\t\t\tvar sy=height / canvas.height;\r\n\t\t\t\tvar mat=submit._matrix;\r\n\t\t\t\tthis._curMat.copyTo(mat);\r\n\t\t\t\tsx !=1 && sy !=1 && mat.scale(sx,sy);\r\n\t\t\t\tvar tx=mat.tx,ty=mat.ty;\r\n\t\t\t\tmat.tx=mat.ty=0;\r\n\t\t\t\tmat.transformPoint(Point.TEMP.setTo(x,y));\r\n\t\t\t\tmat.translate(Point.TEMP.x+tx,Point.TEMP.y+ty);\r\n\t\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\t}\r\n\t\t\tif (Config.showCanvasMark){\r\n\t\t\t\tthis.save();\r\n\t\t\t\tthis.lineWidth=4;\r\n\t\t\t\tthis.strokeStyle=src._targets ? \"yellow\" :\"green\";\r\n\t\t\t\tthis.strokeRect(x-1,y-1,width+2,height+2,1);\r\n\t\t\t\tthis.strokeRect(x,y,width,height,1);\r\n\t\t\t\tthis.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTarget=function(scope,x,y,width,height,m,proName,shaderValue,uv,blend){\r\n\t\t\t(blend===void 0)&& (blend=-1);\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,uv || Texture.DEF_UV,m || this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tshader.glTexture=null;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar submit=this._curSubmit=SubmitTarget.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,shaderValue,proName);\r\n\t\t\t\tif (blend==-1){\r\n\t\t\t\t\tsubmit.blendType=this._nBlendType;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tsubmit.blendType=blend;\r\n\t\t\t\t}\r\n\t\t\t\tsubmit.scope=scope;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.transform=function(a,b,c,d,tx,ty){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tMatrix.mul(Matrix.TEMP.setTo(a,b,c,d,tx,ty),this._curMat,this._curMat);\r\n\t\t\tthis._curMat._checkTransform();\r\n\t\t}\r\n\r\n\t\t__proto.setTransformByMatrix=function(value){\r\n\t\t\tvalue.copyTo(this._curMat);\r\n\t\t}\r\n\r\n\t\t__proto.transformByMatrix=function(value){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tMatrix.mul(value,this._curMat,this._curMat);\r\n\t\t\tthis._curMat._checkTransform();\r\n\t\t}\r\n\r\n\t\t__proto.rotate=function(angle){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tthis._curMat.rotateEx(angle);\r\n\t\t}\r\n\r\n\t\t__proto.scale=function(scaleX,scaleY){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tthis._curMat.scaleEx(scaleX,scaleY);\r\n\t\t}\r\n\r\n\t\t__proto.clipRect=function(x,y,width,height){\r\n\t\t\twidth *=this._curMat.a;\r\n\t\t\theight *=this._curMat.d;\r\n\t\t\tvar p=Point.TEMP;\r\n\t\t\tthis._curMat.transformPoint(p.setTo(x,y));\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tvar submit=this._curSubmit=SubmitScissor.create(this);\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tsubmit.submitIndex=this._submits._length;\r\n\t\t\tsubmit.submitLength=9999999;\r\n\t\t\tSaveClipRect.save(this,submit);\r\n\t\t\tvar clip=this._clipRect;\r\n\t\t\tvar x1=clip.x,y1=clip.y;\r\n\t\t\tvar r=p.x+width,b=p.y+height;\r\n\t\t\tx1 < p.x && (clip.x=p.x);\r\n\t\t\ty1 < p.y && (clip.y=p.y);\r\n\t\t\tclip.width=Math.min(r,x1+clip.width)-clip.x;\r\n\t\t\tclip.height=Math.min(b,y1+clip.height)-clip.y;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tsubmit.clipRect.copyFrom(clip);\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t}\r\n\r\n\t\t__proto.setIBVB=function(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset,type){\r\n\t\t\t(startIndex===void 0)&& (startIndex=0);\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(type===void 0)&& (type=0);\r\n\t\t\tif (ib===null){\r\n\t\t\t\tif (!Render.isFlash){\r\n\t\t\t\t\tib=this._ib;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar falshVB=vb;\r\n\t\t\t\t\t(falshVB._selfIB)|| (falshVB._selfIB=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4));\r\n\t\t\t\t\tfalshVB._selfIB.clear();\r\n\t\t\t\t\tib=falshVB._selfIB;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.expandIBQuadrangle(ib,(vb.byteLength / (/*laya.webgl.utils.Buffer2D.FLOAT32*/4 *vb.vertexStride *4)));\r\n\t\t\t}\r\n\t\t\tif (!shaderValues || !shader)\r\n\t\t\t\tthrow Error(\"setIBVB must input:shader shaderValues\");\r\n\t\t\tvar submit=SubmitOtherIBVB.create(this,vb,ib,numElement,shader,shaderValues,startIndex,offset,type);\r\n\t\t\tmat || (mat=Matrix.EMPTY);\r\n\t\t\tmat.translate(x,y);\r\n\t\t\tMatrix.mul(mat,this._curMat,submit._mat);\r\n\t\t\tmat.translate(-x,-y);\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t}\r\n\r\n\t\t__proto.addRenderObject=function(o){\r\n\t\t\tthis._submits[this._submits._length++]=o;\r\n\t\t}\r\n\r\n\t\t__proto.fillTrangles=function(tex,x,y,points,m){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\tvar length=points.length >> 4;\r\n\t\t\tvar t_tex=tex.bitmap;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t}\r\n\t\t\tGlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,this._x,this._y);\r\n\t\t\tsubmit._numEle+=length *6;\r\n\t\t}\r\n\r\n\t\t__proto.submitElement=function(start,end){\r\n\t\t\tvar renderList=this._submits;\r\n\t\t\tend < 0 && (end=renderList._length);\r\n\t\t\twhile (start < end){\r\n\t\t\t\tstart+=renderList[start].renderSubmit();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.finish=function(){\r\n\t\t\tWebGL.mainContext.finish();\r\n\t\t}\r\n\r\n\t\t__proto.flush=function(){\r\n\t\t\tvar maxNum=Math.max(this._vb.byteLength / (/*laya.webgl.utils.Buffer2D.FLOAT32*/4 *16),this._maxNumEle / 6)+8;\r\n\t\t\tif (maxNum > (this._ib.bufferLength / (6 */*laya.webgl.utils.Buffer2D.SHORT*/2))){\r\n\t\t\t\tGlUtils.expandIBQuadrangle(this._ib,maxNum);\r\n\t\t\t}\r\n\t\t\tif (!this._isMain && AtlasResourceManager.enabled && AtlasResourceManager._atlasRestore > this._atlasResourceChange){\r\n\t\t\t\tthis._atlasResourceChange=AtlasResourceManager._atlasRestore;\r\n\t\t\t\tvar renderList=this._submits;\r\n\t\t\t\tfor (var i=0,s=renderList._length;i < s;i++){\r\n\t\t\t\t\tvar submit=renderList [i];\r\n\t\t\t\t\tif (submit.getRenderType()===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016)\r\n\t\t\t\t\t\t(submit).checkTexture();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.submitElement(0,this._submits._length);\r\n\t\t\tthis._path && this._path.reset();\r\n\t\t\tSkinMeshBuffer.instance && SkinMeshBuffer.getInstance().reset();\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\treturn this._submits._length;\r\n\t\t}\r\n\r\n\t\t__proto.setPathId=function(id){\r\n\t\t\tthis.mId=id;\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tthis.mHaveKey=false;\r\n\t\t\t\tvar tVGM=VectorGraphManager.getInstance();\r\n\t\t\t\tif (tVGM.shapeDic[this.mId]){\r\n\t\t\t\t\tthis.mHaveKey=true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.mHaveLineKey=false;\r\n\t\t\t\tif (tVGM.shapeLineDic[this.mId]){\r\n\t\t\t\t\tthis.mHaveLineKey=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.movePath=function(x,y){\r\n\t\t\tthis.mX+=x;\r\n\t\t\tthis.mY+=y;\r\n\t\t}\r\n\r\n\t\t__proto.beginPath=function(){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\ttPath.tempArray.length=0;\r\n\t\t\ttPath.closePath=false;\r\n\t\t\tthis.mX=0;\r\n\t\t\tthis.mY=0;\r\n\t\t}\r\n\r\n\t\t__proto.closePath=function(){\r\n\t\t\tthis._path.closePath=true;\r\n\t\t}\r\n\r\n\t\t__proto.fill=function(isConvexPolygon){\r\n\t\t\t(isConvexPolygon===void 0)&& (isConvexPolygon=false);\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tthis.drawPoly(0,0,tPath.tempArray,this.fillStyle._color.numColor,0,0,isConvexPolygon);\r\n\t\t}\r\n\r\n\t\t__proto.stroke=function(){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (this.lineWidth > 0){\r\n\t\t\t\tif (this.mId==-1){\r\n\t\t\t\t\ttPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tif (this.mHaveLineKey){\r\n\t\t\t\t\t\tvar tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];\r\n\t\t\t\t\t\ttPath.setGeomtry(tShapeLine);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tVectorGraphManager.getInstance().addLine(this.mId,tPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttPath.update();\r\n\t\t\t\tvar tArray=RenderState2D.getMatrArray();\r\n\t\t\t\tRenderState2D.mat2MatArray(this._curMat,tArray);\r\n\t\t\t\tvar tPosArray=[this.mX,this.mY];\r\n\t\t\t\tvar tempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=tArray;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.line=function(fromX,fromY,toX,toY,lineWidth,mat){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillLineVb(vb,this._clipRect,fromX,fromY,toX,toY,lineWidth,mat)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\t\tif (shader.strokeStyle!==curShader.strokeStyle || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.strokeStyle=shader.strokeStyle;\r\n\t\t\t\t\tsubmit.shaderValue.mainID=/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02;\r\n\t\t\t\t\tsubmit.shaderValue.ALPHA=shader.ALPHA;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tsubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.moveTo=function(x,y){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\ttPath.addPoint(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.lineTo=function(x,y){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\ttPath.addPoint(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.arcTo=function(x1,y1,x2,y2,r){\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tif (this.mHaveKey){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tvar x0=tPath.getEndPointX();\r\n\t\t\tvar y0=tPath.getEndPointY();\r\n\t\t\tvar dx0=NaN,dy0=NaN,dx1=NaN,dy1=NaN,a=NaN,d=NaN,cx=NaN,cy=NaN,a0=NaN,a1=NaN;\r\n\t\t\tvar dir=false;\r\n\t\t\tdx0=x0-x1;\r\n\t\t\tdy0=y0-y1;\r\n\t\t\tdx1=x2-x1;\r\n\t\t\tdy1=y2-y1;\r\n\t\t\tPoint.TEMP.setTo(dx0,dy0);\r\n\t\t\tPoint.TEMP.normalize();\r\n\t\t\tdx0=Point.TEMP.x;\r\n\t\t\tdy0=Point.TEMP.y;\r\n\t\t\tPoint.TEMP.setTo(dx1,dy1);\r\n\t\t\tPoint.TEMP.normalize();\r\n\t\t\tdx1=Point.TEMP.x;\r\n\t\t\tdy1=Point.TEMP.y;\r\n\t\t\ta=Math.acos(dx0 *dx1+dy0 *dy1);\r\n\t\t\tvar tTemp=Math.tan(a / 2.0);\r\n\t\t\td=r / tTemp;\r\n\t\t\tif (d > 10000){\r\n\t\t\t\tthis.lineTo(x1,y1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (dx0 *dy1-dx1 *dy0 <=0.0){\r\n\t\t\t\tcx=x1+dx0 *d+dy0 *r;\r\n\t\t\t\tcy=y1+dy0 *d-dx0 *r;\r\n\t\t\t\ta0=Math.atan2(dx0,-dy0);\r\n\t\t\t\ta1=Math.atan2(-dx1,dy1);\r\n\t\t\t\tdir=false;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tcx=x1+dx0 *d-dy0 *r;\r\n\t\t\t\tcy=y1+dy0 *d+dx0 *r;\r\n\t\t\t\ta0=Math.atan2(-dx0,dy0);\r\n\t\t\t\ta1=Math.atan2(dx1,-dy1);\r\n\t\t\t\tdir=true;\r\n\t\t\t}\r\n\t\t\tthis.arc(cx,cy,r,a0,a1,dir);\r\n\t\t}\r\n\r\n\t\t__proto.arc=function(cx,cy,r,startAngle,endAngle,counterclockwise){\r\n\t\t\t(counterclockwise===void 0)&& (counterclockwise=false);\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tif (this.mHaveKey){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tcx=0;\r\n\t\t\t\tcy=0;\r\n\t\t\t};\r\n\t\t\tvar a=0,da=0,hda=0,kappa=0;\r\n\t\t\tvar dx=0,dy=0,x=0,y=0,tanx=0,tany=0;\r\n\t\t\tvar px=0,py=0,ptanx=0,ptany=0;\r\n\t\t\tvar i=0,ndivs=0,nvals=0;\r\n\t\t\tda=endAngle-startAngle;\r\n\t\t\tif (!counterclockwise){\r\n\t\t\t\tif (Math.abs(da)>=Math.PI *2){\r\n\t\t\t\t\tda=Math.PI *2;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\twhile (da < 0.0){\r\n\t\t\t\t\t\tda+=Math.PI *2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (Math.abs(da)>=Math.PI *2){\r\n\t\t\t\t\tda=-Math.PI *2;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\twhile (da > 0.0){\r\n\t\t\t\t\t\tda-=Math.PI *2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (r < 101){\r\n\t\t\t\tndivs=Math.max(10,da *r / 5);\r\n\t\t\t}\r\n\t\t\telse if (r < 201){\r\n\t\t\t\tndivs=Math.max(10,da *r / 20);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tndivs=Math.max(10,da *r / 40);\r\n\t\t\t}\r\n\t\t\thda=(da / ndivs)/ 2.0;\r\n\t\t\tkappa=Math.abs(4 / 3 *(1-Math.cos(hda))/ Math.sin(hda));\r\n\t\t\tif (counterclockwise)\r\n\t\t\t\tkappa=-kappa;\r\n\t\t\tnvals=0;\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tfor (i=0;i <=ndivs;i++){\r\n\t\t\t\ta=startAngle+da *(i / ndivs);\r\n\t\t\t\tdx=Math.cos(a);\r\n\t\t\t\tdy=Math.sin(a);\r\n\t\t\t\tx=cx+dx *r;\r\n\t\t\t\ty=cy+dy *r;\r\n\t\t\t\tif (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){\r\n\t\t\t\t\ttPath.addPoint(x,y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdx=Math.cos(endAngle);\r\n\t\t\tdy=Math.sin(endAngle);\r\n\t\t\tx=cx+dx *r;\r\n\t\t\ty=cy+dy *r;\r\n\t\t\tif (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){\r\n\t\t\t\ttPath.addPoint(x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.quadraticCurveTo=function(cpx,cpy,x,y){\r\n\t\t\tvar tBezier=Bezier.I;\r\n\t\t\tvar tResultArray=[];\r\n\t\t\tvar tArray=tBezier.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),cpx,cpy,x,y],30,2);\r\n\t\t\tfor (var i=0,n=tArray.length / 2;i < n;i++){\r\n\t\t\t\tthis.lineTo(tArray[i *2],tArray[i *2+1]);\r\n\t\t\t}\r\n\t\t\tthis.lineTo(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.rect=function(x,y,width,height){\r\n\t\t\tthis._other=this._other.make();\r\n\t\t\tthis._other.path || (this._other.path=new Path());\r\n\t\t\tthis._other.path.rect(x,y,width,height);\r\n\t\t}\r\n\r\n\t\t__proto.strokeRect=function(x,y,width,height,parameterLineWidth){\r\n\t\t\tvar tW=parameterLineWidth *0.5;\r\n\t\t\tthis.line(x-tW,y,x+width+tW,y,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x+width,y,x+width,y+height,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x,y,x,y+height,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x-tW,y+height,x+width+tW,y+height,parameterLineWidth,this._curMat);\r\n\t\t}\r\n\r\n\t\t__proto.clip=function(){}\r\n\t\t/**\r\n\t\t*画多边形(用)\r\n\t\t*@param x\r\n\t\t*@param y\r\n\t\t*@param points\r\n\t\t*/\r\n\t\t__proto.drawPoly=function(x,y,points,color,lineWidth,boderColor,isConvexPolygon){\r\n\t\t\t(isConvexPolygon===void 0)&& (isConvexPolygon=false);\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (this.mId==-1){\r\n\t\t\t\ttPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor)\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (this.mHaveKey){\r\n\t\t\t\t\tvar tShape=VectorGraphManager.getInstance().shapeDic[this.mId];\r\n\t\t\t\t\ttPath.setGeomtry(tShape);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tVectorGraphManager.getInstance().addShape(this.mId,tPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttPath.update();\r\n\t\t\tvar tPosArray=[this.mX,this.mY];\r\n\t\t\tvar tArray=RenderState2D.getMatrArray();\r\n\t\t\tRenderState2D.mat2MatArray(this._curMat,tArray);\r\n\t\t\tvar tempSubmit;\r\n\t\t\tif (!isConvexPolygon){\r\n\t\t\t\tvar submit=SubmitStencil.create(4);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=tArray;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t\tsubmit=SubmitStencil.create(5);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t}\r\n\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\ttempSubmit.shaderValue.u_mmat2=tArray;\r\n\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\tif (!isConvexPolygon){\r\n\t\t\t\tsubmit=SubmitStencil.create(3);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t}\r\n\t\t\tif (lineWidth > 0){\r\n\t\t\t\tif (this.mHaveLineKey){\r\n\t\t\t\t\tvar tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];\r\n\t\t\t\t\ttPath.setGeomtry(tShapeLine);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tVectorGraphManager.getInstance().addShape(this.mId,tPath.drawLine(x,y,points,lineWidth,boderColor));\r\n\t\t\t\t}\r\n\t\t\t\ttPath.update();\r\n\t\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=tArray;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*******************************************end矢量绘制***************************************************/\r\n\t\t__proto.drawParticle=function(x,y,pt){\r\n\t\t\tpt.x=x;\r\n\t\t\tpt.y=y;\r\n\t\t\tthis._submits[this._submits._length++]=pt;\r\n\t\t}\r\n\r\n\t\t__proto._getPath=function(){\r\n\t\t\treturn this._path || (this._path=new Path());\r\n\t\t}\r\n\r\n\t\t/*,_shader2D.ALPHA=1*/\r\n\t\t__getset(0,__proto,'globalCompositeOperation',function(){\r\n\t\t\treturn BlendMode.NAMES[this._nBlendType];\r\n\t\t\t},function(value){\r\n\t\t\tvar n=BlendMode.TOINT[value];\r\n\t\t\tn==null || (this._nBlendType===n)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION*/0x10000,this,true),this._curSubmit=Submit.RENDERBASE,this._renderKey=0,this._nBlendType=n);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'strokeStyle',function(){\r\n\t\t\treturn this._shader2D.strokeStyle;\r\n\t\t\t},function(value){\r\n\t\t\tthis._shader2D.strokeStyle.equal(value)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_STROKESTYLE*/0x200,this._shader2D,false),this._shader2D.strokeStyle=DrawStyle.create(value));\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'globalAlpha',function(){\r\n\t\t\treturn this._shader2D.ALPHA;\r\n\t\t\t},function(value){\r\n\t\t\tvalue=Math.floor(value *1000)/ 1000;\r\n\t\t\tif (value !=this._shader2D.ALPHA){\r\n\t\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_ALPHA*/0x1,this._shader2D,true);\r\n\t\t\t\tthis._shader2D.ALPHA=value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'asBitmap',null,function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tthis._targets || (this._targets=new RenderTargetMAX());\r\n\t\t\t\tthis._targets.repaint=true;\r\n\t\t\t\tif (!this._width || !this._height)\r\n\t\t\t\t\tthrow Error(\"asBitmap no size!\");\r\n\t\t\t\tthis._targets.size(this._width,this._height);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tthis._targets=null;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'fillStyle',function(){\r\n\t\t\treturn this._shader2D.fillStyle;\r\n\t\t\t},function(value){\r\n\t\t\tthis._shader2D.fillStyle.equal(value)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FILESTYLE*/0x2,this._shader2D,false),this._shader2D.fillStyle=DrawStyle.create(value));\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'textAlign',function(){\r\n\t\t\treturn this._other.textAlign;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.textAlign===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_TEXTALIGN*/0x8000,this._other,false),this._other.textAlign=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'lineWidth',function(){\r\n\t\t\treturn this._other.lineWidth;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.lineWidth===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_LINEWIDTH*/0x100,this._other,false),this._other.lineWidth=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'textBaseline',function(){\r\n\t\t\treturn this._other.textBaseline;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.textBaseline===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_TEXTBASELINE*/0x4000,this._other,false),this._other.textBaseline=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'font',null,function(str){\r\n\t\t\tif (str==this._other.font.toString())\r\n\t\t\t\treturn;\r\n\t\t\tthis._other=this._other.make();\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FONT*/0x8,this._other,false);\r\n\t\t\tthis._other.font===FontInContext.EMPTY ? (this._other.font=new FontInContext(str)):(this._other.font.setFont(str));\r\n\t\t});\r\n\r\n\t\tWebGLContext2D.__init__=function(){\r\n\t\t\tContextParams.DEFAULT=new ContextParams();\r\n\t\t}\r\n\r\n\t\tWebGLContext2D._SUBMITVBSIZE=32000;\r\n\t\tWebGLContext2D._MAXSIZE=99999999;\r\n\t\tWebGLContext2D._RECTVBSIZE=16;\r\n\t\tWebGLContext2D.MAXCLIPRECT=new Rectangle(0,0,99999999,99999999);\r\n\t\tWebGLContext2D._COUNT=0;\r\n\t\tWebGLContext2D._tmpMatrix=new Matrix();\r\n\t\t__static(WebGLContext2D,\r\n\t\t['_fontTemp',function(){return this._fontTemp=new FontInContext();},'_drawStyleTemp',function(){return this._drawStyleTemp=new DrawStyle(null);}\r\n\t\t]);\r\n\t\tWebGLContext2D.__init$=function(){\r\n\t\t\t//class ContextParams\r\n\t\t\tContextParams=(function(){\r\n\t\t\t\tfunction ContextParams(){\r\n\t\t\t\t\tthis.lineWidth=1;\r\n\t\t\t\t\tthis.path=null;\r\n\t\t\t\t\tthis.textAlign=null;\r\n\t\t\t\t\tthis.textBaseline=null;\r\n\t\t\t\t\tthis.font=FontInContext.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t\t__class(ContextParams,'');\r\n\t\t\t\tvar __proto=ContextParams.prototype;\r\n\t\t\t\t__proto.clear=function(){\r\n\t\t\t\t\tthis.lineWidth=1;\r\n\t\t\t\t\tthis.path && this.path.clear();\r\n\t\t\t\t\tthis.textAlign=this.textBaseline=null;\r\n\t\t\t\t\tthis.font=FontInContext.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t\t__proto.make=function(){\r\n\t\t\t\t\treturn this===ContextParams.DEFAULT ? new ContextParams():this;\r\n\t\t\t\t}\r\n\t\t\t\tContextParams.DEFAULT=null\r\n\t\t\t\treturn ContextParams;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn WebGLContext2D;\r\n\t})(Context)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.Value2D extends laya.webgl.shader.ShaderValue\r\n\tvar Value2D=(function(_super){\r\n\t\tfunction Value2D(mainID,subID){\r\n\t\t\tthis.size=[0,0];\r\n\t\t\tthis.alpha=1.0;\r\n\t\t\t//this.mmat=null;\r\n\t\t\tthis.ALPHA=1.0;\r\n\t\t\t//this.shader=null;\r\n\t\t\t//this.mainID=0;\r\n\t\t\tthis.subID=0;\r\n\t\t\t//this.filters=null;\r\n\t\t\t//this.textureHost=null;\r\n\t\t\t//this.texture=null;\r\n\t\t\t//this.fillStyle=null;\r\n\t\t\t//this.color=null;\r\n\t\t\t//this.strokeStyle=null;\r\n\t\t\t//this.colorAdd=null;\r\n\t\t\t//this.glTexture=null;\r\n\t\t\t//this.u_mmat2=null;\r\n\t\t\t//this._inClassCache=null;\r\n\t\t\tthis._cacheID=0;\r\n\t\t\tValue2D.__super.call(this);\r\n\t\t\tthis.defines=new ShaderDefines2D();\r\n\t\t\tthis.position=Value2D._POSITION;\r\n\t\t\tthis.mainID=mainID;\r\n\t\t\tthis.subID=subID;\r\n\t\t\tthis.textureHost=null;\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.fillStyle=null;\r\n\t\t\tthis.color=null;\r\n\t\t\tthis.strokeStyle=null;\r\n\t\t\tthis.colorAdd=null;\r\n\t\t\tthis.glTexture=null;\r\n\t\t\tthis.u_mmat2=null;\r\n\t\t\tthis._cacheID=mainID|subID;\r\n\t\t\tthis._inClassCache=Value2D._cache[this._cacheID];\r\n\t\t\tif (mainID>0 && !this._inClassCache){\r\n\t\t\t\tthis._inClassCache=Value2D._cache[this._cacheID]=[];\r\n\t\t\t\tthis._inClassCache._length=0;\r\n\t\t\t}\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__class(Value2D,'laya.webgl.shader.d2.value.Value2D',_super);\r\n\t\tvar __proto=Value2D.prototype;\r\n\t\t__proto.setValue=function(value){}\r\n\t\t//throw new Error(\"todo in subclass\");\r\n\t\t__proto.refresh=function(){\r\n\t\t\tvar size=this.size;\r\n\t\t\tsize[0]=RenderState2D.width;\r\n\t\t\tsize[1]=RenderState2D.height;\r\n\t\t\tthis.alpha=this.ALPHA *RenderState2D.worldAlpha;\r\n\t\t\tthis.mmat=RenderState2D.worldMatrix4;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto._ShaderWithCompile=function(){\r\n\t\t\treturn Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID | this.defines._value,Shader2X.create);\r\n\t\t}\r\n\r\n\t\t__proto._withWorldShaderDefines=function(){\r\n\t\t\tvar defs=RenderState2D.worldShaderDefines;\r\n\t\t\tvar sd=Shader.sharders [this.mainID | this.defines._value | defs.getValue()];\r\n\t\t\tif (!sd){\r\n\t\t\t\tvar def={};\r\n\t\t\t\tvar dic;\r\n\t\t\t\tvar name;\r\n\t\t\t\tdic=this.defines.toNameDic();for (name in dic)def[name]=\"\";\r\n\t\t\t\tdic=defs.toNameDic();for (name in dic)def[name]=\"\";\r\n\t\t\t\tsd=Shader.withCompile2D(0,this.mainID,def,this.mainID | this.defines._value| defs.getValue(),Shader2X.create);\r\n\t\t\t};\r\n\t\t\tvar worldFilters=RenderState2D.worldFilters;\r\n\t\t\tif (!worldFilters)return sd;\r\n\t\t\tvar n=worldFilters.length,f;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\t((f=worldFilters[i]))&& f.action.setValue(this);\r\n\t\t\t}\r\n\t\t\treturn sd;\r\n\t\t}\r\n\r\n\t\t__proto.upload=function(){\r\n\t\t\tvar renderstate2d=RenderState2D;\r\n\t\t\tthis.alpha=this.ALPHA *renderstate2d.worldAlpha;\r\n\t\t\tif (RenderState2D.worldMatrix4!==RenderState2D.TEMPMAT4_ARRAY)this.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.WORLDMAT*/0x80);\r\n\t\t\tvar sd=renderstate2d.worldShaderDefines?this._withWorldShaderDefines():(Shader.sharders [this.mainID | this.defines._value] || this._ShaderWithCompile());\r\n\t\t\tvar params;\r\n\t\t\tthis.size[0]=renderstate2d.width,this.size[1]=renderstate2d.height;\r\n\t\t\tthis.mmat=renderstate2d.worldMatrix4;\r\n\t\t\tif (Shader.activeShader!==sd){\r\n\t\t\t\tif (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){\r\n\t\t\t\t\tsd._shaderValueWidth=renderstate2d.width;\r\n\t\t\t\t\tsd._shaderValueHeight=renderstate2d.height;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tparams=sd._params2dQuick2 || sd._make2dQuick2();\r\n\t\t\t\t}\r\n\t\t\t\tsd.upload(this,params);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){\r\n\t\t\t\t\tsd._shaderValueWidth=renderstate2d.width;\r\n\t\t\t\t\tsd._shaderValueHeight=renderstate2d.height;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tparams=(sd._params2dQuick1)|| sd._make2dQuick1();\r\n\t\t\t\t}\r\n\t\t\t\tsd.upload(this,params);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.setFilters=function(value){\r\n\t\t\tthis.filters=value;\r\n\t\t\tif (!value)\r\n\t\t\t\treturn;\r\n\t\t\tvar n=value.length,f;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\tf=value[i];\r\n\t\t\t\tif (f){\r\n\t\t\t\t\tthis.defines.add(f.type);\r\n\t\t\t\t\tf.action.setValue(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.defines.setValue(this.subID);\r\n\t\t}\r\n\r\n\t\t__proto.release=function(){\r\n\t\t\tthis._inClassCache[this._inClassCache._length++]=this;\r\n\t\t\tthis.fillStyle=null;\r\n\t\t\tthis.strokeStyle=null;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\tValue2D._initone=function(type,classT){\r\n\t\t\tValue2D._typeClass[type]=classT;\r\n\t\t\tValue2D._cache[type]=[];\r\n\t\t\tValue2D._cache[type]._length=0;\r\n\t\t}\r\n\r\n\t\tValue2D.__init__=function(){\r\n\t\t\tValue2D._POSITION=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,4 *CONST3D2D.BYTES_PE,0];\r\n\t\t\tValue2D._TEXCOORD=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,4 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,Color2dSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,PrimitiveSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,FillTextureSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,SkinSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,TextureSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01 | /*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40,TextSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01 | /*laya.webgl.shader.d2.ShaderDefines2D.FILTERGLOW*/0x08,TextureSV);\r\n\t\t}\r\n\r\n\t\tValue2D.create=function(mainType,subType){\r\n\t\t\tvar types=Value2D._cache[mainType|subType];\r\n\t\t\tif (types._length)\r\n\t\t\t\treturn types[--types._length];\r\n\t\t\telse\r\n\t\t\treturn new Value2D._typeClass[mainType|subType](subType);\r\n\t\t}\r\n\r\n\t\tValue2D._POSITION=null\r\n\t\tValue2D._TEXCOORD=null\r\n\t\tValue2D._cache=[];\r\n\t\tValue2D._typeClass=[];\r\n\t\tValue2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\treturn Value2D;\r\n\t})(ShaderValue)\r\n\r\n\r\n\t//class laya.webgl.utils.RenderSprite3D extends laya.renders.RenderSprite\r\n\tvar RenderSprite3D=(function(_super){\r\n\t\tfunction RenderSprite3D(type,next){\r\n\t\t\tRenderSprite3D.__super.call(this,type,next);\r\n\t\t}\r\n\r\n\t\t__class(RenderSprite3D,'laya.webgl.utils.RenderSprite3D',_super);\r\n\t\tvar __proto=RenderSprite3D.prototype;\r\n\t\t__proto.onCreate=function(type){\r\n\t\t\tswitch (type){\r\n\t\t\t\tcase 0x20:\r\n\t\t\t\t\tthis._fun=this._blend;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x04:\r\n\t\t\t\t\tthis._fun=this._transform;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._blend=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tvar next=this._next;\r\n\t\t\tvar mask=sprite.mask;\r\n\t\t\tvar submitCMD;\r\n\t\t\tvar submitStencil;\r\n\t\t\tcontext.ctx.save();\r\n\t\t\tif (mask){\r\n\t\t\t\tvar preBlendMode=(context.ctx).globalCompositeOperation;\r\n\t\t\t\tvar tRect=new Rectangle();\r\n\t\t\t\ttRect.copyFrom(mask.getBounds());\r\n\t\t\t\tif (tRect.width > 0 && tRect.height > 0){\r\n\t\t\t\t\tvar scope=SubmitCMDScope.create();\r\n\t\t\t\t\tscope.addValue(\"bounds\",tRect);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope,context],laya.webgl.utils.RenderSprite3D.tmpTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tmask.render(context,-tRect.x,-tRect.y);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.endTmpTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\tcontext.clipRect(x+tRect.x,y+tRect.y,tRect.width,tRect.height);\r\n\t\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\t\tcontext.ctx.restore();\r\n\t\t\t\t\tsubmitStencil=SubmitStencil.create(6);\r\n\t\t\t\t\tpreBlendMode=(context.ctx).globalCompositeOperation;\r\n\t\t\t\t\tsubmitStencil.blendMode=\"mask\";\r\n\t\t\t\t\tcontext.addRenderObject(submitStencil);\r\n\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\tvar shaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\t(context.ctx).drawTarget(scope,x+tRect.x,y+tRect.y,tRect.width,tRect.height,Matrix.TEMP,\"tmpTarget\",shaderValue,Texture.INV_UV,6);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.recycleTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tsubmitStencil=SubmitStencil.create(6);\r\n\t\t\t\t\tsubmitStencil.blendMode=preBlendMode;\r\n\t\t\t\t\tcontext.addRenderObject(submitStencil);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tcontext.ctx.globalCompositeOperation=style.blendMode;\r\n\t\t\t\tnext=this._next;\r\n\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t}\r\n\t\t\tcontext.ctx.restore();\r\n\t\t}\r\n\r\n\t\t__proto._transform=function(sprite,context,x,y){\r\n\t\t\t'use strict';\r\n\t\t\tvar transform=sprite.transform,_next=this._next;\r\n\t\t\tif (transform && _next !=RenderSprite.NORENDER){\r\n\t\t\t\tvar ctx=context.ctx;\r\n\t\t\t\tvar style=sprite._style;\r\n\t\t\t\ttransform.tx=x;\r\n\t\t\t\ttransform.ty=y;\r\n\t\t\t\tvar m2=ctx._getTransformMatrix();\r\n\t\t\t\tvar m1=m2.clone();\r\n\t\t\t\tMatrix.mul(transform,m2,m2);\r\n\t\t\t\tm2._checkTransform();\r\n\t\t\t\t_next._fun.call(_next,sprite,context,0,0);\r\n\t\t\t\tm1.copyTo(m2);\r\n\t\t\t\tm1.destroy();\r\n\t\t\t\ttransform.tx=transform.ty=0;\r\n\t\t\t\t}else {\r\n\t\t\t\t_next._fun.call(_next,sprite,context,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.tmpTarget=function(scope,context){\r\n\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\tvar tmpTarget=RenderTarget2D.create(b.width,b.height);\r\n\t\t\ttmpTarget.start();\r\n\t\t\ttmpTarget.clear(0,0,0,0);\r\n\t\t\tscope.addValue(\"tmpTarget\",tmpTarget);\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.endTmpTarget=function(scope){\r\n\t\t\tvar tmpTarget=scope.getValue(\"tmpTarget\");\r\n\t\t\ttmpTarget.end();\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.recycleTarget=function(scope){\r\n\t\t\tvar tmpTarget=scope.getValue(\"tmpTarget\");\r\n\t\t\ttmpTarget.recycle();\r\n\t\t\tscope.recycle();\r\n\t\t}\r\n\r\n\t\treturn RenderSprite3D;\r\n\t})(RenderSprite)\r\n\r\n\r\n\t//class laya.filters.webgl.ColorFilterActionGL extends laya.filters.webgl.FilterActionGL\r\n\tvar ColorFilterActionGL=(function(_super){\r\n\t\tfunction ColorFilterActionGL(){\r\n\t\t\tthis.data=null;\r\n\t\t\tColorFilterActionGL.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(ColorFilterActionGL,'laya.filters.webgl.ColorFilterActionGL',_super);\r\n\t\tvar __proto=ColorFilterActionGL.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilterActionGL\":true})\r\n\t\t__proto.setValue=function(shader){\r\n\t\t\tshader.colorMat=this.data._mat;\r\n\t\t\tshader.colorAlpha=this.data._alpha;\r\n\t\t}\r\n\r\n\t\t__proto.apply3d=function(scope,sprite,context,x,y){\r\n\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\tvar shaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\tshaderValue.setFilters([this.data]);\r\n\t\t\tvar tMatrix=Matrix.EMPTY;\r\n\t\t\ttMatrix.identity();\r\n\t\t\tcontext.ctx.drawTarget(scope,0,0,b.width,b.height,tMatrix,\"src\",shaderValue);\r\n\t\t}\r\n\r\n\t\treturn ColorFilterActionGL;\r\n\t})(FilterActionGL)\r\n\r\n\r\n\t//class laya.webgl.atlas.Atlaser extends laya.webgl.atlas.AtlasGrid\r\n\tvar Atlaser=(function(_super){\r\n\t\tfunction Atlaser(gridNumX,gridNumY,width,height,atlasID){\r\n\t\t\tthis._atlasCanvas=null;\r\n\t\t\tthis._inAtlasTextureKey=null;\r\n\t\t\tthis._inAtlasTextureBitmapValue=null;\r\n\t\t\tthis._inAtlasTextureOriUVValue=null;\r\n\t\t\tthis._InAtlasWebGLImagesKey=null;\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue=null;\r\n\t\t\tAtlaser.__super.call(this,gridNumX,gridNumY,atlasID);\r\n\t\t\tthis._inAtlasTextureKey=[];\r\n\t\t\tthis._inAtlasTextureBitmapValue=[];\r\n\t\t\tthis._inAtlasTextureOriUVValue=[];\r\n\t\t\tthis._InAtlasWebGLImagesKey=[];\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue=[];\r\n\t\t\tthis._atlasCanvas=new AtlasWebGLCanvas();\r\n\t\t\tthis._atlasCanvas.width=width;\r\n\t\t\tthis._atlasCanvas.height=height;\r\n\t\t\tthis._atlasCanvas.activeResource();\r\n\t\t\tthis._atlasCanvas.lock=true;\r\n\t\t}\r\n\r\n\t\t__class(Atlaser,'laya.webgl.atlas.Atlaser',_super);\r\n\t\tvar __proto=Atlaser.prototype;\r\n\t\t__proto.computeUVinAtlasTexture=function(texture,oriUV,offsetX,offsetY){\r\n\t\t\tvar tex=texture;\r\n\t\t\tvar _width=AtlasResourceManager.atlasTextureWidth;\r\n\t\t\tvar _height=AtlasResourceManager.atlasTextureHeight;\r\n\t\t\tvar u1=offsetX / _width,v1=offsetY / _height,u2=(offsetX+texture.bitmap.width)/ _width,v2=(offsetY+texture.bitmap.height)/ _height;\r\n\t\t\tvar inAltasUVWidth=texture.bitmap.width / _width,inAltasUVHeight=texture.bitmap.height / _height;\r\n\t\t\ttexture.uv=[u1+oriUV[0] *inAltasUVWidth,v1+oriUV[1] *inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3] *inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6] *inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*\r\n\t\t*@param inAtlasRes\r\n\t\t*@return 是否已经存在队列中\r\n\t\t*/\r\n\t\t__proto.addToAtlasTexture=function(mergeAtlasBitmap,offsetX,offsetY){\r\n\t\t\t((mergeAtlasBitmap instanceof laya.webgl.resource.WebGLImage ))&& (this._InAtlasWebGLImagesKey.push(mergeAtlasBitmap),this._InAtlasWebGLImagesOffsetValue.push([offsetX,offsetY]));\r\n\t\t\tthis._atlasCanvas.texSubImage2D(offsetX,offsetY,mergeAtlasBitmap.atlasSource);\r\n\t\t\tmergeAtlasBitmap.clearAtlasSource();\r\n\t\t}\r\n\r\n\t\t__proto.addToAtlas=function(texture,offsetX,offsetY){\r\n\t\t\tvar oriUV=texture.uv.slice();\r\n\t\t\tvar oriBitmap=texture.bitmap;\r\n\t\t\tthis._inAtlasTextureKey.push(texture);\r\n\t\t\tthis._inAtlasTextureOriUVValue.push(oriUV);\r\n\t\t\tthis._inAtlasTextureBitmapValue.push(oriBitmap);\r\n\t\t\tthis.computeUVinAtlasTexture(texture,oriUV,offsetX,offsetY);\r\n\t\t\ttexture.bitmap=this._atlasCanvas;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tfor (var i=0,n=this._inAtlasTextureKey.length;i < n;i++){\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap=this._inAtlasTextureBitmapValue[i];\r\n\t\t\t\tthis._inAtlasTextureKey[i].uv=this._inAtlasTextureOriUVValue[i];\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap.lock=false;\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap.releaseResource();\r\n\t\t\t}\r\n\t\t\tthis._inAtlasTextureKey.length=0;\r\n\t\t\tthis._inAtlasTextureBitmapValue.length=0;\r\n\t\t\tthis._inAtlasTextureOriUVValue.length=0;\r\n\t\t\tthis._InAtlasWebGLImagesKey.length=0;\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue.length=0;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tthis._atlasCanvas.dispose();\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'InAtlasWebGLImagesOffsetValue',function(){\r\n\t\t\treturn this._InAtlasWebGLImagesOffsetValue;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'texture',function(){\r\n\t\t\treturn this._atlasCanvas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'inAtlasWebGLImagesKey',function(){\r\n\t\t\treturn this._InAtlasWebGLImagesKey;\r\n\t\t});\r\n\r\n\t\treturn Atlaser;\r\n\t})(AtlasGrid)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.ShaderDefines2D extends laya.webgl.shader.ShaderDefines\r\n\tvar ShaderDefines2D=(function(_super){\r\n\t\tfunction ShaderDefines2D(){\r\n\t\t\tShaderDefines2D.__super.call(this,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name,ShaderDefines2D.__int2nameMap);\r\n\t\t}\r\n\r\n\t\t__class(ShaderDefines2D,'laya.webgl.shader.d2.ShaderDefines2D',_super);\r\n\t\tShaderDefines2D.__init__=function(){\r\n\t\t\tShaderDefines2D.reg(\"TEXTURE2D\",0x01);\r\n\t\t\tShaderDefines2D.reg(\"COLOR2D\",0x02);\r\n\t\t\tShaderDefines2D.reg(\"PRIMITIVE\",0x04);\r\n\t\t\tShaderDefines2D.reg(\"GLOW_FILTER\",0x08);\r\n\t\t\tShaderDefines2D.reg(\"BLUR_FILTER\",0x10);\r\n\t\t\tShaderDefines2D.reg(\"COLOR_FILTER\",0x20);\r\n\t\t\tShaderDefines2D.reg(\"COLOR_ADD\",0x40);\r\n\t\t\tShaderDefines2D.reg(\"WORLDMAT\",0x80);\r\n\t\t\tShaderDefines2D.reg(\"FILLTEXTURE\",0x100);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.reg=function(name,value){\r\n\t\t\tShaderDefines._reg(name,value,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.toText=function(value,int2name,int2nameMap){\r\n\t\t\treturn ShaderDefines._toText(value,int2name,int2nameMap);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.toInt=function(names){\r\n\t\t\treturn ShaderDefines._toInt(names,ShaderDefines2D.__name2int);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.TEXTURE2D=0x01;\r\n\t\tShaderDefines2D.COLOR2D=0x02;\r\n\t\tShaderDefines2D.PRIMITIVE=0x04;\r\n\t\tShaderDefines2D.FILTERGLOW=0x08;\r\n\t\tShaderDefines2D.FILTERBLUR=0x10;\r\n\t\tShaderDefines2D.FILTERCOLOR=0x20;\r\n\t\tShaderDefines2D.COLORADD=0x40;\r\n\t\tShaderDefines2D.WORLDMAT=0x80;\r\n\t\tShaderDefines2D.FILLTEXTURE=0x100;\r\n\t\tShaderDefines2D.SKINMESH=0x200;\r\n\t\tShaderDefines2D.__name2int={};\r\n\t\tShaderDefines2D.__int2name=[];\r\n\t\tShaderDefines2D.__int2nameMap=[];\r\n\t\treturn ShaderDefines2D;\r\n\t})(ShaderDefines)\r\n\r\n\r\n\t//class laya.webgl.shapes.Ellipse extends laya.webgl.shapes.BasePoly\r\n\tvar Ellipse=(function(_super){\r\n\t\tfunction Ellipse(x,y,width,height,color,borderWidth,borderColor){\r\n\t\t\tEllipse.__super.call(this,x,y,width,height,40,color,borderWidth,borderColor);\r\n\t\t}\r\n\r\n\t\t__class(Ellipse,'laya.webgl.shapes.Ellipse',_super);\r\n\t\treturn Ellipse;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.Line extends laya.webgl.shapes.BasePoly\r\n\tvar Line=(function(_super){\r\n\t\tfunction Line(x,y,points,borderWidth,color){\r\n\t\t\tthis._points=[];\r\n\t\t\tvar tCurrX=NaN;\r\n\t\t\tvar tCurrY=NaN;\r\n\t\t\tvar tLastX=-1;\r\n\t\t\tvar tLastY=-1;\r\n\t\t\tvar tLen=points.length / 2;\r\n\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\ttCurrX=points[i *2];\r\n\t\t\t\ttCurrY=points[i *2+1];\r\n\t\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)>0.01){\r\n\t\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t\t}\r\n\t\t\t\ttLastX=tCurrX;\r\n\t\t\t\ttLastY=tCurrY;\r\n\t\t\t}\r\n\t\t\tLine.__super.call(this,x,y,0,0,0,color,borderWidth,color,0);\r\n\t\t}\r\n\r\n\t\t__class(Line,'laya.webgl.shapes.Line',_super);\r\n\t\tvar __proto=Line.prototype;\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tvar indices=[];\r\n\t\t\tvar verts=[];\r\n\t\t\t(this.borderWidth > 0)&& this.createLine2(this._points,indices,this.borderWidth,start,verts,this._points.length / 2);\r\n\t\t\tib.append(new Uint16Array(indices));\r\n\t\t\tvb.append(new Float32Array(verts));\r\n\t\t}\r\n\r\n\t\treturn Line;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.LoopLine extends laya.webgl.shapes.BasePoly\r\n\tvar LoopLine=(function(_super){\r\n\t\tfunction LoopLine(x,y,points,width,color){\r\n\t\t\tthis._points=[];\r\n\t\t\tvar tCurrX=NaN;\r\n\t\t\tvar tCurrY=NaN;\r\n\t\t\tvar tLastX=-1;\r\n\t\t\tvar tLastY=-1;\r\n\t\t\tvar tLen=points.length / 2-1;\r\n\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\ttCurrX=points[i *2];\r\n\t\t\t\ttCurrY=points[i *2+1];\r\n\t\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){\r\n\t\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t\t}\r\n\t\t\t\ttLastX=tCurrX;\r\n\t\t\t\ttLastY=tCurrY;\r\n\t\t\t}\r\n\t\t\ttCurrX=points[tLen *2];\r\n\t\t\ttCurrY=points[tLen *2+1];\r\n\t\t\ttLastX=this._points[0];\r\n\t\t\ttLastY=this._points[1];\r\n\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){\r\n\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t}\r\n\t\t\tLoopLine.__super.call(this,x,y,0,0,this._points.length / 2,0,width,color);\r\n\t\t}\r\n\r\n\t\t__class(LoopLine,'laya.webgl.shapes.LoopLine',_super);\r\n\t\tvar __proto=LoopLine.prototype;\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tif (this.borderWidth > 0){\r\n\t\t\t\tvar color=this.color;\r\n\t\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\t\tvar verts=[];\r\n\t\t\t\tvar tLastX=-1,tLastY=-1;\r\n\t\t\t\tvar tCurrX=0,tCurrY=0;\r\n\t\t\t\tvar indices=[];\r\n\t\t\t\tvar tLen=Math.floor(this._points.length / 2);\r\n\t\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\t\ttCurrX=this._points[i *2];\r\n\t\t\t\t\ttCurrY=this._points[i *2+1];\r\n\t\t\t\t\tverts.push(this.x+tCurrX,this.y+tCurrY,r,g,b);\r\n\t\t\t\t}\r\n\t\t\t\tthis.createLoopLine(verts,indices,this.borderWidth,start+verts.length / 5);\r\n\t\t\t\tib.append(new Uint16Array(indices));\r\n\t\t\t\tvb.append(new Float32Array(verts));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){\r\n\t\t\tvar tLen=p.length / 5;\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex ? outVertex :p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tvar firstPoint=[points[0],points[1]];\r\n\t\t\tvar lastPoint=[points[points.length-5],points[points.length-4]];\r\n\t\t\tvar midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;\r\n\t\t\tvar midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;\r\n\t\t\tpoints.unshift(midPointX,midPointY,0,0,0);\r\n\t\t\tpoints.push(midPointX,midPointY,0,0,0);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tif (outIndex){\r\n\t\t\t\tindices=outIndex;\r\n\t\t\t};\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\treturn LoopLine;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.Polygon extends laya.webgl.shapes.BasePoly\r\n\tvar Polygon=(function(_super){\r\n\t\tfunction Polygon(x,y,points,color,borderWidth,borderColor){\r\n\t\t\tthis._points=null;\r\n\t\t\tthis._start=-1;\r\n\t\t\tthis.mUint16Array=null;\r\n\t\t\tthis.mFloat32Array=null;\r\n\t\t\tthis._points=points.slice(0,points.length);\r\n\t\t\tPolygon.__super.call(this,x,y,0,0,this._points.length / 2,color,borderWidth,borderColor);\r\n\t\t}\r\n\r\n\t\t__class(Polygon,'laya.webgl.shapes.Polygon',_super);\r\n\t\tvar __proto=Polygon.prototype;\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tvar indices,i=0;\r\n\t\t\tvar tArray=this._points;\r\n\t\t\tvar tLen=0;\r\n\t\t\tif (this.mUint16Array && this.mFloat32Array){\r\n\t\t\t\tif (this._start !=start){\r\n\t\t\t\t\tthis._start=start;\r\n\t\t\t\t\tindices=[];\r\n\t\t\t\t\ttLen=Math.floor(tArray.length / 2);\r\n\t\t\t\t\tfor (i=2;i < tLen;i++){\r\n\t\t\t\t\t\tindices.push(start,start+i-1,start+i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.mUint16Array=new Uint16Array(indices);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._start=start;\r\n\t\t\t\tindices=[];\r\n\t\t\t\tvar verts=[];\r\n\t\t\t\tvar color=this.color;\r\n\t\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\t\ttLen=Math.floor(tArray.length / 2);\r\n\t\t\t\tfor (i=0;i < tLen;i++){\r\n\t\t\t\t\tverts.push(this.x+tArray[i *2],this.y+tArray[i *2+1],r,g,b);\r\n\t\t\t\t}\r\n\t\t\t\tfor (i=2;i < tLen;i++){\r\n\t\t\t\t\tindices.push(start,start+i-1,start+i);\r\n\t\t\t\t}\r\n\t\t\t\tthis.mUint16Array=new Uint16Array(indices);\r\n\t\t\t\tthis.mFloat32Array=new Float32Array(verts);\r\n\t\t\t}\r\n\t\t\tib.append(this.mUint16Array);\r\n\t\t\tvb.append(this.mFloat32Array);\r\n\t\t}\r\n\r\n\t\treturn Polygon;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCanvas extends laya.webgl.submit.Submit\r\n\tvar SubmitCanvas=(function(_super){\r\n\t\tfunction SubmitCanvas(){\r\n\t\t\t//this._ctx_src=null;\r\n\t\t\tthis._matrix=new Matrix();\r\n\t\t\tthis._matrix4=CONST3D2D.defaultMatrix4.concat();\r\n\t\t\tSubmitCanvas.__super.call(this,/*laya.webgl.submit.Submit.TYPE_2D*/10000);\r\n\t\t\tthis.shaderValue=new Value2D(0,0);\r\n\t\t}\r\n\r\n\t\t__class(SubmitCanvas,'laya.webgl.submit.SubmitCanvas',_super);\r\n\t\tvar __proto=SubmitCanvas.prototype;\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._ctx_src._targets){\r\n\t\t\t\tthis._ctx_src._targets.flush(this._ctx_src);\r\n\t\t\t\treturn 1;\r\n\t\t\t};\r\n\t\t\tvar preAlpha=RenderState2D.worldAlpha;\r\n\t\t\tvar preMatrix4=RenderState2D.worldMatrix4;\r\n\t\t\tvar preMatrix=RenderState2D.worldMatrix;\r\n\t\t\tvar preFilters=RenderState2D.worldFilters;\r\n\t\t\tvar preWorldShaderDefines=RenderState2D.worldShaderDefines;\r\n\t\t\tvar v=this.shaderValue;\r\n\t\t\tvar m=this._matrix;\r\n\t\t\tvar m4=this._matrix4;\r\n\t\t\tvar mout=Matrix.TEMP;\r\n\t\t\tMatrix.mul(m,preMatrix,mout);\r\n\t\t\tm4[0]=mout.a;\r\n\t\t\tm4[1]=mout.b;\r\n\t\t\tm4[4]=mout.c;\r\n\t\t\tm4[5]=mout.d;\r\n\t\t\tm4[12]=mout.tx;\r\n\t\t\tm4[13]=mout.ty;\r\n\t\t\tRenderState2D.worldMatrix=mout.clone();\r\n\t\t\tRenderState2D.worldMatrix4=m4;\r\n\t\t\tRenderState2D.worldAlpha=RenderState2D.worldAlpha *v.alpha;\r\n\t\t\tif (v.filters && v.filters.length){\r\n\t\t\t\tRenderState2D.worldFilters=v.filters;\r\n\t\t\t\tRenderState2D.worldShaderDefines=v.defines;\r\n\t\t\t}\r\n\t\t\tthis._ctx_src.flush();\r\n\t\t\tRenderState2D.worldAlpha=preAlpha;\r\n\t\t\tRenderState2D.worldMatrix4=preMatrix4;\r\n\t\t\tRenderState2D.worldMatrix.destroy();\r\n\t\t\tRenderState2D.worldMatrix=preMatrix;\r\n\t\t\tRenderState2D.worldFilters=preFilters;\r\n\t\t\tRenderState2D.worldShaderDefines=preWorldShaderDefines;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitCanvas._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn /*laya.webgl.submit.Submit.TYPE_CANVAS*/10003;\r\n\t\t}\r\n\r\n\t\tSubmitCanvas.create=function(ctx_src,alpha,filters){\r\n\t\t\tvar o=(!SubmitCanvas._cache._length)? (new SubmitCanvas()):SubmitCanvas._cache[--SubmitCanvas._cache._length];\r\n\t\t\to._ctx_src=ctx_src;\r\n\t\t\tvar v=o.shaderValue;\r\n\t\t\tv.alpha=alpha;\r\n\t\t\tv.defines.setValue(0);\r\n\t\t\tfilters && filters.length && v.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitCanvas._cache=(SubmitCanvas._cache=[],SubmitCanvas._cache._length=0,SubmitCanvas._cache);\r\n\t\treturn SubmitCanvas;\r\n\t})(Submit)\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitTexture extends laya.webgl.submit.Submit\r\n\tvar SubmitTexture=(function(_super){\r\n\t\tfunction SubmitTexture(renderType){\r\n\t\t\tthis._preIsSameTextureShader=false;\r\n\t\t\tthis._isSameTexture=true;\r\n\t\t\tthis._texs=new Array;\r\n\t\t\tthis._texsID=new Array;\r\n\t\t\tthis._vbPos=new Array;\r\n\t\t\t(renderType===void 0)&& (renderType=10000);\r\n\t\t\tSubmitTexture.__super.call(this,renderType);\r\n\t\t}\r\n\r\n\t\t__class(SubmitTexture,'laya.webgl.submit.SubmitTexture',_super);\r\n\t\tvar __proto=SubmitTexture.prototype;\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitTexture._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.shaderValue.release();\r\n\t\t\tthis._preIsSameTextureShader=false;\r\n\t\t\tthis._vb=null;\r\n\t\t\tthis._texs.length=0;\r\n\t\t\tthis._isSameTexture=true;\r\n\t\t}\r\n\r\n\t\t__proto.addTexture=function(tex,vbpos){\r\n\t\t\tthis._texsID[this._texs.length]=tex._uvID;\r\n\t\t\tthis._texs.push(tex);\r\n\t\t\tthis._vbPos.push(vbpos);\r\n\t\t}\r\n\r\n\t\t//检查材质是否修改，修改UV，设置是否是同一材质\r\n\t\t__proto.checkTexture=function(){\r\n\t\t\tif (this._texs.length < 1){\r\n\t\t\t\tthis._isSameTexture=true;\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tvar webGLImg=_tex.bitmap;\r\n\t\t\tif (webGLImg===null)return;\r\n\t\t\tvar vbdata=this._vb.getFloat32Array();\r\n\t\t\tfor (var i=0,s=this._texs.length;i < s;i++){\r\n\t\t\t\tvar tex=this._texs[i];\r\n\t\t\t\ttex.active();\r\n\t\t\t\tvar newUV=tex.uv;\r\n\t\t\t\tif (this._texsID[i]!==tex._uvID){\r\n\t\t\t\t\tthis._texsID[i]=tex._uvID;\r\n\t\t\t\t\tvar vbPos=this._vbPos[i];\r\n\t\t\t\t\tvbdata[vbPos+2]=newUV[0];\r\n\t\t\t\t\tvbdata[vbPos+3]=newUV[1];\r\n\t\t\t\t\tvbdata[vbPos+6]=newUV[2];\r\n\t\t\t\t\tvbdata[vbPos+7]=newUV[3];\r\n\t\t\t\t\tvbdata[vbPos+10]=newUV[4];\r\n\t\t\t\t\tvbdata[vbPos+11]=newUV[5];\r\n\t\t\t\t\tvbdata[vbPos+14]=newUV[6];\r\n\t\t\t\t\tvbdata[vbPos+15]=newUV[7];\r\n\t\t\t\t\tthis._vb.setNeedUpload();\r\n\t\t\t\t}\r\n\t\t\t\tif (tex.bitmap!==webGLImg){\r\n\t\t\t\t\tthis._isSameTexture=false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._numEle===0)return 1;\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source){\r\n\t\t\t\t\tSubmitTexture._shaderSet=false;\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\tthis.shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tif (this._preIsSameTextureShader && Shader.activeShader && SubmitTexture._shaderSet)\r\n\t\t\t\tShader.activeShader.uploadTexture2D(this.shaderValue.texture);\r\n\t\t\telse this.shaderValue.upload();\r\n\t\t\tSubmitTexture._shaderSet=true;\r\n\t\t\tif (this._texs.length > 1 && !this._isSameTexture){\r\n\t\t\t\tvar webGLImg=_tex.bitmap;\r\n\t\t\t\tvar index=0;\r\n\t\t\t\tvar shader=Shader.activeShader;\r\n\t\t\t\tfor (var i=0,s=this._texs.length;i < s;i++){\r\n\t\t\t\t\tvar tex2=this._texs[i];\r\n\t\t\t\t\tif (tex2.bitmap!==webGLImg || (i+1)===s){\r\n\t\t\t\t\t\tshader.uploadTexture2D(tex2.source);\r\n\t\t\t\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,(i-index+1)*6,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx+index *6 *CONST3D2D.BYTES_PIDX);\r\n\t\t\t\t\t\twebGLImg=tex2.bitmap;\r\n\t\t\t\t\t\tindex=i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmitTexture.create=function(context,ib,vb,pos,sv){\r\n\t\t\tvar o=SubmitTexture._cache._length ? SubmitTexture._cache[--SubmitTexture._cache._length] :new SubmitTexture();\r\n\t\t\tif (vb==null){\r\n\t\t\t\tvb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));\r\n\t\t\t\tvb.clear();\r\n\t\t\t\tpos=0;\r\n\t\t\t}\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\tvar filters=context._shader2D.filters;\r\n\t\t\tfilters && o.shaderValue.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitTexture._cache=(SubmitTexture._cache=[],SubmitTexture._cache._length=0,SubmitTexture._cache);\r\n\t\tSubmitTexture._shaderSet=true;\r\n\t\treturn SubmitTexture;\r\n\t})(Submit)\r\n\r\n\r\n\t//class laya.webgl.shader.Shader extends laya.resource.Resource\r\n\tvar Shader=(function(_super){\r\n\t\tfunction Shader(vs,ps,saveName,nameMap){\r\n\t\t\tthis.customCompile=false;\r\n\t\t\t//this._nameMap=null;\r\n\t\t\t//this._vs=null;\r\n\t\t\t//this._ps=null;\r\n\t\t\tthis._curActTexIndex=0;\r\n\t\t\t//this._reCompile=false;\r\n\t\t\tthis.tag={};\r\n\t\t\t//this._vshader=null;\r\n\t\t\t//this._pshader=null;\r\n\t\t\tthis._program=null;\r\n\t\t\tthis._params=null;\r\n\t\t\tthis._paramsMap={};\r\n\t\t\tthis._offset=0;\r\n\t\t\t//this._id=0;\r\n\t\t\tShader.__super.call(this);\r\n\t\t\tif ((!vs)|| (!ps))throw \"Shader Error\";\r\n\t\t\tif (Render.isConchApp || Render.isFlash){\r\n\t\t\t\tthis.customCompile=true;\r\n\t\t\t}\r\n\t\t\tthis._id=++Shader._count;\r\n\t\t\tthis._vs=vs;\r\n\t\t\tthis._ps=ps;\r\n\t\t\tthis._nameMap=nameMap ? nameMap :{};\r\n\t\t\tsaveName !=null && (Shader.sharders[saveName]=this);\r\n\t\t}\r\n\r\n\t\t__class(Shader,'laya.webgl.shader.Shader',_super);\r\n\t\tvar __proto=Shader.prototype;\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tthis._compile();\r\n\t\t\tthis.completeCreate();\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t\t//忽略尺寸尺寸\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tWebGL.mainContext.deleteShader(this._vshader);\r\n\t\t\tWebGL.mainContext.deleteShader(this._pshader);\r\n\t\t\tWebGL.mainContext.deleteProgram(this._program);\r\n\t\t\tthis._vshader=this._pshader=this._program=null;\r\n\t\t\tthis._params=null;\r\n\t\t\tthis._paramsMap={};\r\n\t\t\tthis.memorySize=0;\r\n\t\t\tthis._curActTexIndex=0;\r\n\t\t}\r\n\r\n\t\t__proto._compile=function(){\r\n\t\t\tif (!this._vs || !this._ps || this._params)\r\n\t\t\t\treturn;\r\n\t\t\tthis._reCompile=true;\r\n\t\t\tthis._params=[];\r\n\t\t\tvar text=[this._vs,this._ps];\r\n\t\t\tvar result;\r\n\t\t\tif (this.customCompile)\r\n\t\t\t\tresult=this._preGetParams(this._vs,this._ps);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._program=gl.createProgram();\r\n\t\t\tthis._vshader=Shader._createShader(gl,text[0],/*laya.webgl.WebGLContext.VERTEX_SHADER*/0x8B31);\r\n\t\t\tthis._pshader=Shader._createShader(gl,text[1],/*laya.webgl.WebGLContext.FRAGMENT_SHADER*/0x8B30);\r\n\t\t\tgl.attachShader(this._program,this._vshader);\r\n\t\t\tgl.attachShader(this._program,this._pshader);\r\n\t\t\tgl.linkProgram(this._program);\r\n\t\t\tif (!this.customCompile && !gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.LINK_STATUS*/0x8B82)){\r\n\t\t\t\tthrow gl.getProgramInfoLog(this._program);\r\n\t\t\t};\r\n\t\t\tvar one,i=0,j=0,n=0,location;\r\n\t\t\tvar attribNum=this.customCompile ? result.attributes.length :gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.ACTIVE_ATTRIBUTES*/0x8B89);\r\n\t\t\tfor (i=0;i < attribNum;i++){\r\n\t\t\t\tvar attrib=this.customCompile ? result.attributes[i] :gl.getActiveAttrib(this._program,i);\r\n\t\t\t\tlocation=gl.getAttribLocation(this._program,attrib.name);\r\n\t\t\t\tone={vartype:\"attribute\",ivartype:0,attrib:attrib,location:location,name:attrib.name,type:attrib.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};\r\n\t\t\t\tthis._params.push(one);\r\n\t\t\t};\r\n\t\t\tvar nUniformNum=this.customCompile ? result.uniforms.length :gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.ACTIVE_UNIFORMS*/0x8B86);\r\n\t\t\tfor (i=0;i < nUniformNum;i++){\r\n\t\t\t\tvar uniform=this.customCompile ? result.uniforms[i] :gl.getActiveUniform(this._program,i);\r\n\t\t\t\tlocation=gl.getUniformLocation(this._program,uniform.name);\r\n\t\t\t\tone={vartype:\"uniform\",ivartype:1,attrib:attrib,location:location,name:uniform.name,type:uniform.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};\r\n\t\t\t\tif (one.name.indexOf('[0]')> 0){\r\n\t\t\t\t\tone.name=one.name.substr(0,one.name.length-3);\r\n\t\t\t\t\tone.isArray=true;\r\n\t\t\t\t\tone.location=gl.getUniformLocation(this._program,one.name);\r\n\t\t\t\t}\r\n\t\t\t\tthis._params.push(one);\r\n\t\t\t}\r\n\t\t\tfor (i=0,n=this._params.length;i < n;i++){\r\n\t\t\t\tone=this._params[i];\r\n\t\t\t\tone.indexOfParams=i;\r\n\t\t\t\tone.index=1;\r\n\t\t\t\tone.value=[one.location,null];\r\n\t\t\t\tone.codename=one.name;\r\n\t\t\t\tone.name=this._nameMap[one.codename] ? this._nameMap[one.codename] :one.codename;\r\n\t\t\t\tthis._paramsMap[one.name]=one;\r\n\t\t\t\tone._this=this;\r\n\t\t\t\tone.uploadedValue=[];\r\n\t\t\t\tif (one.vartype===\"attribute\"){\r\n\t\t\t\t\tone.fun=this._attribute;\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (one.type){\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.INT*/0x1404:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform1iv :this._uniform1i;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT*/0x1406:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform1fv :this._uniform1f;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC2*/0x8B50:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec2v:this._uniform_vec2;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC3*/0x8B51:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec3v:this._uniform_vec3;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC4*/0x8B52:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec4v:this._uniform_vec4;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.SAMPLER_2D*/0x8B5E:\r\n\t\t\t\t\t\tone.fun=this._uniform_sampler2D;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.SAMPLER_CUBE*/0x8B60:\r\n\t\t\t\t\t\tone.fun=this._uniform_samplerCube;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT4*/0x8B5C:\r\n\t\t\t\t\t\tone.fun=this._uniformMatrix4fv;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.BOOL*/0x8B56:\r\n\t\t\t\t\t\tone.fun=this._uniform1i;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT2*/0x8B5A:\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT3*/0x8B5B:\r\n\t\t\t\t\t\tthrow new Error(\"compile shader err!\");\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\tthrow new Error(\"compile shader err!\");\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据变量名字获得\r\n\t\t*@param name\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getUniform=function(name){\r\n\t\t\treturn this._paramsMap[name];\r\n\t\t}\r\n\r\n\t\t__proto._attribute=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enableVertexAttribArray(one.location);\r\n\t\t\tgl.vertexAttribPointer(one.location,value[0],value[1],value[2],value[3],value[4]+this._offset);\r\n\t\t\treturn 2;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1f=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value){\r\n\t\t\t\tWebGL.mainContext.uniform1f(one.location,uploadedValue[0]=value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1fv=function(one,value){\r\n\t\t\tif (value.length < 4){\r\n\t\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\t\tWebGL.mainContext.uniform1fv(one.location,value);\r\n\t\t\t\t\tuploadedValue[0]=value[0];\r\n\t\t\t\t\tuploadedValue[1]=value[1];\r\n\t\t\t\t\tuploadedValue[2]=value[2];\r\n\t\t\t\t\tuploadedValue[3]=value[3];\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t\t}else {\r\n\t\t\t\tWebGL.mainContext.uniform1fv(one.location,value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec2=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){\r\n\t\t\t\tWebGL.mainContext.uniform2f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec2v=function(one,value){\r\n\t\t\tif (value.length < 2){\r\n\t\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\t\tWebGL.mainContext.uniform2fv(one.location,value);\r\n\t\t\t\t\tuploadedValue[0]=value[0];\r\n\t\t\t\t\tuploadedValue[1]=value[1];\r\n\t\t\t\t\tuploadedValue[2]=value[2];\r\n\t\t\t\t\tuploadedValue[3]=value[3];\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t\t}else {\r\n\t\t\t\tWebGL.mainContext.uniform2fv(one.location,value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){\r\n\t\t\t\tWebGL.mainContext.uniform3f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform3fv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\tWebGL.mainContext.uniform4f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform4fv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix2fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix2fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix3fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix3fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix4fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix4fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value){\r\n\t\t\t\tWebGL.mainContext.uniform1i(one.location,uploadedValue[0]=value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1iv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform1iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_ivec2=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){\r\n\t\t\t\tWebGL.mainContext.uniform2i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_ivec2v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform2iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){\r\n\t\t\t\tWebGL.mainContext.uniform3i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3vi=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform3iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\tWebGL.mainContext.uniform4i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4vi=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform4iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_sampler2D=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]==null){\r\n\t\t\t\tuploadedValue[0]=this._curActTexIndex;\r\n\t\t\t\tgl.uniform1i(one.location,this._curActTexIndex);\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t\t\tthis._curActTexIndex++;\r\n\t\t\t\treturn 1;\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_samplerCube=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]==null){\r\n\t\t\t\tuploadedValue[0]=this._curActTexIndex;\r\n\t\t\t\tgl.uniform1i(one.location,this._curActTexIndex);\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_CUBE_MAP*/0x8513,value);\r\n\t\t\t\tthis._curActTexIndex++;\r\n\t\t\t\treturn 1;\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_CUBE_MAP*/0x8513,value);\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._noSetValue=function(one){\r\n\t\t\tconsole.log(\"no....:\"+one.name);\r\n\t\t}\r\n\r\n\t\t//throw new Error(\"upload shader err,must set value:\"+one.name);\r\n\t\t__proto.uploadOne=function(name,value){\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tvar one=this._paramsMap[name];\r\n\t\t\tone.fun.call(this,one,value);\r\n\t\t}\r\n\r\n\t\t__proto.uploadTexture2D=function(value){\r\n\t\t\tStat.shaderCall++;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.activeTexture(/*laya.webgl.WebGLContext.TEXTURE0*/0x84C0);\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*提交shader到GPU\r\n\t\t*@param shaderValue\r\n\t\t*/\r\n\t\t__proto.upload=function(shaderValue,params){\r\n\t\t\tShader.activeShader=this;\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tif (this._reCompile){\r\n\t\t\t\tparams=this._params;\r\n\t\t\t\tthis._reCompile=false;\r\n\t\t\t\t}else {\r\n\t\t\t\tparams=params || this._params;\r\n\t\t\t};\r\n\t\t\tvar one,value,n=params.length,shaderCall=0;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\tone=params[i];\r\n\t\t\t\t((value=shaderValue[one.name])!==null)&& (shaderCall+=one.fun.call(this,one,value));\r\n\t\t\t}\r\n\t\t\tStat.shaderCall+=shaderCall;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*按数组的定义提交\r\n\t\t*@param shaderValue 数组格式[name,value,...]\r\n\t\t*/\r\n\t\t__proto.uploadArray=function(shaderValue,length,_bufferUsage){\r\n\t\t\tShader.activeShader=this;\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tvar params=this._params,value;\r\n\t\t\tvar one,shaderCall=0;\r\n\t\t\tfor (var i=length-2;i >=0;i-=2){\r\n\t\t\t\tone=this._paramsMap[shaderValue[i]];\r\n\t\t\t\tif (!one)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tvalue=shaderValue[i+1];\r\n\t\t\t\tif (value !=null){\r\n\t\t\t\t\t_bufferUsage && _bufferUsage[one.name] && _bufferUsage[one.name].bind();\r\n\t\t\t\t\tshaderCall+=one.fun.call(this,one,value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tStat.shaderCall+=shaderCall;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*得到编译后的变量及相关预定义\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getParams=function(){\r\n\t\t\treturn this._params;\r\n\t\t}\r\n\r\n\t\t__proto._preGetParams=function(vs,ps){\r\n\t\t\tvar text=[vs,ps];\r\n\t\t\tvar result={};\r\n\t\t\tvar attributes=[];\r\n\t\t\tvar uniforms=[];\r\n\t\t\tvar definesInfo={};\r\n\t\t\tvar definesName=[];\r\n\t\t\tresult.attributes=attributes;\r\n\t\t\tresult.uniforms=uniforms;\r\n\t\t\tresult.defines=definesInfo;\r\n\t\t\tvar removeAnnotation=new RegExp(\"(/\\\\*([^*]|[\\\\r\\\\\\n]|(\\\\*+([^*/]|[\\\\r\\\\n])))*\\\\*+/)|(//.*)\",\"g\");\r\n\t\t\tvar reg=new RegExp(\"(\\\".*\\\")|('.*')|([#\\\\w\\\\*-\\\\.+/()=<>{}\\\\\\\\]+)|([,;:\\\\\\\\])\",\"g\");\r\n\t\t\tvar i=0,n=0,one;\r\n\t\t\tfor (var s=0;s < 2;s++){\r\n\t\t\t\ttext[s]=text[s].replace(removeAnnotation,\"\");\r\n\t\t\t\tvar words=text[s].match(reg);\r\n\t\t\t\tvar tempelse;\r\n\t\t\t\tfor (i=0,n=words.length;i < n;i++){\r\n\t\t\t\t\tvar word=words[i];\r\n\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\tif (word==\"#define\"){\r\n\t\t\t\t\t\t\tword=words[++i];\r\n\t\t\t\t\t\t\tdefinesName[word]=1;\r\n\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t}else if (word==\"#ifdef\"){\r\n\t\t\t\t\t\t\ttempelse=words[++i];\r\n\t\t\t\t\t\t\tvar def=definesInfo[tempelse]=definesInfo[tempelse] || [];\r\n\t\t\t\t\t\t\tfor (i++;i < n;i++){\r\n\t\t\t\t\t\t\t\tword=words[i];\r\n\t\t\t\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\t\t\t\tif (word==\"#else\"){\r\n\t\t\t\t\t\t\t\t\t\tfor (i++;i < n;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tword=words[i];\r\n\t\t\t\t\t\t\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (word==\"#endif\"){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,!definesName[tempelse]);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,definesName[tempelse]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t__proto.parseOne=function(attributes,uniforms,words,i,word,b){\r\n\t\t\tvar one={type:Shader.shaderParamsMap[words[i+1]],name:words[i+2],size:isNaN(parseInt(words[i+3]))? 1 :parseInt(words[i+3])};\r\n\t\t\tif (b){\r\n\t\t\t\tif (word==\"attribute\"){\r\n\t\t\t\t\tattributes.push(one);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tuniforms.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (words[i+3]==':'){\r\n\t\t\t\tone.type=words[i+4];\r\n\t\t\t\ti+=2;\r\n\t\t\t}\r\n\t\t\ti+=2;\r\n\t\t\treturn i;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.resourceManager.removeResource(this);\r\n\t\t\t_super.prototype.dispose.call(this);\r\n\t\t}\r\n\r\n\t\tShader.getShader=function(name){\r\n\t\t\treturn Shader.sharders[name];\r\n\t\t}\r\n\r\n\t\tShader.create=function(vs,ps,saveName,nameMap){\r\n\t\t\treturn new Shader(vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\tShader.withCompile=function(nameID,define,shaderName,createShader){\r\n\t\t\tif (shaderName && Shader.sharders[shaderName])\r\n\t\t\t\treturn Shader.sharders[shaderName];\r\n\t\t\tvar pre=Shader._preCompileShader[0.0002 *nameID];\r\n\t\t\tif (!pre)\r\n\t\t\t\tthrow new Error(\"withCompile shader err!\"+nameID);\r\n\t\t\treturn pre.createShader(define,shaderName,createShader);\r\n\t\t}\r\n\r\n\t\tShader.withCompile2D=function(nameID,mainID,define,shaderName,createShader){\r\n\t\t\tif (shaderName && Shader.sharders[shaderName])\r\n\t\t\t\treturn Shader.sharders[shaderName];\r\n\t\t\tvar pre=Shader._preCompileShader[0.0002 *nameID+mainID];\r\n\t\t\tif (!pre)\r\n\t\t\t\tthrow new Error(\"withCompile shader err!\"+nameID+\" \"+mainID);\r\n\t\t\treturn pre.createShader(define,shaderName,createShader);\r\n\t\t}\r\n\r\n\t\tShader.addInclude=function(fileName,txt){\r\n\t\t\tif (!txt || txt.length===0)\r\n\t\t\t\tthrow new Error(\"add shader include file err:\"+fileName);\r\n\t\t\tif (Shader._includeFiles[fileName])\r\n\t\t\t\tthrow new Error(\"add shader include file err, has add:\"+fileName);\r\n\t\t\tShader._includeFiles[fileName]=txt;\r\n\t\t}\r\n\r\n\t\tShader.preCompile=function(nameID,vs,ps,nameMap){\r\n\t\t\tvar id=0.0002 *nameID;\r\n\t\t\tShader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap,Shader._includeFiles);\r\n\t\t}\r\n\r\n\t\tShader.preCompile2D=function(nameID,mainID,vs,ps,nameMap){\r\n\t\t\tvar id=0.0002 *nameID+mainID;\r\n\t\t\tShader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap,Shader._includeFiles);\r\n\t\t}\r\n\r\n\t\tShader._createShader=function(gl,str,type){\r\n\t\t\tvar shader=gl.createShader(type);\r\n\t\t\tgl.shaderSource(shader,str);\r\n\t\t\tgl.compileShader(shader);\r\n\t\t\tif (!gl.getShaderParameter(shader,/*laya.webgl.WebGLContext.COMPILE_STATUS*/0x8B81)){\r\n\t\t\t\tthrow gl.getShaderInfoLog(shader);\r\n\t\t\t}\r\n\t\t\treturn shader;\r\n\t\t}\r\n\r\n\t\tShader._TEXTURES=[ /*laya.webgl.WebGLContext.TEXTURE0*/0x84C0,/*laya.webgl.WebGLContext.TEXTURE1*/0x84C1,/*laya.webgl.WebGLContext.TEXTURE2*/0x84C2,/*laya.webgl.WebGLContext.TEXTURE3*/0x84C3,/*laya.webgl.WebGLContext.TEXTURE4*/0x84C4,/*laya.webgl.WebGLContext.TEXTURE5*/0x84C5,/*laya.webgl.WebGLContext.TEXTURE6*/0x84C6,,/*laya.webgl.WebGLContext.TEXTURE7*/0x84C7,/*laya.webgl.WebGLContext.TEXTURE8*/0x84C8];\r\n\t\tShader._includeFiles={};\r\n\t\tShader._count=0;\r\n\t\tShader._preCompileShader={};\r\n\t\tShader.SHADERNAME2ID=0.0002;\r\n\t\tShader.activeShader=null\r\n\t\tShader.sharders=(Shader.sharders=[],Shader.sharders.length=0x20,Shader.sharders);\r\n\t\t__static(Shader,\r\n\t\t['shaderParamsMap',function(){return this.shaderParamsMap={\"float\":/*laya.webgl.WebGLContext.FLOAT*/0x1406,\"int\":/*laya.webgl.WebGLContext.INT*/0x1404,\"bool\":/*laya.webgl.WebGLContext.BOOL*/0x8B56,\"vec2\":/*laya.webgl.WebGLContext.FLOAT_VEC2*/0x8B50,\"vec3\":/*laya.webgl.WebGLContext.FLOAT_VEC3*/0x8B51,\"vec4\":/*laya.webgl.WebGLContext.FLOAT_VEC4*/0x8B52,\"ivec2\":/*laya.webgl.WebGLContext.INT_VEC2*/0x8B53,\"ivec3\":/*laya.webgl.WebGLContext.INT_VEC3*/0x8B54,\"ivec4\":/*laya.webgl.WebGLContext.INT_VEC4*/0x8B55,\"bvec2\":/*laya.webgl.WebGLContext.BOOL_VEC2*/0x8B57,\"bvec3\":/*laya.webgl.WebGLContext.BOOL_VEC3*/0x8B58,\"bvec4\":/*laya.webgl.WebGLContext.BOOL_VEC4*/0x8B59,\"mat2\":/*laya.webgl.WebGLContext.FLOAT_MAT2*/0x8B5A,\"mat3\":/*laya.webgl.WebGLContext.FLOAT_MAT3*/0x8B5B,\"mat4\":/*laya.webgl.WebGLContext.FLOAT_MAT4*/0x8B5C,\"sampler2D\":/*laya.webgl.WebGLContext.SAMPLER_2D*/0x8B5E,\"samplerCube\":/*laya.webgl.WebGLContext.SAMPLER_CUBE*/0x8B60};},'nameKey',function(){return this.nameKey=new StringKey();}\r\n\t\t]);\r\n\t\treturn Shader;\r\n\t})(Resource)\r\n\r\n\r\n\t//class laya.webgl.resource.RenderTarget2D extends laya.resource.Texture\r\n\tvar RenderTarget2D=(function(_super){\r\n\t\tfunction RenderTarget2D(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\tthis._type=0;\r\n\t\t\tthis._svWidth=NaN;\r\n\t\t\tthis._svHeight=NaN;\r\n\t\t\tthis._preRenderTarget=null;\r\n\t\t\tthis._alreadyResolved=false;\r\n\t\t\tthis._looked=false;\r\n\t\t\tthis._surfaceFormat=0;\r\n\t\t\tthis._surfaceType=0;\r\n\t\t\tthis._depthStencilFormat=0;\r\n\t\t\tthis._mipMap=false;\r\n\t\t\tthis._repeat=false;\r\n\t\t\tthis._minFifter=0;\r\n\t\t\tthis._magFifter=0;\r\n\t\t\tthis._destroy=false;\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=-1);\r\n\t\t\tthis._type=1;\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis._surfaceFormat=surfaceFormat;\r\n\t\t\tthis._surfaceType=surfaceType;\r\n\t\t\tthis._depthStencilFormat=depthStencilFormat;\r\n\t\t\tthis._mipMap=mipMap;\r\n\t\t\tthis._repeat=repeat;\r\n\t\t\tthis._minFifter=minFifter;\r\n\t\t\tthis._magFifter=magFifter;\r\n\t\t\tthis._createWebGLRenderTarget();\r\n\t\t\tthis.bitmap.lock=true;\r\n\t\t\tRenderTarget2D.__super.call(this,this.bitmap,Texture.INV_UV);\r\n\t\t}\r\n\r\n\t\t__class(RenderTarget2D,'laya.webgl.resource.RenderTarget2D',_super);\r\n\t\tvar __proto=RenderTarget2D.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.resource.IDispose\":true})\r\n\t\t//TODO:临时......................................................\r\n\t\t__proto.getType=function(){\r\n\t\t\treturn this._type;\r\n\t\t}\r\n\r\n\t\t//*/\r\n\t\t__proto.getTexture=function(){\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tif (this.bitmap && this._w==w && this._h==h)\r\n\t\t\t\treturn;\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tthis.release();\r\n\t\t\tthis._createWebGLRenderTarget();\r\n\t\t}\r\n\r\n\t\t__proto.release=function(){\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\r\n\t\t__proto.recycle=function(){\r\n\t\t\tRenderTarget2D.POOL.push(this);\r\n\t\t}\r\n\r\n\t\t__proto.start=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._preRenderTarget=RenderState2D.curRenderTarget;\r\n\t\t\tRenderState2D.curRenderTarget=this;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this.bitmap.frameBuffer);\r\n\t\t\tthis._alreadyResolved=false;\r\n\t\t\tif (this._type==1){\r\n\t\t\t\tgl.viewport(0,0,this._w,this._h);\r\n\t\t\t\tthis._svWidth=RenderState2D.width;\r\n\t\t\t\tthis._svHeight=RenderState2D.height;\r\n\t\t\t\tRenderState2D.width=this._w;\r\n\t\t\t\tRenderState2D.height=this._h;\r\n\t\t\t\tShader.activeShader=null;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(r,g,b,a){\r\n\t\t\t(r===void 0)&& (r=0.0);\r\n\t\t\t(g===void 0)&& (g=0.0);\r\n\t\t\t(b===void 0)&& (b=0.0);\r\n\t\t\t(a===void 0)&& (a=1.0);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.clearColor(r,g,b,a);\r\n\t\t\tvar clearFlag=/*laya.webgl.WebGLContext.COLOR_BUFFER_BIT*/0x00004000;\r\n\t\t\tswitch (this._depthStencilFormat){\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.STENCIL_INDEX8*/0x8D48:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100;\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\tgl.clear(clearFlag);\r\n\t\t}\r\n\r\n\t\t__proto.end=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this._preRenderTarget ? this._preRenderTarget.bitmap.frameBuffer :null);\r\n\t\t\tthis._alreadyResolved=true;\r\n\t\t\tRenderState2D.curRenderTarget=this._preRenderTarget;\r\n\t\t\tif (this._type==1){\r\n\t\t\t\tgl.viewport(0,0,this._svWidth,this._svHeight);\r\n\t\t\t\tRenderState2D.width=this._svWidth;\r\n\t\t\t\tRenderState2D.height=this._svHeight;\r\n\t\t\t\tShader.activeShader=null;\r\n\t\t\t}else gl.viewport(0,0,Laya.stage.width,Laya.stage.height);\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(x,y,width,height){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,(this.bitmap).frameBuffer);\r\n\t\t\tvar canRead=(gl.checkFramebufferStatus(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40)===/*laya.webgl.WebGLContext.FRAMEBUFFER_COMPLETE*/0x8CD5);\r\n\t\t\tif (!canRead){\r\n\t\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\t\t\tvar pixels=new Uint8Array(this._w *this._h *4);\r\n\t\t\tgl.readPixels(x,y,width,height,this._surfaceFormat,this._surfaceType,pixels);\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\treturn pixels;\r\n\t\t}\r\n\r\n\t\t/**彻底清理资源,注意会强制解锁清理*/\r\n\t\t__proto.destroy=function(foreDiposeTexture){\r\n\t\t\t(foreDiposeTexture===void 0)&& (foreDiposeTexture=false);\r\n\t\t\tif (!this._destroy){\r\n\t\t\t\tthis._loaded=false;\r\n\t\t\t\tthis.bitmap.dispose();\r\n\t\t\t\tthis.bitmap=null;\r\n\t\t\t\tthis._destroy=true;\r\n\t\t\t\t_super.prototype.destroy.call(this);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//待测试\r\n\t\t__proto.dispose=function(){}\r\n\t\t__proto._createWebGLRenderTarget=function(){\r\n\t\t\tthis.bitmap=new WebGLRenderTarget(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter);\r\n\t\t\tthis.bitmap.activeResource();\r\n\t\t\tthis._alreadyResolved=true;\r\n\t\t\tthis._destroy=false;\r\n\t\t\tthis._loaded=true;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'surfaceFormat',function(){\r\n\t\t\treturn this._surfaceFormat;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'magFifter',function(){\r\n\t\t\treturn this._magFifter;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'surfaceType',function(){\r\n\t\t\treturn this._surfaceType;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'mipMap',function(){\r\n\t\t\treturn this._mipMap;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'depthStencilFormat',function(){\r\n\t\t\treturn this._depthStencilFormat;\r\n\t\t});\r\n\r\n\t\t//}\r\n\t\t__getset(0,__proto,'minFifter',function(){\r\n\t\t\treturn this._minFifter;\r\n\t\t});\r\n\r\n\t\t/**返回RenderTarget的Texture*/\r\n\t\t__getset(0,__proto,'source',function(){\r\n\t\t\tif (this._alreadyResolved)\r\n\t\t\t\treturn _super.prototype._$get_source.call(this);\r\n\t\t\tthrow new Error(\"RenderTarget  还未准备好！\");\r\n\t\t});\r\n\r\n\t\tRenderTarget2D.create=function(w,h,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=-1);\r\n\t\t\tvar t=RenderTarget2D.POOL.pop();\r\n\t\t\tt || (t=new RenderTarget2D(w,h));\r\n\t\t\tif (!t.bitmap || t._w !=w || t._h !=h || t._surfaceFormat !=surfaceFormat || t._surfaceType !=surfaceType || t._depthStencilFormat !=depthStencilFormat || t._mipMap !=mipMap || t._repeat !=repeat || t._minFifter !=minFifter || t._magFifter !=magFifter){\r\n\t\t\t\tt._w=w;\r\n\t\t\t\tt._h=h;\r\n\t\t\t\tt._surfaceFormat=surfaceFormat;\r\n\t\t\t\tt._surfaceType=surfaceType;\r\n\t\t\t\tt._depthStencilFormat=depthStencilFormat;\r\n\t\t\t\tt._mipMap=mipMap;\r\n\t\t\t\tt._repeat=repeat;\r\n\t\t\t\tt._minFifter=minFifter;\r\n\t\t\t\tt._magFifter=magFifter;\r\n\t\t\t\tt.release();\r\n\t\t\t\tt._createWebGLRenderTarget();\r\n\t\t\t}\r\n\t\t\treturn t;\r\n\t\t}\r\n\r\n\t\tRenderTarget2D.TYPE2D=1;\r\n\t\tRenderTarget2D.TYPE3D=2;\r\n\t\tRenderTarget2D.POOL=[];\r\n\t\treturn RenderTarget2D;\r\n\t})(Texture)\r\n\r\n\r\n\t//class laya.webgl.utils.Buffer extends laya.resource.Resource\r\n\tvar Buffer=(function(_super){\r\n\t\tfunction Buffer(){\r\n\t\t\tthis._glBuffer=null;\r\n\t\t\tthis._buffer=null;\r\n\t\t\tthis._bufferType=0;\r\n\t\t\tthis._bufferUsage=0;\r\n\t\t\tthis._byteLength=0;\r\n\t\t\tBuffer.__super.call(this);\r\n\t\t\tBuffer._gl=WebGL.mainContext;\r\n\t\t}\r\n\r\n\t\t__class(Buffer,'laya.webgl.utils.Buffer',_super);\r\n\t\tvar __proto=Buffer.prototype;\r\n\t\t__proto._bind=function(){\r\n\t\t\tthis.activeResource();\r\n\t\t\t(Buffer._bindActive[this._bufferType]===this._glBuffer)|| (Buffer._gl.bindBuffer(this._bufferType,Buffer._bindActive[this._bufferType]=this._glBuffer),Shader.activeShader=null);\r\n\t\t}\r\n\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tthis._glBuffer || (this._glBuffer=Buffer._gl.createBuffer());\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._glBuffer){\r\n\t\t\t\tWebGL.mainContext.deleteBuffer(this._glBuffer);\r\n\t\t\t\tthis._glBuffer=null;\r\n\t\t\t}\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.resourceManager.removeResource(this);\r\n\t\t\t_super.prototype.dispose.call(this);\r\n\t\t}\r\n\r\n\t\t//TODO:私有\r\n\t\t__getset(0,__proto,'byteLength',function(){\r\n\t\t\treturn this._byteLength;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'bufferType',function(){\r\n\t\t\treturn this._bufferType;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'bufferUsage',function(){\r\n\t\t\treturn this._bufferUsage;\r\n\t\t});\r\n\r\n\t\tBuffer._gl=null\r\n\t\tBuffer._bindActive={};\r\n\t\treturn Buffer;\r\n\t})(Resource)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar SkinSV=(function(_super){\r\n\t\tfunction SkinSV(type){\r\n\t\t\tthis.texcoord=null;\r\n\t\t\tthis.offsetX=300;\r\n\t\t\tthis.offsetY=0;\r\n\t\t\tSkinSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,0);\r\n\t\t\tvar _vlen=8 *CONST3D2D.BYTES_PE;\r\n\t\t\tthis.position=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,0];\r\n\t\t\tthis.texcoord=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,2 *CONST3D2D.BYTES_PE];\r\n\t\t\tthis.color=[4,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,4 *CONST3D2D.BYTES_PE];\r\n\t\t}\r\n\r\n\t\t__class(SkinSV,'laya.webgl.shader.d2.skinAnishader.SkinSV',_super);\r\n\t\treturn SkinSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.Color2dSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar Color2dSV=(function(_super){\r\n\t\tfunction Color2dSV(args){\r\n\t\t\tColor2dSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0);\r\n\t\t\tthis.color=[];\r\n\t\t}\r\n\r\n\t\t__class(Color2dSV,'laya.webgl.shader.d2.value.Color2dSV',_super);\r\n\t\tvar __proto=Color2dSV.prototype;\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tvalue.fillStyle&&(this.color=value.fillStyle._color._color);\r\n\t\t\tvalue.strokeStyle&&(this.color=value.strokeStyle._color._color);\r\n\t\t}\r\n\r\n\t\treturn Color2dSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.FillTextureSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar FillTextureSV=(function(_super){\r\n\t\tfunction FillTextureSV(type){\r\n\t\t\tthis.u_colorMatrix=null;\r\n\t\t\tthis.strength=0;\r\n\t\t\tthis.colorMat=null;\r\n\t\t\tthis.colorAlpha=null;\r\n\t\t\tthis.u_TexRange=[0,1,0,1];\r\n\t\t\tthis.u_offset=[0,0];\r\n\t\t\tthis.texcoord=Value2D._TEXCOORD;\r\n\t\t\tFillTextureSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,0);\r\n\t\t}\r\n\r\n\t\t__class(FillTextureSV,'laya.webgl.shader.d2.value.FillTextureSV',_super);\r\n\t\tvar __proto=FillTextureSV.prototype;\r\n\t\t//this.color=[4,WebGLContext.FLOAT,false,_vlen,4 *CONST3D2D.BYTES_PE];\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\tthis.ALPHA=vo.ALPHA;\r\n\t\t\tvo.filters && this.setFilters(vo.filters);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.shader=null;\r\n\t\t\tthis.defines.setValue(0);\r\n\t\t}\r\n\r\n\t\treturn FillTextureSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.TextureSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar TextureSV=(function(_super){\r\n\t\tfunction TextureSV(subID){\r\n\t\t\tthis.u_colorMatrix=null;\r\n\t\t\tthis.strength=0;\r\n\t\t\tthis.colorMat=null;\r\n\t\t\tthis.colorAlpha=null;\r\n\t\t\tthis.texcoord=Value2D._TEXCOORD;\r\n\t\t\t(subID===void 0)&& (subID=0);\r\n\t\t\tTextureSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,subID);\r\n\t\t}\r\n\r\n\t\t__class(TextureSV,'laya.webgl.shader.d2.value.TextureSV',_super);\r\n\t\tvar __proto=TextureSV.prototype;\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\tthis.ALPHA=vo.ALPHA;\r\n\t\t\tvo.filters && this.setFilters(vo.filters);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.shader=null;\r\n\t\t\tthis.defines.setValue(0);\r\n\t\t}\r\n\r\n\t\treturn TextureSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.PrimitiveSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar PrimitiveSV=(function(_super){\r\n\t\tfunction PrimitiveSV(args){\r\n\t\t\tthis.a_color=null;\r\n\t\t\tthis.u_pos=[0,0];\r\n\t\t\tPrimitiveSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0);\r\n\t\t\tthis.position=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,5 *CONST3D2D.BYTES_PE,0];\r\n\t\t\tthis.a_color=[3,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,5 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];\r\n\t\t}\r\n\r\n\t\t__class(PrimitiveSV,'laya.webgl.shader.d2.value.PrimitiveSV',_super);\r\n\t\treturn PrimitiveSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasWebGLCanvas extends laya.resource.Bitmap\r\n\tvar AtlasWebGLCanvas=(function(_super){\r\n\t\tfunction AtlasWebGLCanvas(){\r\n\t\t\tthis._flashCacheImage=null;\r\n\t\t\tthis._flashCacheImageNeedFlush=false;\r\n\t\t\tAtlasWebGLCanvas.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(AtlasWebGLCanvas,'laya.webgl.atlas.AtlasWebGLCanvas',_super);\r\n\t\tvar __proto=AtlasWebGLCanvas.prototype;\r\n\t\t/***重新创建资源*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar glTex=this._source=gl.createTexture();\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,null);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t/***销毁资源*/\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._source){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**采样image到WebGLTexture的一部分*/\r\n\t\t__proto.texSubImage2D=function(xoffset,yoffset,bitmap){\r\n\t\t\tif (!Render.isFlash){\r\n\t\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\t\t(xoffset-1 >=0)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset-1,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(xoffset+1 <=this._w)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset+1,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(yoffset-1 >=0)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset-1,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(yoffset+1 <=this._h)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset+1,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap);\r\n\t\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\t\t}else {\r\n\t\t\t\tif (!this._flashCacheImage){\r\n\t\t\t\t\tthis._flashCacheImage=HTMLImage.create(null);\r\n\t\t\t\t\tthis._flashCacheImage.image.createCanvas(this._w,this._h);\r\n\t\t\t\t};\r\n\t\t\t\tvar bmData=bitmap.bitmapdata;\r\n\t\t\t\t(xoffset-1 >=0)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width-1,bmData.height,xoffset,yoffset));\r\n\t\t\t\t(xoffset+1 <=this._w)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width+1,bmData.height,xoffset,yoffset));\r\n\t\t\t\t(yoffset-1 >=0)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width,bmData.height-1,xoffset,yoffset));\r\n\t\t\t\t(yoffset+1 <=this._h)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width+1,bmData.height,xoffset,yoffset));\r\n\t\t\t\tthis._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width,bmData.height,xoffset,yoffset);\r\n\t\t\t\t(this._flashCacheImageNeedFlush)|| (this._flashCacheImageNeedFlush=true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**采样image到WebGLTexture的一部分*/\r\n\t\t__proto.texSubImage2DPixel=function(xoffset,yoffset,width,height,pixel){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\tvar pixels=new Uint8Array(pixel.data);\r\n\t\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,width,height,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,pixels);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t}\r\n\r\n\t\t/***\r\n\t\t*设置图片宽度\r\n\t\t*@param value 图片宽度\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',_super.prototype._$get_width,function(value){\r\n\t\t\tthis._w=value;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置图片高度\r\n\t\t*@param value 图片高度\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',_super.prototype._$get_height,function(value){\r\n\t\t\tthis._h=value;\r\n\t\t});\r\n\r\n\t\treturn AtlasWebGLCanvas;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLCanvas extends laya.resource.Bitmap\r\n\tvar WebGLCanvas=(function(_super){\r\n\t\tfunction WebGLCanvas(type){\r\n\t\t\t//this._ctx=null;\r\n\t\t\tthis._is2D=false;\r\n\t\t\t//this._canvas=null;\r\n\t\t\t//this.iscpuSource=false;\r\n\t\t\tvar _$this=this;\r\n\t\t\tWebGLCanvas.__super.call(this);\r\n\t\t\tthis._canvas=this;\r\n\t\t\tif (type===\"2D\" || (type===\"AUTO\" && !Render.isWebGL)){\r\n\t\t\t\tthis._is2D=true;\r\n\t\t\t\tthis._canvas=this._source=Browser.createElement(\"canvas\");\r\n\t\t\t\tthis.iscpuSource=true;\r\n\t\t\t\tvar o=this;\r\n\t\t\t\to.getContext=function (contextID,other){\r\n\t\t\t\t\tif (_$this._ctx)return _$this._ctx;\r\n\t\t\t\t\tvar ctx=_$this._ctx=_$this._canvas.getContext(contextID,other);\r\n\t\t\t\t\tif (ctx){\r\n\t\t\t\t\t\tctx._canvas=o;\r\n\t\t\t\t\t\tctx.size=function (){\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ctx;\r\n\t\t\t\t}\r\n\t\t\t}else this._canvas={};\r\n\t\t}\r\n\r\n\t\t__class(WebGLCanvas,'laya.webgl.resource.WebGLCanvas',_super);\r\n\t\tvar __proto=WebGLCanvas.prototype;\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._ctx && this._ctx.clear();\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._ctx && this._ctx.destroy();\r\n\t\t\tthis._ctx=null;\r\n\t\t}\r\n\r\n\t\t__proto._setContext=function(context){\r\n\t\t\tthis._ctx=context;\r\n\t\t}\r\n\r\n\t\t__proto.getContext=function(contextID,other){\r\n\t\t\treturn this._ctx ? this._ctx :(this._ctx=WebGLCanvas._createContext(this));\r\n\t\t}\r\n\r\n\t\t/*override public function copyTo(dec:Bitmap):void {\r\n\t\tsuper.copyTo(dec);\r\n\t\t(dec as WebGLCanvas)._ctx=_ctx;\r\n\t}*/\r\n\r\n\r\n\t__proto.size=function(w,h){\r\n\t\tif (this._w !=w || this._h !=h){\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tthis._ctx && this._ctx.size(w,h);\r\n\t\t\tthis._canvas && (this._canvas.height=h,this._canvas.width=w);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.recreateResource=function(){\r\n\t\tthis.startCreate();\r\n\t\tthis.createWebGlTexture();\r\n\t\tthis.completeCreate();\r\n\t}\r\n\r\n\r\n\t__proto.detoryResource=function(){\r\n\t\tif (this._source && !this.iscpuSource){\r\n\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\tthis._source=null;\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.createWebGlTexture=function(){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tif (!this._canvas){\r\n\t\t\tthrow \"create GLTextur err:no data:\"+this._canvas;\r\n\t\t};\r\n\r\n\t\tvar glTex=this._source=gl.createTexture();\r\n\t\tthis.iscpuSource=false;\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,null);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\tthis._canvas=null;\r\n\t}\r\n\r\n\r\n\t__proto.texSubImage2D=function(webglCanvas,xoffset,yoffset){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,webglCanvas._source);\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t*返回HTML Image,as3无internal货friend，通常禁止开发者修改image内的任何属性\r\n\t*@param HTML Image\r\n\t*/\r\n\t__getset(0,__proto,'canvas',function(){\r\n\t\treturn this._canvas;\r\n\t});\r\n\r\n\r\n\t__getset(0,__proto,'context',function(){\r\n\t\treturn this._ctx;\r\n\t});\r\n\r\n\r\n\t__getset(0,__proto,'asBitmap',null,function(value){\r\n\t\tthis._ctx && (this._ctx.asBitmap=value);\r\n\t});\r\n\r\n\r\n\tWebGLCanvas.create=function(type){\r\n\t\treturn new WebGLCanvas(type);\r\n\t}\r\n\r\n\r\n\tWebGLCanvas._createContext=null\r\n\treturn WebGLCanvas;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLCharImage extends laya.resource.Bitmap\r\n\tvar WebGLCharImage=(function(_super){\r\n\t\tfunction WebGLCharImage(canvas,char){\r\n\t\t\tthis.borderSize=12;\r\n\t\t\t//this._ctx=null;\r\n\t\t\t//this._allowMerageInAtlas=false;\r\n\t\t\t//this._enableMerageInAtlas=false;\r\n\t\t\t//this.canvas=null;\r\n\t\t\t//this.char=null;\r\n\t\t\tWebGLCharImage.__super.call(this);\r\n\t\t\tthis.canvas=canvas;\r\n\t\t\tthis.char=char;\r\n\t\t\tthis._enableMerageInAtlas=true;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\t/*__JS__ */this._ctx=canvas;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ctx=canvas.getContext('2d',undefined);\r\n\t\t\t};\r\n\t\t\tvar xs=char.xs,ys=char.ys;\r\n\t\t\tvar t=null;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\tthis._ctx.font=char.font;\r\n\t\t\t\tt=this._ctx.measureText(char.char);\r\n\t\t\t\tchar.width=t.width *xs;\r\n\t\t\t\tchar.height=t.height *ys;\r\n\t\t\t\t}else {\r\n\t\t\t\tt=Utils.measureText(char.char,char.font);\r\n\t\t\t\tchar.width=t.width *xs;\r\n\t\t\t\tchar.height=t.height *ys;\r\n\t\t\t}\r\n\t\t\tthis.onresize(char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t}\r\n\r\n\t\t__class(WebGLCharImage,'laya.webgl.resource.WebGLCharImage',_super);\r\n\t\tvar __proto=WebGLCharImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar char=this.char;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tvar xs=char.xs,ys=char.ys;\r\n\t\t\tthis.onresize(char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t\tthis.canvas && (this.canvas.height=this._h,this.canvas.width=this._w);\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\tvar nFontSize=char.fontSize;\r\n\t\t\t\tif (xs !=1 || ys !=1){\r\n\t\t\t\t\tnFontSize=parseInt(nFontSize *((xs > ys)? xs :ys)+\"\");\r\n\t\t\t\t};\r\n\t\t\t\tvar sFont=\"normal 100 \"+nFontSize+\"px Arial\";\r\n\t\t\t\tif (char.borderColor){\r\n\t\t\t\t\tsFont+=\" 1 \"+char.borderColor;\r\n\t\t\t\t}\r\n\t\t\t\tthis._ctx.font=sFont;\r\n\t\t\t\tthis._ctx.textBaseline=\"top\";\r\n\t\t\t\tthis._ctx.fillStyle=char.fillColor;\r\n\t\t\t\tthis._ctx.fillText(char.char,this.borderSize,this.borderSize,null,null,null);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ctx.save();\r\n\t\t\t\t(this._ctx).clearRect(0,0,char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t\t\tthis._ctx.font=char.font;\r\n\t\t\t\tthis._ctx.textBaseline=\"top\";\r\n\t\t\t\tthis._ctx.translate(this.borderSize,this.borderSize);\r\n\t\t\t\tif (xs !=1 || ys !=1){\r\n\t\t\t\t\tthis._ctx.scale(xs,ys);\r\n\t\t\t\t}\r\n\t\t\t\tif (char.fillColor && char.borderColor){\r\n\t\t\t\t\t/*__JS__ */this._ctx.strokeStyle=char.borderColor;\r\n\t\t\t\t\t/*__JS__ */this._ctx.lineWidth=char.lineWidth;\r\n\t\t\t\t\tthis._ctx.strokeText(char.char,0,0,null,null,0,null);\r\n\t\t\t\t\tthis._ctx.fillStyle=char.fillColor;\r\n\t\t\t\t\tthis._ctx.fillText(char.char,0,0,null,null,null);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tif (char.lineWidth===-1){\r\n\t\t\t\t\t\tthis._ctx.fillStyle=char.fillColor ? char.fillColor :\"white\";\r\n\t\t\t\t\t\tthis._ctx.fillText(char.char,0,0,null,null,null);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t/*__JS__ */this._ctx.strokeStyle=char.borderColor?char.borderColor:'white';\r\n\t\t\t\t\t\t/*__JS__ */this._ctx.lineWidth=char.lineWidth;\r\n\t\t\t\t\t\tthis._ctx.strokeText(char.char,0,0,null,null,0,null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._ctx.restore();\r\n\t\t\t}\r\n\t\t\tchar.borderSize=this.borderSize;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.onresize=function(w,h){\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tif ((this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)){\r\n\t\t\t\tthis._allowMerageInAtlas=true\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._allowMerageInAtlas=false;\r\n\t\t\t\tthrow new Error(\"文字尺寸超出大图合集限制！\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.clearAtlasSource=function(){}\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\t\treturn this._allowMerageInAtlas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'atlasSource',function(){\r\n\t\t\treturn this.canvas;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source,通常禁止修改\r\n\t\t*@param value 是否创建\r\n\t\t*/\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\t\treturn this._enableMerageInAtlas;\r\n\t\t\t},function(value){\r\n\t\t\tthis._enableMerageInAtlas=value;\r\n\t\t});\r\n\r\n\t\treturn WebGLCharImage;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLRenderTarget extends laya.resource.Bitmap\r\n\tvar WebGLRenderTarget=(function(_super){\r\n\t\tfunction WebGLRenderTarget(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\t//this._frameBuffer=null;\r\n\t\t\t//this._depthStencilBuffer=null;\r\n\t\t\t//this._surfaceFormat=0;\r\n\t\t\t//this._surfaceType=0;\r\n\t\t\t//this._depthStencilFormat=0;\r\n\t\t\t//this._mipMap=false;\r\n\t\t\t//this._repeat=false;\r\n\t\t\t//this._minFifter=0;\r\n\t\t\t//this._magFifter=0;\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=1);\r\n\t\t\tWebGLRenderTarget.__super.call(this);\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis._surfaceFormat=surfaceFormat;\r\n\t\t\tthis._surfaceType=surfaceType;\r\n\t\t\tthis._depthStencilFormat=depthStencilFormat;\r\n\t\t\tthis._mipMap=mipMap;\r\n\t\t\tthis._repeat=repeat;\r\n\t\t\tthis._minFifter=minFifter;\r\n\t\t\tthis._magFifter=magFifter;\r\n\t\t}\r\n\r\n\t\t__class(WebGLRenderTarget,'laya.webgl.resource.WebGLRenderTarget',_super);\r\n\t\tvar __proto=WebGLRenderTarget.prototype;\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._frameBuffer || (this._frameBuffer=gl.createFramebuffer());\r\n\t\t\tthis._source || (this._source=gl.createTexture());\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);\r\n\t\t\tvar minFifter=this._minFifter;\r\n\t\t\tvar magFifter=this._magFifter;\r\n\t\t\tvar repeat=this._repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\t\tvar isPot=Arith.isPOT(this._w,this._h);\r\n\t\t\tif (isPot){\r\n\t\t\t\tif (this._mipMap)\r\n\t\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\t\telse\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\t\tthis._mipMap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t\t}else {\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t}\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this._frameBuffer);\r\n\t\t\tgl.framebufferTexture2D(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.COLOR_ATTACHMENT0*/0x8CE0,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source,0);\r\n\t\t\tif (this._depthStencilFormat){\r\n\t\t\t\tthis._depthStencilBuffer || (this._depthStencilBuffer=gl.createRenderbuffer());\r\n\t\t\t\tgl.bindRenderbuffer(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\tgl.renderbufferStorage(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilFormat,this._w,this._h);\r\n\t\t\t\tswitch (this._depthStencilFormat){\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.DEPTH_ATTACHMENT*/0x8D00,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.STENCIL_INDEX8*/0x8D48:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.STENCIL_ATTACHMENT*/0x8D20,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.DEPTH_STENCIL_ATTACHMENT*/0x821A,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tgl.bindRenderbuffer(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,null);\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._frameBuffer){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tWebGL.mainContext.deleteFramebuffer(this._frameBuffer);\r\n\t\t\t\tWebGL.mainContext.deleteRenderbuffer(this._depthStencilBuffer);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis._frameBuffer=null;\r\n\t\t\t\tthis._depthStencilBuffer=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'depthStencilBuffer',function(){\r\n\t\t\treturn this._depthStencilBuffer;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'frameBuffer',function(){\r\n\t\t\treturn this._frameBuffer;\r\n\t\t});\r\n\r\n\t\treturn WebGLRenderTarget;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLSubImage extends laya.resource.Bitmap\r\n\tvar WebGLSubImage=(function(_super){\r\n\t\tfunction WebGLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,enableMerageInAtlas){\r\n\t\t\t//this._ctx=null;\r\n\t\t\t//this._allowMerageInAtlas=false;\r\n\t\t\t//this._enableMerageInAtlas=false;\r\n\t\t\t//this.canvas=null;\r\n\t\t\t//this.repeat=false;\r\n\t\t\t//this.mipmap=false;\r\n\t\t\t//this.minFifter=0;\r\n\t\t\t//this.magFifter=0;\r\n\t\t\t//this.atlasImage=null;\r\n\t\t\tthis.offsetX=0;\r\n\t\t\tthis.offsetY=0;\r\n\t\t\t//this.src=null;\r\n\t\t\t(enableMerageInAtlas===void 0)&& (enableMerageInAtlas=true);\r\n\t\t\tWebGLSubImage.__super.call(this);\r\n\t\t\tthis.repeat=true;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=-1;\r\n\t\t\tthis.magFifter=-1;\r\n\t\t\tthis.atlasImage=atlasImage;\r\n\t\t\tthis.canvas=canvas;\r\n\t\t\tthis._ctx=canvas.getContext('2d',undefined);\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis.offsetX=offsetX;\r\n\t\t\tthis.offsetY=offsetY;\r\n\t\t\tthis.src=src;\r\n\t\t\tthis._enableMerageInAtlas=enableMerageInAtlas;\r\n\t\t}\r\n\r\n\t\t__class(WebGLSubImage,'laya.webgl.resource.WebGLSubImage',_super);\r\n\t\tvar __proto=WebGLSubImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t/*override public function copyTo(dec:Bitmap):void {\r\n\t\tvar d:WebGLSubImage=dec as WebGLSubImage;\r\n\t\tsuper.copyTo(dec);\r\n\t\td._ctx=_ctx;\r\n\t}*/\r\n\r\n\r\n\t__proto.size=function(w,h){\r\n\t\tthis._w=w;\r\n\t\tthis._h=h;\r\n\t\tthis._ctx && this._ctx.size(w,h);\r\n\t\tthis.canvas && (this.canvas.height=h,this.canvas.width=w);\r\n\t}\r\n\r\n\r\n\t__proto.recreateResource=function(){\r\n\t\tthis.startCreate();\r\n\t\tthis.size(this._w,this._h);\r\n\t\tthis._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h);\r\n\t\t(!(AtlasResourceManager.enabled && this._allowMerageInAtlas))&& (this.createWebGlTexture());\r\n\t\tthis.completeCreate();\r\n\t}\r\n\r\n\r\n\t__proto.createWebGlTexture=function(){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tif (!this.canvas){\r\n\t\t\tthrow \"create GLTextur err:no data:\"+this.canvas;\r\n\t\t};\r\n\r\n\t\tvar glTex=this._source=gl.createTexture();\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,this.canvas);\r\n\t\tvar minFifter=this.minFifter;\r\n\t\tvar magFifter=this.magFifter;\r\n\t\tvar repeat=this.repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\tvar isPOT=Arith.isPOT(this.width,this.height);\r\n\t\tif (isPOT){\r\n\t\t\tif (this.mipmap)\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\telse\r\n\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\tthis.mipmap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t}else {\r\n\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t}\r\n\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\tthis.canvas=null;\r\n\t\tthis.memorySize=this._w *this._h *4;\r\n\t}\r\n\r\n\r\n\t__proto.detoryResource=function(){\r\n\t\tif (!(AtlasResourceManager.enabled && this._allowMerageInAtlas)&& this._source){\r\n\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\tthis._source=null;\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.clearAtlasSource=function(){\r\n\t\tthis.canvas=null;\r\n\t}\r\n\r\n\r\n\t__proto.dispose=function(){\r\n\t\tthis.resourceManager.removeResource(this);\r\n\t\t_super.prototype.dispose.call(this);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t*是否创建私有Source\r\n\t*@return 是否创建\r\n\t*/\r\n\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\treturn this._allowMerageInAtlas;\r\n\t});\r\n\r\n\r\n\t//public var createFromPixel:Boolean=true;\r\n\t__getset(0,__proto,'atlasSource',function(){\r\n\t\treturn this.canvas;\r\n\t});\r\n\r\n\r\n\t/**\r\n\t*是否创建私有Source,通常禁止修改\r\n\t*@param value 是否创建\r\n\t*/\r\n\t/**\r\n\t*是否创建私有Source\r\n\t*@return 是否创建\r\n\t*/\r\n\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\treturn this._allowMerageInAtlas;\r\n\t\t},function(value){\r\n\r\n\t\tthis._allowMerageInAtlas=value;\r\n\t});\r\n\r\n\r\n\treturn WebGLSubImage;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.Shader2X extends laya.webgl.shader.Shader\r\n\tvar Shader2X=(function(_super){\r\n\t\tfunction Shader2X(vs,ps,saveName,nameMap){\r\n\t\t\tthis._params2dQuick1=null;\r\n\t\t\tthis._params2dQuick2=null;\r\n\t\t\tthis._shaderValueWidth=NaN;\r\n\t\t\tthis._shaderValueHeight=NaN;\r\n\t\t\tShader2X.__super.call(this,vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\t__class(Shader2X,'laya.webgl.shader.d2.Shader2X',_super);\r\n\t\tvar __proto=Shader2X.prototype;\r\n\t\t__proto.upload2dQuick1=function(shaderValue){\r\n\t\t\tthis.upload(shaderValue,this._params2dQuick1 || this._make2dQuick1());\r\n\t\t}\r\n\r\n\t\t__proto._make2dQuick1=function(){\r\n\t\t\tif (!this._params2dQuick1){\r\n\t\t\t\tthis.activeResource();\r\n\t\t\t\tthis._params2dQuick1=[];\r\n\t\t\t\tvar params=this._params,one;\r\n\t\t\t\tfor (var i=0,n=params.length;i < n;i++){\r\n\t\t\t\t\tone=params[i];\r\n\t\t\t\t\tif (!Render.isFlash && (one.name===\"size\" || one.name===\"mmat\" || one.name===\"position\" || one.name===\"texcoord\"))continue ;\r\n\t\t\t\t\tthis._params2dQuick1.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this._params2dQuick1;\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tthis._params2dQuick1=null;\r\n\t\t\tthis._params2dQuick2=null;\r\n\t\t}\r\n\r\n\t\t__proto.upload2dQuick2=function(shaderValue){\r\n\t\t\tthis.upload(shaderValue,this._params2dQuick2 || this._make2dQuick2());\r\n\t\t}\r\n\r\n\t\t__proto._make2dQuick2=function(){\r\n\t\t\tif (!this._params2dQuick2){\r\n\t\t\t\tthis.activeResource();\r\n\t\t\t\tthis._params2dQuick2=[];\r\n\t\t\t\tvar params=this._params,one;\r\n\t\t\t\tfor (var i=0,n=params.length;i < n;i++){\r\n\t\t\t\t\tone=params[i];\r\n\t\t\t\t\tif (!Render.isFlash && (one.name===\"size\"))continue ;\r\n\t\t\t\t\tthis._params2dQuick2.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this._params2dQuick2;\r\n\t\t}\r\n\r\n\t\tShader2X.create=function(vs,ps,saveName,nameMap){\r\n\t\t\treturn new Shader2X(vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\treturn Shader2X;\r\n\t})(Shader)\r\n\r\n\r\n\t//class laya.webgl.utils.Buffer2D extends laya.webgl.utils.Buffer\r\n\tvar Buffer2D=(function(_super){\r\n\t\tfunction Buffer2D(){\r\n\t\t\tthis._maxsize=0;\r\n\t\t\tthis._upload=true;\r\n\t\t\tthis._uploadSize=0;\r\n\t\t\tBuffer2D.__super.call(this);\r\n\t\t\tthis.lock=true;\r\n\t\t}\r\n\r\n\t\t__class(Buffer2D,'laya.webgl.utils.Buffer2D',_super);\r\n\t\tvar __proto=Buffer2D.prototype;\r\n\t\t__proto._bufferData=function(){\r\n\t\t\tthis._maxsize=Math.max(this._maxsize,this._byteLength);\r\n\t\t\tif (Stat.loopCount % 30==0){\r\n\t\t\t\tif (this._buffer.byteLength > (this._maxsize+64)){\r\n\t\t\t\t\tthis.memorySize=this._buffer.byteLength;\r\n\t\t\t\t\tthis._buffer=this._buffer.slice(0,this._maxsize+64);\r\n\t\t\t\t\tthis._checkArrayUse();\r\n\t\t\t\t}\r\n\t\t\t\tthis._maxsize=this._byteLength;\r\n\t\t\t}\r\n\t\t\tif (this._uploadSize < this._buffer.byteLength){\r\n\t\t\t\tthis._uploadSize=this._buffer.byteLength;\r\n\t\t\t\tBuffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);\r\n\t\t\t\tthis.memorySize=this._uploadSize;\r\n\t\t\t}\r\n\t\t\tBuffer._gl.bufferSubData(this._bufferType,0,this._buffer);\r\n\t\t}\r\n\r\n\t\t__proto._bufferSubData=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tthis._maxsize=Math.max(this._maxsize,this._byteLength);\r\n\t\t\tif (Stat.loopCount % 30==0){\r\n\t\t\t\tif (this._buffer.byteLength > (this._maxsize+64)){\r\n\t\t\t\t\tthis.memorySize=this._buffer.byteLength;\r\n\t\t\t\t\tthis._buffer=this._buffer.slice(0,this._maxsize+64);\r\n\t\t\t\t\tthis._checkArrayUse();\r\n\t\t\t\t}\r\n\t\t\t\tthis._maxsize=this._byteLength;\r\n\t\t\t}\r\n\t\t\tif (this._uploadSize < this._buffer.byteLength){\r\n\t\t\t\tthis._uploadSize=this._buffer.byteLength;\r\n\t\t\t\tBuffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);\r\n\t\t\t\tthis.memorySize=this._uploadSize;\r\n\t\t\t}\r\n\t\t\tif (dataStart || dataLength){\r\n\t\t\t\tvar subBuffer=this._buffer.slice(dataStart,dataLength);\r\n\t\t\t\tBuffer._gl.bufferSubData(this._bufferType,offset,subBuffer);\r\n\t\t\t\t}else {\r\n\t\t\t\tBuffer._gl.bufferSubData(this._bufferType,offset,this._buffer);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._checkArrayUse=function(){}\r\n\t\t__proto._bind_upload=function(){\r\n\t\t\tif (!this._upload)\r\n\t\t\t\treturn false;\r\n\t\t\tthis._upload=false;\r\n\t\t\tthis._bind();\r\n\t\t\tthis._bufferData();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._bind_subUpload=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tif (!this._upload)\r\n\t\t\t\treturn false;\r\n\t\t\tthis._upload=false;\r\n\t\t\tthis._bind();\r\n\t\t\tthis._bufferSubData(offset,dataStart,dataLength);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._resizeBuffer=function(nsz,copy){\r\n\t\t\tif (nsz < this._buffer.byteLength)\r\n\t\t\t\treturn this;\r\n\t\t\tthis.memorySize=nsz;\r\n\t\t\tif (copy && this._buffer && this._buffer.byteLength > 0){\r\n\t\t\t\tvar newbuffer=new ArrayBuffer(nsz);\r\n\t\t\t\tvar n=new Uint8Array(newbuffer);\r\n\t\t\t\tn.set(new Uint8Array(this._buffer),0);\r\n\t\t\t\tthis._buffer=newbuffer;\r\n\t\t\t}else\r\n\t\t\tthis._buffer=new ArrayBuffer(nsz);\r\n\t\t\tthis._checkArrayUse();\r\n\t\t\tthis._upload=true;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.append=function(data){\r\n\t\t\tthis._upload=true;\r\n\t\t\tvar byteLen=0,n;\r\n\t\t\tbyteLen=data.byteLength;\r\n\t\t\tif ((data instanceof Uint8Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Uint8Array(this._buffer,this._byteLength);\r\n\t\t\t\t}else if ((data instanceof Uint16Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Uint16Array(this._buffer,this._byteLength);\r\n\t\t\t\t}else if ((data instanceof Float32Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Float32Array(this._buffer,this._byteLength);\r\n\t\t\t}\r\n\t\t\tn.set(data,0);\r\n\t\t\tthis._byteLength+=byteLen;\r\n\t\t\tthis._checkArrayUse();\r\n\t\t}\r\n\r\n\t\t__proto.getBuffer=function(){\r\n\t\t\treturn this._buffer;\r\n\t\t}\r\n\r\n\t\t__proto.setNeedUpload=function(){\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.getNeedUpload=function(){\r\n\t\t\treturn this._upload;\r\n\t\t}\r\n\r\n\t\t__proto.upload=function(){\r\n\t\t\tvar scuess=this._bind_upload();\r\n\t\t\tBuffer._gl.bindBuffer(this._bufferType,null);\r\n\t\t\tBuffer._bindActive[this._bufferType]=null;\r\n\t\t\tShader.activeShader=null\r\n\t\t\treturn scuess;\r\n\t\t}\r\n\r\n\t\t__proto.subUpload=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tvar scuess=this._bind_subUpload();\r\n\t\t\tBuffer._gl.bindBuffer(this._bufferType,null);\r\n\t\t\tBuffer._bindActive[this._bufferType]=null;\r\n\t\t\tShader.activeShader=null\r\n\t\t\treturn scuess;\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tthis._upload=true;\r\n\t\t\tthis._uploadSize=0;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._byteLength=0;\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'bufferLength',function(){\r\n\t\t\treturn this._buffer.byteLength;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'byteLength',_super.prototype._$get_byteLength,function(value){\r\n\t\t\tif (this._byteLength===value)\r\n\t\t\t\treturn;\r\n\t\t\tvalue <=this._buffer.byteLength || (this._resizeBuffer(value *2+256,true));\r\n\t\t\tthis._byteLength=value;\r\n\t\t});\r\n\r\n\t\tBuffer2D.__int__=function(gl){\r\n\t\t\tIndexBuffer2D.QuadrangleIB=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\tGlUtils.fillIBQuadrangle(IndexBuffer2D.QuadrangleIB,16);\r\n\t\t}\r\n\r\n\t\tBuffer2D.FLOAT32=4;\r\n\t\tBuffer2D.SHORT=2;\r\n\t\treturn Buffer2D;\r\n\t})(Buffer)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.GlowSV extends laya.webgl.shader.d2.value.TextureSV\r\n\tvar GlowSV=(function(_super){\r\n\t\tfunction GlowSV(args){\r\n\t\t\tthis.u_blurX=false;\r\n\t\t\tthis.u_color=null;\r\n\t\t\tthis.u_offset=null;\r\n\t\t\tthis.u_strength=NaN;\r\n\t\t\tthis.u_texW=0;\r\n\t\t\tthis.u_texH=0;\r\n\t\t\tGlowSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.FILTERGLOW*/0x08| /*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01);\r\n\t\t}\r\n\r\n\t\t__class(GlowSV,'laya.webgl.shader.d2.value.GlowSV',_super);\r\n\t\tvar __proto=GlowSV.prototype;\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\t_super.prototype.setValue.call(this,vo);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\t_super.prototype.clear.call(this);\r\n\t\t}\r\n\r\n\t\treturn GlowSV;\r\n\t})(TextureSV)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.TextSV extends laya.webgl.shader.d2.value.TextureSV\r\n\tvar TextSV=(function(_super){\r\n\t\tfunction TextSV(args){\r\n\t\t\tTextSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40);\r\n\t\t\tthis.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40);\r\n\t\t}\r\n\r\n\t\t__class(TextSV,'laya.webgl.shader.d2.value.TextSV',_super);\r\n\t\tvar __proto=TextSV.prototype;\r\n\t\t__proto.release=function(){\r\n\t\t\tTextSV.pool[TextSV._length++]=this;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\t_super.prototype.clear.call(this);\r\n\t\t}\r\n\r\n\t\tTextSV.create=function(){\r\n\t\t\tif (TextSV._length)return TextSV.pool[--TextSV._length];\r\n\t\t\telse return new TextSV(null);\r\n\t\t}\r\n\r\n\t\tTextSV.pool=[];\r\n\t\tTextSV._length=0;\r\n\t\treturn TextSV;\r\n\t})(TextureSV)\r\n\r\n\r\n\t//class laya.webgl.utils.IndexBuffer2D extends laya.webgl.utils.Buffer2D\r\n\tvar IndexBuffer2D=(function(_super){\r\n\t\tfunction IndexBuffer2D(bufferUsage){\r\n\t\t\tthis._uint8Array=null;\r\n\t\t\tthis._uint16Array=null;\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\tIndexBuffer2D.__super.call(this);\r\n\t\t\tthis._bufferUsage=bufferUsage;\r\n\t\t\tthis._bufferType=/*laya.webgl.WebGLContext.ELEMENT_ARRAY_BUFFER*/0x8893;\r\n\t\t\tRender.isFlash || (this._buffer=new ArrayBuffer(8));\r\n\t\t}\r\n\r\n\t\t__class(IndexBuffer2D,'laya.webgl.utils.IndexBuffer2D',_super);\r\n\t\tvar __proto=IndexBuffer2D.prototype;\r\n\t\t__proto._checkArrayUse=function(){\r\n\t\t\tthis._uint8Array && (this._uint8Array=new Uint8Array(this._buffer));\r\n\t\t\tthis._uint16Array && (this._uint16Array=new Uint16Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.getUint8Array=function(){\r\n\t\t\treturn this._uint8Array || (this._uint8Array=new Uint8Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.getUint16Array=function(){\r\n\t\t\treturn this._uint16Array || (this._uint16Array=new Uint16Array(this._buffer));\r\n\t\t}\r\n\r\n\t\tIndexBuffer2D.QuadrangleIB=null\r\n\t\tIndexBuffer2D.create=function(bufferUsage){\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\treturn new IndexBuffer2D(bufferUsage);\r\n\t\t}\r\n\r\n\t\treturn IndexBuffer2D;\r\n\t})(Buffer2D)\r\n\r\n\r\n\t//class laya.webgl.utils.VertexBuffer2D extends laya.webgl.utils.Buffer2D\r\n\tvar VertexBuffer2D=(function(_super){\r\n\t\tfunction VertexBuffer2D(vertexStride,bufferUsage){\r\n\t\t\tthis._floatArray32=null;\r\n\t\t\tthis._vertexStride=0;\r\n\t\t\tVertexBuffer2D.__super.call(this);\r\n\t\t\tthis._vertexStride=vertexStride;\r\n\t\t\tthis._bufferUsage=bufferUsage;\r\n\t\t\tthis._bufferType=/*laya.webgl.WebGLContext.ARRAY_BUFFER*/0x8892;\r\n\t\t\tRender.isFlash || (this._buffer=new ArrayBuffer(8));\r\n\t\t\tthis.getFloat32Array();\r\n\t\t}\r\n\r\n\t\t__class(VertexBuffer2D,'laya.webgl.utils.VertexBuffer2D',_super);\r\n\t\tvar __proto=VertexBuffer2D.prototype;\r\n\t\t__proto.getFloat32Array=function(){\r\n\t\t\treturn this._floatArray32 || (this._floatArray32=new Float32Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.bind=function(ibBuffer){\r\n\t\t\t(ibBuffer)&& (ibBuffer._bind());\r\n\t\t\tthis._bind();\r\n\t\t}\r\n\r\n\t\t__proto.insertData=function(data,pos){\r\n\t\t\tvar vbdata=this.getFloat32Array();\r\n\t\t\tvbdata.set(data,pos);\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.bind_upload=function(ibBuffer){\r\n\t\t\t(ibBuffer._bind_upload())|| (ibBuffer._bind());\r\n\t\t\t(this._bind_upload())|| (this._bind());\r\n\t\t}\r\n\r\n\t\t__proto._checkArrayUse=function(){\r\n\t\t\tthis._floatArray32 && (this._floatArray32=new Float32Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tfor (var i=0;i < 10;i++)\r\n\t\t\tWebGL.mainContext.disableVertexAttribArray(i);\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'vertexStride',function(){\r\n\t\t\treturn this._vertexStride;\r\n\t\t});\r\n\r\n\t\tVertexBuffer2D.create=function(vertexStride,bufferUsage){\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\treturn new VertexBuffer2D(vertexStride,bufferUsage);\r\n\t\t}\r\n\r\n\t\treturn VertexBuffer2D;\r\n\t})(Buffer2D)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLImage extends laya.resource.HTMLImage\r\n\tvar WebGLImage=(function(_super){\r\n\t\tfunction WebGLImage(src,def){\r\n\t\t\tthis._image=null;\r\n\t\t\tthis._allowMerageInAtlas=false;\r\n\t\t\tthis._enableMerageInAtlas=false;\r\n\t\t\tthis.repeat=false;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=0;\r\n\t\t\tthis.magFifter=0;\r\n\t\t\tWebGLImage.__super.call(this,src,def);\r\n\t\t\tthis.repeat=false;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=-1;\r\n\t\t\tthis.magFifter=-1;\r\n\t\t\tthis._src=src;\r\n\t\t\tthis._image=new Browser.window.Image();\r\n\t\t\tif (def){\r\n\t\t\t\tdef.onload && (this.onload=def.onload);\r\n\t\t\t\tdef.onerror && (this.onerror=def.onerror);\r\n\t\t\t\tdef.onCreate && def.onCreate(this);\r\n\t\t\t}\r\n\t\t\tthis._image.crossOrigin=(src && (src.indexOf(\"data:\")==0))? null :\"\";\r\n\t\t\t(src)&& (this._image.src=src);\r\n\t\t\tthis._enableMerageInAtlas=true;\r\n\t\t}\r\n\r\n\t\t__class(WebGLImage,'laya.webgl.resource.WebGLImage',_super);\r\n\t\tvar __proto=WebGLImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t__proto._init_=function(src,def){}\r\n\t\t__proto._createWebGlTexture=function(){\r\n\t\t\tif (!this._image){\r\n\t\t\t\tthrow \"create GLTextur err:no data:\"+this._image;\r\n\t\t\t};\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar glTex=this._source=gl.createTexture();\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,this._image);\r\n\t\t\tvar minFifter=this.minFifter;\r\n\t\t\tvar magFifter=this.magFifter;\r\n\t\t\tvar repeat=this.repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\t\tvar isPot=Arith.isPOT(this._w,this._h);\r\n\t\t\tif (isPot){\r\n\t\t\t\tif (this.mipmap)\r\n\t\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\t\telse\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\t\tthis.mipmap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t\t}else {\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t}\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tthis._image.onload=null;\r\n\t\t\tthis._image=null;\r\n\t\t\tif (isPot)\r\n\t\t\t\tthis.memorySize=this._w *this._h *4 *(1+1 / 3);\r\n\t\t\telse\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis._recreateLock=false;\r\n\t\t}\r\n\r\n\t\t/***重新创建资源，如果异步创建中被强制释放再创建，则需等待释放完成后再重新加载创建。*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tvar _$this=this;\r\n\t\t\tif (this._src==null || this._src===\"\")\r\n\t\t\t\treturn;\r\n\t\t\tthis._needReleaseAgain=false;\r\n\t\t\tif (!this._image){\r\n\t\t\t\tthis._recreateLock=true;\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tthis._image=new Browser.window.Image();\r\n\t\t\t\tthis._image.crossOrigin=this._src.indexOf(\"data:\")==0 ? null :\"\";\r\n\t\t\t\tthis._image.onload=function (){\r\n\t\t\t\t\tif (_this._needReleaseAgain){\r\n\t\t\t\t\t\t_this._needReleaseAgain=false;\r\n\t\t\t\t\t\t_this._image.onload=null;\r\n\t\t\t\t\t\t_this._image=null;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t(!(_this._allowMerageInAtlas && _this._enableMerageInAtlas))? (_this._createWebGlTexture()):(_$this.memorySize=0,_$this._recreateLock=false);\r\n\t\t\t\t\t_this.completeCreate();\r\n\t\t\t\t};\r\n\t\t\t\tthis._image.src=this._src;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (this._recreateLock){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\t(!(this._allowMerageInAtlas && this._enableMerageInAtlas))? (this._createWebGlTexture()):(this.memorySize=0,this._recreateLock=false);\r\n\t\t\t\tthis.completeCreate();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***销毁资源*/\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._recreateLock){\r\n\t\t\t\tthis._needReleaseAgain=true;\r\n\t\t\t}\r\n\t\t\tif (this._source){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis._image=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***调整尺寸*/\r\n\t\t__proto.onresize=function(){\r\n\t\t\tthis._w=this._image.width;\r\n\t\t\tthis._h=this._image.height;\r\n\t\t\t(AtlasResourceManager.enabled)&& (this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)? this._allowMerageInAtlas=true :this._allowMerageInAtlas=false;\r\n\t\t}\r\n\r\n\t\t__proto.clearAtlasSource=function(){\r\n\t\t\tthis._image=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回HTML Image,as3无internal货friend，通常禁止开发者修改image内的任何属性\r\n\t\t*@param HTML Image\r\n\t\t*/\r\n\t\t__getset(0,__proto,'image',function(){\r\n\t\t\treturn this._image;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\t\treturn this._allowMerageInAtlas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'atlasSource',function(){\r\n\t\t\treturn this._image;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source,通常禁止修改\r\n\t\t*@param value 是否创建\r\n\t\t*/\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\t\treturn this._enableMerageInAtlas;\r\n\t\t\t},function(value){\r\n\t\t\tthis._enableMerageInAtlas=value;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置onload函数\r\n\t\t*@param value onload函数\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onload',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onload=value;\r\n\t\t\tthis._image && (this._image.onload=this._onload !=null ? (function(){\r\n\t\t\t\t_$this.onresize();\r\n\t\t\t\t_$this._onload();\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置onerror函数\r\n\t\t*@param value onerror函数\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onerror',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onerror=value;\r\n\t\t\tthis._image && (this._image.onerror=this._onerror !=null ? (function(){\r\n\t\t\t\t_$this._onerror()\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\treturn WebGLImage;\r\n\t})(HTMLImage)\r\n\r\n\r\n\tLaya.__init([DrawText,WebGLContext,AtlasGrid,WebGLContext2D,RenderTargetMAX,ShaderCompile]);\r\n\tnew LayaMain();\r\n\r\n})(window,document,Laya);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/libs/laya.core.js\n// module id = 31\n// module chunks = 3","\r\n(function(window,document,Laya){\r\n\tvar __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;\r\n\r\n\tvar Arith=laya.maths.Arith,Bezier=laya.maths.Bezier,Bitmap=laya.resource.Bitmap,Browser=laya.utils.Browser;\r\n\tvar Color=laya.utils.Color,ColorFilter=laya.filters.ColorFilter,Config=Laya.Config,Context=laya.resource.Context;\r\n\tvar Event=laya.events.Event,Filter=laya.filters.Filter,Graphics=laya.display.Graphics,HTMLCanvas=laya.resource.HTMLCanvas;\r\n\tvar HTMLChar=laya.utils.HTMLChar,HTMLImage=laya.resource.HTMLImage,Handler=laya.utils.Handler,Matrix=laya.maths.Matrix;\r\n\tvar Point=laya.maths.Point,Rectangle=laya.maths.Rectangle,Render=laya.renders.Render,RenderContext=laya.renders.RenderContext;\r\n\tvar RenderSprite=laya.renders.RenderSprite,Resource=laya.resource.Resource,ResourceManager=laya.resource.ResourceManager;\r\n\tvar RunDriver=laya.utils.RunDriver,Sprite=laya.display.Sprite,Stat=laya.utils.Stat,StringKey=laya.utils.StringKey;\r\n\tvar Style=laya.display.css.Style,System=laya.system.System,Texture=laya.resource.Texture,Utils=laya.utils.Utils;\r\n\tvar VectorGraphManager=laya.utils.VectorGraphManager,WordText=laya.utils.WordText;\r\n\tLaya.interface('laya.webgl.shapes.IShape');\r\n\tLaya.interface('laya.webgl.submit.ISubmit');\r\n\tLaya.interface('laya.webgl.text.ICharSegment');\r\n\tLaya.interface('laya.webgl.canvas.save.ISaveData');\r\n\tLaya.interface('laya.webgl.resource.IMergeAtlasBitmap');\r\n\tLaya.interface('laya.filters.IFilterActionGL','laya.filters.IFilterAction');\r\n\t//class laya.filters.webgl.FilterActionGL\r\n\tvar FilterActionGL=(function(){\r\n\t\tfunction FilterActionGL(){}\r\n\t\t__class(FilterActionGL,'laya.filters.webgl.FilterActionGL');\r\n\t\tvar __proto=FilterActionGL.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilterActionGL\":true})\r\n\t\t__proto.setValue=function(shader){}\r\n\t\t__proto.setValueMix=function(shader){}\r\n\t\t__proto.apply3d=function(scope,sprite,context,x,y){return null;}\r\n\t\t__proto.apply=function(srcCanvas){return null;}\r\n\t\t__getset(0,__proto,'typeMix',function(){\r\n\t\t\treturn 0;\r\n\t\t});\r\n\r\n\t\treturn FilterActionGL;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.ShaderValue\r\n\tvar ShaderValue=(function(){\r\n\t\tfunction ShaderValue(){}\r\n\t\t__class(ShaderValue,'laya.webgl.shader.ShaderValue');\r\n\t\treturn ShaderValue;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasGrid\r\n\tvar AtlasGrid=(function(){\r\n\t\tvar TexRowInfo,TexMergeTexSize;\r\n\t\tfunction AtlasGrid(width,height,atlasID){\r\n\t\t\tthis._atlasID=0;\r\n\t\t\tthis._width=0;\r\n\t\t\tthis._height=0;\r\n\t\t\tthis._texCount=0;\r\n\t\t\tthis._rowInfo=null;\r\n\t\t\tthis._cells=null;\r\n\t\t\tthis._failSize=new TexMergeTexSize();\r\n\t\t\t(width===void 0)&& (width=0);\r\n\t\t\t(height===void 0)&& (height=0);\r\n\t\t\t(atlasID===void 0)&& (atlasID=0);\r\n\t\t\tthis._cells=null;\r\n\t\t\tthis._rowInfo=null;\r\n\t\t\tthis._init(width,height);\r\n\t\t\tthis._atlasID=atlasID;\r\n\t\t}\r\n\r\n\t\t__class(AtlasGrid,'laya.webgl.atlas.AtlasGrid');\r\n\t\tvar __proto=AtlasGrid.prototype;\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto.getAltasID=function(){\r\n\t\t\treturn this._atlasID;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto.setAltasID=function(atlasID){\r\n\t\t\tif (atlasID >=0){\r\n\t\t\t\tthis._atlasID=atlasID;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto.addTex=function(type,width,height){\r\n\t\t\tvar result=this._get(width,height);\r\n\t\t\tif (result.ret==false){\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\tthis._fill(result.x,result.y,width,height,type);\r\n\t\t\tthis._texCount++;\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto._release=function(){\r\n\t\t\tif (this._cells !=null){\r\n\t\t\t\tthis._cells.length=0;\r\n\t\t\t\tthis._cells=null;\r\n\t\t\t}\r\n\t\t\tif (this._rowInfo){\r\n\t\t\t\tthis._rowInfo.length=0;\r\n\t\t\t\tthis._rowInfo=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------------------\r\n\t\t__proto._init=function(width,height){\r\n\t\t\tthis._width=width;\r\n\t\t\tthis._height=height;\r\n\t\t\tthis._release();\r\n\t\t\tif (this._width==0)return false;\r\n\t\t\tthis._cells=new Uint8Array(this._width *this._height*3);\r\n\t\t\tthis._rowInfo=__newvec(this._height);\r\n\t\t\tfor (var i=0;i < this._height;i++){\r\n\t\t\t\tthis._rowInfo[i]=new TexRowInfo();\r\n\t\t\t}\r\n\t\t\tthis._clear();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._get=function(width,height){\r\n\t\t\tvar pFillInfo=new MergeFillInfo();\r\n\t\t\tif (width >=this._failSize.width && height >=this._failSize.height){\r\n\t\t\t\treturn pFillInfo;\r\n\t\t\t};\r\n\t\t\tvar rx=-1;\r\n\t\t\tvar ry=-1;\r\n\t\t\tvar nWidth=this._width;\r\n\t\t\tvar nHeight=this._height;\r\n\t\t\tvar pCellBox=this._cells;\r\n\t\t\tfor (var y=0;y < nHeight;y++){\r\n\t\t\t\tif (this._rowInfo[y].spaceCount < width)continue ;\r\n\t\t\t\tfor (var x=0;x < nWidth;){\r\n\t\t\t\t\tvar tm=(y *nWidth+x)*3;\r\n\t\t\t\t\tif (pCellBox[tm] !=0 || pCellBox[tm+1] < width || pCellBox[tm+2] < height){\r\n\t\t\t\t\t\tx+=pCellBox[tm+1];\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\trx=x;\r\n\t\t\t\t\try=y;\r\n\t\t\t\t\tfor (var xx=0;xx < width;xx++){\r\n\t\t\t\t\t\tif (pCellBox[3*xx+tm+2] < height){\r\n\t\t\t\t\t\t\trx=-1;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (rx < 0){\r\n\t\t\t\t\t\tx+=pCellBox[tm+1];\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpFillInfo.ret=true;\r\n\t\t\t\t\tpFillInfo.x=rx;\r\n\t\t\t\t\tpFillInfo.y=ry;\r\n\t\t\t\t\treturn pFillInfo;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn pFillInfo;\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._fill=function(x,y,w,h,type){\r\n\t\t\tvar nWidth=this._width;\r\n\t\t\tvar nHeghit=this._height;\r\n\t\t\tthis._check((x+w)<=nWidth && (y+h)<=nHeghit);\r\n\t\t\tfor (var yy=y;yy < (h+y);++yy){\r\n\t\t\t\tthis._check(this._rowInfo[yy].spaceCount >=w);\r\n\t\t\t\tthis._rowInfo[yy].spaceCount-=w;\r\n\t\t\t\tfor (var xx=0;xx < w;xx++){\r\n\t\t\t\t\tvar tm=(x+yy *nWidth+xx)*3;\r\n\t\t\t\t\tthis._check(this._cells[tm]==0);\r\n\t\t\t\t\tthis._cells[tm]=type;\r\n\t\t\t\t\tthis._cells[tm+1]=w;\r\n\t\t\t\t\tthis._cells[tm+2]=h;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (x > 0){\r\n\t\t\t\tfor (yy=0;yy < h;++yy){\r\n\t\t\t\t\tvar s=0;\r\n\t\t\t\t\tfor (xx=x-1;xx >=0;--xx,++s){\r\n\t\t\t\t\t\tif (this._cells[((y+yy)*nWidth+xx)*3] !=0)break ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (xx=s;xx > 0;--xx){\r\n\t\t\t\t\t\tthis._cells[((y+yy)*nWidth+x-xx)*3+1]=xx;\r\n\t\t\t\t\t\tthis._check(xx > 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (y > 0){\r\n\t\t\t\tfor (xx=x;xx < (x+w);++xx){\r\n\t\t\t\t\ts=0;\r\n\t\t\t\t\tfor (yy=y-1;yy >=0;--yy,s++){\r\n\t\t\t\t\t\tif (this._cells[(xx+yy *nWidth)*3] !=0)break ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (yy=s;yy > 0;--yy){\r\n\t\t\t\t\t\tthis._cells[(xx+(y-yy)*nWidth)*3+2]=yy;\r\n\t\t\t\t\t\tthis._check(yy > 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._check=function(ret){\r\n\t\t\tif (ret==false){\r\n\t\t\t\tconsole.log(\"xtexMerger 错误啦\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//------------------------------------------------------------------\r\n\t\t__proto._clear=function(){\r\n\t\t\tthis._texCount=0;\r\n\t\t\tfor (var y=0;y < this._height;y++){\r\n\t\t\t\tthis._rowInfo[y].spaceCount=this._width;\r\n\t\t\t}\r\n\t\t\tfor (var i=0;i < this._height;i++){\r\n\t\t\t\tfor (var j=0;j < this._width;j++){\r\n\t\t\t\t\tvar tm=(i *this._width+j)*3;\r\n\t\t\t\t\tthis._cells[tm]=0;\r\n\t\t\t\t\tthis._cells[tm+1]=this._width-j;\r\n\t\t\t\t\tthis._cells[tm+2]=this._width-i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._failSize.width=this._width+1;\r\n\t\t\tthis._failSize.height=this._height+1;\r\n\t\t}\r\n\r\n\t\tAtlasGrid.__init$=function(){\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t//class TexRowInfo\r\n\t\t\tTexRowInfo=(function(){\r\n\t\t\t\tfunction TexRowInfo(){\r\n\t\t\t\t\tthis.spaceCount=0;\r\n\t\t\t\t}\r\n\t\t\t\t__class(TexRowInfo,'');\r\n\t\t\t\treturn TexRowInfo;\r\n\t\t\t})()\r\n\t\t\t//------------------------------------------------------------------------------\r\n\t\t\t//class TexMergeTexSize\r\n\t\t\tTexMergeTexSize=(function(){\r\n\t\t\t\tfunction TexMergeTexSize(){\r\n\t\t\t\t\tthis.width=0;\r\n\t\t\t\t\tthis.height=0;\r\n\t\t\t\t}\r\n\t\t\t\t__class(TexMergeTexSize,'');\r\n\t\t\t\treturn TexMergeTexSize;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn AtlasGrid;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasResourceManager\r\n\tvar AtlasResourceManager=(function(){\r\n\t\tfunction AtlasResourceManager(width,height,gridSize,maxTexNum){\r\n\t\t\tthis._currentAtlasCount=0;\r\n\t\t\tthis._maxAtlaserCount=0;\r\n\t\t\tthis._width=0;\r\n\t\t\tthis._height=0;\r\n\t\t\tthis._gridSize=0;\r\n\t\t\tthis._gridNumX=0;\r\n\t\t\tthis._gridNumY=0;\r\n\t\t\tthis._init=false;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t\tthis._setAtlasParam=false;\r\n\t\t\tthis._atlaserArray=null;\r\n\t\t\tthis._needGC=false;\r\n\t\t\tthis._setAtlasParam=true;\r\n\t\t\tthis._width=width;\r\n\t\t\tthis._height=height;\r\n\t\t\tthis._gridSize=gridSize;\r\n\t\t\tthis._maxAtlaserCount=maxTexNum;\r\n\t\t\tthis._gridNumX=width / gridSize;\r\n\t\t\tthis._gridNumY=height / gridSize;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t\tthis._atlaserArray=[];\r\n\t\t}\r\n\r\n\t\t__class(AtlasResourceManager,'laya.webgl.atlas.AtlasResourceManager');\r\n\t\tvar __proto=AtlasResourceManager.prototype;\r\n\t\t__proto.setAtlasParam=function(width,height,gridSize,maxTexNum){\r\n\t\t\tif (this._setAtlasParam==true){\r\n\t\t\t\tAtlasResourceManager._sid_=0;\r\n\t\t\t\tthis._width=width;\r\n\t\t\t\tthis._height=height;\r\n\t\t\t\tthis._gridSize=gridSize;\r\n\t\t\t\tthis._maxAtlaserCount=maxTexNum;\r\n\t\t\t\tthis._gridNumX=width / gridSize;\r\n\t\t\t\tthis._gridNumY=height / gridSize;\r\n\t\t\t\tthis._curAtlasIndex=0;\r\n\t\t\t\tthis.freeAll();\r\n\t\t\t\treturn true;\r\n\t\t\t\t}else {\r\n\t\t\t\tconsole.log(\"设置大图合集参数错误，只能在开始页面设置各种参数\");\r\n\t\t\t\tthrow-1;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t//添加 图片到大图集\r\n\t\t__proto.pushData=function(texture){\r\n\t\t\tvar tex=texture;\r\n\t\t\tthis._setAtlasParam=false;\r\n\t\t\tvar bFound=false;\r\n\t\t\tvar nImageGridX=(Math.ceil((texture.bitmap.width+2)/ this._gridSize));\r\n\t\t\tvar nImageGridY=(Math.ceil((texture.bitmap.height+2)/ this._gridSize));\r\n\t\t\tvar bSuccess=false;\r\n\t\t\tfor (var k=0;k < 2;k++){\r\n\t\t\t\tvar maxAtlaserCount=this._maxAtlaserCount;\r\n\t\t\t\tfor (var i=0;i < maxAtlaserCount;i++){\r\n\t\t\t\t\tvar altasIndex=(this._curAtlasIndex+i)% maxAtlaserCount;\r\n\t\t\t\t\t(this._atlaserArray.length-1>=altasIndex)|| (this._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++)));\r\n\t\t\t\t\tvar atlas=this._atlaserArray[altasIndex];\r\n\t\t\t\t\tvar bitmap=texture.bitmap;\r\n\t\t\t\t\tvar webGLImageIndex=atlas.inAtlasWebGLImagesKey.indexOf(bitmap);\r\n\t\t\t\t\tvar offsetX=0,offsetY=0;\r\n\t\t\t\t\tif (webGLImageIndex==-1){\r\n\t\t\t\t\t\tvar fillInfo=atlas.addTex(1,nImageGridX,nImageGridY);\r\n\t\t\t\t\t\tif (fillInfo.ret){\r\n\t\t\t\t\t\t\toffsetX=fillInfo.x *this._gridSize+1;\r\n\t\t\t\t\t\t\toffsetY=fillInfo.y *this._gridSize+1;\r\n\t\t\t\t\t\t\tbitmap.lock=true;\r\n\t\t\t\t\t\t\tatlas.addToAtlasTexture((bitmap),offsetX,offsetY);\r\n\t\t\t\t\t\t\tatlas.addToAtlas(texture,offsetX,offsetY);\r\n\t\t\t\t\t\t\tbSuccess=true;\r\n\t\t\t\t\t\t\tthis._curAtlasIndex=altasIndex;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvar offset=atlas.InAtlasWebGLImagesOffsetValue[webGLImageIndex];\r\n\t\t\t\t\t\toffsetX=offset[0];\r\n\t\t\t\t\t\toffsetY=offset[1];\r\n\t\t\t\t\t\tatlas.addToAtlas(texture,offsetX,offsetY);\r\n\t\t\t\t\t\tbSuccess=true;\r\n\t\t\t\t\t\tthis._curAtlasIndex=altasIndex;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (bSuccess)\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tthis._atlaserArray.push(new Atlaser(this._gridNumX,this._gridNumY,this._width,this._height,AtlasResourceManager._sid_++));\r\n\t\t\t\tthis._needGC=true;\r\n\t\t\t\tthis.garbageCollection();\r\n\t\t\t\tthis._curAtlasIndex=this._atlaserArray.length-1;\r\n\t\t\t}\r\n\t\t\tif (!bSuccess){\r\n\t\t\t\tconsole.log(\">>>AtlasManager pushData error\");\r\n\t\t\t}\r\n\t\t\treturn bSuccess;\r\n\t\t}\r\n\r\n\t\t__proto.addToAtlas=function(tex){\r\n\t\t\tlaya.webgl.atlas.AtlasResourceManager.instance.pushData(tex);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*回收大图合集,不建议手动调用\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.garbageCollection=function(){\r\n\t\t\tif (this._needGC===true){\r\n\t\t\t\tvar n=this._atlaserArray.length-this._maxAtlaserCount;\r\n\t\t\t\tfor (var i=0;i < n;i++)\r\n\t\t\t\tthis._atlaserArray[i].dispose();\r\n\t\t\t\tthis._atlaserArray.splice(0,n);\r\n\t\t\t\tthis._needGC=false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.freeAll=function(){\r\n\t\t\tfor (var i=0,n=this._atlaserArray.length;i < n;i++){\r\n\t\t\t\tthis._atlaserArray[i].dispose();\r\n\t\t\t}\r\n\t\t\tthis._atlaserArray.length=0;\r\n\t\t\tthis._curAtlasIndex=0;\r\n\t\t}\r\n\r\n\t\t__proto.getAtlaserCount=function(){\r\n\t\t\treturn this._atlaserArray.length;\r\n\t\t}\r\n\r\n\t\t__proto.getAtlaserByIndex=function(index){\r\n\t\t\treturn this._atlaserArray[index];\r\n\t\t}\r\n\r\n\t\t__getset(1,AtlasResourceManager,'instance',function(){\r\n\t\t\tif (!AtlasResourceManager._Instance){\r\n\t\t\t\tAtlasResourceManager._Instance=new AtlasResourceManager(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,/*CLASS CONST:laya.webgl.atlas.AtlasResourceManager.gridSize*/16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount);\r\n\t\t\t}\r\n\t\t\treturn AtlasResourceManager._Instance;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'enabled',function(){\r\n\t\t\treturn AtlasResourceManager._enabled;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'atlasLimitWidth',function(){\r\n\t\t\treturn AtlasResourceManager._atlasLimitWidth;\r\n\t\t\t},function(value){\r\n\t\t\tAtlasResourceManager._atlasLimitWidth=value;\r\n\t\t});\r\n\r\n\t\t__getset(1,AtlasResourceManager,'atlasLimitHeight',function(){\r\n\t\t\treturn AtlasResourceManager._atlasLimitHeight;\r\n\t\t\t},function(value){\r\n\t\t\tAtlasResourceManager._atlasLimitHeight=value;\r\n\t\t});\r\n\r\n\t\tAtlasResourceManager._enable=function(){\r\n\t\t\tAtlasResourceManager._enabled=true;\r\n\t\t\tConfig.atlasEnable=true;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager._disable=function(){\r\n\t\t\tAtlasResourceManager._enabled=false;\r\n\t\t\tConfig.atlasEnable=false;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager.__init__=function(){\r\n\t\t\tAtlasResourceManager.atlasTextureWidth=2048;\r\n\t\t\tAtlasResourceManager.atlasTextureHeight=2048;\r\n\t\t\tAtlasResourceManager.maxTextureCount=6;\r\n\t\t\tAtlasResourceManager.atlasLimitWidth=512;\r\n\t\t\tAtlasResourceManager.atlasLimitHeight=512;\r\n\t\t}\r\n\r\n\t\tAtlasResourceManager._enabled=false;\r\n\t\tAtlasResourceManager._atlasLimitWidth=0;\r\n\t\tAtlasResourceManager._atlasLimitHeight=0;\r\n\t\tAtlasResourceManager.gridSize=16;\r\n\t\tAtlasResourceManager.atlasTextureWidth=0;\r\n\t\tAtlasResourceManager.atlasTextureHeight=0;\r\n\t\tAtlasResourceManager.maxTextureCount=0;\r\n\t\tAtlasResourceManager._atlasRestore=0;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_NO=0;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_RIGHT=1;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_LEFT=2;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_BOTTOM=4;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_TOP=8;\r\n\t\tAtlasResourceManager.BOARDER_TYPE_ALL=15;\r\n\t\tAtlasResourceManager._sid_=0;\r\n\t\tAtlasResourceManager._Instance=null;\r\n\t\treturn AtlasResourceManager;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.atlas.MergeFillInfo\r\n\tvar MergeFillInfo=(function(){\r\n\t\tfunction MergeFillInfo(){\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t\tthis.ret=false;\r\n\t\t\tthis.ret=false;\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t}\r\n\r\n\t\t__class(MergeFillInfo,'laya.webgl.atlas.MergeFillInfo');\r\n\t\treturn MergeFillInfo;\r\n\t})()\r\n\r\n\r\n\t;\r\n\t//class laya.webgl.canvas.BlendMode\r\n\tvar BlendMode=(function(){\r\n\t\tfunction BlendMode(){};\r\n\t\t__class(BlendMode,'laya.webgl.canvas.BlendMode');\r\n\t\tBlendMode._init_=function(gl){\r\n\t\t\tBlendMode.fns=[BlendMode.BlendNormal,BlendMode.BlendAdd,BlendMode.BlendMultiply,BlendMode.BlendScreen,BlendMode.BlendOverlay,BlendMode.BlendLight,BlendMode.BlendMask,BlendMode.BlendDestinationOut];\r\n\t\t\tBlendMode.targetFns=[BlendMode.BlendNormalTarget,BlendMode.BlendAddTarget,BlendMode.BlendMultiplyTarget,BlendMode.BlendScreenTarget,BlendMode.BlendOverlayTarget,BlendMode.BlendLightTarget,BlendMode.BlendMask,BlendMode.BlendDestinationOut];\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendNormal=function(gl){\r\n\t\t\tgl.blendFuncSeparate(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303,/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendAdd=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.DST_ALPHA*/0x0304);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMultiply=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.DST_COLOR*/0x0306,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendScreen=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendOverlay=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_COLOR*/0x0301);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendLight=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendNormalTarget=function(gl){\r\n\t\t\tgl.blendFuncSeparate(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303,/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendAddTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.DST_ALPHA*/0x0304);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMultiplyTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.DST_COLOR*/0x0306,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_ALPHA*/0x0303);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendScreenTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendOverlayTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ONE*/1,/*laya.webgl.WebGLContext.ONE_MINUS_SRC_COLOR*/0x0301);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendLightTarget=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302,/*laya.webgl.WebGLContext.ONE*/1);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendMask=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ZERO*/0,/*laya.webgl.WebGLContext.SRC_ALPHA*/0x0302);\r\n\t\t}\r\n\r\n\t\tBlendMode.BlendDestinationOut=function(gl){\r\n\t\t\tgl.blendFunc(/*laya.webgl.WebGLContext.ZERO*/0,/*laya.webgl.WebGLContext.ZERO*/0);\r\n\t\t}\r\n\r\n\t\tBlendMode.activeBlendFunction=null;\r\n\t\tBlendMode.NAMES=[\"normal\",\"add\",\"multiply\",\"screen\",\"overlay\",\"light\",\"mask\",\"destination-out\"];\r\n\t\tBlendMode.TOINT={\"normal\":0,\"add\":1,\"multiply\":2,\"screen\":3 ,\"lighter\":1,\"overlay\":4,\"light\":5,\"mask\":6,\"destination-out\":7};\r\n\t\tBlendMode.NORMAL=\"normal\";\r\n\t\tBlendMode.ADD=\"add\";\r\n\t\tBlendMode.MULTIPLY=\"multiply\";\r\n\t\tBlendMode.SCREEN=\"screen\";\r\n\t\tBlendMode.LIGHT=\"light\";\r\n\t\tBlendMode.OVERLAY=\"overlay\";\r\n\t\tBlendMode.DESTINATIONOUT=\"destination-out\";\r\n\t\tBlendMode.fns=[];\r\n\t\tBlendMode.targetFns=[];\r\n\t\treturn BlendMode;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.DrawStyle\r\n\tvar DrawStyle=(function(){\r\n\t\tfunction DrawStyle(value){\r\n\t\t\tthis._color=Color.create(\"black\");\r\n\t\t\tthis.setValue(value);\r\n\t\t}\r\n\r\n\t\t__class(DrawStyle,'laya.webgl.canvas.DrawStyle');\r\n\t\tvar __proto=DrawStyle.prototype;\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tif ((typeof value=='string')){\r\n\t\t\t\t\tthis._color=Color.create(value);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ((value instanceof laya.utils.Color )){\r\n\t\t\t\t\tthis._color=value;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis._color=Color.create(\"black\");\r\n\t\t}\r\n\r\n\t\t__proto.equal=function(value){\r\n\t\t\tif ((typeof value=='string'))return this._color.strColor===value;\r\n\t\t\tif ((value instanceof laya.utils.Color ))return this._color.numColor===(value).numColor;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto.toColorStr=function(){\r\n\t\t\treturn this._color.strColor;\r\n\t\t}\r\n\r\n\t\tDrawStyle.create=function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tvar color;\r\n\t\t\t\tif ((typeof value=='string'))color=Color.create(value);\r\n\t\t\t\telse if ((value instanceof laya.utils.Color ))color=value;\r\n\t\t\t\tif (color){\r\n\t\t\t\t\treturn color._drawStyle || (color._drawStyle=new DrawStyle(value));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tDrawStyle.DEFAULT=new DrawStyle(\"#000000\");\r\n\t\treturn DrawStyle;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.Path\r\n\tvar Path=(function(){\r\n\t\tfunction Path(){\r\n\t\t\tthis._x=0;\r\n\t\t\tthis._y=0;\r\n\t\t\t//this._rect=null;\r\n\t\t\t//this.ib=null;\r\n\t\t\t//this.vb=null;\r\n\t\t\tthis.dirty=false;\r\n\t\t\t//this.geomatrys=null;\r\n\t\t\t//this._curGeomatry=null;\r\n\t\t\tthis.offset=0;\r\n\t\t\tthis.count=0;\r\n\t\t\tthis.geoStart=0;\r\n\t\t\tthis.tempArray=[];\r\n\t\t\tthis.closePath=false;\r\n\t\t\tthis.geomatrys=[];\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\tthis.vb=VertexBuffer2D.create(5);\r\n\t\t}\r\n\r\n\t\t__class(Path,'laya.webgl.canvas.Path');\r\n\t\tvar __proto=Path.prototype;\r\n\t\t__proto.addPoint=function(pointX,pointY){\r\n\t\t\tthis.tempArray.push(pointX,pointY);\r\n\t\t}\r\n\r\n\t\t__proto.getEndPointX=function(){\r\n\t\t\treturn this.tempArray[this.tempArray.length-2];\r\n\t\t}\r\n\r\n\t\t__proto.getEndPointY=function(){\r\n\t\t\treturn this.tempArray[this.tempArray.length-1];\r\n\t\t}\r\n\r\n\t\t__proto.polygon=function(x,y,points,color,borderWidth,borderColor){\r\n\t\t\tvar geo;\r\n\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new Polygon(x,y,points,color,borderWidth,borderColor));\r\n\t\t\tif (!color)geo.fill=false;\r\n\t\t\tif (borderColor==undefined)geo.borderWidth=0;\r\n\t\t\treturn geo;\r\n\t\t}\r\n\r\n\t\t__proto.setGeomtry=function(shape){\r\n\t\t\tthis.geomatrys.push(this._curGeomatry=shape);\r\n\t\t}\r\n\r\n\t\t__proto.drawLine=function(x,y,points,width,color){\r\n\t\t\tvar geo;\r\n\t\t\tif (this.closePath){\r\n\t\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new LoopLine(x,y,points,width,color));\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.geomatrys.push(this._curGeomatry=geo=new Line(x,y,points,width,color));\r\n\t\t\t}\r\n\t\t\tgeo.fill=false;\r\n\t\t\treturn geo;\r\n\t\t}\r\n\r\n\t\t__proto.update=function(){\r\n\t\t\tvar si=this.ib.byteLength;\r\n\t\t\tvar len=this.geomatrys.length;\r\n\t\t\tthis.offset=si;\r\n\t\t\tfor (var i=this.geoStart;i < len;i++){\r\n\t\t\t\tthis.geomatrys[i].getData(this.ib,this.vb,this.vb.byteLength / 20);\r\n\t\t\t}\r\n\t\t\tthis.geoStart=len;\r\n\t\t\tthis.count=(this.ib.byteLength-si)/ CONST3D2D.BYTES_PIDX;\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis.vb.clear();\r\n\t\t\tthis.ib.clear();\r\n\t\t\tthis.offset=this.count=this.geoStart=0;\r\n\t\t\tthis.geomatrys.length=0;\r\n\t\t}\r\n\r\n\t\treturn Path;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveBase\r\n\tvar SaveBase=(function(){\r\n\t\tfunction SaveBase(){\r\n\t\t\t//this._valueName=null;\r\n\t\t\t//this._value=null;\r\n\t\t\t//this._dataObj=null;\r\n\t\t\t//this._newSubmit=false;\r\n\t\t}\r\n\r\n\t\t__class(SaveBase,'laya.webgl.canvas.save.SaveBase');\r\n\t\tvar __proto=SaveBase.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tthis._dataObj[this._valueName]=this._value;\r\n\t\t\tSaveBase._cache[SaveBase._cache._length++]=this;\r\n\t\t\tthis._newSubmit && (context._curSubmit=Submit.RENDERBASE,context._renderKey=0);\r\n\t\t}\r\n\r\n\t\tSaveBase._createArray=function(){\r\n\t\t\tvar value=[];\r\n\t\t\tvalue._length=0;\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tSaveBase._init=function(){\r\n\t\t\tvar namemap=SaveBase._namemap={};\r\n\t\t\tnamemap[0x1]=\"ALPHA\";\r\n\t\t\tnamemap[0x2]=\"fillStyle\";\r\n\t\t\tnamemap[0x8]=\"font\";\r\n\t\t\tnamemap[0x100]=\"lineWidth\";\r\n\t\t\tnamemap[0x200]=\"strokeStyle\";\r\n\t\t\tnamemap[0x2000]=\"_mergeID\";\r\n\t\t\tnamemap[0x400]=namemap[0x800]=namemap[0x1000]=[];\r\n\t\t\tnamemap[0x4000]=\"textBaseline\";\r\n\t\t\tnamemap[0x8000]=\"textAlign\";\r\n\t\t\tnamemap[0x10000]=\"_nBlendType\";\r\n\t\t\tnamemap[0x80000]=\"shader\";\r\n\t\t\tnamemap[0x100000]=\"filters\";\r\n\t\t\treturn namemap;\r\n\t\t}\r\n\r\n\t\tSaveBase.save=function(context,type,dataObj,newSubmit){\r\n\t\t\tif ((context._saveMark._saveuse & type)!==type){\r\n\t\t\t\tcontext._saveMark._saveuse |=type;\r\n\t\t\t\tvar cache=SaveBase._cache;\r\n\t\t\t\tvar o=cache._length > 0 ? cache[--cache._length] :(new SaveBase());\r\n\t\t\t\to._value=dataObj[o._valueName=SaveBase._namemap[type]];\r\n\t\t\t\to._dataObj=dataObj;\r\n\t\t\t\to._newSubmit=newSubmit;\r\n\t\t\t\tvar _save=context._save;\r\n\t\t\t\t_save[_save._length++]=o;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSaveBase._cache=laya.webgl.canvas.save.SaveBase._createArray();\r\n\t\tSaveBase._namemap=SaveBase._init();\r\n\t\treturn SaveBase;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveClipRect\r\n\tvar SaveClipRect=(function(){\r\n\t\tfunction SaveClipRect(){\r\n\t\t\t//this._clipSaveRect=null;\r\n\t\t\t//this._submitScissor=null;\r\n\t\t\tthis._clipRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(SaveClipRect,'laya.webgl.canvas.save.SaveClipRect');\r\n\t\tvar __proto=SaveClipRect.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._clipRect=this._clipSaveRect;\r\n\t\t\tSaveClipRect._cache[SaveClipRect._cache._length++]=this;\r\n\t\t\tthis._submitScissor.submitLength=context._submits._length-this._submitScissor.submitIndex;\r\n\t\t\tcontext._curSubmit=Submit.RENDERBASE;\r\n\t\t\tcontext._renderKey=0;\r\n\t\t}\r\n\r\n\t\tSaveClipRect.save=function(context,submitScissor){\r\n\t\t\tif ((context._saveMark._saveuse & /*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000)==/*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000)return;\r\n\t\t\tcontext._saveMark._saveuse |=/*laya.webgl.canvas.save.SaveBase.TYPE_CLIPRECT*/0x20000;\r\n\t\t\tvar cache=SaveClipRect._cache;\r\n\t\t\tvar o=cache._length > 0 ? cache[--cache._length] :(new SaveClipRect());\r\n\t\t\to._clipSaveRect=context._clipRect;\r\n\t\t\tcontext._clipRect=o._clipRect.copyFrom(context._clipRect);\r\n\t\t\to._submitScissor=submitScissor;\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveClipRect._cache=SaveBase._createArray();\r\n\t\treturn SaveClipRect;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveMark\r\n\tvar SaveMark=(function(){\r\n\t\tfunction SaveMark(){\r\n\t\t\tthis._saveuse=0;\r\n\t\t\t//this._preSaveMark=null;\r\n\t\t\t;\r\n\t\t}\r\n\r\n\t\t__class(SaveMark,'laya.webgl.canvas.save.SaveMark');\r\n\t\tvar __proto=SaveMark.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._saveMark=this._preSaveMark;\r\n\t\t\tSaveMark._no[SaveMark._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveMark.Create=function(context){\r\n\t\t\tvar no=SaveMark._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveMark());\r\n\t\t\to._saveuse=0;\r\n\t\t\to._preSaveMark=context._saveMark;\r\n\t\t\tcontext._saveMark=o;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSaveMark._no=SaveBase._createArray();\r\n\t\treturn SaveMark;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveTransform\r\n\tvar SaveTransform=(function(){\r\n\t\tfunction SaveTransform(){\r\n\t\t\t//this._savematrix=null;\r\n\t\t\tthis._matrix=new Matrix();\r\n\t\t}\r\n\r\n\t\t__class(SaveTransform,'laya.webgl.canvas.save.SaveTransform');\r\n\t\tvar __proto=SaveTransform.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tcontext._curMat=this._savematrix;\r\n\t\t\tSaveTransform._no[SaveTransform._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveTransform.save=function(context){\r\n\t\t\tvar _saveMark=context._saveMark;\r\n\t\t\tif ((_saveMark._saveuse & /*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800)===/*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800)return;\r\n\t\t\t_saveMark._saveuse |=/*laya.webgl.canvas.save.SaveBase.TYPE_TRANSFORM*/0x800;\r\n\t\t\tvar no=SaveTransform._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveTransform());\r\n\t\t\to._savematrix=context._curMat;\r\n\t\t\tcontext._curMat=context._curMat.copyTo(o._matrix);\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveTransform._no=SaveBase._createArray();\r\n\t\treturn SaveTransform;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.canvas.save.SaveTranslate\r\n\tvar SaveTranslate=(function(){\r\n\t\tfunction SaveTranslate(){\r\n\t\t\t//this._x=NaN;\r\n\t\t\t//this._y=NaN;\r\n\t\t}\r\n\r\n\t\t__class(SaveTranslate,'laya.webgl.canvas.save.SaveTranslate');\r\n\t\tvar __proto=SaveTranslate.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.canvas.save.ISaveData\":true})\r\n\t\t__proto.isSaveMark=function(){return false;}\r\n\t\t__proto.restore=function(context){\r\n\t\t\tvar mat=context._curMat;\r\n\t\t\tcontext._x=this._x;\r\n\t\t\tcontext._y=this._y;\r\n\t\t\tSaveTranslate._no[SaveTranslate._no._length++]=this;\r\n\t\t}\r\n\r\n\t\tSaveTranslate.save=function(context){\r\n\t\t\tvar no=SaveTranslate._no;\r\n\t\t\tvar o=no._length > 0 ? no[--no._length] :(new SaveTranslate());\r\n\t\t\to._x=context._x;\r\n\t\t\to._y=context._y;\r\n\t\t\tvar _save=context._save;\r\n\t\t\t_save[_save._length++]=o;\r\n\t\t}\r\n\r\n\t\tSaveTranslate._no=SaveBase._createArray();\r\n\t\treturn SaveTranslate;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.resource.RenderTargetMAX\r\n\tvar RenderTargetMAX=(function(){\r\n\t\tvar OneTarget;\r\n\t\tfunction RenderTargetMAX(){\r\n\t\t\tthis.oneTargets=null;\r\n\t\t\tthis.repaint=false;\r\n\t\t\tthis._width=NaN;\r\n\t\t\tthis._height=NaN;\r\n\t\t\tthis._clipRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(RenderTargetMAX,'laya.webgl.resource.RenderTargetMAX');\r\n\t\tvar __proto=RenderTargetMAX.prototype;\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tif (this._width===w && this._height===h)return;\r\n\t\t\tthis.repaint=true;\r\n\t\t\tthis._width=w;\r\n\t\t\tthis._height=h;\r\n\t\t\tif (!this.oneTargets)\r\n\t\t\t\tthis.oneTargets=new OneTarget(w,h);\r\n\t\t\telse\r\n\t\t\tthis.oneTargets.target.size(w,h);\r\n\t\t}\r\n\r\n\t\t__proto._flushToTarget=function(context,target){\r\n\t\t\tif (target._destroy)return;\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tvar preworldClipRect=RenderState2D.worldClipRect;\r\n\t\t\tRenderState2D.worldClipRect=this._clipRect;\r\n\t\t\tthis._clipRect.x=this._clipRect.y=0;\r\n\t\t\tthis._clipRect.width=this._width;\r\n\t\t\tthis._clipRect.height=this._height;\r\n\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tvar preAlpha=RenderState2D.worldAlpha;\r\n\t\t\tvar preMatrix4=RenderState2D.worldMatrix4;\r\n\t\t\tvar preMatrix=RenderState2D.worldMatrix;\r\n\t\t\tvar preFilters=RenderState2D.worldFilters;\r\n\t\t\tvar preShaderDefines=RenderState2D.worldShaderDefines;\r\n\t\t\tRenderState2D.worldMatrix=RenderTargetMAX._matrixDefault;\r\n\t\t\tRenderState2D.restoreTempArray();\r\n\t\t\tRenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;\r\n\t\t\tRenderState2D.worldAlpha=1;\r\n\t\t\tRenderState2D.worldFilters=null;\r\n\t\t\tRenderState2D.worldShaderDefines=null;\r\n\t\t\tBaseShader.activeShader=null;\r\n\t\t\ttarget.start();\r\n\t\t\tConfig.showCanvasMark ? target.clear(0,1,0,0.3):target.clear(0,0,0,0);\r\n\t\t\tcontext.flush();\r\n\t\t\ttarget.end();\r\n\t\t\tBaseShader.activeShader=null;\r\n\t\t\tRenderState2D.worldAlpha=preAlpha;\r\n\t\t\tRenderState2D.worldMatrix4=preMatrix4;\r\n\t\t\tRenderState2D.worldMatrix=preMatrix;\r\n\t\t\tRenderState2D.worldFilters=preFilters;\r\n\t\t\tRenderState2D.worldShaderDefines=preShaderDefines;\r\n\t\t\tRenderState2D.worldScissorTest=worldScissorTest\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\tvar y=RenderState2D.height-preworldClipRect.y-preworldClipRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(preworldClipRect.x,y,preworldClipRect.width,preworldClipRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\tRenderState2D.worldClipRect=preworldClipRect;\r\n\t\t}\r\n\r\n\t\t__proto.flush=function(context){\r\n\t\t\tif (this.repaint){\r\n\t\t\t\tthis._flushToTarget(context,this.oneTargets.target);\r\n\t\t\t\tthis.repaint=false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTo=function(context,x,y,width,height){\r\n\t\t\tcontext.drawTexture(this.oneTargets.target.getTexture(),x,y,width,height,0,0);\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tif (this.oneTargets){\r\n\t\t\t\tthis.oneTargets.target.destroy();\r\n\t\t\t\tthis.oneTargets.target=null;\r\n\t\t\t\tthis.oneTargets=null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__static(RenderTargetMAX,\r\n\t\t['_matrixDefault',function(){return this._matrixDefault=new Matrix();}\r\n\t\t]);\r\n\t\tRenderTargetMAX.__init$=function(){\r\n\t\t\t//class OneTarget\r\n\t\t\tOneTarget=(function(){\r\n\t\t\t\tfunction OneTarget(w,h){\r\n\t\t\t\t\t//this.x=NaN;\r\n\t\t\t\t\t//this.width=NaN;\r\n\t\t\t\t\t//this.height=NaN;\r\n\t\t\t\t\t//this.target=null;\r\n\t\t\t\t\tthis.width=w;\r\n\t\t\t\t\tthis.height=h;\r\n\t\t\t\t\tthis.target=RenderTarget2D.create(w,h);\r\n\t\t\t\t}\r\n\t\t\t\t__class(OneTarget,'');\r\n\t\t\t\treturn OneTarget;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn RenderTargetMAX;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.d2.Shader2D\r\n\tvar Shader2D=(function(){\r\n\t\tfunction Shader2D(){\r\n\t\t\tthis.ALPHA=1;\r\n\t\t\t//this.glTexture=null;\r\n\t\t\t//this.shader=null;\r\n\t\t\t//this.filters=null;\r\n\t\t\tthis.shaderType=0;\r\n\t\t\t//this.colorAdd=null;\r\n\t\t\t//this.strokeStyle=null;\r\n\t\t\t//this.fillStyle=null;\r\n\t\t\tthis.defines=new ShaderDefines2D();\r\n\t\t}\r\n\r\n\t\t__class(Shader2D,'laya.webgl.shader.d2.Shader2D');\r\n\t\tShader2D.__init__=function(){\r\n\t\t\tShader.addInclude(\"parts/ColorFilter_ps_uniform.glsl\",\"uniform vec4 colorAlpha;\\nuniform mat4 colorMat;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorFilter_ps_logic.glsl\",\"gl_FragColor = gl_FragColor * colorMat + colorAlpha/255.0;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/GlowFilter_ps_uniform.glsl\",\"uniform vec4 u_color;\\nuniform float u_strength;\\nuniform float u_blurX;\\nuniform float u_blurY;\\nuniform float u_offsetX;\\nuniform float u_offsetY;\\nuniform float u_textW;\\nuniform float u_textH;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/GlowFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/GlowFilter_ps_logic.glsl\",\"const float c_IterationTime = 10.0;\\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\\nfloat maxNum = u_blurX * u_blurY;\\nvec2 vec2Off = vec2(0.0,0.0);\\nfloat floatOff = c_IterationTime/2.0;\\nfor(float i = 0.0;i<=c_IterationTime; ++i){\\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\\n\t\tvec4Color += texture2D(texture, v_texcoord + vec2FilterDir + vec2Off)/floatIterationTotalTime;\\n\t}\\n}\\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/GlowFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_ps_logic.glsl\",\"gl_FragColor=vec4(0.0);\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 0])*0.004431848411938341;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 1])*0.05399096651318985;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 2])*0.2419707245191454;\\ngl_FragColor += texture2D(texture, v_texcoord        )*0.3989422804014327;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 3])*0.2419707245191454;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 4])*0.05399096651318985;\\ngl_FragColor += texture2D(texture, vBlurTexCoords[ 5])*0.004431848411938341;\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_ps_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_ps_uniform.glsl\",\"varying vec2 vBlurTexCoords[6];\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_vs_uniform.glsl\",\"uniform float strength;\\nvarying vec2 vBlurTexCoords[6];\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_vs_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/BlurFilter_vs_logic.glsl\",\"\\nvBlurTexCoords[ 0] = v_texcoord + vec2(-0.012 * strength, 0.0);\\nvBlurTexCoords[ 1] = v_texcoord + vec2(-0.008 * strength, 0.0);\\nvBlurTexCoords[ 2] = v_texcoord + vec2(-0.004 * strength, 0.0);\\nvBlurTexCoords[ 3] = v_texcoord + vec2( 0.004 * strength, 0.0);\\nvBlurTexCoords[ 4] = v_texcoord + vec2( 0.008 * strength, 0.0);\\nvBlurTexCoords[ 5] = v_texcoord + vec2( 0.012 * strength, 0.0);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/BlurFilter_vs_logic.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorAdd_ps_uniform.glsl\",\"uniform vec4 colorAdd;\\n\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorAdd_ps_uniform.glsl*/);\r\n\t\t\tShader.addInclude(\"parts/ColorAdd_ps_logic.glsl\",\"gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/parts/ColorAdd_ps_logic.glsl*/);\r\n\t\t\tvar vs,ps;\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec2 texcoord;\\nuniform vec2 size;\\n\\n#ifdef WORLDMAT\\nuniform mat4 mmat;\\n#endif\\nvarying vec2 v_texcoord;\\n\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_vs_uniform.glsl\\\";\\nvoid main() {\\n  #ifdef WORLDMAT\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  #else\\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\\n  #endif\\n  \\n  v_texcoord = texcoord;\\n  #include?BLUR_FILTER  \\\"parts/BlurFilter_vs_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/texture.vs*/;\r\n\t\t\tps=\"precision mediump float;\\n//precision highp float;\\nvarying vec2 v_texcoord;\\nuniform sampler2D texture;\\nuniform float alpha;\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_ps_uniform.glsl\\\";\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\n#include?GLOW_FILTER \\\"parts/GlowFilter_ps_uniform.glsl\\\";\\n#include?COLOR_ADD \\\"parts/ColorAdd_ps_uniform.glsl\\\";\\n\\nvoid main() {\\n   vec4 color= texture2D(texture, v_texcoord);\\n   color.a*=alpha;\\n   gl_FragColor=color;\\n   #include?COLOR_ADD \\\"parts/ColorAdd_ps_logic.glsl\\\";   \\n   #include?BLUR_FILTER  \\\"parts/BlurFilter_ps_logic.glsl\\\";\\n   #include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n   #include?GLOW_FILTER \\\"parts/GlowFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/texture.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nuniform vec2 size;\\nuniform mat4 mmat;\\nvoid main() {\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/line.vs*/;\r\n\t\t\tps=\"precision mediump float;\\nuniform vec4 color;\\nuniform float alpha;\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\nvoid main() {\\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\\n\ta.w = alpha;\\n\tgl_FragColor = a;\\n\t#include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/line.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec3 a_color;\\nuniform mat4 mmat;\\nuniform mat4 u_mmat2;\\nuniform vec2 u_pos;\\nuniform vec2 size;\\nvarying vec3 color;\\nvoid main(){\\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\\n  vec4 pos=mmat*u_mmat2*tPos;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  color=a_color;\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/primitive.vs*/;\r\n\t\t\tps=\"precision mediump float;\\n//precision mediump float;\\nvarying vec3 color;\\nuniform float alpha;\\nvoid main(){\\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\\n\t//a.a*=alpha;\\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/primitive.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,vs,ps,null);\r\n\t\t\tvs=\"attribute vec4 position;\\nattribute vec2 texcoord;\\nuniform vec2 size;\\n\\n#ifdef WORLDMAT\\nuniform mat4 mmat;\\n#endif\\nvarying vec2 v_texcoord;\\n\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_vs_uniform.glsl\\\";\\nvoid main() {\\n  #ifdef WORLDMAT\\n  vec4 pos=mmat*position;\\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  #else\\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\\n  #endif\\n  \\n  v_texcoord = texcoord;\\n  #include?BLUR_FILTER  \\\"parts/BlurFilter_vs_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/texture.vs*/;\r\n\t\t\tps=\"precision highp float;\\n//precision highp float;\\nvarying vec2 v_texcoord;\\nuniform sampler2D texture;\\nuniform float alpha;\\nuniform vec4 u_TexRange;\\nuniform vec2 u_offset;\\n#include?BLUR_FILTER  \\\"parts/BlurFilter_ps_uniform.glsl\\\";\\n#include?COLOR_FILTER \\\"parts/ColorFilter_ps_uniform.glsl\\\";\\n#include?GLOW_FILTER \\\"parts/GlowFilter_ps_uniform.glsl\\\";\\n#include?COLOR_ADD \\\"parts/ColorAdd_ps_uniform.glsl\\\";\\n\\nvoid main() {\\n   vec2 newTexCoord;\\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\\n   vec4 color= texture2D(texture, newTexCoord);\\n   color.a*=alpha;\\n   gl_FragColor=color;\\n   #include?COLOR_ADD \\\"parts/ColorAdd_ps_logic.glsl\\\";   \\n   #include?BLUR_FILTER  \\\"parts/BlurFilter_ps_logic.glsl\\\";\\n   #include?COLOR_FILTER \\\"parts/ColorFilter_ps_logic.glsl\\\";\\n   #include?GLOW_FILTER \\\"parts/GlowFilter_ps_logic.glsl\\\";\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/files/fillTextureShader.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,vs,ps,null);\r\n\t\t\tvs=\"attribute vec2 position;\\nattribute vec2 texcoord;\\nattribute vec4 color;\\nuniform vec2 size;\\nuniform float offsetX;\\nuniform float offsetY;\\nuniform mat4 mmat;\\nuniform mat4 u_mmat2;\\nvarying vec2 v_texcoord;\\nvarying vec4 v_color;\\nvoid main() {\\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\\n  v_color = color;\\n  v_texcoord = texcoord;  \\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/skinAnishader/skinShader.vs*/;\r\n\t\t\tps=\"precision mediump float;\\nvarying vec2 v_texcoord;\\nvarying vec4 v_color;\\nuniform sampler2D texture;\\nuniform float alpha;\\nvoid main() {\\n\tvec4 t_color = texture2D(texture, v_texcoord);\\n\tgl_FragColor = t_color.rgba * v_color;\\n\tgl_FragColor.a = gl_FragColor.a * alpha;\\n}\"/*__INCLUDESTR__E:/trank/libs/LayaAir/publish/LayaAirPublish/branch/src/webGL/src/laya/webgl/shader/d2/skinAnishader/skinShader.ps*/;\r\n\t\t\tShader.preCompile2D(0,/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,vs,ps,null);\r\n\t\t}\r\n\r\n\t\treturn Shader2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.ShaderDefines\r\n\tvar ShaderDefines=(function(){\r\n\t\tfunction ShaderDefines(name2int,int2name,int2nameMap){\r\n\t\t\tthis._value=0;\r\n\t\t\t//this._name2int=null;\r\n\t\t\t//this._int2name=null;\r\n\t\t\t//this._int2nameMap=null;\r\n\t\t\tthis._name2int=name2int;\r\n\t\t\tthis._int2name=int2name;\r\n\t\t\tthis._int2nameMap=int2nameMap;\r\n\t\t}\r\n\r\n\t\t__class(ShaderDefines,'laya.webgl.shader.ShaderDefines');\r\n\t\tvar __proto=ShaderDefines.prototype;\r\n\t\t__proto.add=function(value){\r\n\t\t\tif ((typeof value=='string'))value=this._name2int[value];\r\n\t\t\tthis._value |=value;\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.addInt=function(value){\r\n\t\t\tthis._value |=value;\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.remove=function(value){\r\n\t\t\tif ((typeof value=='string'))value=this._name2int[value];\r\n\t\t\tthis._value &=(~value);\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.isDefine=function(def){\r\n\t\t\treturn (this._value & def)===def;\r\n\t\t}\r\n\r\n\t\t__proto.getValue=function(){\r\n\t\t\treturn this._value;\r\n\t\t}\r\n\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tthis._value=value;\r\n\t\t}\r\n\r\n\t\t__proto.toNameDic=function(){\r\n\t\t\tvar r=this._int2nameMap[this._value];\r\n\t\t\treturn r ? r :ShaderDefines._toText(this._value,this._int2name,this._int2nameMap);\r\n\t\t}\r\n\r\n\t\tShaderDefines._reg=function(name,value,_name2int,_int2name){\r\n\t\t\t_name2int[name]=value;\r\n\t\t\t_int2name[value]=name;\r\n\t\t}\r\n\r\n\t\tShaderDefines._toText=function(value,_int2name,_int2nameMap){\r\n\t\t\tvar r=_int2nameMap[value];\r\n\t\t\tif (r)return r;\r\n\t\t\tvar o={};\r\n\t\t\tvar d=1;\r\n\t\t\tfor (var i=0;i < 32;i++){\r\n\t\t\t\td=1 << i;\r\n\t\t\t\tif (d > value)break ;\r\n\t\t\t\tif (value & d){\r\n\t\t\t\t\tvar name=_int2name[d];\r\n\t\t\t\t\tname && (o[name]=\"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t_int2nameMap[value]=o;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tShaderDefines._toInt=function(names,_name2int){\r\n\t\t\tvar words=names.split('.');\r\n\t\t\tvar num=0;\r\n\t\t\tfor (var i=0,n=words.length;i < n;i++){\r\n\t\t\t\tvar value=_name2int[words[i]];\r\n\t\t\t\tif (!value)throw new Error(\"Defines to int err:\"+names+\"/\"+words[i]);\r\n\t\t\t\tnum |=value;\r\n\t\t\t}\r\n\t\t\treturn num;\r\n\t\t}\r\n\r\n\t\treturn ShaderDefines;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*这里销毁的问题，后面待确认\r\n\t*/\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinMesh\r\n\tvar SkinMesh=(function(){\r\n\t\tfunction SkinMesh(){\r\n\t\t\tthis.mVBBuffer=null;\r\n\t\t\tthis.mIBBuffer=null;\r\n\t\t\tthis.mVBData=null;\r\n\t\t\tthis.mIBData=null;\r\n\t\t\tthis.mEleNum=0;\r\n\t\t\tthis.mTexture=null;\r\n\t\t\tthis.transform=null;\r\n\t\t\tthis._vs=null;\r\n\t\t\tthis._ps=null;\r\n\t\t\tthis._indexStart=-1;\r\n\t\t\tthis._verticles=null;\r\n\t\t\tthis._uvs=null;\r\n\t\t\tthis._tempMat16=RenderState2D.getMatrArray();\r\n\t\t}\r\n\r\n\t\t__class(SkinMesh,'laya.webgl.shader.d2.skinAnishader.SkinMesh');\r\n\t\tvar __proto=SkinMesh.prototype;\r\n\t\t__proto.init=function(texture,vs,ps){\r\n\t\t\tif (vs){\r\n\t\t\t\tthis._vs=vs;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._vs=[];\r\n\t\t\t\tvar tWidth=texture.width;\r\n\t\t\t\tvar tHeight=texture.height;\r\n\t\t\t\tvar tRed=1;\r\n\t\t\t\tvar tGreed=1;\r\n\t\t\t\tvar tBlue=1;\r\n\t\t\t\tvar tAlpha=1;\r\n\t\t\t\tthis._vs.push(0,0,0,0,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(tWidth,0,1,0,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(tWidth,tHeight,1,1,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t\tthis._vs.push(0,tHeight,0,1,tRed,tGreed,tBlue,tAlpha);\r\n\t\t\t}\r\n\t\t\tif (ps){\r\n\t\t\t\tthis._ps=ps;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (!SkinMesh._defaultPS){\r\n\t\t\t\t\tSkinMesh._defaultPS=[];\r\n\t\t\t\t\tSkinMesh._defaultPS.push(0,1,3,3,1,2);\r\n\t\t\t\t}\r\n\t\t\t\tthis._ps=SkinMesh._defaultPS;\r\n\t\t\t}\r\n\t\t\tthis.mVBData=new Float32Array(this._vs);\r\n\t\t\tthis.mIBData=new Uint16Array(this._ps.length);\r\n\t\t\tthis.mIBData[\"start\"]=-1;\r\n\t\t\tthis.mEleNum=this._ps.length;\r\n\t\t\tthis.mTexture=texture;\r\n\t\t}\r\n\r\n\t\t__proto.init2=function(texture,vs,ps,verticles,uvs){\r\n\t\t\tif (ps){\r\n\t\t\t\tthis._ps=ps;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ps=[];\r\n\t\t\t\tthis._ps.push(0,1,3,3,1,2);\r\n\t\t\t}\r\n\t\t\tthis._verticles=verticles;\r\n\t\t\tthis._uvs=uvs;\r\n\t\t\tthis.mEleNum=this._ps.length;\r\n\t\t\tthis.mTexture=texture;\r\n\t\t\tif (Render.isConchNode || Render.isConchApp){\r\n\t\t\t\tthis._initMyData();\r\n\t\t\t\tthis.mVBData=new Float32Array(this._vs);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._initMyData=function(){\r\n\t\t\tvar vsI=0;\r\n\t\t\tvar vI=0;\r\n\t\t\tvar vLen=this._verticles.length;\r\n\t\t\tvar tempVLen=vLen *4;\r\n\t\t\tthis._vs=SkinMesh._tempVS;\r\n\t\t\tvar insertNew=false;\r\n\t\t\tif (Render.isConchNode || Render.isConchApp){\r\n\t\t\t\tthis._vs.length=tempVLen;\r\n\t\t\t\tinsertNew=true;\r\n\t\t\t\t}else{\r\n\t\t\t\tif (this._vs.length < tempVLen){\r\n\t\t\t\t\tthis._vs.length=tempVLen;\r\n\t\t\t\t\tinsertNew=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tSkinMesh._tVSLen=tempVLen;\r\n\t\t\tif (insertNew){\r\n\t\t\t\twhile (vsI < tempVLen){\r\n\t\t\t\t\tthis._vs[vsI]=this._verticles[vI];\r\n\t\t\t\t\tthis._vs[vsI+1]=this._verticles[vI+1];\r\n\t\t\t\t\tthis._vs[vsI+2]=this._uvs[vI];\r\n\t\t\t\t\tthis._vs[vsI+3]=this._uvs[vI+1];\r\n\t\t\t\t\tthis._vs[vsI+4]=1;\r\n\t\t\t\t\tthis._vs[vsI+5]=1;\r\n\t\t\t\t\tthis._vs[vsI+6]=1;\r\n\t\t\t\t\tthis._vs[vsI+7]=1;\r\n\t\t\t\t\tvsI+=8;\r\n\t\t\t\t\tvI+=2;\r\n\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\twhile (vsI < tempVLen){\r\n\t\t\t\t\tthis._vs[vsI]=this._verticles[vI];\r\n\t\t\t\t\tthis._vs[vsI+1]=this._verticles[vI+1];\r\n\t\t\t\t\tthis._vs[vsI+2]=this._uvs[vI];\r\n\t\t\t\t\tthis._vs[vsI+3]=this._uvs[vI+1];\r\n\t\t\t\t\tvsI+=8;\r\n\t\t\t\t\tvI+=2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.getData2=function(vb,ib,start){\r\n\t\t\tthis.mVBBuffer=vb;\r\n\t\t\tthis.mIBBuffer=ib;\r\n\t\t\tthis._initMyData();\r\n\t\t\tvb.appendEx2(this._vs,Float32Array,SkinMesh._tVSLen,4);\r\n\t\t\tthis._indexStart=ib.byteLength;\r\n\t\t\tvar tIB;\r\n\t\t\ttIB=SkinMesh._tempIB;\r\n\t\t\tif (tIB.length < this._ps.length){\r\n\t\t\t\ttIB.length=this._ps.length;\r\n\t\t\t}\r\n\t\t\tfor (var i=0,n=this._ps.length;i < n;i++){\r\n\t\t\t\ttIB[i]=this._ps[i]+start;\r\n\t\t\t}\r\n\t\t\tib.appendEx2(tIB,Uint16Array,this._ps.length,2);\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(vb,ib,start){\r\n\t\t\tthis.mVBBuffer=vb;\r\n\t\t\tthis.mIBBuffer=ib;\r\n\t\t\tvb.append(this.mVBData);\r\n\t\t\tthis._indexStart=ib.byteLength;\r\n\t\t\tif (this.mIBData[\"start\"] !=start){\r\n\t\t\t\tfor (var i=0,n=this._ps.length;i < n;i++){\r\n\t\t\t\t\tthis.mIBData[i]=this._ps[i]+start;\r\n\t\t\t\t}\r\n\t\t\t\tthis.mIBData[\"start\"]=start;\r\n\t\t\t}\r\n\t\t\tib.append(this.mIBData);\r\n\t\t}\r\n\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tif (Render.isWebGL && this.mTexture){\r\n\t\t\t\tcontext._renderKey=0;\r\n\t\t\t\tcontext._shader2D.glTexture=null;\r\n\t\t\t\tSkinMeshBuffer.getInstance().addSkinMesh(this);\r\n\t\t\t\tvar tempSubmit=Submit.createShape(context,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,0));\r\n\t\t\t\tthis.transform || (this.transform=Matrix.EMPTY);\r\n\t\t\t\tthis.transform.translate(x,y);\r\n\t\t\t\tMatrix.mul16(this.transform,context._curMat,this._tempMat16);\r\n\t\t\t\tthis.transform.translate(-x,-y);\r\n\t\t\t\tvar tShaderValue=tempSubmit.shaderValue;\r\n\t\t\t\ttShaderValue.textureHost=this.mTexture;\r\n\t\t\t\ttShaderValue.offsetX=0;\r\n\t\t\t\ttShaderValue.offsetY=0;\r\n\t\t\t\ttShaderValue.u_mmat2=this._tempMat16;\r\n\t\t\t\ttShaderValue.ALPHA=context._shader2D.ALPHA;\r\n\t\t\t\tcontext._submits[context._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t\telse if (Render.isConchApp&&this.mTexture){\r\n\t\t\t\tthis.transform || (this.transform=Matrix.EMPTY);\r\n\t\t\t\tcontext.setSkinMesh&&context.setSkinMesh(x,y,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tSkinMesh._tempVS=[];\r\n\t\tSkinMesh._tempIB=[];\r\n\t\tSkinMesh._defaultPS=null\r\n\t\tSkinMesh._tVSLen=0;\r\n\t\treturn SkinMesh;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer\r\n\tvar SkinMeshBuffer=(function(){\r\n\t\tfunction SkinMeshBuffer(){\r\n\t\t\tthis.ib=null;\r\n\t\t\tthis.vb=null;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\tthis.vb=VertexBuffer2D.create(8);\r\n\t\t}\r\n\r\n\t\t__class(SkinMeshBuffer,'laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer');\r\n\t\tvar __proto=SkinMeshBuffer.prototype;\r\n\t\t__proto.addSkinMesh=function(skinMesh){\r\n\t\t\tskinMesh.getData2(this.vb,this.ib,this.vb.byteLength / 32);\r\n\t\t}\r\n\r\n\t\t__proto.reset=function(){\r\n\t\t\tthis.vb.clear();\r\n\t\t\tthis.ib.clear();\r\n\t\t}\r\n\r\n\t\tSkinMeshBuffer.getInstance=function(){\r\n\t\t\treturn SkinMeshBuffer.instance=SkinMeshBuffer.instance|| new SkinMeshBuffer();\r\n\t\t}\r\n\r\n\t\tSkinMeshBuffer.instance=null\r\n\t\treturn SkinMeshBuffer;\r\n\t})()\r\n\r\n\r\n\t//此类可以减少代码\r\n\t//class laya.webgl.shapes.BasePoly\r\n\tvar BasePoly=(function(){\r\n\t\tfunction BasePoly(x,y,width,height,edges,color,borderWidth,borderColor,round){\r\n\t\t\t//this.x=NaN;\r\n\t\t\t//this.y=NaN;\r\n\t\t\t//this.r=NaN;\r\n\t\t\t//this.width=NaN;\r\n\t\t\t//this.height=NaN;\r\n\t\t\t//this.edges=NaN;\r\n\t\t\tthis.r0=0\r\n\t\t\t//this.color=0;\r\n\t\t\t//this.borderColor=NaN;\r\n\t\t\t//this.borderWidth=NaN;\r\n\t\t\t//this.round=0;\r\n\t\t\tthis.fill=true;\r\n\t\t\t//this.mUint16Array=null;\r\n\t\t\t//this.mFloat32Array=null;\r\n\t\t\tthis.r1=Math.PI / 2;\r\n\t\t\t(round===void 0)&& (round=0);\r\n\t\t\tthis.x=x;\r\n\t\t\tthis.y=y;\r\n\t\t\tthis.width=width;\r\n\t\t\tthis.height=height;\r\n\t\t\tthis.edges=edges;\r\n\t\t\tthis.color=color;\r\n\t\t\tthis.borderWidth=borderWidth;\r\n\t\t\tthis.borderColor=borderColor;\r\n\t\t}\r\n\r\n\t\t__class(BasePoly,'laya.webgl.shapes.BasePoly');\r\n\t\tvar __proto=BasePoly.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.shapes.IShape\":true})\r\n\t\t__proto.getData=function(ib,vb,start){}\r\n\t\t__proto.rebuild=function(points){}\r\n\t\t__proto.setMatrix=function(mat){}\r\n\t\t__proto.needUpdate=function(mat){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.sector=function(outVert,outIndex,start){\r\n\t\t\tvar x=this.x,y=this.y,edges=this.edges,seg=(this.r1-this.r0)/ edges;\r\n\t\t\tvar w=this.width,h=this.height,color=this.color;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\toutVert.push(x,y,r,g,b);\r\n\t\t\tfor (var i=0;i < edges+1;i++){\r\n\t\t\t\toutVert.push(x+Math.sin(seg *i+this.r0)*w,y+Math.cos(seg *i+this.r0)*h);\r\n\t\t\t\toutVert.push(r,g,b);\r\n\t\t\t}\r\n\t\t\tfor (i=0;i < edges;i++){\r\n\t\t\t\toutIndex.push(start,start+i+1,start+i+2);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//用于画线\r\n\t\t__proto.createLine2=function(p,indices,lineWidth,len,outVertex,indexCount){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tvar length=points.length / 2;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[2];\r\n\t\t\tp2y=points[3];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx+this.x,p1y-perpy+this.y,r,g,b,p1x+perpx+this.x,p1y+perpy+this.y,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*2];\r\n\t\t\t\tp1y=points[(i-1)*2+1];\r\n\t\t\t\tp2x=points[(i)*2];\r\n\t\t\t\tp2y=points[(i)*2+1];\r\n\t\t\t\tp3x=points[(i+1)*2];\r\n\t\t\t\tp3y=points[(i+1)*2+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px+this.x,py+this.y,r,g,b,p2x-(px-p2x)+this.x,p2y-(py-p2y)+this.y,r,g,b);\r\n\t\t\t}\r\n\t\t\tp1x=points[points.length-4];\r\n\t\t\tp1y=points[points.length-3];\r\n\t\t\tp2x=points[points.length-2];\r\n\t\t\tp2y=points[points.length-1];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p2x-perpx+this.x,p2y-perpy+this.y,r,g,b,p2x+perpx+this.x,p2y+perpy+this.y,r,g,b);\r\n\t\t\tvar groupLen=indexCount;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//用于比如 扇形 不带两直线\r\n\t\t__proto.createLine=function(p,indices,lineWidth,len){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tpoints.splice(0,5);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tp1x=points[points.length-10];\r\n\t\t\tp1y=points[points.length-9];\r\n\t\t\tp2x=points[points.length-5];\r\n\t\t\tp2y=points[points.length-4];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t//闭合路径\r\n\t\t__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex ? outVertex :p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tpoints.splice(0,5);\r\n\t\t\tvar firstPoint=[points[0],points[1]];\r\n\t\t\tvar lastPoint=[points[points.length-5],points[points.length-4]];\r\n\t\t\tvar midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;\r\n\t\t\tvar midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;\r\n\t\t\tpoints.unshift(midPointX,midPointY,0,0,0);\r\n\t\t\tpoints.push(midPointX,midPointY,0,0,0);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tif (outIndex){\r\n\t\t\t\tindices=outIndex;\r\n\t\t\t};\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\treturn BasePoly;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shapes.GeometryData\r\n\tvar GeometryData=(function(){\r\n\t\tfunction GeometryData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,shape){\r\n\t\t\t//this.lineWidth=NaN;\r\n\t\t\t//this.lineColor=NaN;\r\n\t\t\t//this.lineAlpha=NaN;\r\n\t\t\t//this.fillColor=NaN;\r\n\t\t\t//this.fillAlpha=NaN;\r\n\t\t\t//this.shape=null;\r\n\t\t\t//this.fill=false;\r\n\t\t\tthis.lineWidth=lineWidth;\r\n\t\t\tthis.lineColor=lineColor;\r\n\t\t\tthis.lineAlpha=lineAlpha;\r\n\t\t\tthis.fillColor=fillColor;\r\n\t\t\tthis.fillAlpha=fillAlpha;\r\n\t\t\tthis.shape=shape;\r\n\t\t\tthis.fill=fill;\r\n\t\t}\r\n\r\n\t\t__class(GeometryData,'laya.webgl.shapes.GeometryData');\r\n\t\tvar __proto=GeometryData.prototype;\r\n\t\t__proto.clone=function(){\r\n\t\t\treturn new GeometryData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape);\r\n\t\t}\r\n\r\n\t\t__proto.getIndexData=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.getVertexData=function(){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis.shape=null;\r\n\t\t}\r\n\r\n\t\treturn GeometryData;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.shapes.Vertex\r\n\tvar Vertex=(function(){\r\n\t\tfunction Vertex(p){\r\n\t\t\t//this.points=null;\r\n\t\t\tif((p instanceof Float32Array))\r\n\t\t\t\tthis.points=p;\r\n\t\t\telse if((p instanceof Array)){\r\n\t\t\t\tvar len=p.length;\r\n\t\t\t\tthis.points=new Float32Array(p);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(Vertex,'laya.webgl.shapes.Vertex');\r\n\t\tvar __proto=Vertex.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.shapes.IShape\":true})\r\n\t\t__proto.getData=function(ib,vb,start){}\r\n\t\t__proto.needUpdate=function(mat){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto.rebuild=function(points){}\r\n\t\t// TODO Auto Generated method stub\r\n\t\t__proto.setMatrix=function(mat){}\r\n\t\treturn Vertex;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.Submit\r\n\tvar Submit=(function(){\r\n\t\tfunction Submit(renderType){\r\n\t\t\t//this._selfVb=null;\r\n\t\t\t//this._ib=null;\r\n\t\t\t//this._blendFn=null;\r\n\t\t\t//this._renderType=0;\r\n\t\t\t//this._vb=null;\r\n\t\t\t//this._startIdx=0;\r\n\t\t\t//this._numEle=0;\r\n\t\t\t//this.shaderValue=null;\r\n\t\t\t(renderType===void 0)&& (renderType=10000);\r\n\t\t\tthis._renderType=renderType;\r\n\t\t}\r\n\r\n\t\t__class(Submit,'laya.webgl.submit.Submit');\r\n\t\tvar __proto=Submit.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=Submit._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.shaderValue.release();\r\n\t\t\tthis._vb=null;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn this._renderType;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._numEle===0)return 1;\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tthis.shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis.shaderValue.upload();\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmit.__init__=function(){\r\n\t\t\tvar s=Submit.RENDERBASE=new Submit(-1);\r\n\t\t\ts.shaderValue=new Value2D(0,0);\r\n\t\t\ts.shaderValue.ALPHA=-1234;\r\n\t\t}\r\n\r\n\t\tSubmit.create=function(context,ib,vb,pos,sv){\r\n\t\t\tvar o=Submit._cache._length ? Submit._cache[--Submit._cache._length] :new Submit();\r\n\t\t\tif (vb==null){\r\n\t\t\t\tvb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));\r\n\t\t\t\tvb.clear();\r\n\t\t\t\tpos=0;\r\n\t\t\t}\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\tvar filters=context._shader2D.filters;\r\n\t\t\tfilters && o.shaderValue.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmit.createShape=function(ctx,ib,vb,numEle,offset,sv){\r\n\t\t\tvar o=(!Submit._cache._length)? (new Submit()):Submit._cache[--Submit._cache._length];\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._numEle=numEle;\r\n\t\t\to._startIdx=offset;\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(ctx._shader2D);\r\n\t\t\tvar blendType=ctx._nBlendType;\r\n\t\t\to._blendFn=ctx._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmit.TYPE_2D=10000;\r\n\t\tSubmit.TYPE_CANVAS=10003;\r\n\t\tSubmit.TYPE_CMDSETRT=10004;\r\n\t\tSubmit.TYPE_CUSTOM=10005;\r\n\t\tSubmit.TYPE_BLURRT=10006;\r\n\t\tSubmit.TYPE_CMDDESTORYPRERT=10007;\r\n\t\tSubmit.TYPE_DISABLESTENCIL=10008;\r\n\t\tSubmit.TYPE_OTHERIBVB=10009;\r\n\t\tSubmit.TYPE_PRIMITIVE=10010;\r\n\t\tSubmit.TYPE_RT=10011;\r\n\t\tSubmit.TYPE_BLUR_RT=10012;\r\n\t\tSubmit.TYPE_TARGET=10013;\r\n\t\tSubmit.TYPE_CHANGE_VALUE=10014;\r\n\t\tSubmit.TYPE_SHAPE=10015;\r\n\t\tSubmit.TYPE_TEXTURE=10016;\r\n\t\tSubmit.TYPE_FILLTEXTURE=10017;\r\n\t\tSubmit.RENDERBASE=null\r\n\t\tSubmit._cache=(Submit._cache=[],Submit._cache._length=0,Submit._cache);\r\n\t\treturn Submit;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCMD\r\n\tvar SubmitCMD=(function(){\r\n\t\tfunction SubmitCMD(){\r\n\t\t\tthis.fun=null;\r\n\t\t\tthis.args=null;\r\n\t\t}\r\n\r\n\t\t__class(SubmitCMD,'laya.webgl.submit.SubmitCMD');\r\n\t\tvar __proto=SubmitCMD.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis.fun.apply(null,this.args);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitCMD._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\tSubmitCMD.create=function(args,fun){\r\n\t\t\tvar o=SubmitCMD._cache._length?SubmitCMD._cache[--SubmitCMD._cache._length]:new SubmitCMD();\r\n\t\t\to.fun=fun;\r\n\t\t\to.args=args;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitCMD._cache=(SubmitCMD._cache=[],SubmitCMD._cache._length=0,SubmitCMD._cache);\r\n\t\treturn SubmitCMD;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCMDScope\r\n\tvar SubmitCMDScope=(function(){\r\n\t\tfunction SubmitCMDScope(){\r\n\t\t\tthis.variables={};\r\n\t\t}\r\n\r\n\t\t__class(SubmitCMDScope,'laya.webgl.submit.SubmitCMDScope');\r\n\t\tvar __proto=SubmitCMDScope.prototype;\r\n\t\t__proto.getValue=function(name){\r\n\t\t\treturn this.variables[name];\r\n\t\t}\r\n\r\n\t\t__proto.addValue=function(name,value){\r\n\t\t\treturn this.variables[name]=value;\r\n\t\t}\r\n\r\n\t\t__proto.setValue=function(name,value){\r\n\t\t\tif(this.variables.hasOwnProperty(name)){\r\n\t\t\t\treturn this.variables[name]=value;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tfor(var key in this.variables){\r\n\t\t\t\tdelete this.variables[key];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.recycle=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tSubmitCMDScope.POOL.push(this);\r\n\t\t}\r\n\r\n\t\tSubmitCMDScope.create=function(){\r\n\t\t\tvar scope=SubmitCMDScope.POOL.pop();\r\n\t\t\tscope||(scope=new SubmitCMDScope());\r\n\t\t\treturn scope;\r\n\t\t}\r\n\r\n\t\tSubmitCMDScope.POOL=[];\r\n\t\treturn SubmitCMDScope;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitOtherIBVB\r\n\tvar SubmitOtherIBVB=(function(){\r\n\t\tfunction SubmitOtherIBVB(){\r\n\t\t\tthis.offset=0;\r\n\t\t\t//this._vb=null;\r\n\t\t\t//this._ib=null;\r\n\t\t\t//this._blendFn=null;\r\n\t\t\t//this._mat=null;\r\n\t\t\t//this._shader=null;\r\n\t\t\t//this._shaderValue=null;\r\n\t\t\t//this._numEle=0;\r\n\t\t\tthis.startIndex=0;\r\n\t\t\t;\r\n\t\t\tthis._mat=Matrix.create();\r\n\t\t}\r\n\r\n\t\t__class(SubmitOtherIBVB,'laya.webgl.submit.SubmitOtherIBVB');\r\n\t\tvar __proto=SubmitOtherIBVB.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitOtherIBVB._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn /*laya.webgl.submit.Submit.TYPE_OTHERIBVB*/10009;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tvar _tex=this._shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source)\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\tthis._shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar w=RenderState2D.worldMatrix4;\r\n\t\t\tvar wmat=Matrix.TEMP;\r\n\t\t\tMatrix.mulPre(this._mat,w[0],w[1],w[4],w[5],w[12],w[13],wmat);\r\n\t\t\tvar tmp=RenderState2D.worldMatrix4=SubmitOtherIBVB.tempMatrix4;\r\n\t\t\ttmp[0]=wmat.a;\r\n\t\t\ttmp[1]=wmat.b;\r\n\t\t\ttmp[4]=wmat.c;\r\n\t\t\ttmp[5]=wmat.d;\r\n\t\t\ttmp[12]=wmat.tx;\r\n\t\t\ttmp[13]=wmat.ty;\r\n\t\t\tthis._shader._offset=this.offset;\r\n\t\t\tthis._shaderValue.refresh();\r\n\t\t\tthis._shader.upload(this._shaderValue);\r\n\t\t\tthis._shader._offset=0;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this.startIndex);\r\n\t\t\tRenderState2D.worldMatrix4=w;\r\n\t\t\tBaseShader.activeShader=null;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmitOtherIBVB.create=function(context,vb,ib,numElement,shader,shaderValue,startIndex,offset,type){\r\n\t\t\t(type===void 0)&& (type=0);\r\n\t\t\tvar o=(!SubmitOtherIBVB._cache._length)? (new SubmitOtherIBVB()):SubmitOtherIBVB._cache[--SubmitOtherIBVB._cache._length];\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._numEle=numElement;\r\n\t\t\to._shader=shader;\r\n\t\t\to._shaderValue=shaderValue;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\tswitch(type){\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\to.offset=0;\r\n\t\t\t\t\to.startIndex=offset / (CONST3D2D.BYTES_PE *vb.vertexStride)*1.5;\r\n\t\t\t\t\to.startIndex *=CONST3D2D.BYTES_PIDX;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\to.startIndex=startIndex;\r\n\t\t\t\t\to.offset=offset;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitOtherIBVB._cache=(SubmitOtherIBVB._cache=[],SubmitOtherIBVB._cache._length=0,SubmitOtherIBVB._cache);\r\n\t\tSubmitOtherIBVB.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,];\r\n\t\treturn SubmitOtherIBVB;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitScissor\r\n\tvar SubmitScissor=(function(){\r\n\t\tfunction SubmitScissor(){\r\n\t\t\tthis.submitIndex=0;\r\n\t\t\tthis.submitLength=0;\r\n\t\t\tthis.context=null;\r\n\t\t\tthis.clipRect=new Rectangle();\r\n\t\t\tthis.screenRect=new Rectangle();\r\n\t\t}\r\n\r\n\t\t__class(SubmitScissor,'laya.webgl.submit.SubmitScissor');\r\n\t\tvar __proto=SubmitScissor.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto._scissor=function(x,y,w,h){\r\n\t\t\tvar m=RenderState2D.worldMatrix4;\r\n\t\t\tvar a=m[0],d=m[5],tx=m[12],ty=m[13];\r\n\t\t\tx=x *a+tx;\r\n\t\t\ty=y *d+ty;\r\n\t\t\tw *=a;\r\n\t\t\th *=d;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar r=x+w;\r\n\t\t\tvar b=y+h;\r\n\t\t\tx < 0 && (x=0,w=r-x);\r\n\t\t\ty < 0 && (y=0,h=b-y);\r\n\t\t\tvar screen=RenderState2D.worldClipRect;\r\n\t\t\tx=Math.max(x,screen.x);\r\n\t\t\ty=Math.max(y,screen.y);\r\n\t\t\tw=Math.min(r,screen.right)-x;\r\n\t\t\th=Math.min(b,screen.bottom)-y;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tthis.screenRect.copyFrom(screen);\r\n\t\t\tscreen.x=x;\r\n\t\t\tscreen.y=y;\r\n\t\t\tscreen.width=w;\r\n\t\t\tscreen.height=h;\r\n\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\ty=RenderState2D.height-y-h;\r\n\t\t\tWebGL.mainContext.scissor(x,y,w,h);\r\n\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tthis.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\ty=RenderState2D.height-this.screenRect.y-this.screenRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t}\r\n\t\t\tscreen.copyFrom(this.screenRect);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._scissorWithTagart=function(x,y,w,h){\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar r=x+w;\r\n\t\t\tvar b=y+h;\r\n\t\t\tx < 0 && (x=0,w=r-x);\r\n\t\t\ty < 0 && (y=0,h=b-y);\r\n\t\t\tvar screen=RenderState2D.worldClipRect;\r\n\t\t\tx=Math.max(x,screen.x);\r\n\t\t\ty=Math.max(y,screen.y);\r\n\t\t\tw=Math.min(r,screen.right)-x;\r\n\t\t\th=Math.min(b,screen.bottom)-y;\r\n\t\t\tif (w < 1 || h < 1){\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar worldScissorTest=RenderState2D.worldScissorTest;\r\n\t\t\tthis.screenRect.copyFrom(screen);\r\n\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\tscreen.x=x;\r\n\t\t\tscreen.y=y;\r\n\t\t\tscreen.width=w;\r\n\t\t\tscreen.height=h;\r\n\t\t\ty=RenderState2D.height-y-h;\r\n\t\t\tWebGL.mainContext.scissor(x,y,w,h);\r\n\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\tthis.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength);\r\n\t\t\tif (worldScissorTest){\r\n\t\t\t\ty=RenderState2D.height-this.screenRect.y-this.screenRect.height;\r\n\t\t\t\tWebGL.mainContext.scissor(this.screenRect.x,y,this.screenRect.width,this.screenRect.height);\r\n\t\t\t\tWebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tWebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t}\r\n\t\t\tscreen.copyFrom(this.screenRect);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis.submitLength=Math.min(this.context._submits._length-1,this.submitLength);\r\n\t\t\tif (this.submitLength < 1 || this.clipRect.width < 1 || this.clipRect.height < 1)\r\n\t\t\t\treturn this.submitLength+1;\r\n\t\t\tif (this.context._targets)\r\n\t\t\t\tthis._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);\r\n\t\t\telse this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height);\r\n\t\t\treturn this.submitLength+1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitScissor._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.context=null;\r\n\t\t}\r\n\r\n\t\tSubmitScissor.create=function(context){\r\n\t\t\tvar o=SubmitScissor._cache._length?SubmitScissor._cache[--SubmitScissor._cache._length]:new SubmitScissor();\r\n\t\t\to.context=context;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitScissor._cache=(SubmitScissor._cache=[],SubmitScissor._cache._length=0,SubmitScissor._cache);\r\n\t\treturn SubmitScissor;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitStencil\r\n\tvar SubmitStencil=(function(){\r\n\t\tfunction SubmitStencil(){\r\n\t\t\tthis.step=0;\r\n\t\t\tthis.blendMode=null;\r\n\t\t\tthis.level=0;\r\n\t\t}\r\n\r\n\t\t__class(SubmitStencil,'laya.webgl.submit.SubmitStencil');\r\n\t\tvar __proto=SubmitStencil.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tswitch(this.step){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tthis.do1();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tthis.do2();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tthis.do3();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tthis.do4();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\tthis.do5();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 6:\r\n\t\t\t\t\tthis.do6();\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitStencil._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.do1=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.colorMask(false,false,false,false);\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,this.level,0xFF);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.INCR*/0x1E02);\r\n\t\t}\r\n\r\n\t\t//gl.stencilOp(WebGLContext.KEEP,WebGLContext.KEEP,WebGLContext.INVERT);//测试通过给模版缓冲 写入值 一开始是0 现在是 0xFF (模版缓冲中不知道是多少位的数据)\r\n\t\t__proto.do2=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,this.level+1,0xFF);\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t}\r\n\r\n\t\t__proto.do3=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.disable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t}\r\n\r\n\t\t__proto.do4=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enable(/*laya.webgl.WebGLContext.STENCIL_TEST*/0x0B90);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400);\r\n\t\t\tgl.colorMask(false,false,false,false);\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.ALWAYS*/0x0207,this.level,0xFF);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.INVERT*/0x150A);\r\n\t\t}\r\n\r\n\t\t__proto.do5=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.stencilFunc(/*laya.webgl.WebGLContext.EQUAL*/0x0202,0xff,0xFF);\r\n\t\t\tgl.colorMask(true,true,true,true);\r\n\t\t\tgl.stencilOp(/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00,/*laya.webgl.WebGLContext.KEEP*/0x1E00);\r\n\t\t}\r\n\r\n\t\t__proto.do6=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tBlendMode.targetFns[BlendMode.TOINT[this.blendMode]](gl);\r\n\t\t}\r\n\r\n\t\tSubmitStencil.create=function(step){\r\n\t\t\tvar o=SubmitStencil._cache._length?SubmitStencil._cache[--SubmitStencil._cache._length]:new SubmitStencil();\r\n\t\t\to.step=step;\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitStencil._cache=(SubmitStencil._cache=[],SubmitStencil._cache._length=0,SubmitStencil._cache);\r\n\t\treturn SubmitStencil;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitTarget\r\n\tvar SubmitTarget=(function(){\r\n\t\tfunction SubmitTarget(){\r\n\t\t\tthis._renderType=0;\r\n\t\t\tthis._vb=null;\r\n\t\t\tthis._ib=null;\r\n\t\t\tthis._startIdx=0;\r\n\t\t\tthis._numEle=0;\r\n\t\t\tthis.shaderValue=null;\r\n\t\t\tthis.blendType=0;\r\n\t\t\tthis.proName=null;\r\n\t\t\tthis.scope=null;\r\n\t\t}\r\n\r\n\t\t__class(SubmitTarget,'laya.webgl.submit.SubmitTarget');\r\n\t\tvar __proto=SubmitTarget.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.submit.ISubmit\":true})\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar target=this.scope.getValue(this.proName);\r\n\t\t\tif (target){\r\n\t\t\t\tthis.shaderValue.texture=target.source;\r\n\t\t\t\tthis.shaderValue.upload();\r\n\t\t\t\tthis.blend();\r\n\t\t\t\tStat.drawCall++;\r\n\t\t\t\tStat.trianglesFaces+=this._numEle/3;\r\n\t\t\t\tWebGL.mainContext.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.blend=function(){\r\n\t\t\tif (BlendMode.activeBlendFunction!==BlendMode.fns[this.blendType]){\r\n\t\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tBlendMode.fns[this.blendType](gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=BlendMode.fns[this.blendType];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitTarget._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\tSubmitTarget.create=function(context,ib,vb,pos,sv,proName){\r\n\t\t\tvar o=SubmitTarget._cache._length?SubmitTarget._cache[--SubmitTarget._cache._length]:new SubmitTarget();\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to.proName=proName;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\to.blendType=context._nBlendType;\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitTarget._cache=(SubmitTarget._cache=[],SubmitTarget._cache._length=0,SubmitTarget._cache);\r\n\t\treturn SubmitTarget;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*...特殊的字符，如泰文，必须重新实现这个类\r\n\t*/\r\n\t//class laya.webgl.text.CharSegment\r\n\tvar CharSegment=(function(){\r\n\t\tfunction CharSegment(){\r\n\t\t\tthis._sourceStr=null;\r\n\t\t}\r\n\r\n\t\t__class(CharSegment,'laya.webgl.text.CharSegment');\r\n\t\tvar __proto=CharSegment.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.text.ICharSegment\":true})\r\n\t\t__proto.textToSpit=function(str){\r\n\t\t\tthis._sourceStr=str;\r\n\t\t}\r\n\r\n\t\t__proto.getChar=function(i){\r\n\t\t\treturn this._sourceStr.charAt(i);\r\n\t\t}\r\n\r\n\t\t__proto.getCharCode=function(i){\r\n\t\t\treturn this._sourceStr.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\t__proto.length=function(){\r\n\t\t\treturn this._sourceStr.length;\r\n\t\t}\r\n\r\n\t\treturn CharSegment;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.DrawText\r\n\tvar DrawText=(function(){\r\n\t\tvar CharValue;\r\n\t\tfunction DrawText(){};\r\n\t\t__class(DrawText,'laya.webgl.text.DrawText');\r\n\t\tDrawText.__init__=function(){\r\n\t\t\tDrawText._charsTemp=new Array;\r\n\t\t\tDrawText._drawValue=new CharValue();\r\n\t\t\tDrawText._charSeg=new CharSegment();\r\n\t\t}\r\n\r\n\t\tDrawText.customCharSeg=function(charseg){\r\n\t\t\tDrawText._charSeg=charseg;\r\n\t\t}\r\n\r\n\t\tDrawText.getChar=function(char,id,drawValue){\r\n\t\t\treturn DrawText._charsCache[id]=DrawTextChar.createOneChar(char,drawValue);\r\n\t\t}\r\n\r\n\t\tDrawText._drawSlow=function(save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy){\r\n\t\t\tvar drawValue=DrawText._drawValue.value(font,fillColor,borderColor,lineWidth,sx,sy);\r\n\t\t\tvar i=0,n=0;\r\n\t\t\tvar chars=DrawText._charsTemp;\r\n\t\t\tvar width=0,oneChar,htmlWord,id=NaN;\r\n\t\t\tif (words){\r\n\t\t\t\tchars.length=words.length;\r\n\t\t\t\tfor (i=0,n=words.length;i < n;i++){\r\n\t\t\t\t\thtmlWord=words[i];\r\n\t\t\t\t\tid=htmlWord.charNum+drawValue.txtID;\r\n\t\t\t\t\tchars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(htmlWord.char,id,drawValue);\r\n\t\t\t\t\toneChar.active();\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tif ((txt instanceof laya.utils.WordText ))\r\n\t\t\t\t\tDrawText._charSeg.textToSpit((txt).toString());\r\n\t\t\t\telse\r\n\t\t\t\tDrawText._charSeg.textToSpit(txt);\r\n\t\t\t\tvar len=/*if err,please use iflash.method.xmlLength()*/DrawText._charSeg.length();\r\n\t\t\t\tchars.length=len;\r\n\t\t\t\tfor (i=0,n=len;i < n;i++){\r\n\t\t\t\t\tid=DrawText._charSeg.getCharCode(i)+drawValue.txtID;\r\n\t\t\t\t\tchars[i]=oneChar=DrawText._charsCache[id] || DrawText.getChar(DrawText._charSeg.getChar(i),id,drawValue);\r\n\t\t\t\t\toneChar.active();\r\n\t\t\t\t\twidth+=oneChar.width;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar dx=0;\r\n\t\t\tif (textAlign!==null && textAlign!==\"left\")\r\n\t\t\t\tdx=-(textAlign==\"center\" ? (width / 2):width);\r\n\t\t\tvar uv,bdSz=NaN,texture,value,saveLength=0;\r\n\t\t\tif (words){\r\n\t\t\t\tfor (i=0,n=chars.length;i < n;i++){\r\n\t\t\t\t\toneChar=chars[i];\r\n\t\t\t\t\tif (!oneChar.isSpace){\r\n\t\t\t\t\t\thtmlWord=words[i];\r\n\t\t\t\t\t\tbdSz=oneChar.borderSize;\r\n\t\t\t\t\t\ttexture=oneChar.texture;\r\n\t\t\t\t\t\tctx._drawText(texture,x+dx+htmlWord.x *sx-bdSz,y+htmlWord.y *sy-bdSz,texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tfor (i=0,n=chars.length;i < n;i++){\r\n\t\t\t\t\toneChar=chars[i];\r\n\t\t\t\t\tif (!oneChar.isSpace){\r\n\t\t\t\t\t\tbdSz=oneChar.borderSize;\r\n\t\t\t\t\t\ttexture=oneChar.texture;\r\n\t\t\t\t\t\tctx._drawText(texture,x+dx-bdSz,y-bdSz,texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t\t\t\tsave && (value=save[saveLength++],value || (value=save[saveLength-1]=[]),value[0]=texture,value[1]=dx-bdSz,value[2]=-bdSz);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdx+=oneChar.width;\r\n\t\t\t\t}\r\n\t\t\t\tsave && (save.length=saveLength);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText._drawFast=function(save,ctx,curMat,x,y){\r\n\t\t\tvar texture,value;\r\n\t\t\tfor (var i=0,n=save.length;i < n;i++){\r\n\t\t\t\tvalue=save[i];\r\n\t\t\t\ttexture=value[0];\r\n\t\t\t\ttexture.active();\r\n\t\t\t\tctx._drawText(texture,x+value[1],y+value[2],texture.width,texture.height,curMat,0,0,0,0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText.drawText=function(ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y){\r\n\t\t\tif ((txt && txt.length===0)|| (words && words.length===0))\r\n\t\t\t\treturn;\r\n\t\t\tvar sx=curMat.a,sy=curMat.d;\r\n\t\t\t(curMat.b!==0 || curMat.c!==0)&& (sx=sy=1);\r\n\t\t\tvar scale=sx!==1 || sy!==1;\r\n\t\t\tif (scale && Laya.stage.transform){\r\n\t\t\t\tvar t=Laya.stage.transform;\r\n\t\t\t\tscale=t.a===sx && t.d===sy;\r\n\t\t\t}else scale=false;\r\n\t\t\tif (scale){\r\n\t\t\t\tcurMat=curMat.copyTo(WebGLContext2D._tmpMatrix);\r\n\t\t\t\tcurMat.scale(1 / sx,1 / sy);\r\n\t\t\t\tcurMat._checkTransform();\r\n\t\t\t\tx *=sx;\r\n\t\t\t\ty *=sy;\r\n\t\t\t}else sx=sy=1;\r\n\t\t\tif (words){\r\n\t\t\t\tDrawText._drawSlow(null,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t}else {\r\n\t\t\t\tif (txt.toUpperCase===null){\r\n\t\t\t\t\tvar idNum=sx+sy *100000;\r\n\t\t\t\t\tvar myCache=txt;\r\n\t\t\t\t\tif (!myCache.changed && myCache.id===idNum){\r\n\t\t\t\t\t\tDrawText._drawFast(myCache.save,ctx,curMat,x,y);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tmyCache.id=idNum;\r\n\t\t\t\t\t\tmyCache.changed=false;\r\n\t\t\t\t\t\tDrawText._drawSlow(myCache.save,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t};\r\n\t\t\t\tvar id=txt+font.toString()+fillColor+borderColor+lineWidth+sx+sy+textAlign;\r\n\t\t\t\tvar cache=DrawText._textsCache[id];\r\n\t\t\t\tif (cache){\r\n\t\t\t\t\tDrawText._drawFast(cache,ctx,curMat,x,y);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tDrawText._textsCache.__length || (DrawText._textsCache.__length=0);\r\n\t\t\t\t\tif (DrawText._textsCache.__length > Config.WebGLTextCacheCount){\r\n\t\t\t\t\t\tDrawText._textsCache={};\r\n\t\t\t\t\t\tDrawText._textsCache.__length=0;\r\n\t\t\t\t\t\tDrawText._curPoolIndex=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tDrawText._textCachesPool[DrawText._curPoolIndex] ? (cache=DrawText._textsCache[id]=DrawText._textCachesPool[DrawText._curPoolIndex],cache.length=0):(DrawText._textCachesPool[DrawText._curPoolIndex]=cache=DrawText._textsCache[id]=[]);\r\n\t\t\t\t\tDrawText._textsCache.__length++\r\n\t\t\t\t\tDrawText._curPoolIndex++;\r\n\t\t\t\t\tDrawText._drawSlow(cache,ctx,txt,words,curMat,font,textAlign,fillColor,borderColor,lineWidth,x,y,sx,sy);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tDrawText._charsTemp=null\r\n\t\tDrawText._textCachesPool=[];\r\n\t\tDrawText._curPoolIndex=0;\r\n\t\tDrawText._charsCache={};\r\n\t\tDrawText._textsCache={};\r\n\t\tDrawText._drawValue=null\r\n\t\tDrawText.d=[];\r\n\t\tDrawText._charSeg=null;\r\n\t\tDrawText.__init$=function(){\r\n\t\t\t//class CharValue\r\n\t\t\tCharValue=(function(){\r\n\t\t\t\tfunction CharValue(){\r\n\t\t\t\t\t//this.txtID=NaN;\r\n\t\t\t\t\t//this.font=null;\r\n\t\t\t\t\t//this.fillColor=null;\r\n\t\t\t\t\t//this.borderColor=null;\r\n\t\t\t\t\t//this.lineWidth=0;\r\n\t\t\t\t\t//this.scaleX=NaN;\r\n\t\t\t\t\t//this.scaleY=NaN;\r\n\t\t\t\t}\r\n\t\t\t\t__class(CharValue,'');\r\n\t\t\t\tvar __proto=CharValue.prototype;\r\n\t\t\t\t__proto.value=function(font,fillColor,borderColor,lineWidth,scaleX,scaleY){\r\n\t\t\t\t\tthis.font=font;\r\n\t\t\t\t\tthis.fillColor=fillColor;\r\n\t\t\t\t\tthis.borderColor=borderColor;\r\n\t\t\t\t\tthis.lineWidth=lineWidth;\r\n\t\t\t\t\tthis.scaleX=scaleX;\r\n\t\t\t\t\tthis.scaleY=scaleY;\r\n\t\t\t\t\tvar key=font.toString()+scaleX+scaleY+lineWidth+fillColor+borderColor;\r\n\t\t\t\t\tthis.txtID=CharValue._keymap[key];\r\n\t\t\t\t\tif (!this.txtID){\r\n\t\t\t\t\t\tthis.txtID=(++CharValue._keymapCount)*0.0000001;\r\n\t\t\t\t\t\tCharValue._keymap[key]=this.txtID;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\tCharValue.clear=function(){\r\n\t\t\t\t\tCharValue._keymap={};\r\n\t\t\t\t\tCharValue._keymapCount=1;\r\n\t\t\t\t}\r\n\t\t\t\tCharValue._keymap={};\r\n\t\t\t\tCharValue._keymapCount=1;\r\n\t\t\t\treturn CharValue;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn DrawText;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.DrawTextChar\r\n\tvar DrawTextChar=(function(){\r\n\t\tfunction DrawTextChar(content,drawValue){\r\n\t\t\t//this.xs=NaN;\r\n\t\t\t//this.ys=NaN;\r\n\t\t\t//this.width=0;\r\n\t\t\t//this.height=0;\r\n\t\t\t//this.char=null;\r\n\t\t\t//this.fillColor=null;\r\n\t\t\t//this.borderColor=null;\r\n\t\t\t//this.borderSize=0;\r\n\t\t\t//this.font=null;\r\n\t\t\t//this.fontSize=0;\r\n\t\t\t//this.texture=null;\r\n\t\t\t//this.lineWidth=0;\r\n\t\t\t//this.UV=null;\r\n\t\t\t//this.isSpace=false;\r\n\t\t\tthis.char=content;\r\n\t\t\tthis.isSpace=content===' ';\r\n\t\t\tthis.xs=drawValue.scaleX;\r\n\t\t\tthis.ys=drawValue.scaleY;\r\n\t\t\tthis.font=drawValue.font.toString();\r\n\t\t\tthis.fontSize=drawValue.font.size;\r\n\t\t\tthis.fillColor=drawValue.fillColor;\r\n\t\t\tthis.borderColor=drawValue.borderColor;\r\n\t\t\tthis.lineWidth=drawValue.lineWidth;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\t/*__JS__ */var pCanvas=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */pCanvas._source=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */pCanvas._source.canvas=ConchTextCanvas;\r\n\t\t\t\t/*__JS__ */this.texture=new Texture(new WebGLCharImage(pCanvas,this));\r\n\t\t\t\t}else {\r\n\t\t\t\tthis.texture=new Texture(new WebGLCharImage(Browser.canvas.source,this));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__class(DrawTextChar,'laya.webgl.text.DrawTextChar');\r\n\t\tvar __proto=DrawTextChar.prototype;\r\n\t\t__proto.active=function(){\r\n\t\t\tthis.texture.active();\r\n\t\t}\r\n\r\n\t\tDrawTextChar.createOneChar=function(content,drawValue){\r\n\t\t\tvar char=new DrawTextChar(content,drawValue);\r\n\t\t\treturn char;\r\n\t\t}\r\n\r\n\t\treturn DrawTextChar;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.text.FontInContext\r\n\tvar FontInContext=(function(){\r\n\t\tfunction FontInContext(font){\r\n\t\t\t//this._text=null;\r\n\t\t\t//this._words=null;\r\n\t\t\tthis._index=0;\r\n\t\t\tthis._size=14;\r\n\t\t\tthis._italic=-2;\r\n\t\t\tthis.setFont(font || \"14px Arial\");\r\n\t\t}\r\n\r\n\t\t__class(FontInContext,'laya.webgl.text.FontInContext');\r\n\t\tvar __proto=FontInContext.prototype;\r\n\t\t__proto.setFont=function(value){\r\n\t\t\tthis._words=value.split(' ');\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++){\r\n\t\t\t\tif (this._words[i].indexOf('px')> 0){\r\n\t\t\t\t\tthis._index=i;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._size=parseInt(this._words[this._index]);\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._italic=-2;\r\n\t\t}\r\n\r\n\t\t__proto.getItalic=function(){\r\n\t\t\tthis._italic===-2 && (this._italic=this.hasType(\"italic\"));\r\n\t\t\treturn this._italic;\r\n\t\t}\r\n\r\n\t\t__proto.hasType=function(name){\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++)\r\n\t\t\tif (this._words[i]===name)return i;\r\n\t\t\treturn-1;\r\n\t\t}\r\n\r\n\t\t__proto.removeType=function(name){\r\n\t\t\tfor (var i=0,n=this._words.length;i < n;i++)\r\n\t\t\tif (this._words[i]===name){\r\n\t\t\t\tthis._words.splice(i,1);\r\n\t\t\t\tif (this._index > i)this._index--;\r\n\t\t\t\tbreak ;\r\n\t\t\t}\r\n\t\t\tthis._text=null;\r\n\t\t\tthis._italic=-2;\r\n\t\t}\r\n\r\n\t\t__proto.copyTo=function(dec){\r\n\t\t\tdec._text=this._text;\r\n\t\t\tdec._size=this._size;\r\n\t\t\tdec._index=this._index;\r\n\t\t\tdec._words=this._words.slice();\r\n\t\t\tdec._italic=-2;\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\t__proto.toString=function(){\r\n\t\t\treturn this._text ? this._text :(this._text=this._words.join(' '));\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'size',function(){\r\n\t\t\treturn this._size;\r\n\t\t\t},function(value){\r\n\t\t\tthis._size=value;\r\n\t\t\tthis._words[this._index]=value+\"px\";\r\n\t\t\tthis._text=null;\r\n\t\t});\r\n\r\n\t\tFontInContext.create=function(font){\r\n\t\t\tvar r=FontInContext._cache[font];\r\n\t\t\tif (r)return r;\r\n\t\t\tr=FontInContext._cache[font]=new FontInContext(font);\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\tFontInContext.EMPTY=new FontInContext();\r\n\t\tFontInContext._cache={};\r\n\t\treturn FontInContext;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.CONST3D2D\r\n\tvar CONST3D2D=(function(){\r\n\t\tfunction CONST3D2D(){};\r\n\t\t__class(CONST3D2D,'laya.webgl.utils.CONST3D2D');\r\n\t\tCONST3D2D.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tCONST3D2D.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tCONST3D2D.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0];\r\n\t\tCONST3D2D._TMPARRAY=[];\r\n\t\tCONST3D2D._OFFSETX=0;\r\n\t\tCONST3D2D._OFFSETY=0;\r\n\t\t__static(CONST3D2D,\r\n\t\t['BYTES_PE',function(){return this.BYTES_PE=/*__JS__ */Float32Array.BYTES_PER_ELEMENT;},'BYTES_PIDX',function(){return this.BYTES_PIDX=/*__JS__ */Uint16Array.BYTES_PER_ELEMENT;}\r\n\t\t]);\r\n\t\treturn CONST3D2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.GlUtils\r\n\tvar GlUtils=(function(){\r\n\t\tfunction GlUtils(){};\r\n\t\t__class(GlUtils,'laya.webgl.utils.GlUtils');\r\n\t\tGlUtils.make2DProjection=function(width,height,depth){\r\n\t\t\treturn [2.0 / width,0,0,0,0,-2.0 / height,0,0,0,0,2.0 / depth,0,-1,1,0,1,];\r\n\t\t}\r\n\r\n\t\tGlUtils.fillIBQuadrangle=function(buffer,count){\r\n\t\t\tif (count > 65535 / 4){\r\n\t\t\t\tthrow Error(\"IBQuadrangle count:\"+count+\" must<:\"+Math.floor(65535 / 4));\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tcount=Math.floor(count);\r\n\t\t\tbuffer._resizeBuffer((count+1)*6 */*laya.webgl.utils.Buffer2D.SHORT*/2,false);\r\n\t\t\tbuffer.byteLength=buffer.bufferLength;\r\n\t\t\tvar bufferData=buffer.getUint16Array();\r\n\t\t\tvar idx=0;\r\n\t\t\tfor (var i=0;i < count;i++){\r\n\t\t\t\tbufferData[idx++]=i *4;\r\n\t\t\t\tbufferData[idx++]=i *4+2;\r\n\t\t\t\tbufferData[idx++]=i *4+1;\r\n\t\t\t\tbufferData[idx++]=i *4;\r\n\t\t\t\tbufferData[idx++]=i *4+3;\r\n\t\t\t\tbufferData[idx++]=i *4+2;\r\n\t\t\t}\r\n\t\t\tbuffer.setNeedUpload();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.expandIBQuadrangle=function(buffer,count){\r\n\t\t\tbuffer.bufferLength >=(count *6 */*laya.webgl.utils.Buffer2D.SHORT*/2)|| GlUtils.fillIBQuadrangle(buffer,count);\r\n\t\t}\r\n\r\n\t\tGlUtils.mathCeilPowerOfTwo=function(value){\r\n\t\t\tvalue--;\r\n\t\t\tvalue |=value >> 1;\r\n\t\t\tvalue |=value >> 2;\r\n\t\t\tvalue |=value >> 4;\r\n\t\t\tvalue |=value >> 8;\r\n\t\t\tvalue |=value >> 16;\r\n\t\t\tvalue++;\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillQuadrangleImgVb=function(vb,x,y,point4,uv,m,_x,_y){\r\n\t\t\t'use strict';\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvpos-=/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvbdata[vpos+2]=uv[0];\r\n\t\t\tvbdata[vpos+3]=uv[1];\r\n\t\t\tvbdata[vpos+6]=uv[2];\r\n\t\t\tvbdata[vpos+7]=uv[3];\r\n\t\t\tvbdata[vpos+10]=uv[4];\r\n\t\t\tvbdata[vpos+11]=uv[5];\r\n\t\t\tvbdata[vpos+14]=uv[6];\r\n\t\t\tvbdata[vpos+15]=uv[7];\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\tm.bTransform=true;\r\n\t\t\t\tvar tx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\tvbdata[vpos]=(point4[0]+x)*a+(point4[1]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+1]=(point4[0]+x)*b+(point4[1]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+4]=(point4[2]+x)*a+(point4[3]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+5]=(point4[2]+x)*b+(point4[3]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+8]=(point4[4]+x)*a+(point4[5]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+9]=(point4[4]+x)*b+(point4[5]+y)*d+ty;\r\n\t\t\t\tvbdata[vpos+12]=(point4[6]+x)*a+(point4[7]+y)*c+tx;\r\n\t\t\t\tvbdata[vpos+13]=(point4[6]+x)*b+(point4[7]+y)*d+ty;\r\n\t\t\t\t}else {\r\n\t\t\t\tm.bTransform=false;\r\n\t\t\t\tx+=m.tx+_x;\r\n\t\t\t\ty+=m.ty+_y;\r\n\t\t\t\tvbdata[vpos]=x+point4[0];\r\n\t\t\t\tvbdata[vpos+1]=y+point4[1];\r\n\t\t\t\tvbdata[vpos+4]=x+point4[2];\r\n\t\t\t\tvbdata[vpos+5]=y+point4[3];\r\n\t\t\t\tvbdata[vpos+8]=x+point4[4];\r\n\t\t\t\tvbdata[vpos+9]=y+point4[5];\r\n\t\t\t\tvbdata[vpos+12]=x+point4[6];\r\n\t\t\t\tvbdata[vpos+13]=y+point4[7];\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillTranglesVB=function(vb,x,y,points,m,_x,_y){\r\n\t\t\t'use strict';\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+points.length;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvpos-=points.length;\r\n\t\t\tvar len=points.length;\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tfor (var i=0;i < len;i+=4){\r\n\t\t\t\tvbdata[vpos+i+2]=points[i+2];\r\n\t\t\t\tvbdata[vpos+i+3]=points[i+3];\r\n\t\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\t\tm.bTransform=true;\r\n\t\t\t\t\tvar tx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\tvbdata[vpos+i]=(points[i]+x)*a+(points[i+1]+y)*c+tx;\r\n\t\t\t\t\tvbdata[vpos+i+1]=(points[i]+x)*b+(points[i+1]+y)*d+ty;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tm.bTransform=false;\r\n\t\t\t\t\tx+=m.tx+_x;\r\n\t\t\t\t\ty+=m.ty+_y;\r\n\t\t\t\t\tvbdata[vpos+i]=x+points[i];\r\n\t\t\t\t\tvbdata[vpos+i+1]=y+points[i+1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.copyPreImgVb=function(vb,dx,dy){\r\n\t\t\tvar vpos=(vb._byteLength >> 2);\r\n\t\t\tvb.byteLength=((vpos+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tfor (var i=0,ci=vpos-16;i < 4;i++){\r\n\t\t\t\tvbdata[vpos]=vbdata[ci]+dx;++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci]+dy;++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci];++vpos;++ci;\r\n\t\t\t\tvbdata[vpos]=vbdata[ci];++vpos;++ci;\r\n\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillRectImgVb=function(vb,clip,x,y,width,height,uv,m,_x,_y,dx,dy,round){\r\n\t\t\t(round===void 0)&& (round=false);\r\n\t\t\t'use strict';\r\n\t\t\tvar mType=1;\r\n\t\t\tvar toBx,toBy,toEx,toEy;\r\n\t\t\tvar cBx,cBy,cEx,cEy;\r\n\t\t\tvar w0,h0,tx,ty;\r\n\t\t\tvar finalX,finalY,offsetX,offsetY;\r\n\t\t\tvar a=m.a,b=m.b,c=m.c,d=m.d;\r\n\t\t\tvar useClip=clip.width < /*laya.webgl.canvas.WebGLContext2D._MAXSIZE*/99999999;\r\n\t\t\tif (a!==1 || b!==0 || c!==0 || d!==1){\r\n\t\t\t\tm.bTransform=true;\r\n\t\t\t\tif (b===0 && c===0){\r\n\t\t\t\t\tmType=23;\r\n\t\t\t\t\tw0=width+x,h0=height+y;\r\n\t\t\t\t\ttx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\ttoBx=a *x+tx;\r\n\t\t\t\t\ttoEx=a *w0+tx;\r\n\t\t\t\t\ttoBy=d *y+ty;\r\n\t\t\t\t\ttoEy=d *h0+ty;\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tmType=23;\r\n\t\t\t\tm.bTransform=false;\r\n\t\t\t\ttoBx=x+m.tx+_x;\r\n\t\t\t\ttoEx=toBx+width;\r\n\t\t\t\ttoBy=y+m.ty+_y;\r\n\t\t\t\ttoEy=toBy+height;\r\n\t\t\t}\r\n\t\t\tif (useClip){\r\n\t\t\t\tcBx=clip.x,cBy=clip.y,cEx=clip.width+cBx,cEy=clip.height+cBy;\r\n\t\t\t}\r\n\t\t\tif (mType!==1 && (Math.min(toBx,toEx)>=cEx || Math.min(toBy ,toEy)>=cEy || Math.max(toEx,toBx)<=cBx || Math.max(toEy,toBy)<=cBy))\r\n\t\t\t\treturn false;\r\n\t\t\tvar vpos=(vb._byteLength >> 2);\r\n\t\t\tvb.byteLength=((vpos+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=vb.getFloat32Array();\r\n\t\t\tvbdata[vpos+2]=uv[0];\r\n\t\t\tvbdata[vpos+3]=uv[1];\r\n\t\t\tvbdata[vpos+6]=uv[2];\r\n\t\t\tvbdata[vpos+7]=uv[3];\r\n\t\t\tvbdata[vpos+10]=uv[4];\r\n\t\t\tvbdata[vpos+11]=uv[5];\r\n\t\t\tvbdata[vpos+14]=uv[6];\r\n\t\t\tvbdata[vpos+15]=uv[7];\r\n\t\t\tswitch (mType){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\ttx=m.tx+_x,ty=m.ty+_y;\r\n\t\t\t\t\tw0=width+x,h0=height+y;\r\n\t\t\t\t\tvar w1=x,h1=y;\r\n\t\t\t\t\tvar aw1=a *w1,ch1=c *h1,dh1=d *h1,bw1=b *w1;\r\n\t\t\t\t\tvar aw0=a *w0,ch0=c *h0,dh0=d *h0,bw0=b *w0;\r\n\t\t\t\t\tif (round){\r\n\t\t\t\t\t\tfinalX=aw1+ch1+tx;\r\n\t\t\t\t\t\toffsetX=Math.round(finalX)-finalX;\r\n\t\t\t\t\t\tfinalY=dh1+bw1+ty;\r\n\t\t\t\t\t\toffsetY=Math.round(finalY)-finalY;\r\n\t\t\t\t\t\tvbdata[vpos]=finalX+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+1]=finalY+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+4]=aw0+ch1+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+5]=dh1+bw0+ty+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+8]=aw0+ch0+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+9]=dh0+bw0+ty+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+12]=aw1+ch0+tx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+13]=dh0+bw1+ty+offsetY;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvbdata[vpos]=aw1+ch1+tx;\r\n\t\t\t\t\t\tvbdata[vpos+1]=dh1+bw1+ty;\r\n\t\t\t\t\t\tvbdata[vpos+4]=aw0+ch1+tx;\r\n\t\t\t\t\t\tvbdata[vpos+5]=dh1+bw0+ty;\r\n\t\t\t\t\t\tvbdata[vpos+8]=aw0+ch0+tx;\r\n\t\t\t\t\t\tvbdata[vpos+9]=dh0+bw0+ty;\r\n\t\t\t\t\t\tvbdata[vpos+12]=aw1+ch0+tx;\r\n\t\t\t\t\t\tvbdata[vpos+13]=dh0+bw1+ty;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase 23:\r\n\t\t\t\t\tif (round){\r\n\t\t\t\t\t\tfinalX=toBx+dx;\r\n\t\t\t\t\t\toffsetX=Math.round(finalX)-finalX;\r\n\t\t\t\t\t\tfinalY=toBy;\r\n\t\t\t\t\t\toffsetY=Math.round(finalY)-finalY;\r\n\t\t\t\t\t\tvbdata[vpos]=finalX+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+1]=finalY+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+4]=toEx+dx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+5]=toBy+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+8]=toEx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+9]=toEy+offsetY;\r\n\t\t\t\t\t\tvbdata[vpos+12]=toBx+offsetX;\r\n\t\t\t\t\t\tvbdata[vpos+13]=toEy+offsetY;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tvbdata[vpos]=toBx+dx;\r\n\t\t\t\t\t\tvbdata[vpos+1]=toBy;\r\n\t\t\t\t\t\tvbdata[vpos+4]=toEx+dx;\r\n\t\t\t\t\t\tvbdata[vpos+5]=toBy;\r\n\t\t\t\t\t\tvbdata[vpos+8]=toEx;\r\n\t\t\t\t\t\tvbdata[vpos+9]=toEy;\r\n\t\t\t\t\t\tvbdata[vpos+12]=toBx;\r\n\t\t\t\t\t\tvbdata[vpos+13]=toEy;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\tvb._upload=true;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils.fillLineVb=function(vb,clip,fx,fy,tx,ty,width,mat){\r\n\t\t\t'use strict';\r\n\t\t\tvar linew=width *.5;\r\n\t\t\tvar data=GlUtils._fillLineArray;\r\n\t\t\tvar perpx=-(fy-ty),perpy=fx-tx;\r\n\t\t\tvar dist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx /=dist,perpy /=dist,perpx *=linew,perpy *=linew;\r\n\t\t\tdata[0]=fx-perpx,data[1]=fy-perpy,data[4]=fx+perpx,data[5]=fy+perpy,data[8]=tx+perpx,data[9]=ty+perpy,data[12]=tx-perpx,data[13]=ty-perpy;\r\n\t\t\tmat && mat.transformPointArray(data,data);\r\n\t\t\tvar vpos=(vb._byteLength >> 2)+/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16;\r\n\t\t\tvb.byteLength=(vpos << 2);\r\n\t\t\tvb.insertData(data,vpos-/*laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tGlUtils._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];\r\n\t\treturn GlUtils;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.MatirxArray\r\n\tvar MatirxArray=(function(){\r\n\t\tfunction MatirxArray(){};\r\n\t\t__class(MatirxArray,'laya.webgl.utils.MatirxArray');\r\n\t\tMatirxArray.ArrayMul=function(a,b,o){\r\n\t\t\tif (!a){\r\n\t\t\t\tMatirxArray.copyArray(b,o);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!b){\r\n\t\t\t\tMatirxArray.copyArray(a,o);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar ai0=NaN,ai1=NaN,ai2=NaN,ai3=NaN;\r\n\t\t\tfor (var i=0;i < 4;i++){\r\n\t\t\t\tai0=a[i];\r\n\t\t\t\tai1=a[i+4];\r\n\t\t\t\tai2=a[i+8];\r\n\t\t\t\tai3=a[i+12];\r\n\t\t\t\to[i]=ai0 *b[0]+ai1 *b[1]+ai2 *b[2]+ai3 *b[3];\r\n\t\t\t\to[i+4]=ai0 *b[4]+ai1 *b[5]+ai2 *b[6]+ai3 *b[7];\r\n\t\t\t\to[i+8]=ai0 *b[8]+ai1 *b[9]+ai2 *b[10]+ai3 *b[11];\r\n\t\t\t\to[i+12]=ai0 *b[12]+ai1 *b[13]+ai2 *b[14]+ai3 *b[15];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tMatirxArray.copyArray=function(f,t){\r\n\t\t\tif (!f)return;\r\n\t\t\tif (!t)return;\r\n\t\t\tfor (var i=0;i < f.length;i++){\r\n\t\t\t\tt[i]=f[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn MatirxArray;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.RenderState2D\r\n\tvar RenderState2D=(function(){\r\n\t\tfunction RenderState2D(){};\r\n\t\t__class(RenderState2D,'laya.webgl.utils.RenderState2D');\r\n\t\tRenderState2D.getMatrArray=function(){\r\n\t\t\treturn [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\t}\r\n\r\n\t\tRenderState2D.mat2MatArray=function(mat,matArray){\r\n\t\t\tvar m=mat;\r\n\t\t\tvar m4=matArray;\r\n\t\t\tm4[0]=m.a;\r\n\t\t\tm4[1]=m.b;\r\n\t\t\tm4[4]=m.c;\r\n\t\t\tm4[5]=m.d;\r\n\t\t\tm4[12]=m.tx;\r\n\t\t\tm4[13]=m.ty;\r\n\t\t\treturn matArray;\r\n\t\t}\r\n\r\n\t\tRenderState2D.restoreTempArray=function(){\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[0]=1;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[1]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[4]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[5]=1;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[12]=0;\r\n\t\t\tRenderState2D.TEMPMAT4_ARRAY[13]=0;\r\n\t\t}\r\n\r\n\t\tRenderState2D.clear=function(){\r\n\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\tRenderState2D.worldShaderDefines=null;\r\n\t\t\tRenderState2D.worldFilters=null;\r\n\t\t\tRenderState2D.worldAlpha=1;\r\n\t\t\tRenderState2D.worldClipRect.x=RenderState2D.worldClipRect.y=0;\r\n\t\t\tRenderState2D.worldClipRect.width=RenderState2D.width;\r\n\t\t\tRenderState2D.worldClipRect.height=RenderState2D.height;\r\n\t\t\tRenderState2D.curRenderTarget=null;\r\n\t\t}\r\n\r\n\t\tRenderState2D._MAXSIZE=99999999;\r\n\t\tRenderState2D.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tRenderState2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\tRenderState2D.worldMatrix4=RenderState2D.TEMPMAT4_ARRAY;\r\n\t\tRenderState2D.worldAlpha=1.0;\r\n\t\tRenderState2D.worldScissorTest=false;\r\n\t\tRenderState2D.worldFilters=null\r\n\t\tRenderState2D.worldShaderDefines=null\r\n\t\tRenderState2D.worldClipRect=new Rectangle(0,0,99999999,99999999);\r\n\t\tRenderState2D.curRenderTarget=null\r\n\t\tRenderState2D.width=0;\r\n\t\tRenderState2D.height=0;\r\n\t\t__static(RenderState2D,\r\n\t\t['worldMatrix',function(){return this.worldMatrix=new Matrix();}\r\n\t\t]);\r\n\t\treturn RenderState2D;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.utils.ShaderCompile\r\n\tvar ShaderCompile=(function(){\r\n\t\tvar ShaderScriptBlock;\r\n\t\tfunction ShaderCompile(name,vs,ps,nameMap,includeFiles){\r\n\t\t\t//this._VS=null;\r\n\t\t\t//this._PS=null;\r\n\t\t\t//this._VSTXT=null;\r\n\t\t\t//this._PSTXT=null;\r\n\t\t\t//this._nameMap=null;\r\n\t\t\tthis._VSTXT=vs;\r\n\t\t\tthis._PSTXT=ps;\r\n\t\t\tfunction split (str){\r\n\t\t\t\tvar words=str.split(' ');\r\n\t\t\t\tvar out=[];\r\n\t\t\t\tfor (var i=0;i < words.length;i++)\r\n\t\t\t\twords[i].length > 0 && out.push(words[i]);\r\n\t\t\t\treturn out;\r\n\t\t\t}\r\n\t\t\tfunction c (script){\r\n\t\t\t\tvar i=0,n=0,ofs=0,words,condition;\r\n\t\t\t\tvar top=new ShaderScriptBlock(0,null,null,null);\r\n\t\t\t\tvar parent=top;\r\n\t\t\t\tvar lines=script.split('\\n');\r\n\t\t\t\tfor (i=0,n=lines.length;i < n;i++){\r\n\t\t\t\t\tvar line=lines[i];\r\n\t\t\t\t\tif (line.indexOf(\"#ifdef\")>=0){\r\n\t\t\t\t\t\twords=split(line);\r\n\t\t\t\t\t\tparent=new ShaderScriptBlock(1,words[1],\"\",parent);\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#else\")>=0){\r\n\t\t\t\t\t\tcondition=parent.condition;\r\n\t\t\t\t\t\tparent=new ShaderScriptBlock(2,null,\"\",parent.parent);\r\n\t\t\t\t\t\tparent.condition=condition;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#endif\")>=0){\r\n\t\t\t\t\t\tparent=parent.parent;\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (line.indexOf(\"#include\")>=0){\r\n\t\t\t\t\t\twords=split(line);\r\n\t\t\t\t\t\tvar fname=words[1];\r\n\t\t\t\t\t\tvar chr=fname.charAt(0);\r\n\t\t\t\t\t\tif (chr==='\"' || chr===\"'\"){\r\n\t\t\t\t\t\t\tfname=fname.substr(1,fname.length-2);\r\n\t\t\t\t\t\t\tofs=fname.lastIndexOf(chr);\r\n\t\t\t\t\t\t\tif (ofs > 0)fname=fname.substr(0,ofs);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tofs=words[0].indexOf('?');\r\n\t\t\t\t\t\tvar str=ofs > 0 ? words[0].substr(ofs+1):words[0];\r\n\t\t\t\t\t\tnew ShaderScriptBlock(1,str,includeFiles[fname],parent);\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (parent.childs.length > 0 && parent.childs[parent.childs.length-1].type===0){\r\n\t\t\t\t\t\tparent.childs[parent.childs.length-1].text+=\"\\n\"+line;\r\n\t\t\t\t\t}else new ShaderScriptBlock(0,null,line,parent);\r\n\t\t\t\t}\r\n\t\t\t\treturn top;\r\n\t\t\t}\r\n\t\t\tthis._VS=c(vs);\r\n\t\t\tthis._PS=c(ps);\r\n\t\t\tthis._nameMap=nameMap;\r\n\t\t}\r\n\r\n\t\t__class(ShaderCompile,'laya.webgl.utils.ShaderCompile');\r\n\t\tvar __proto=ShaderCompile.prototype;\r\n\t\t__proto.createShader=function(define,shaderName,createShader){\r\n\t\t\tvar defMap={};\r\n\t\t\tvar defineStr=\"\";\r\n\t\t\tif (define){\r\n\t\t\t\tfor (var i in define){\r\n\t\t\t\t\tdefineStr+=\"#define \"+i+\"\\n\";\r\n\t\t\t\t\tdefMap[i]=true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar vs=this._VS.toscript(defMap,[]);\r\n\t\t\tvar ps=this._PS.toscript(defMap,[]);\r\n\t\t\treturn (createShader || Shader.create)(defineStr+vs.join('\\n'),defineStr+ps.join('\\n'),shaderName,this._nameMap);\r\n\t\t}\r\n\r\n\t\tShaderCompile.IFDEF_NO=0;\r\n\t\tShaderCompile.IFDEF_YES=1;\r\n\t\tShaderCompile.IFDEF_ELSE=2;\r\n\t\tShaderCompile.__init$=function(){\r\n\t\t\t//class ShaderScriptBlock\r\n\t\t\tShaderScriptBlock=(function(){\r\n\t\t\t\tfunction ShaderScriptBlock(type,condition,text,parent){\r\n\t\t\t\t\t//this.type=0;\r\n\t\t\t\t\t//this.condition=null;\r\n\t\t\t\t\t//this.text=null;\r\n\t\t\t\t\t//this.parent=null;\r\n\t\t\t\t\tthis.childs=new Array;\r\n\t\t\t\t\tthis.type=type;\r\n\t\t\t\t\tthis.text=text;\r\n\t\t\t\t\tthis.parent=parent;\r\n\t\t\t\t\tparent && parent.childs.push(this);\r\n\t\t\t\t\tif (!condition)return;\r\n\t\t\t\t\tvar newcondition=\"\";\r\n\t\t\t\t\tvar preIsParam=false,isParam=false;\r\n\t\t\t\t\tfor (var i=0,n=condition.length;i < n;i++){\r\n\t\t\t\t\t\tvar c=condition.charAt(i);\r\n\t\t\t\t\t\tisParam=\"!&|() \\t\".indexOf(c)< 0;\r\n\t\t\t\t\t\tif (preIsParam !=isParam){\r\n\t\t\t\t\t\t\tisParam && (newcondition+=\"this.\");\r\n\t\t\t\t\t\t\tpreIsParam=isParam;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewcondition+=c;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.condition=RunDriver.createShaderCondition(newcondition);\r\n\t\t\t\t}\r\n\t\t\t\t__class(ShaderScriptBlock,'');\r\n\t\t\t\tvar __proto=ShaderScriptBlock.prototype;\r\n\t\t\t\t__proto.toscript=function(def,out){\r\n\t\t\t\t\tif (this.type===/*laya.webgl.utils.ShaderCompile.IFDEF_NO*/0){\r\n\t\t\t\t\t\tthis.text && out.push(this.text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.childs.length < 1 && !this.text)return out;\r\n\t\t\t\t\tif (this.type!==/*laya.webgl.utils.ShaderCompile.IFDEF_NO*/0){\r\n\t\t\t\t\t\tvar ifdef=!!this.condition.call(def);\r\n\t\t\t\t\t\tthis.type===/*laya.webgl.utils.ShaderCompile.IFDEF_ELSE*/2 && (ifdef=!ifdef);\r\n\t\t\t\t\t\tif (!ifdef)return out;\r\n\t\t\t\t\t\tthis.text && out.push(this.text);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.childs.length > 0 && this.childs.forEach(function(o,index,arr){\r\n\t\t\t\t\t\to.toscript(def,out)\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn out;\r\n\t\t\t\t}\r\n\t\t\t\treturn ShaderScriptBlock;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn ShaderCompile;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.webgl.WebGL\r\n\tvar WebGL=(function(){\r\n\t\tfunction WebGL(){};\r\n\t\t__class(WebGL,'laya.webgl.WebGL');\r\n\t\tWebGL._float32ArraySlice=function(){\r\n\t\t\tvar _this=/*__JS__ */this;\r\n\t\t\tvar sz=_this.length;\r\n\t\t\tvar dec=new Float32Array(_this.length);\r\n\t\t\tfor (var i=0;i < sz;i++)dec[i]=_this[i];\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\tWebGL._uint16ArraySlice=function(__arg){\r\n\t\t\tvar arg=arguments;\r\n\t\t\tvar _this=/*__JS__ */this;\r\n\t\t\tvar sz=0;\r\n\t\t\tvar dec;\r\n\t\t\tvar i=0;\r\n\t\t\tif (arg.length===0){\r\n\t\t\t\tsz=_this.length;\r\n\t\t\t\tdec=new Uint16Array(sz);\r\n\t\t\t\tfor (i=0;i < sz;i++)\r\n\t\t\t\tdec[i]=_this[i];\r\n\t\t\t\t}else if (arg.length===2){\r\n\t\t\t\tvar start=arg[0];\r\n\t\t\t\tvar end=arg[1];\r\n\t\t\t\tif (end > start){\r\n\t\t\t\t\tsz=end-start;\r\n\t\t\t\t\tdec=new Uint16Array(sz);\r\n\t\t\t\t\tfor (i=start;i < end;i++)\r\n\t\t\t\t\tdec[i-start]=_this[i];\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tdec=new Uint16Array(0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn dec;\r\n\t\t}\r\n\r\n\t\tWebGL.expandContext=function(){\r\n\t\t\tvar from=Context.prototype;\r\n\t\t\tvar to=/*__JS__ */CanvasRenderingContext2D.prototype;\r\n\t\t\tto.fillTrangles=from.fillTrangles;\r\n\t\t\tBuffer2D.__int__(null);\r\n\t\t\tto.setIBVB=function (x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset){\r\n\t\t\t\t(startIndex===void 0)&& (startIndex=0);\r\n\t\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t\tif (ib===null){\r\n\t\t\t\t\tthis._ib=this._ib || IndexBuffer2D.QuadrangleIB;\r\n\t\t\t\t\tib=this._ib;\r\n\t\t\t\t\tGlUtils.expandIBQuadrangle(ib,(vb.byteLength / (4 *16)+8));\r\n\t\t\t\t}\r\n\t\t\t\tthis._setIBVB(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset);\r\n\t\t\t};\r\n\t\t\tto.fillTrangles=function (tex,x,y,points,m){\r\n\t\t\t\tthis._curMat=this._curMat || Matrix.create();\r\n\t\t\t\tthis._vb=this._vb || VertexBuffer2D.create();\r\n\t\t\t\tif (!this._ib){\r\n\t\t\t\t\tthis._ib=IndexBuffer2D.create();\r\n\t\t\t\t\tGlUtils.fillIBQuadrangle(this._ib,length / 4);\r\n\t\t\t\t};\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar length=points.length >> 4;\r\n\t\t\t\tGlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,0,0);\r\n\t\t\t\tGlUtils.expandIBQuadrangle(this._ib,(vb.byteLength / (4 *16)+8));\r\n\t\t\t\tvar shaderValues=new Value2D(0x01,0);\r\n\t\t\t\tshaderValues.textureHost=tex;\r\n\t\t\t\tvar sd=new Shader2X(\"attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }\",\"precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; void main() {vec4 color= texture2D(texture, v_texcoord); color.a*=1.0; gl_FragColor= color;}\");\r\n\t\t\t\t/*__JS__ */vb._vertType=3;\r\n\t\t\t\tthis._setIBVB(x,y,this._ib,vb,length *6,m,sd,shaderValues,0,0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.enable=function(){\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\tif (!Render.isConchWebGL){\r\n\t\t\t\t\tRunDriver.skinAniSprite=function (){\r\n\t\t\t\t\t\tvar tSkinSprite=new SkinMesh()\r\n\t\t\t\t\t\treturn tSkinSprite;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tWebGL.expandContext();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!WebGL.isWebGLSupported())return false;\r\n\t\t\tif (Render.isWebGL)return true;\r\n\t\t\tHTMLImage.create=function (src,def){\r\n\t\t\t\treturn new WebGLImage(src,def);\r\n\t\t\t}\r\n\t\t\tRender.WebGL=WebGL;\r\n\t\t\tRender.isWebGL=true;\r\n\t\t\tDrawText.__init__();\r\n\t\t\tRunDriver.createRenderSprite=function (type,next){\r\n\t\t\t\treturn new RenderSprite3D(type,next);\r\n\t\t\t}\r\n\t\t\tRunDriver.createWebGLContext2D=function (c){\r\n\t\t\t\treturn new WebGLContext2D(c);\r\n\t\t\t}\r\n\t\t\tRunDriver.changeWebGLSize=function (width,height){\r\n\t\t\t\tlaya.webgl.WebGL.onStageResize(width,height);\r\n\t\t\t}\r\n\t\t\tRunDriver.createGraphics=function (){\r\n\t\t\t\treturn new GraphicsGL();\r\n\t\t\t};\r\n\t\t\tvar action=RunDriver.createFilterAction;\r\n\t\t\tRunDriver.createFilterAction=action ? action :function (type){\r\n\t\t\t\treturn new ColorFilterActionGL()\r\n\t\t\t}\r\n\t\t\tRunDriver.clear=function (color){\r\n\t\t\t\tRenderState2D.worldScissorTest && laya.webgl.WebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\tif (color==null){\r\n\t\t\t\t\tRender.context.ctx.clearBG(0,0,0,0);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tvar c=Color.create(color)._color;\r\n\t\t\t\t\tRender.context.ctx.clearBG(c[0],c[1],c[2],c[3]);\r\n\t\t\t\t}\r\n\t\t\t\tRenderState2D.clear();\r\n\t\t\t}\r\n\t\t\tRunDriver.addToAtlas=function (texture,force){\r\n\t\t\t\t(force===void 0)&& (force=false);\r\n\t\t\t\tvar bitmap=texture.bitmap;\r\n\t\t\t\tif (!Render.optimizeTextureMemory(texture.url,texture)){\r\n\t\t\t\t\t(bitmap).enableMerageInAtlas=false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif ((Laya.__typeof(bitmap,'laya.webgl.resource.IMergeAtlasBitmap'))&& ((bitmap).allowMerageInAtlas)){\r\n\t\t\t\t\tbitmap.on(/*laya.events.Event.RECOVERED*/\"recovered\",texture,texture.addTextureToAtlas);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tAtlasResourceManager._enable();\r\n\t\t\tRunDriver.beginFlush=function (){\r\n\t\t\t\tvar atlasResourceManager=AtlasResourceManager.instance;\r\n\t\t\t\tvar count=atlasResourceManager.getAtlaserCount();\r\n\t\t\t\tfor (var i=0;i < count;i++){\r\n\t\t\t\t\tvar atlerCanvas=atlasResourceManager.getAtlaserByIndex(i).texture;\r\n\t\t\t\t\t(atlerCanvas._flashCacheImageNeedFlush)&& (RunDriver.flashFlushImage(atlerCanvas));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tRunDriver.drawToCanvas=function (sprite,_renderType,canvasWidth,canvasHeight,offsetX,offsetY){\r\n\t\t\t\tvar renderTarget=new RenderTarget2D(canvasWidth,canvasHeight,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,0,false);\r\n\t\t\t\trenderTarget.start();\r\n\t\t\t\trenderTarget.clear(1.0,0.0,0.0,1.0);\r\n\t\t\t\tsprite.render(Render.context,-offsetX,RenderState2D.height-canvasHeight-offsetY);\r\n\t\t\t\tRender.context.flush();\r\n\t\t\t\trenderTarget.end();\r\n\t\t\t\tvar pixels=renderTarget.getData(0,0,renderTarget.width,renderTarget.height);\r\n\t\t\t\trenderTarget.dispose();\r\n\t\t\t\treturn pixels;\r\n\t\t\t}\r\n\t\t\tRunDriver.createFilterAction=function (type){\r\n\t\t\t\tvar action;\r\n\t\t\t\tswitch (type){\r\n\t\t\t\t\tcase /*laya.filters.Filter.COLOR*/0x20:\r\n\t\t\t\t\t\taction=new ColorFilterActionGL();\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t\treturn action;\r\n\t\t\t}\r\n\t\t\tRunDriver.addTextureToAtlas=function (texture){\r\n\t\t\t\ttexture._uvID++;\r\n\t\t\t\tAtlasResourceManager._atlasRestore++;\r\n\t\t\t\t((texture.bitmap).enableMerageInAtlas)&& (AtlasResourceManager.instance.addToAtlas(texture));\r\n\t\t\t}\r\n\t\t\tRunDriver.getTexturePixels=function (value,x,y,width,height){\r\n\t\t\t\t(Render.context.ctx).clear();\r\n\t\t\t\tvar tSprite=new Sprite();\r\n\t\t\t\ttSprite.graphics.drawTexture(value,-x,-y);\r\n\t\t\t\tvar tRenderTarget=RenderTarget2D.create(width,height);\r\n\t\t\t\ttRenderTarget.start();\r\n\t\t\t\ttRenderTarget.clear(0,0,0,0);\r\n\t\t\t\ttSprite.render(Render.context,0,0);\r\n\t\t\t\t(Render.context.ctx).flush();\r\n\t\t\t\ttRenderTarget.end();\r\n\t\t\t\tvar tUint8Array=tRenderTarget.getData(0,0,width,height);\r\n\t\t\t\tvar tArray=[];\r\n\t\t\t\tvar tIndex=0;\r\n\t\t\t\tfor (var i=height-1;i >=0;i--){\r\n\t\t\t\t\tfor (var j=0;j < width;j++){\r\n\t\t\t\t\t\ttIndex=(i *width+j)*4;\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+1]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+2]);\r\n\t\t\t\t\t\ttArray.push(tUint8Array[tIndex+3]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn tArray;\r\n\t\t\t}\r\n\t\t\tRunDriver.skinAniSprite=function (){\r\n\t\t\t\tvar tSkinSprite=new SkinMesh()\r\n\t\t\t\treturn tSkinSprite;\r\n\t\t\t}\r\n\t\t\tFilter._filterStart=function (scope,sprite,context,x,y){\r\n\t\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\t\tvar source=RenderTarget2D.create(b.width,b.height);\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t\tscope.addValue(\"src\",source);\r\n\t\t\t\tscope.addValue(\"ScissorTest\",RenderState2D.worldScissorTest);\r\n\t\t\t\tif (RenderState2D.worldScissorTest){\r\n\t\t\t\t\tvar tClilpRect=new Rectangle();\r\n\t\t\t\t\ttClilpRect.copyFrom((context.ctx)._clipRect)\r\n\t\t\t\t\tscope.addValue(\"clipRect\",tClilpRect);\r\n\t\t\t\t\tRenderState2D.worldScissorTest=false;\r\n\t\t\t\t\tlaya.webgl.WebGL.mainContext.disable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFilter._filterEnd=function (scope,sprite,context,x,y){\r\n\t\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tvar out=RenderTarget2D.create(b.width,b.height);\r\n\t\t\t\tout.start();\r\n\t\t\t\tout.clear(0,0,0,0);\r\n\t\t\t\tscope.addValue(\"out\",out);\r\n\t\t\t\tsprite._set$P('_filterCache',out);\r\n\t\t\t\tsprite._set$P('_isHaveGlowFilter',scope.getValue(\"_isHaveGlowFilter\"));\r\n\t\t\t}\r\n\t\t\tFilter._EndTarget=function (scope,context){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.recycle();\r\n\t\t\t\tvar out=scope.getValue(\"out\");\r\n\t\t\t\tout.end();\r\n\t\t\t\tvar b=scope.getValue(\"ScissorTest\");\r\n\t\t\t\tif (b){\r\n\t\t\t\t\tRenderState2D.worldScissorTest=true;\r\n\t\t\t\t\tlaya.webgl.WebGL.mainContext.enable(/*laya.webgl.WebGLContext.SCISSOR_TEST*/0x0C11);\r\n\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\tvar tClipRect=scope.getValue(\"clipRect\");\r\n\t\t\t\t\t(context.ctx).clipRect(tClipRect.x,tClipRect.y,tClipRect.width,tClipRect.height);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFilter._useSrc=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"out\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tsource=scope.getValue(\"src\");\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t}\r\n\t\t\tFilter._endSrc=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t}\r\n\t\t\tFilter._useOut=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"src\");\r\n\t\t\t\tsource.end();\r\n\t\t\t\tsource=scope.getValue(\"out\");\r\n\t\t\t\tsource.start();\r\n\t\t\t\tsource.clear(0,0,0,0);\r\n\t\t\t}\r\n\t\t\tFilter._endOut=function (scope){\r\n\t\t\t\tvar source=scope.getValue(\"out\");\r\n\t\t\t\tsource.end();\r\n\t\t\t}\r\n\t\t\tFilter._recycleScope=function (scope){\r\n\t\t\t\tscope.recycle();\r\n\t\t\t}\r\n\t\t\tFilter._filter=function (sprite,context,x,y){\r\n\t\t\t\tvar next=this._next;\r\n\t\t\t\tif (next){\r\n\t\t\t\t\tvar filters=sprite.filters,len=filters.length;\r\n\t\t\t\t\tif (len==1 && (filters[0].type==/*laya.filters.Filter.COLOR*/0x20)){\r\n\t\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\t\tcontext.ctx.setFilters([filters[0]]);\r\n\t\t\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\t\t\tcontext.ctx.restore();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar shaderValue;\r\n\t\t\t\t\tvar b;\r\n\t\t\t\t\tvar scope=SubmitCMDScope.create();\r\n\t\t\t\t\tvar p=Point.TEMP;\r\n\t\t\t\t\tvar tMatrix=context.ctx._getTransformMatrix();\r\n\t\t\t\t\tvar mat=Matrix.create();\r\n\t\t\t\t\ttMatrix.copyTo(mat);\r\n\t\t\t\t\tvar tPadding=0;\r\n\t\t\t\t\tvar tHalfPadding=0;\r\n\t\t\t\t\tvar tIsHaveGlowFilter=false;\r\n\t\t\t\t\tvar out=sprite._$P._filterCache ? sprite._$P._filterCache :null;\r\n\t\t\t\t\tif (!out || sprite._repaint){\r\n\t\t\t\t\t\ttIsHaveGlowFilter=sprite._isHaveGlowFilter();\r\n\t\t\t\t\t\tscope.addValue(\"_isHaveGlowFilter\",tIsHaveGlowFilter);\r\n\t\t\t\t\t\tif (tIsHaveGlowFilter){\r\n\t\t\t\t\t\t\ttPadding=50;\r\n\t\t\t\t\t\t\ttHalfPadding=25;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb=new Rectangle();\r\n\t\t\t\t\t\tb.copyFrom((sprite).getSelfBounds());\r\n\t\t\t\t\t\tb.x+=(sprite).x;\r\n\t\t\t\t\t\tb.y+=(sprite).y;\r\n\t\t\t\t\t\tb.x-=(sprite).pivotX;\r\n\t\t\t\t\t\tb.y-=(sprite).pivotY;\r\n\t\t\t\t\t\tvar tSX=b.x;\r\n\t\t\t\t\t\tvar tSY=b.y;\r\n\t\t\t\t\t\tb.width+=tPadding;\r\n\t\t\t\t\t\tb.height+=tPadding;\r\n\t\t\t\t\t\tp.x=b.x *mat.a+b.y *mat.c;\r\n\t\t\t\t\t\tp.y=b.y *mat.d+b.x *mat.b;\r\n\t\t\t\t\t\tb.x=p.x;\r\n\t\t\t\t\t\tb.y=p.y;\r\n\t\t\t\t\t\tp.x=b.width *mat.a+b.height *mat.c;\r\n\t\t\t\t\t\tp.y=b.height *mat.d+b.width *mat.b;\r\n\t\t\t\t\t\tb.width=p.x;\r\n\t\t\t\t\t\tb.height=p.y;\r\n\t\t\t\t\t\tif (b.width <=0 || b.height <=0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tout && out.recycle();\r\n\t\t\t\t\t\tscope.addValue(\"bounds\",b);\r\n\t\t\t\t\t\tvar submit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterStart);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t(context.ctx)._renderKey=0;\r\n\t\t\t\t\t\t(context.ctx)._shader2D.glTexture=null;\r\n\t\t\t\t\t\tvar tX=sprite.x-tSX+tHalfPadding;\r\n\t\t\t\t\t\tvar tY=sprite.y-tSY+tHalfPadding;\r\n\t\t\t\t\t\tnext._fun.call(next,sprite,context,tX,tY);\r\n\t\t\t\t\t\tsubmit=SubmitCMD.create([scope,sprite,context,0,0],Filter._filterEnd);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\tfor (var i=0;i < len;i++){\r\n\t\t\t\t\t\t\tif (i !=0){\r\n\t\t\t\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._useSrc);\r\n\t\t\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t\t\tshaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\t\t\t\tcontext.ctx.drawTarget(scope,0,0,b.width,b.height,Matrix.TEMP,\"out\",shaderValue,null,BlendMode.TOINT.overlay);\r\n\t\t\t\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._useOut);\r\n\t\t\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tvar fil=filters[i];\r\n\t\t\t\t\t\t\tfil.action.apply3d(scope,sprite,context,0,0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubmit=SubmitCMD.create([scope,context],Filter._EndTarget);\r\n\t\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\ttIsHaveGlowFilter=sprite._$P._isHaveGlowFilter ? sprite._$P._isHaveGlowFilter :false;\r\n\t\t\t\t\t\tif (tIsHaveGlowFilter){\r\n\t\t\t\t\t\t\ttPadding=50;\r\n\t\t\t\t\t\t\ttHalfPadding=25;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb=sprite.getBounds();\r\n\t\t\t\t\t\tif (b.width <=0 || b.height <=0){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tb.width+=tPadding;\r\n\t\t\t\t\t\tb.height+=tPadding;\r\n\t\t\t\t\t\tp.x=b.x *mat.a+b.y *mat.c;\r\n\t\t\t\t\t\tp.y=b.y *mat.d+b.x *mat.b;\r\n\t\t\t\t\t\tb.x=p.x;\r\n\t\t\t\t\t\tb.y=p.y;\r\n\t\t\t\t\t\tp.x=b.width *mat.a+b.height *mat.c;\r\n\t\t\t\t\t\tp.y=b.height *mat.d+b.width *mat.b;\r\n\t\t\t\t\t\tb.width=p.x;\r\n\t\t\t\t\t\tb.height=p.y;\r\n\t\t\t\t\t\tscope.addValue(\"out\",out);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx=x-tHalfPadding-sprite.x;\r\n\t\t\t\t\ty=y-tHalfPadding-sprite.y;\r\n\t\t\t\t\tp.setTo(x,y);\r\n\t\t\t\t\tmat.transformPoint(p);\r\n\t\t\t\t\tx=p.x+b.x;\r\n\t\t\t\t\ty=p.y+b.y;\r\n\t\t\t\t\tshaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\t(context.ctx).drawTarget(scope,x,y,b.width,b.height,Matrix.TEMP,\"out\",shaderValue,null,BlendMode.TOINT.overlay);\r\n\t\t\t\t\tsubmit=SubmitCMD.create([scope],Filter._recycleScope);\r\n\t\t\t\t\tcontext.addRenderObject(submit);\r\n\t\t\t\t\tmat.destroy();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tFloat32Array.prototype.slice || (Float32Array.prototype.slice=WebGL._float32ArraySlice);\r\n\t\t\tUint16Array.prototype.slice || (Uint16Array.prototype.slice=WebGL._uint16ArraySlice);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tWebGL.isWebGLSupported=function(){\r\n\t\t\tvar canvas=Browser.createElement('canvas');\r\n\t\t\tvar gl;\r\n\t\t\tvar names=[\"webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"];\r\n\t\t\tfor (var i=0;i < names.length;i++){\r\n\t\t\t\ttry {\r\n\t\t\t\t\tgl=canvas.getContext(names[i]);\r\n\t\t\t\t}catch (e){}\r\n\t\t\t\tif (gl)return names[i];\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tWebGL.onStageResize=function(width,height){\r\n\t\t\tif (WebGL.mainContext==null)return;\r\n\t\t\tWebGL.mainContext.viewport(0,0,width,height);\r\n\t\t\tRenderState2D.width=width;\r\n\t\t\tRenderState2D.height=height;\r\n\t\t}\r\n\r\n\t\tWebGL.isExperimentalWebgl=function(){\r\n\t\t\treturn WebGL._isExperimentalWebgl;\r\n\t\t}\r\n\r\n\t\tWebGL.addRenderFinish=function(){\r\n\t\t\tif (WebGL._isExperimentalWebgl || Render.isFlash){\r\n\t\t\t\tRunDriver.endFinish=function (){\r\n\t\t\t\t\tRender.context.ctx.finish();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.removeRenderFinish=function(){\r\n\t\t\tif (WebGL._isExperimentalWebgl){\r\n\t\t\t\tRunDriver.endFinish=function (){}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.onInvalidGLRes=function(){\r\n\t\t\tAtlasResourceManager.instance.freeAll();\r\n\t\t\tResourceManager.releaseContentManagers(true);\r\n\t\t\tWebGL.doNodeRepaint(Laya.stage);\r\n\t\t\tWebGL.mainContext.viewport(0,0,RenderState2D.width,RenderState2D.height);\r\n\t\t\tLaya.stage.event(/*laya.events.Event.DEVICE_LOST*/\"devicelost\");\r\n\t\t}\r\n\r\n\t\tWebGL.doNodeRepaint=function(sprite){\r\n\t\t\t(sprite.numChildren==0)&& (sprite.repaint());\r\n\t\t\tfor (var i=0;i < sprite.numChildren;i++)\r\n\t\t\tWebGL.doNodeRepaint(sprite.getChildAt(i));\r\n\t\t}\r\n\r\n\t\tWebGL.init=function(canvas,width,height){\r\n\t\t\tWebGL.mainCanvas=canvas;\r\n\t\t\tHTMLCanvas._createContext=function (canvas){\r\n\t\t\t\treturn new WebGLContext2D(canvas);\r\n\t\t\t};\r\n\t\t\tvar webGLName=WebGL.isWebGLSupported();\r\n\t\t\tvar gl=WebGL.mainContext=RunDriver.newWebGLContext(canvas,webGLName);\r\n\t\t\tWebGL._isExperimentalWebgl=(webGLName !=\"webgl\" && (Browser.onWeiXin || Browser.onMQQBrowser));\r\n\t\t\tWebGL.frameShaderHighPrecision=false;\r\n\t\t\ttry {\r\n\t\t\t\tvar precisionFormat=laya.webgl.WebGL.mainContext.getShaderPrecisionFormat(/*laya.webgl.WebGLContext.FRAGMENT_SHADER*/0x8B30,/*laya.webgl.WebGLContext.HIGH_FLOAT*/0x8DF2);\r\n\t\t\t\tprecisionFormat.precision ? WebGL.frameShaderHighPrecision=true :WebGL.frameShaderHighPrecision=false;\r\n\t\t\t}catch (e){}\r\n\t\t\tBrowser.window.SetupWebglContext && Browser.window.SetupWebglContext(gl);\r\n\t\t\tgl.deleteTexture1=gl.deleteTexture;\r\n\t\t\tgl.deleteTexture=function (t){\r\n\t\t\t\tif (t==WebGLContext.curBindTexValue){\r\n\t\t\t\t\tWebGLContext.curBindTexValue=null;\r\n\t\t\t\t}\r\n\t\t\t\tgl.deleteTexture1(t);\r\n\t\t\t}\r\n\t\t\tWebGL.onStageResize(width,height);\r\n\t\t\tif (WebGL.mainContext==null)\r\n\t\t\t\tthrow new Error(\"webGL getContext err!\");\r\n\t\t\tSystem.__init__();\r\n\t\t\tAtlasResourceManager.__init__();\r\n\t\t\tShaderDefines2D.__init__();\r\n\t\t\tSubmit.__init__();\r\n\t\t\tWebGLContext2D.__init__();\r\n\t\t\tValue2D.__init__();\r\n\t\t\tShader2D.__init__();\r\n\t\t\tBuffer2D.__int__(gl);\r\n\t\t\tBlendMode._init_(gl);\r\n\t\t\tif (Render.isConchApp){\r\n\t\t\t\t/*__JS__ */conch.setOnInvalidGLRes(WebGL.onInvalidGLRes);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tWebGL.mainCanvas=null\r\n\t\tWebGL.mainContext=null\r\n\t\tWebGL.antialias=true;\r\n\t\tWebGL.frameShaderHighPrecision=false;\r\n\t\tWebGL._bg_null=[0,0,0,0];\r\n\t\tWebGL._isExperimentalWebgl=false;\r\n\t\treturn WebGL;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.WebGLContext\r\n\tvar WebGLContext=(function(){\r\n\t\tfunction WebGLContext(){};\r\n\t\t__class(WebGLContext,'laya.webgl.WebGLContext');\r\n\t\tWebGLContext.UseProgram=function(program){\r\n\t\t\tif (WebGLContext._useProgram===program)return false;\r\n\t\t\tWebGL.mainContext.useProgram(program);\r\n\t\t\tWebGLContext._useProgram=program;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthTest=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthTest && (WebGLContext._depthTest=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.DEPTH_TEST*/0x0B71):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.DEPTH_TEST*/0x0B71));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthMask=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthMask && (WebGLContext._depthMask=value,gl.depthMask(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setDepthFunc=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._depthFunc && (WebGLContext._depthFunc=value,gl.depthFunc(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setBlend=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._blend && (WebGLContext._blend=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.BLEND*/0x0BE2):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.BLEND*/0x0BE2));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setBlendFunc=function(gl,sFactor,dFactor){\r\n\t\t\t(sFactor!==WebGLContext._sFactor||dFactor!==WebGLContext._dFactor)&& (WebGLContext._sFactor=sFactor,WebGLContext._dFactor=dFactor,gl.blendFunc(sFactor,dFactor));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setCullFace=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._cullFace && (WebGLContext._cullFace=value,value?gl.enable(/*CLASS CONST:laya.webgl.WebGLContext.CULL_FACE*/0x0B44):gl.disable(/*CLASS CONST:laya.webgl.WebGLContext.CULL_FACE*/0x0B44));\r\n\t\t}\r\n\r\n\t\tWebGLContext.setFrontFace=function(gl,value){\r\n\t\t\tvalue!==WebGLContext._frontFace && (WebGLContext._frontFace=value,gl.frontFace(value));\r\n\t\t}\r\n\r\n\t\tWebGLContext.bindTexture=function(gl,target,texture){\r\n\t\t\tgl.bindTexture(target,texture);\r\n\t\t\tWebGLContext.curBindTexTarget=target;\r\n\t\t\tWebGLContext.curBindTexValue=texture;\r\n\t\t}\r\n\r\n\t\tWebGLContext.DEPTH_BUFFER_BIT=0x00000100;\r\n\t\tWebGLContext.STENCIL_BUFFER_BIT=0x00000400;\r\n\t\tWebGLContext.COLOR_BUFFER_BIT=0x00004000;\r\n\t\tWebGLContext.POINTS=0x0000;\r\n\t\tWebGLContext.LINES=0x0001;\r\n\t\tWebGLContext.LINE_LOOP=0x0002;\r\n\t\tWebGLContext.LINE_STRIP=0x0003;\r\n\t\tWebGLContext.TRIANGLES=0x0004;\r\n\t\tWebGLContext.TRIANGLE_STRIP=0x0005;\r\n\t\tWebGLContext.TRIANGLE_FAN=0x0006;\r\n\t\tWebGLContext.ZERO=0;\r\n\t\tWebGLContext.ONE=1;\r\n\t\tWebGLContext.SRC_COLOR=0x0300;\r\n\t\tWebGLContext.ONE_MINUS_SRC_COLOR=0x0301;\r\n\t\tWebGLContext.SRC_ALPHA=0x0302;\r\n\t\tWebGLContext.ONE_MINUS_SRC_ALPHA=0x0303;\r\n\t\tWebGLContext.DST_ALPHA=0x0304;\r\n\t\tWebGLContext.ONE_MINUS_DST_ALPHA=0x0305;\r\n\t\tWebGLContext.DST_COLOR=0x0306;\r\n\t\tWebGLContext.ONE_MINUS_DST_COLOR=0x0307;\r\n\t\tWebGLContext.SRC_ALPHA_SATURATE=0x0308;\r\n\t\tWebGLContext.FUNC_ADD=0x8006;\r\n\t\tWebGLContext.BLEND_EQUATION=0x8009;\r\n\t\tWebGLContext.BLEND_EQUATION_RGB=0x8009;\r\n\t\tWebGLContext.BLEND_EQUATION_ALPHA=0x883D;\r\n\t\tWebGLContext.FUNC_SUBTRACT=0x800A;\r\n\t\tWebGLContext.FUNC_REVERSE_SUBTRACT=0x800B;\r\n\t\tWebGLContext.BLEND_DST_RGB=0x80C8;\r\n\t\tWebGLContext.BLEND_SRC_RGB=0x80C9;\r\n\t\tWebGLContext.BLEND_DST_ALPHA=0x80CA;\r\n\t\tWebGLContext.BLEND_SRC_ALPHA=0x80CB;\r\n\t\tWebGLContext.CONSTANT_COLOR=0x8001;\r\n\t\tWebGLContext.ONE_MINUS_CONSTANT_COLOR=0x8002;\r\n\t\tWebGLContext.CONSTANT_ALPHA=0x8003;\r\n\t\tWebGLContext.ONE_MINUS_CONSTANT_ALPHA=0x8004;\r\n\t\tWebGLContext.BLEND_COLOR=0x8005;\r\n\t\tWebGLContext.ARRAY_BUFFER=0x8892;\r\n\t\tWebGLContext.ELEMENT_ARRAY_BUFFER=0x8893;\r\n\t\tWebGLContext.ARRAY_BUFFER_BINDING=0x8894;\r\n\t\tWebGLContext.ELEMENT_ARRAY_BUFFER_BINDING=0x8895;\r\n\t\tWebGLContext.STREAM_DRAW=0x88E0;\r\n\t\tWebGLContext.STATIC_DRAW=0x88E4;\r\n\t\tWebGLContext.DYNAMIC_DRAW=0x88E8;\r\n\t\tWebGLContext.BUFFER_SIZE=0x8764;\r\n\t\tWebGLContext.BUFFER_USAGE=0x8765;\r\n\t\tWebGLContext.CURRENT_VERTEX_ATTRIB=0x8626;\r\n\t\tWebGLContext.FRONT=0x0404;\r\n\t\tWebGLContext.BACK=0x0405;\r\n\t\tWebGLContext.CULL_FACE=0x0B44;\r\n\t\tWebGLContext.FRONT_AND_BACK=0x0408;\r\n\t\tWebGLContext.BLEND=0x0BE2;\r\n\t\tWebGLContext.DITHER=0x0BD0;\r\n\t\tWebGLContext.STENCIL_TEST=0x0B90;\r\n\t\tWebGLContext.DEPTH_TEST=0x0B71;\r\n\t\tWebGLContext.SCISSOR_TEST=0x0C11;\r\n\t\tWebGLContext.POLYGON_OFFSET_FILL=0x8037;\r\n\t\tWebGLContext.SAMPLE_ALPHA_TO_COVERAGE=0x809E;\r\n\t\tWebGLContext.SAMPLE_COVERAGE=0x80A0;\r\n\t\tWebGLContext.NO_ERROR=0;\r\n\t\tWebGLContext.INVALID_ENUM=0x0500;\r\n\t\tWebGLContext.INVALID_VALUE=0x0501;\r\n\t\tWebGLContext.INVALID_OPERATION=0x0502;\r\n\t\tWebGLContext.OUT_OF_MEMORY=0x0505;\r\n\t\tWebGLContext.CW=0x0900;\r\n\t\tWebGLContext.CCW=0x0901;\r\n\t\tWebGLContext.LINE_WIDTH=0x0B21;\r\n\t\tWebGLContext.ALIASED_POINT_SIZE_RANGE=0x846D;\r\n\t\tWebGLContext.ALIASED_LINE_WIDTH_RANGE=0x846E;\r\n\t\tWebGLContext.CULL_FACE_MODE=0x0B45;\r\n\t\tWebGLContext.FRONT_FACE=0x0B46;\r\n\t\tWebGLContext.DEPTH_RANGE=0x0B70;\r\n\t\tWebGLContext.DEPTH_WRITEMASK=0x0B72;\r\n\t\tWebGLContext.DEPTH_CLEAR_VALUE=0x0B73;\r\n\t\tWebGLContext.DEPTH_FUNC=0x0B74;\r\n\t\tWebGLContext.STENCIL_CLEAR_VALUE=0x0B91;\r\n\t\tWebGLContext.STENCIL_FUNC=0x0B92;\r\n\t\tWebGLContext.STENCIL_FAIL=0x0B94;\r\n\t\tWebGLContext.STENCIL_PASS_DEPTH_FAIL=0x0B95;\r\n\t\tWebGLContext.STENCIL_PASS_DEPTH_PASS=0x0B96;\r\n\t\tWebGLContext.STENCIL_REF=0x0B97;\r\n\t\tWebGLContext.STENCIL_VALUE_MASK=0x0B93;\r\n\t\tWebGLContext.STENCIL_WRITEMASK=0x0B98;\r\n\t\tWebGLContext.STENCIL_BACK_FUNC=0x8800;\r\n\t\tWebGLContext.STENCIL_BACK_FAIL=0x8801;\r\n\t\tWebGLContext.STENCIL_BACK_PASS_DEPTH_FAIL=0x8802;\r\n\t\tWebGLContext.STENCIL_BACK_PASS_DEPTH_PASS=0x8803;\r\n\t\tWebGLContext.STENCIL_BACK_REF=0x8CA3;\r\n\t\tWebGLContext.STENCIL_BACK_VALUE_MASK=0x8CA4;\r\n\t\tWebGLContext.STENCIL_BACK_WRITEMASK=0x8CA5;\r\n\t\tWebGLContext.VIEWPORT=0x0BA2;\r\n\t\tWebGLContext.SCISSOR_BOX=0x0C10;\r\n\t\tWebGLContext.COLOR_CLEAR_VALUE=0x0C22;\r\n\t\tWebGLContext.COLOR_WRITEMASK=0x0C23;\r\n\t\tWebGLContext.UNPACK_ALIGNMENT=0x0CF5;\r\n\t\tWebGLContext.PACK_ALIGNMENT=0x0D05;\r\n\t\tWebGLContext.MAX_TEXTURE_SIZE=0x0D33;\r\n\t\tWebGLContext.MAX_VIEWPORT_DIMS=0x0D3A;\r\n\t\tWebGLContext.SUBPIXEL_BITS=0x0D50;\r\n\t\tWebGLContext.RED_BITS=0x0D52;\r\n\t\tWebGLContext.GREEN_BITS=0x0D53;\r\n\t\tWebGLContext.BLUE_BITS=0x0D54;\r\n\t\tWebGLContext.ALPHA_BITS=0x0D55;\r\n\t\tWebGLContext.DEPTH_BITS=0x0D56;\r\n\t\tWebGLContext.STENCIL_BITS=0x0D57;\r\n\t\tWebGLContext.POLYGON_OFFSET_UNITS=0x2A00;\r\n\t\tWebGLContext.POLYGON_OFFSET_FACTOR=0x8038;\r\n\t\tWebGLContext.TEXTURE_BINDING_2D=0x8069;\r\n\t\tWebGLContext.SAMPLE_BUFFERS=0x80A8;\r\n\t\tWebGLContext.SAMPLES=0x80A9;\r\n\t\tWebGLContext.SAMPLE_COVERAGE_VALUE=0x80AA;\r\n\t\tWebGLContext.SAMPLE_COVERAGE_INVERT=0x80AB;\r\n\t\tWebGLContext.NUM_COMPRESSED_TEXTURE_FORMATS=0x86A2;\r\n\t\tWebGLContext.COMPRESSED_TEXTURE_FORMATS=0x86A3;\r\n\t\tWebGLContext.DONT_CARE=0x1100;\r\n\t\tWebGLContext.FASTEST=0x1101;\r\n\t\tWebGLContext.NICEST=0x1102;\r\n\t\tWebGLContext.GENERATE_MIPMAP_HINT=0x8192;\r\n\t\tWebGLContext.BYTE=0x1400;\r\n\t\tWebGLContext.UNSIGNED_BYTE=0x1401;\r\n\t\tWebGLContext.SHORT=0x1402;\r\n\t\tWebGLContext.UNSIGNED_SHORT=0x1403;\r\n\t\tWebGLContext.INT=0x1404;\r\n\t\tWebGLContext.UNSIGNED_INT=0x1405;\r\n\t\tWebGLContext.FLOAT=0x1406;\r\n\t\tWebGLContext.DEPTH_COMPONENT=0x1902;\r\n\t\tWebGLContext.ALPHA=0x1906;\r\n\t\tWebGLContext.RGB=0x1907;\r\n\t\tWebGLContext.RGBA=0x1908;\r\n\t\tWebGLContext.LUMINANCE=0x1909;\r\n\t\tWebGLContext.LUMINANCE_ALPHA=0x190A;\r\n\t\tWebGLContext.UNSIGNED_SHORT_4_4_4_4=0x8033;\r\n\t\tWebGLContext.UNSIGNED_SHORT_5_5_5_1=0x8034;\r\n\t\tWebGLContext.UNSIGNED_SHORT_5_6_5=0x8363;\r\n\t\tWebGLContext.FRAGMENT_SHADER=0x8B30;\r\n\t\tWebGLContext.VERTEX_SHADER=0x8B31;\r\n\t\tWebGLContext.MAX_VERTEX_ATTRIBS=0x8869;\r\n\t\tWebGLContext.MAX_VERTEX_UNIFORM_VECTORS=0x8DFB;\r\n\t\tWebGLContext.MAX_VARYING_VECTORS=0x8DFC;\r\n\t\tWebGLContext.MAX_COMBINED_TEXTURE_IMAGE_UNITS=0x8B4D;\r\n\t\tWebGLContext.MAX_VERTEX_TEXTURE_IMAGE_UNITS=0x8B4C;\r\n\t\tWebGLContext.MAX_TEXTURE_IMAGE_UNITS=0x8872;\r\n\t\tWebGLContext.MAX_FRAGMENT_UNIFORM_VECTORS=0x8DFD;\r\n\t\tWebGLContext.SHADER_TYPE=0x8B4F;\r\n\t\tWebGLContext.DELETE_STATUS=0x8B80;\r\n\t\tWebGLContext.LINK_STATUS=0x8B82;\r\n\t\tWebGLContext.VALIDATE_STATUS=0x8B83;\r\n\t\tWebGLContext.ATTACHED_SHADERS=0x8B85;\r\n\t\tWebGLContext.ACTIVE_UNIFORMS=0x8B86;\r\n\t\tWebGLContext.ACTIVE_ATTRIBUTES=0x8B89;\r\n\t\tWebGLContext.SHADING_LANGUAGE_VERSION=0x8B8C;\r\n\t\tWebGLContext.CURRENT_PROGRAM=0x8B8D;\r\n\t\tWebGLContext.NEVER=0x0200;\r\n\t\tWebGLContext.LESS=0x0201;\r\n\t\tWebGLContext.EQUAL=0x0202;\r\n\t\tWebGLContext.LEQUAL=0x0203;\r\n\t\tWebGLContext.GREATER=0x0204;\r\n\t\tWebGLContext.NOTEQUAL=0x0205;\r\n\t\tWebGLContext.GEQUAL=0x0206;\r\n\t\tWebGLContext.ALWAYS=0x0207;\r\n\t\tWebGLContext.KEEP=0x1E00;\r\n\t\tWebGLContext.REPLACE=0x1E01;\r\n\t\tWebGLContext.INCR=0x1E02;\r\n\t\tWebGLContext.DECR=0x1E03;\r\n\t\tWebGLContext.INVERT=0x150A;\r\n\t\tWebGLContext.INCR_WRAP=0x8507;\r\n\t\tWebGLContext.DECR_WRAP=0x8508;\r\n\t\tWebGLContext.VENDOR=0x1F00;\r\n\t\tWebGLContext.RENDERER=0x1F01;\r\n\t\tWebGLContext.VERSION=0x1F02;\r\n\t\tWebGLContext.NEAREST=0x2600;\r\n\t\tWebGLContext.LINEAR=0x2601;\r\n\t\tWebGLContext.NEAREST_MIPMAP_NEAREST=0x2700;\r\n\t\tWebGLContext.LINEAR_MIPMAP_NEAREST=0x2701;\r\n\t\tWebGLContext.NEAREST_MIPMAP_LINEAR=0x2702;\r\n\t\tWebGLContext.LINEAR_MIPMAP_LINEAR=0x2703;\r\n\t\tWebGLContext.TEXTURE_MAG_FILTER=0x2800;\r\n\t\tWebGLContext.TEXTURE_MIN_FILTER=0x2801;\r\n\t\tWebGLContext.TEXTURE_WRAP_S=0x2802;\r\n\t\tWebGLContext.TEXTURE_WRAP_T=0x2803;\r\n\t\tWebGLContext.TEXTURE_2D=0x0DE1;\r\n\t\tWebGLContext.TEXTURE=0x1702;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP=0x8513;\r\n\t\tWebGLContext.TEXTURE_BINDING_CUBE_MAP=0x8514;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_POSITIVE_X=0x8515;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_X=0x8516;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_POSITIVE_Y=0x8517;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_Y=0x8518;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_POSITIVE_Z=0x8519;\r\n\t\tWebGLContext.TEXTURE_CUBE_MAP_NEGATIVE_Z=0x851A;\r\n\t\tWebGLContext.MAX_CUBE_MAP_TEXTURE_SIZE=0x851C;\r\n\t\tWebGLContext.TEXTURE0=0x84C0;\r\n\t\tWebGLContext.TEXTURE1=0x84C1;\r\n\t\tWebGLContext.TEXTURE2=0x84C2;\r\n\t\tWebGLContext.TEXTURE3=0x84C3;\r\n\t\tWebGLContext.TEXTURE4=0x84C4;\r\n\t\tWebGLContext.TEXTURE5=0x84C5;\r\n\t\tWebGLContext.TEXTURE6=0x84C6;\r\n\t\tWebGLContext.TEXTURE7=0x84C7;\r\n\t\tWebGLContext.TEXTURE8=0x84C8;\r\n\t\tWebGLContext.TEXTURE9=0x84C9;\r\n\t\tWebGLContext.TEXTURE10=0x84CA;\r\n\t\tWebGLContext.TEXTURE11=0x84CB;\r\n\t\tWebGLContext.TEXTURE12=0x84CC;\r\n\t\tWebGLContext.TEXTURE13=0x84CD;\r\n\t\tWebGLContext.TEXTURE14=0x84CE;\r\n\t\tWebGLContext.TEXTURE15=0x84CF;\r\n\t\tWebGLContext.TEXTURE16=0x84D0;\r\n\t\tWebGLContext.TEXTURE17=0x84D1;\r\n\t\tWebGLContext.TEXTURE18=0x84D2;\r\n\t\tWebGLContext.TEXTURE19=0x84D3;\r\n\t\tWebGLContext.TEXTURE20=0x84D4;\r\n\t\tWebGLContext.TEXTURE21=0x84D5;\r\n\t\tWebGLContext.TEXTURE22=0x84D6;\r\n\t\tWebGLContext.TEXTURE23=0x84D7;\r\n\t\tWebGLContext.TEXTURE24=0x84D8;\r\n\t\tWebGLContext.TEXTURE25=0x84D9;\r\n\t\tWebGLContext.TEXTURE26=0x84DA;\r\n\t\tWebGLContext.TEXTURE27=0x84DB;\r\n\t\tWebGLContext.TEXTURE28=0x84DC;\r\n\t\tWebGLContext.TEXTURE29=0x84DD;\r\n\t\tWebGLContext.TEXTURE30=0x84DE;\r\n\t\tWebGLContext.TEXTURE31=0x84DF;\r\n\t\tWebGLContext.ACTIVE_TEXTURE=0x84E0;\r\n\t\tWebGLContext.REPEAT=0x2901;\r\n\t\tWebGLContext.CLAMP_TO_EDGE=0x812F;\r\n\t\tWebGLContext.MIRRORED_REPEAT=0x8370;\r\n\t\tWebGLContext.FLOAT_VEC2=0x8B50;\r\n\t\tWebGLContext.FLOAT_VEC3=0x8B51;\r\n\t\tWebGLContext.FLOAT_VEC4=0x8B52;\r\n\t\tWebGLContext.INT_VEC2=0x8B53;\r\n\t\tWebGLContext.INT_VEC3=0x8B54;\r\n\t\tWebGLContext.INT_VEC4=0x8B55;\r\n\t\tWebGLContext.BOOL=0x8B56;\r\n\t\tWebGLContext.BOOL_VEC2=0x8B57;\r\n\t\tWebGLContext.BOOL_VEC3=0x8B58;\r\n\t\tWebGLContext.BOOL_VEC4=0x8B59;\r\n\t\tWebGLContext.FLOAT_MAT2=0x8B5A;\r\n\t\tWebGLContext.FLOAT_MAT3=0x8B5B;\r\n\t\tWebGLContext.FLOAT_MAT4=0x8B5C;\r\n\t\tWebGLContext.SAMPLER_2D=0x8B5E;\r\n\t\tWebGLContext.SAMPLER_CUBE=0x8B60;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_ENABLED=0x8622;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_SIZE=0x8623;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_STRIDE=0x8624;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_TYPE=0x8625;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_NORMALIZED=0x886A;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_POINTER=0x8645;\r\n\t\tWebGLContext.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=0x889F;\r\n\t\tWebGLContext.COMPILE_STATUS=0x8B81;\r\n\t\tWebGLContext.LOW_FLOAT=0x8DF0;\r\n\t\tWebGLContext.MEDIUM_FLOAT=0x8DF1;\r\n\t\tWebGLContext.HIGH_FLOAT=0x8DF2;\r\n\t\tWebGLContext.LOW_INT=0x8DF3;\r\n\t\tWebGLContext.MEDIUM_INT=0x8DF4;\r\n\t\tWebGLContext.HIGH_INT=0x8DF5;\r\n\t\tWebGLContext.FRAMEBUFFER=0x8D40;\r\n\t\tWebGLContext.RENDERBUFFER=0x8D41;\r\n\t\tWebGLContext.RGBA4=0x8056;\r\n\t\tWebGLContext.RGB5_A1=0x8057;\r\n\t\tWebGLContext.RGB565=0x8D62;\r\n\t\tWebGLContext.DEPTH_COMPONENT16=0x81A5;\r\n\t\tWebGLContext.STENCIL_INDEX=0x1901;\r\n\t\tWebGLContext.STENCIL_INDEX8=0x8D48;\r\n\t\tWebGLContext.DEPTH_STENCIL=0x84F9;\r\n\t\tWebGLContext.RENDERBUFFER_WIDTH=0x8D42;\r\n\t\tWebGLContext.RENDERBUFFER_HEIGHT=0x8D43;\r\n\t\tWebGLContext.RENDERBUFFER_INTERNAL_FORMAT=0x8D44;\r\n\t\tWebGLContext.RENDERBUFFER_RED_SIZE=0x8D50;\r\n\t\tWebGLContext.RENDERBUFFER_GREEN_SIZE=0x8D51;\r\n\t\tWebGLContext.RENDERBUFFER_BLUE_SIZE=0x8D52;\r\n\t\tWebGLContext.RENDERBUFFER_ALPHA_SIZE=0x8D53;\r\n\t\tWebGLContext.RENDERBUFFER_DEPTH_SIZE=0x8D54;\r\n\t\tWebGLContext.RENDERBUFFER_STENCIL_SIZE=0x8D55;\r\n\t\tWebGLContext.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=0x8CD0;\r\n\t\tWebGLContext.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=0x8CD1;\r\n\t\tWebGLContext.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=0x8CD2;\r\n\t\tWebGLContext.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=0x8CD3;\r\n\t\tWebGLContext.COLOR_ATTACHMENT0=0x8CE0;\r\n\t\tWebGLContext.DEPTH_ATTACHMENT=0x8D00;\r\n\t\tWebGLContext.STENCIL_ATTACHMENT=0x8D20;\r\n\t\tWebGLContext.DEPTH_STENCIL_ATTACHMENT=0x821A;\r\n\t\tWebGLContext.NONE=0;\r\n\t\tWebGLContext.FRAMEBUFFER_COMPLETE=0x8CD5;\r\n\t\tWebGLContext.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=0x8CD6;\r\n\t\tWebGLContext.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=0x8CD7;\r\n\t\tWebGLContext.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=0x8CD9;\r\n\t\tWebGLContext.FRAMEBUFFER_UNSUPPORTED=0x8CDD;\r\n\t\tWebGLContext.FRAMEBUFFER_BINDING=0x8CA6;\r\n\t\tWebGLContext.RENDERBUFFER_BINDING=0x8CA7;\r\n\t\tWebGLContext.MAX_RENDERBUFFER_SIZE=0x84E8;\r\n\t\tWebGLContext.INVALID_FRAMEBUFFER_OPERATION=0x0506;\r\n\t\tWebGLContext.UNPACK_FLIP_Y_WEBGL=0x9240;\r\n\t\tWebGLContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL=0x9241;\r\n\t\tWebGLContext.CONTEXT_LOST_WEBGL=0x9242;\r\n\t\tWebGLContext.UNPACK_COLORSPACE_CONVERSION_WEBGL=0x9243;\r\n\t\tWebGLContext.BROWSER_DEFAULT_WEBGL=0x9244;\r\n\t\tWebGLContext._useProgram=null;\r\n\t\tWebGLContext._depthTest=true;\r\n\t\tWebGLContext._depthMask=true;\r\n\t\tWebGLContext._blend=false;\r\n\t\tWebGLContext._cullFace=false;\r\n\t\tWebGLContext.curBindTexTarget=null\r\n\t\tWebGLContext.curBindTexValue=null\r\n\t\t__static(WebGLContext,\r\n\t\t['_depthFunc',function(){return this._depthFunc=/*CLASS CONST:laya.webgl.WebGLContext.LESS*/0x0201;},'_sFactor',function(){return this._sFactor=/*CLASS CONST:laya.webgl.WebGLContext.ONE*/1;},'_dFactor',function(){return this._dFactor=/*CLASS CONST:laya.webgl.WebGLContext.ZERO*/0;},'_frontFace',function(){return this._frontFace=/*CLASS CONST:laya.webgl.WebGLContext.CCW*/0x0901;}\r\n\t\t]);\r\n\t\treturn WebGLContext;\r\n\t})()\r\n\r\n\r\n\t//class laya.webgl.display.GraphicsGL extends laya.display.Graphics\r\n\tvar GraphicsGL=(function(_super){\r\n\t\tfunction GraphicsGL(){\r\n\t\t\tGraphicsGL.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(GraphicsGL,'laya.webgl.display.GraphicsGL',_super);\r\n\t\tvar __proto=GraphicsGL.prototype;\r\n\t\t__proto.setShader=function(shader){\r\n\t\t\tthis._saveToCmd(Render.context._setShader,[shader]);\r\n\t\t}\r\n\r\n\t\t__proto.setIBVB=function(x,y,ib,vb,numElement,shader){\r\n\t\t\tthis._saveToCmd(Render.context._setIBVB,[x,y,ib,vb,numElement,shader]);\r\n\t\t}\r\n\r\n\t\t__proto.drawParticle=function(x,y,ps){\r\n\t\t\tvar pt=RunDriver.createParticleTemplate2D(ps);\r\n\t\t\tpt.x=x;\r\n\t\t\tpt.y=y;\r\n\t\t\tthis._saveToCmd(Render.context._drawParticle,[pt]);\r\n\t\t}\r\n\r\n\t\treturn GraphicsGL;\r\n\t})(Graphics)\r\n\r\n\r\n\t//class laya.webgl.canvas.WebGLContext2D extends laya.resource.Context\r\n\tvar WebGLContext2D=(function(_super){\r\n\t\tvar ContextParams;\r\n\t\tfunction WebGLContext2D(c){\r\n\t\t\tthis._x=0;\r\n\t\t\tthis._y=0;\r\n\t\t\tthis._id=++WebGLContext2D._COUNT;\r\n\t\t\t//this._other=null;\r\n\t\t\tthis._path=null;\r\n\t\t\t//this._primitiveValue2D=null;\r\n\t\t\tthis._drawCount=1;\r\n\t\t\tthis._maxNumEle=0;\r\n\t\t\tthis._clear=false;\r\n\t\t\tthis._isMain=false;\r\n\t\t\tthis._atlasResourceChange=0;\r\n\t\t\tthis._submits=[];\r\n\t\t\tthis._curSubmit=null;\r\n\t\t\tthis._ib=null;\r\n\t\t\tthis._vb=null;\r\n\t\t\t//this._curMat=null;\r\n\t\t\tthis._nBlendType=0;\r\n\t\t\t//this._save=null;\r\n\t\t\t//this._targets=null;\r\n\t\t\t//this._renderKey=NaN;\r\n\t\t\tthis._saveMark=null;\r\n\t\t\t//this.sprite=null;\r\n\t\t\tthis.mId=-1;\r\n\t\t\tthis.mHaveKey=false;\r\n\t\t\tthis.mHaveLineKey=false;\r\n\t\t\tthis.mX=0;\r\n\t\t\tthis.mY=0;\r\n\t\t\tWebGLContext2D.__super.call(this);\r\n\t\t\tthis._width=99999999;\r\n\t\t\tthis._height=99999999;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tthis._shader2D=new Shader2D();\r\n\t\t\tthis.mOutPoint\r\n\t\t\tthis._canvas=c;\r\n\t\t\tthis._curMat=Matrix.create();\r\n\t\t\tif (Render.isFlash){\r\n\t\t\t\tthis._ib=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\t\tGlUtils.fillIBQuadrangle(this._ib,16);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tthis._ib=IndexBuffer2D.QuadrangleIB;\r\n\t\t\tthis._vb=VertexBuffer2D.create(-1);\r\n\t\t\tthis._other=ContextParams.DEFAULT;\r\n\t\t\tthis._save=[SaveMark.Create(this)];\r\n\t\t\tthis._save.length=10;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__class(WebGLContext2D,'laya.webgl.canvas.WebGLContext2D',_super);\r\n\t\tvar __proto=WebGLContext2D.prototype;\r\n\t\t__proto.setIsMainContext=function(){\r\n\t\t\tthis._isMain=true;\r\n\t\t}\r\n\r\n\t\t__proto.clearBG=function(r,g,b,a){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.clearColor(r,g,b,a);\r\n\t\t\tgl.clear(/*laya.webgl.WebGLContext.COLOR_BUFFER_BIT*/0x00004000 | /*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100);\r\n\t\t}\r\n\r\n\t\t__proto._getSubmits=function(){\r\n\t\t\treturn this._submits;\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._curMat && this._curMat.destroy();\r\n\t\t\tthis._targets && this._targets.destroy();\r\n\t\t\tthis._vb && this._vb.releaseResource();\r\n\t\t\tthis._ib && (this._ib !=IndexBuffer2D.QuadrangleIB)&& this._ib.releaseResource();\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._vb.clear();\r\n\t\t\tthis._targets && (this._targets.repaint=true);\r\n\t\t\tthis._other=ContextParams.DEFAULT;\r\n\t\t\tthis._clear=true;\r\n\t\t\tthis._repaint=false;\r\n\t\t\tthis._drawCount=1;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._other.lineWidth=this._shader2D.ALPHA=1.0;\r\n\t\t\tthis._nBlendType=0;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tthis._shader2D.fillStyle=this._shader2D.strokeStyle=DrawStyle.DEFAULT;\r\n\t\t\tfor (var i=0,n=this._submits._length;i < n;i++)\r\n\t\t\tthis._submits[i].releaseRender();\r\n\t\t\tthis._submits._length=0;\r\n\t\t\tthis._curMat.identity();\r\n\t\t\tthis._other.clear();\r\n\t\t\tthis._saveMark=this._save[0];\r\n\t\t\tthis._save._length=1;\r\n\t\t}\r\n\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tthis._width=w;\r\n\t\t\tthis._height=h;\r\n\t\t\tthis._targets && (this._targets.size(w,h));\r\n\t\t\tthis._canvas.memorySize-=this._canvas.memorySize;\r\n\t\t}\r\n\r\n\t\t__proto._getTransformMatrix=function(){\r\n\t\t\treturn this._curMat;\r\n\t\t}\r\n\r\n\t\t__proto.translate=function(x,y){\r\n\t\t\tif (x!==0 || y!==0){\r\n\t\t\t\tSaveTranslate.save(this);\r\n\t\t\t\tif (this._curMat.bTransform){\r\n\t\t\t\t\tSaveTransform.save(this);\r\n\t\t\t\t\tthis._curMat.transformPoint(Point.TEMP.setTo(x,y));\r\n\t\t\t\t\tx=Point.TEMP.x;\r\n\t\t\t\t\ty=Point.TEMP.y;\r\n\t\t\t\t}\r\n\t\t\t\tthis._x+=x;\r\n\t\t\t\tthis._y+=y;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.save=function(){\r\n\t\t\tthis._save[this._save._length++]=SaveMark.Create(this);\r\n\t\t}\r\n\r\n\t\t__proto.restore=function(){\r\n\t\t\tvar sz=this._save._length;\r\n\t\t\tif (sz < 1)\r\n\t\t\t\treturn;\r\n\t\t\tfor (var i=sz-1;i >=0;i--){\r\n\t\t\t\tvar o=this._save[i];\r\n\t\t\t\to.restore(this);\r\n\t\t\t\tif (o.isSaveMark()){\r\n\t\t\t\t\tthis._save._length=i;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.measureText=function(text){\r\n\t\t\treturn RunDriver.measureText(text,this._other.font.toString());\r\n\t\t}\r\n\r\n\t\t__proto._fillText=function(txt,words,x,y,fontStr,color,strokeColor,lineWidth,textAlign){\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tvar font=fontStr ? FontInContext.create(fontStr):this._other.font;\r\n\t\t\tif (AtlasResourceManager.enabled){\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA)\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\tDrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,strokeColor,lineWidth,x,y);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tvar preDef=this._shader2D.defines.getValue();\r\n\t\t\t\tvar colorAdd=color ? Color.create(color)._color :shader.colorAdd;\r\n\t\t\t\tif (shader.ALPHA!==curShader.ALPHA || colorAdd!==shader.colorAdd || curShader.colorAdd!==shader.colorAdd){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tshader.colorAdd=colorAdd;\r\n\t\t\t\t}\r\n\t\t\t\tDrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,color,strokeColor,lineWidth,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//shader.defines.setValue(preDef);\r\n\t\t__proto.fillWords=function(words,x,y,fontStr,color){\r\n\t\t\twords.length > 0 && this._fillText(null,words,x,y,fontStr,color,null,-1,null);\r\n\t\t}\r\n\r\n\t\t__proto.fillText=function(txt,x,y,fontStr,color,textAlign){\r\n\t\t\ttxt.length > 0 && this._fillText(txt,null,x,y,fontStr,color,null,-1,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto.strokeText=function(txt,x,y,fontStr,color,lineWidth,textAlign){\r\n\t\t\tif (txt.length===0)\r\n\t\t\t\treturn;\r\n\t\t\tthis._fillText(txt,null,x,y,fontStr,null,color,lineWidth || 1,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto.fillBorderText=function(txt,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign){\r\n\t\t\tif (txt.length===0)\r\n\t\t\t\treturn;\r\n\t\t\tthis._fillBorderText(txt,null,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign);\r\n\t\t}\r\n\r\n\t\t__proto._fillBorderText=function(txt,words,x,y,fontStr,fillColor,borderColor,lineWidth,textAlign){\r\n\t\t\tif (!AtlasResourceManager.enabled){\r\n\t\t\t\tthis._fillText(txt,words,x,y,fontStr,null,borderColor,lineWidth || 1,textAlign);\r\n\t\t\t\tthis._fillText(txt,words,x,y,fontStr,fillColor,null,-1,textAlign);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tif (shader.ALPHA!==curShader.ALPHA)\r\n\t\t\t\tshader.glTexture=null;\r\n\t\t\tvar font=fontStr ? (WebGLContext2D._fontTemp.setFont(fontStr),WebGLContext2D._fontTemp):this._other.font;\r\n\t\t\tDrawText.drawText(this,txt,words,this._curMat,font,textAlign || this._other.textAlign,fillColor,borderColor,lineWidth || 1,x,y);\r\n\t\t}\r\n\r\n\t\t__proto.fillBorderWords=function(words,x,y,font,color,borderColor,lineWidth){\r\n\t\t\tif (!words||words.length===0)\r\n\t\t\t\treturn;\r\n\t\t\tthis._fillBorderText(null,words,x,y,font,color,borderColor,lineWidth,null);\r\n\t\t}\r\n\r\n\t\t__proto.fillRect=function(x,y,width,height,fillStyle){\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,Texture.DEF_UV,this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar pre=this._shader2D.fillStyle;\r\n\t\t\t\tfillStyle && (this._shader2D.fillStyle=DrawStyle.create(fillStyle));\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tif (shader.fillStyle!==curShader.fillStyle || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tvar submit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.color=shader.fillStyle._color._color;\r\n\t\t\t\t\tsubmit.shaderValue.ALPHA=shader.ALPHA;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._shader2D.fillStyle=pre;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.fillTexture=function(texture,x,y,width,height,type,offset,other){\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar w=texture.bitmap.width,h=texture.bitmap.height,uv=texture.uv;\r\n\t\t\tvar ox=offset.x % texture.width,oy=offset.y % texture.height;\r\n\t\t\tif (w!=other.w||h!=other.h){\r\n\t\t\t\tif (!other.w && !other.h){\r\n\t\t\t\t\tother.oy=other.ox=0;\r\n\t\t\t\t\tswitch(type){\r\n\t\t\t\t\t\tcase \"repeat\":\r\n\t\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tcase \"repeat-x\":\r\n\t\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\t\tif (oy < 0){\r\n\t\t\t\t\t\t\t\tif (texture.height+oy > height){\r\n\t\t\t\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tother.height=texture.height+oy;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tother.oy=oy;\r\n\t\t\t\t\t\t\t\tif (texture.height+oy > height){\r\n\t\t\t\t\t\t\t\t\tother.height=height-oy;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tother.height=texture.height;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tcase \"repeat-y\":\r\n\t\t\t\t\t\t\tif (ox < 0){\r\n\t\t\t\t\t\t\t\tif (texture.width+ox > width){\r\n\t\t\t\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tother.width=texture.width+ox;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\tother.ox=ox;\r\n\t\t\t\t\t\t\t\tif (texture.width+ox > width){\r\n\t\t\t\t\t\t\t\t\tother.width=width-ox;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\tother.width=texture.width;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\tdefault :\r\n\t\t\t\t\t\t\tother.width=width;\r\n\t\t\t\t\t\t\tother.height=height;\r\n\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tother.w=w;\r\n\t\t\t\tother.h=h;\r\n\t\t\t\tother.uv=[0,0,other.width / w,0,other.width / w,other.height / h,0,other.height / h];\r\n\t\t\t}\r\n\t\t\tx+=other.ox;\r\n\t\t\ty+=other.oy;\r\n\t\t\tox-=other.ox;\r\n\t\t\toy-=other.oy;\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,other.width,other.height,other.uv,this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar submit=SubmitTexture.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,0));\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tvar shaderValue=submit.shaderValue;\r\n\t\t\t\tshaderValue.textureHost=texture;\r\n\t\t\t\tvar tTextureX=uv[0] *w;\r\n\t\t\t\tvar tTextureY=uv[1] *h;\r\n\t\t\t\tvar tTextureW=(uv[2]-uv[0])*w;\r\n\t\t\t\tvar tTextureH=(uv[5]-uv[3])*h;\r\n\t\t\t\tvar tx=-ox / w;\r\n\t\t\t\tvar ty=-oy/ h;\r\n\t\t\t\tshaderValue.u_TexRange[0]=tTextureX / w;\r\n\t\t\t\tshaderValue.u_TexRange[1]=tTextureW / w;\r\n\t\t\t\tshaderValue.u_TexRange[2]=tTextureY / h;\r\n\t\t\t\tshaderValue.u_TexRange[3]=tTextureH / h;\r\n\t\t\t\tshaderValue.u_offset[0]=tx;\r\n\t\t\t\tshaderValue.u_offset[1]=ty;\r\n\t\t\t\tif (AtlasResourceManager.enabled && !this._isMain)\r\n\t\t\t\t\tsubmit.addTexture(texture,(vb._byteLength >> 2)-/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\t\tthis._curSubmit=submit;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_FILLTEXTURE*/10017;\r\n\t\t\t\tsubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.setShader=function(shader){\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_SHADER*/0x80000,this._shader2D,true);\r\n\t\t\tthis._shader2D.shader=shader;\r\n\t\t}\r\n\r\n\t\t__proto.setFilters=function(value){\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FILTERS*/0x100000,this._shader2D,true);\r\n\t\t\tthis._shader2D.filters=value;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._drawCount++;\r\n\t\t}\r\n\r\n\t\t__proto.drawTexture=function(tex,x,y,width,height,tx,ty){\r\n\t\t\tthis._drawTextureM(tex,x,y,width,height,tx,ty,null,1);\r\n\t\t}\r\n\r\n\t\t__proto.addTextureVb=function(invb,x,y){\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar vpos=(finalVB._byteLength >> 2);\r\n\t\t\tfinalVB.byteLength=((vpos+/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16)<< 2);\r\n\t\t\tvar vbdata=finalVB.getFloat32Array();\r\n\t\t\tfor (var i=0,ci=0;i < 16;i+=4){\r\n\t\t\t\tvbdata[vpos++]=invb[i]+x;\r\n\t\t\t\tvbdata[vpos++]=invb[i+1]+y;\r\n\t\t\t\tvbdata[vpos++]=invb[i+2];\r\n\t\t\t\tvbdata[vpos++]=invb[i+3];\r\n\t\t\t}\r\n\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\tfinalVB._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.willDrawTexture=function(tex,alpha){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tif (this.sprite){\r\n\t\t\t\t\tLaya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t};\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA*alpha+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid==this._renderKey)return rid;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar preAlpha=shader.ALPHA;\r\n\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\tshader.ALPHA *=alpha;\r\n\t\t\tthis._renderKey=rid;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tshader.glTexture=webGLImg;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar submit=null;\r\n\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\tthis._curSubmit=submit;\r\n\t\t\tshader.ALPHA=preAlpha;\r\n\t\t\treturn rid;\r\n\t\t}\r\n\r\n\t\t__proto.drawTextures=function(tex,pos,tx,ty){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tthis.sprite && Laya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar pre=this._clipRect;\r\n\t\t\tthis._clipRect=WebGLContext2D.MAXCLIPRECT;\r\n\t\t\tif (!this._drawTextureM(tex,pos[0],pos[1],tex.width,tex.height,tx,ty,null,1)){\r\n\t\t\t\talert(\"drawTextures err\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._clipRect=pre;\r\n\t\t\tStat.drawCall+=pos.length / 2;\r\n\t\t\tif (pos.length < 4)\r\n\t\t\t\treturn;\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar sx=this._curMat.a,sy=this._curMat.d;\r\n\t\t\tfor (var i=2,sz=pos.length;i < sz;i+=2){\r\n\t\t\t\tGlUtils.copyPreImgVb(finalVB,(pos[i]-pos[i-2])*sx,(pos[i+1]-pos[i-1])*sy);\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t}\r\n\r\n\t\t__proto._drawTextureM=function(tex,x,y,width,height,tx,ty,m,alpha){\r\n\t\t\tif (!(tex.loaded && tex.bitmap && tex.source)){\r\n\t\t\t\tif (this.sprite){\r\n\t\t\t\t\tLaya.timer.callLater(this,this._repaintSprite);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tx+=tx;\r\n\t\t\ty+=ty;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA *alpha+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid!=this._renderKey){\r\n\t\t\t\tthis._renderKey=rid;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar alphaBack=shader.ALPHA;\r\n\t\t\t\tshader.ALPHA *=alpha;\r\n\t\t\t\tshader.glTexture=webGLImg;\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar submit=null;\r\n\t\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\t\tthis._curSubmit=submit;\r\n\t\t\t\tfinalVB=this._curSubmit._vb || this._vb;\r\n\t\t\t\tshader.ALPHA=alphaBack;\r\n\t\t\t}\r\n\t\t\tif (GlUtils.fillRectImgVb(finalVB,this._clipRect,x,y,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tif (AtlasResourceManager.enabled && !this._isMain)\r\n\t\t\t\t\t(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t__proto._repaintSprite=function(){\r\n\t\t\tthis.sprite.repaint();\r\n\t\t}\r\n\r\n\t\t//}\r\n\t\t__proto._drawText=function(tex,x,y,width,height,m,tx,ty,dx,dy){\r\n\t\t\tvar webGLImg=tex.bitmap;\r\n\t\t\tthis._drawCount++;\r\n\t\t\tvar rid=webGLImg.id+this._shader2D.ALPHA+/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\tif (rid!=this._renderKey){\r\n\t\t\t\tthis._renderKey=rid;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tshader.glTexture=webGLImg;\r\n\t\t\t\tvar vb=this._vb;\r\n\t\t\t\tvar submit=null;\r\n\t\t\t\tvar submitID=NaN;\r\n\t\t\t\tvar vbSize=(vb._byteLength / 32)*3;\r\n\t\t\t\tif (AtlasResourceManager.enabled){\r\n\t\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tsubmit=SubmitTexture.create(this,this._ib,vb,vbSize,TextSV.create());\r\n\t\t\t\t}\r\n\t\t\t\tsubmit._preIsSameTextureShader=this._curSubmit._renderType===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016 && shader.ALPHA===curShader.ALPHA;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tsubmit._renderType=/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016;\r\n\t\t\t\tthis._curSubmit=submit;\r\n\t\t\t}\r\n\t\t\ttex.active();\r\n\t\t\tvar finalVB=this._curSubmit._vb || this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(finalVB,this._clipRect,x+tx,y+ty,width || tex.width,height || tex.height,tex.uv,m || this._curMat,this._x,this._y,dx,dy,true)){\r\n\t\t\t\tif (AtlasResourceManager.enabled && !this._isMain){\r\n\t\t\t\t\t(this._curSubmit).addTexture(tex,(finalVB._byteLength >> 2)-/*CLASS CONST:laya.webgl.canvas.WebGLContext2D._RECTVBSIZE*/16);\r\n\t\t\t\t}\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t\tthis._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTextureWithTransform=function(tex,x,y,width,height,transform,tx,ty,alpha){\r\n\t\t\tvar curMat=this._curMat;\r\n\t\t\t(tx!==0 || ty!==0)&& (this._x=tx *curMat.a+ty *curMat.c,this._y=ty *curMat.d+tx *curMat.b);\r\n\t\t\tif (transform && curMat.bTransform){\r\n\t\t\t\tMatrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);\r\n\t\t\t\ttransform=WebGLContext2D._tmpMatrix;\r\n\t\t\t\ttransform._checkTransform();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis._x+=curMat.tx;\r\n\t\t\t\tthis._y+=curMat.ty;\r\n\t\t\t}\r\n\t\t\tthis._drawTextureM(tex,x,y,width,height,0,0,transform,alpha);\r\n\t\t\tthis._x=this._y=0;\r\n\t\t}\r\n\r\n\t\t__proto.fillQuadrangle=function(tex,x,y,point4,m){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (tex.bitmap){\r\n\t\t\t\tvar t_tex=tex.bitmap;\r\n\t\t\t\tif (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=t_tex;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\t\tsubmit.shaderValue.glTexture=t_tex;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.fillQuadrangleImgVb(vb,x,y,point4,tex.uv,m || this._curMat,this._x,this._y);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (!submit.shaderValue.fillStyle || !submit.shaderValue.fillStyle.equal(tex)|| shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02);\r\n\t\t\t\t\tsubmit.shaderValue.fillStyle=DrawStyle.create(tex);\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.fillQuadrangleImgVb(vb,x,y,point4,Texture.DEF_UV,m || this._curMat,this._x,this._y);\r\n\t\t\t}\r\n\t\t\tsubmit._numEle+=6;\r\n\t\t}\r\n\r\n\t\t__proto.drawTexture2=function(x,y,pivotX,pivotY,transform,alpha,blendMode,args){\r\n\t\t\tvar curMat=this._curMat;\r\n\t\t\tthis._x=x *curMat.a+y *curMat.c;\r\n\t\t\tthis._y=y *curMat.d+x *curMat.b;\r\n\t\t\tif (transform){\r\n\t\t\t\tif (curMat.bTransform || transform.bTransform){\r\n\t\t\t\t\tMatrix.mul(transform,curMat,WebGLContext2D._tmpMatrix);\r\n\t\t\t\t\ttransform=WebGLContext2D._tmpMatrix;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tthis._x+=transform.tx+curMat.tx;\r\n\t\t\t\t\tthis._y+=transform.ty+curMat.ty;\r\n\t\t\t\t\ttransform=Matrix.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (alpha===1 && !blendMode)\r\n\t\t\t\tthis._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);\r\n\t\t\telse{\r\n\t\t\t\tvar preAlpha=this._shader2D.ALPHA;\r\n\t\t\t\tvar preblendType=this._nBlendType;\r\n\t\t\t\tthis._shader2D.ALPHA=alpha;\r\n\t\t\t\tblendMode && (this._nBlendType=BlendMode.TOINT(blendMode));\r\n\t\t\t\tthis._drawTextureM(args[0],args[1]-pivotX,args[2]-pivotY,args[3],args[4],0,0,transform,1);\r\n\t\t\t\tthis._shader2D.ALPHA=preAlpha;\r\n\t\t\t\tthis._nBlendType=preblendType;\r\n\t\t\t}\r\n\t\t\tthis._x=this._y=0;\r\n\t\t}\r\n\r\n\t\t__proto.drawCanvas=function(canvas,x,y,width,height){\r\n\t\t\tvar src=canvas.context;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (src._targets){\r\n\t\t\t\tthis._submits[this._submits._length++]=SubmitCanvas.create(src,0,null);\r\n\t\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\t\tsrc._targets.drawTo(this,x,y,width,height);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tvar submit=this._submits[this._submits._length++]=SubmitCanvas.create(src,this._shader2D.ALPHA,this._shader2D.filters);\r\n\t\t\t\tvar sx=width / canvas.width;\r\n\t\t\t\tvar sy=height / canvas.height;\r\n\t\t\t\tvar mat=submit._matrix;\r\n\t\t\t\tthis._curMat.copyTo(mat);\r\n\t\t\t\tsx !=1 && sy !=1 && mat.scale(sx,sy);\r\n\t\t\t\tvar tx=mat.tx,ty=mat.ty;\r\n\t\t\t\tmat.tx=mat.ty=0;\r\n\t\t\t\tmat.transformPoint(Point.TEMP.setTo(x,y));\r\n\t\t\t\tmat.translate(Point.TEMP.x+tx,Point.TEMP.y+ty);\r\n\t\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\t}\r\n\t\t\tif (Config.showCanvasMark){\r\n\t\t\t\tthis.save();\r\n\t\t\t\tthis.lineWidth=4;\r\n\t\t\t\tthis.strokeStyle=src._targets ? \"yellow\" :\"green\";\r\n\t\t\t\tthis.strokeRect(x-1,y-1,width+2,height+2,1);\r\n\t\t\t\tthis.strokeRect(x,y,width,height,1);\r\n\t\t\t\tthis.restore();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.drawTarget=function(scope,x,y,width,height,m,proName,shaderValue,uv,blend){\r\n\t\t\t(blend===void 0)&& (blend=-1);\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillRectImgVb(vb,this._clipRect,x,y,width,height,uv || Texture.DEF_UV,m || this._curMat,this._x,this._y,0,0)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tshader.glTexture=null;\r\n\t\t\t\tvar curShader=this._curSubmit.shaderValue;\r\n\t\t\t\tvar submit=this._curSubmit=SubmitTarget.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,shaderValue,proName);\r\n\t\t\t\tif (blend==-1){\r\n\t\t\t\t\tsubmit.blendType=this._nBlendType;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tsubmit.blendType=blend;\r\n\t\t\t\t}\r\n\t\t\t\tsubmit.scope=scope;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\tthis._curSubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.transform=function(a,b,c,d,tx,ty){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tMatrix.mul(Matrix.TEMP.setTo(a,b,c,d,tx,ty),this._curMat,this._curMat);\r\n\t\t\tthis._curMat._checkTransform();\r\n\t\t}\r\n\r\n\t\t__proto.setTransformByMatrix=function(value){\r\n\t\t\tvalue.copyTo(this._curMat);\r\n\t\t}\r\n\r\n\t\t__proto.transformByMatrix=function(value){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tMatrix.mul(value,this._curMat,this._curMat);\r\n\t\t\tthis._curMat._checkTransform();\r\n\t\t}\r\n\r\n\t\t__proto.rotate=function(angle){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tthis._curMat.rotateEx(angle);\r\n\t\t}\r\n\r\n\t\t__proto.scale=function(scaleX,scaleY){\r\n\t\t\tSaveTransform.save(this);\r\n\t\t\tthis._curMat.scaleEx(scaleX,scaleY);\r\n\t\t}\r\n\r\n\t\t__proto.clipRect=function(x,y,width,height){\r\n\t\t\twidth *=this._curMat.a;\r\n\t\t\theight *=this._curMat.d;\r\n\t\t\tvar p=Point.TEMP;\r\n\t\t\tthis._curMat.transformPoint(p.setTo(x,y));\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tvar submit=this._curSubmit=SubmitScissor.create(this);\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tsubmit.submitIndex=this._submits._length;\r\n\t\t\tsubmit.submitLength=9999999;\r\n\t\t\tSaveClipRect.save(this,submit);\r\n\t\t\tvar clip=this._clipRect;\r\n\t\t\tvar x1=clip.x,y1=clip.y;\r\n\t\t\tvar r=p.x+width,b=p.y+height;\r\n\t\t\tx1 < p.x && (clip.x=p.x);\r\n\t\t\ty1 < p.y && (clip.y=p.y);\r\n\t\t\tclip.width=Math.min(r,x1+clip.width)-clip.x;\r\n\t\t\tclip.height=Math.min(b,y1+clip.height)-clip.y;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tsubmit.clipRect.copyFrom(clip);\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t}\r\n\r\n\t\t__proto.setIBVB=function(x,y,ib,vb,numElement,mat,shader,shaderValues,startIndex,offset,type){\r\n\t\t\t(startIndex===void 0)&& (startIndex=0);\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(type===void 0)&& (type=0);\r\n\t\t\tif (ib===null){\r\n\t\t\t\tif (!Render.isFlash){\r\n\t\t\t\t\tib=this._ib;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar falshVB=vb;\r\n\t\t\t\t\t(falshVB._selfIB)|| (falshVB._selfIB=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4));\r\n\t\t\t\t\tfalshVB._selfIB.clear();\r\n\t\t\t\t\tib=falshVB._selfIB;\r\n\t\t\t\t}\r\n\t\t\t\tGlUtils.expandIBQuadrangle(ib,(vb.byteLength / (/*laya.webgl.utils.Buffer2D.FLOAT32*/4 *vb.vertexStride *4)));\r\n\t\t\t}\r\n\t\t\tif (!shaderValues || !shader)\r\n\t\t\t\tthrow Error(\"setIBVB must input:shader shaderValues\");\r\n\t\t\tvar submit=SubmitOtherIBVB.create(this,vb,ib,numElement,shader,shaderValues,startIndex,offset,type);\r\n\t\t\tmat || (mat=Matrix.EMPTY);\r\n\t\t\tmat.translate(x,y);\r\n\t\t\tMatrix.mul(mat,this._curMat,submit._mat);\r\n\t\t\tmat.translate(-x,-y);\r\n\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t}\r\n\r\n\t\t__proto.addRenderObject=function(o){\r\n\t\t\tthis._submits[this._submits._length++]=o;\r\n\t\t}\r\n\r\n\t\t__proto.fillTrangles=function(tex,x,y,points,m){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tvar shader=this._shader2D;\r\n\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\tvar length=points.length >> 4;\r\n\t\t\tvar t_tex=tex.bitmap;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tif (shader.glTexture !=t_tex || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0));\r\n\t\t\t\tsubmit.shaderValue.textureHost=tex;\r\n\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t}\r\n\t\t\tGlUtils.fillTranglesVB(vb,x,y,points,m || this._curMat,this._x,this._y);\r\n\t\t\tsubmit._numEle+=length *6;\r\n\t\t}\r\n\r\n\t\t__proto.submitElement=function(start,end){\r\n\t\t\tvar renderList=this._submits;\r\n\t\t\tend < 0 && (end=renderList._length);\r\n\t\t\twhile (start < end){\r\n\t\t\t\tstart+=renderList[start].renderSubmit();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.finish=function(){\r\n\t\t\tWebGL.mainContext.finish();\r\n\t\t}\r\n\r\n\t\t__proto.flush=function(){\r\n\t\t\tvar maxNum=Math.max(this._vb.byteLength / (/*laya.webgl.utils.Buffer2D.FLOAT32*/4 *16),this._maxNumEle / 6)+8;\r\n\t\t\tif (maxNum > (this._ib.bufferLength / (6 */*laya.webgl.utils.Buffer2D.SHORT*/2))){\r\n\t\t\t\tGlUtils.expandIBQuadrangle(this._ib,maxNum);\r\n\t\t\t}\r\n\t\t\tif (!this._isMain && AtlasResourceManager.enabled && AtlasResourceManager._atlasRestore > this._atlasResourceChange){\r\n\t\t\t\tthis._atlasResourceChange=AtlasResourceManager._atlasRestore;\r\n\t\t\t\tvar renderList=this._submits;\r\n\t\t\t\tfor (var i=0,s=renderList._length;i < s;i++){\r\n\t\t\t\t\tvar submit=renderList [i];\r\n\t\t\t\t\tif (submit.getRenderType()===/*laya.webgl.submit.Submit.TYPE_TEXTURE*/10016)\r\n\t\t\t\t\t\t(submit).checkTexture();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.submitElement(0,this._submits._length);\r\n\t\t\tthis._path && this._path.reset();\r\n\t\t\tSkinMeshBuffer.instance && SkinMeshBuffer.getInstance().reset();\r\n\t\t\tthis._curSubmit=Submit.RENDERBASE;\r\n\t\t\tthis._renderKey=0;\r\n\t\t\treturn this._submits._length;\r\n\t\t}\r\n\r\n\t\t__proto.setPathId=function(id){\r\n\t\t\tthis.mId=id;\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tthis.mHaveKey=false;\r\n\t\t\t\tvar tVGM=VectorGraphManager.getInstance();\r\n\t\t\t\tif (tVGM.shapeDic[this.mId]){\r\n\t\t\t\t\tthis.mHaveKey=true;\r\n\t\t\t\t}\r\n\t\t\t\tthis.mHaveLineKey=false;\r\n\t\t\t\tif (tVGM.shapeLineDic[this.mId]){\r\n\t\t\t\t\tthis.mHaveLineKey=true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.movePath=function(x,y){\r\n\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\tthis.mX+=x;\r\n\t\t\tthis.mY+=y;\r\n\t\t}\r\n\r\n\t\t__proto.beginPath=function(){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\ttPath.tempArray.length=0;\r\n\t\t\ttPath.closePath=false;\r\n\t\t\tthis.mX=0;\r\n\t\t\tthis.mY=0;\r\n\t\t}\r\n\r\n\t\t__proto.closePath=function(){\r\n\t\t\tthis._path.closePath=true;\r\n\t\t}\r\n\r\n\t\t__proto.fill=function(isConvexPolygon){\r\n\t\t\t(isConvexPolygon===void 0)&& (isConvexPolygon=false);\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tthis.drawPoly(0,0,tPath.tempArray,this.fillStyle._color.numColor,0,0,isConvexPolygon);\r\n\t\t}\r\n\r\n\t\t__proto.stroke=function(){\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (this.lineWidth > 0){\r\n\t\t\t\tif (this.mId==-1){\r\n\t\t\t\t\ttPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tif (this.mHaveLineKey){\r\n\t\t\t\t\t\tvar tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];\r\n\t\t\t\t\t\ttShapeLine.rebuild(tPath.tempArray);\r\n\t\t\t\t\t\ttPath.setGeomtry(tShapeLine);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tVectorGraphManager.getInstance().addLine(this.mId,tPath.drawLine(0,0,tPath.tempArray,this.lineWidth,this.strokeStyle._color.numColor));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttPath.update();\r\n\t\t\t\tvar tPosArray=[this.mX,this.mY];\r\n\t\t\t\tvar tempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=RenderState2D.TEMPMAT4_ARRAY;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.line=function(fromX,fromY,toX,toY,lineWidth,mat){\r\n\t\t\tvar submit=this._curSubmit;\r\n\t\t\tvar vb=this._vb;\r\n\t\t\tif (GlUtils.fillLineVb(vb,this._clipRect,fromX,fromY,toX,toY,lineWidth,mat)){\r\n\t\t\t\tthis._renderKey=0;\r\n\t\t\t\tvar shader=this._shader2D;\r\n\t\t\t\tvar curShader=submit.shaderValue;\r\n\t\t\t\tif (shader.strokeStyle!==curShader.strokeStyle || shader.ALPHA!==curShader.ALPHA){\r\n\t\t\t\t\tshader.glTexture=null;\r\n\t\t\t\t\tsubmit=this._curSubmit=Submit.create(this,this._ib,vb,((vb._byteLength-16 */*laya.webgl.utils.Buffer2D.FLOAT32*/4)/ 32)*3,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0));\r\n\t\t\t\t\tsubmit.shaderValue.strokeStyle=shader.strokeStyle;\r\n\t\t\t\t\tsubmit.shaderValue.mainID=/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02;\r\n\t\t\t\t\tsubmit.shaderValue.ALPHA=shader.ALPHA;\r\n\t\t\t\t\tthis._submits[this._submits._length++]=submit;\r\n\t\t\t\t}\r\n\t\t\t\tsubmit._numEle+=6;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.moveTo=function(x,y,b){\r\n\t\t\t(b===void 0)&& (b=true);\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (b){\r\n\t\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\t}\r\n\t\t\ttPath.addPoint(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.lineTo=function(x,y,b){\r\n\t\t\t(b===void 0)&& (b=true);\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (b){\r\n\t\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\t}\r\n\t\t\ttPath.addPoint(x,y);\r\n\t\t}\r\n\r\n\t\t__proto.drawCurves=function(x,y,args){\r\n\t\t\tthis.setPathId(-1);\r\n\t\t\tthis.beginPath();\r\n\t\t\tthis.strokeStyle=args[3];\r\n\t\t\tthis.lineWidth=args[4];\r\n\t\t\tvar points=args[2];\r\n\t\t\tx+=args[0],y+=args[1];\r\n\t\t\tthis.movePath(x,y);\r\n\t\t\tthis.moveTo(points[0],points[1]);\r\n\t\t\tvar i=2,n=points.length;\r\n\t\t\twhile (i < n){\r\n\t\t\t\tthis.quadraticCurveTo(points[i++],points[i++],points[i++],points[i++]);\r\n\t\t\t}\r\n\t\t\tthis.stroke();\r\n\t\t}\r\n\r\n\t\t__proto.arcTo=function(x1,y1,x2,y2,r){\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tif (this.mHaveKey){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tvar x0=tPath.getEndPointX();\r\n\t\t\tvar y0=tPath.getEndPointY();\r\n\t\t\tvar dx0=NaN,dy0=NaN,dx1=NaN,dy1=NaN,a=NaN,d=NaN,cx=NaN,cy=NaN,a0=NaN,a1=NaN;\r\n\t\t\tvar dir=false;\r\n\t\t\tdx0=x0-x1;\r\n\t\t\tdy0=y0-y1;\r\n\t\t\tdx1=x2-x1;\r\n\t\t\tdy1=y2-y1;\r\n\t\t\tPoint.TEMP.setTo(dx0,dy0);\r\n\t\t\tPoint.TEMP.normalize();\r\n\t\t\tdx0=Point.TEMP.x;\r\n\t\t\tdy0=Point.TEMP.y;\r\n\t\t\tPoint.TEMP.setTo(dx1,dy1);\r\n\t\t\tPoint.TEMP.normalize();\r\n\t\t\tdx1=Point.TEMP.x;\r\n\t\t\tdy1=Point.TEMP.y;\r\n\t\t\ta=Math.acos(dx0 *dx1+dy0 *dy1);\r\n\t\t\tvar tTemp=Math.tan(a / 2.0);\r\n\t\t\td=r / tTemp;\r\n\t\t\tif (d > 10000){\r\n\t\t\t\tthis.lineTo(x1,y1);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (dx0 *dy1-dx1 *dy0 <=0.0){\r\n\t\t\t\tcx=x1+dx0 *d+dy0 *r;\r\n\t\t\t\tcy=y1+dy0 *d-dx0 *r;\r\n\t\t\t\ta0=Math.atan2(dx0,-dy0);\r\n\t\t\t\ta1=Math.atan2(-dx1,dy1);\r\n\t\t\t\tdir=false;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tcx=x1+dx0 *d-dy0 *r;\r\n\t\t\t\tcy=y1+dy0 *d+dx0 *r;\r\n\t\t\t\ta0=Math.atan2(-dx0,dy0);\r\n\t\t\t\ta1=Math.atan2(dx1,-dy1);\r\n\t\t\t\tdir=true;\r\n\t\t\t}\r\n\t\t\tthis.arc(cx,cy,r,a0,a1,dir);\r\n\t\t}\r\n\r\n\t\t__proto.arc=function(cx,cy,r,startAngle,endAngle,counterclockwise){\r\n\t\t\t(counterclockwise===void 0)&& (counterclockwise=false);\r\n\t\t\tif (this.mId !=-1){\r\n\t\t\t\tvar tShape=VectorGraphManager.getInstance().shapeDic[this.mId];\r\n\t\t\t\tif (tShape){\r\n\t\t\t\t\tif (this.mHaveKey && !tShape.needUpdate(this._curMat))\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tcx=0;\r\n\t\t\t\tcy=0;\r\n\t\t\t};\r\n\t\t\tvar a=0,da=0,hda=0,kappa=0;\r\n\t\t\tvar dx=0,dy=0,x=0,y=0,tanx=0,tany=0;\r\n\t\t\tvar px=0,py=0,ptanx=0,ptany=0;\r\n\t\t\tvar i=0,ndivs=0,nvals=0;\r\n\t\t\tda=endAngle-startAngle;\r\n\t\t\tif (!counterclockwise){\r\n\t\t\t\tif (Math.abs(da)>=Math.PI *2){\r\n\t\t\t\t\tda=Math.PI *2;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\twhile (da < 0.0){\r\n\t\t\t\t\t\tda+=Math.PI *2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (Math.abs(da)>=Math.PI *2){\r\n\t\t\t\t\tda=-Math.PI *2;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\twhile (da > 0.0){\r\n\t\t\t\t\t\tda-=Math.PI *2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (r < 101){\r\n\t\t\t\tndivs=Math.max(10,da *r / 5);\r\n\t\t\t}\r\n\t\t\telse if (r < 201){\r\n\t\t\t\tndivs=Math.max(10,da *r / 20);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tndivs=Math.max(10,da *r / 40);\r\n\t\t\t}\r\n\t\t\thda=(da / ndivs)/ 2.0;\r\n\t\t\tkappa=Math.abs(4 / 3 *(1-Math.cos(hda))/ Math.sin(hda));\r\n\t\t\tif (counterclockwise)\r\n\t\t\t\tkappa=-kappa;\r\n\t\t\tnvals=0;\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tfor (i=0;i <=ndivs;i++){\r\n\t\t\t\ta=startAngle+da *(i / ndivs);\r\n\t\t\t\tdx=Math.cos(a);\r\n\t\t\t\tdy=Math.sin(a);\r\n\t\t\t\tx=cx+dx *r;\r\n\t\t\t\ty=cy+dy *r;\r\n\t\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\t\tif (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){\r\n\t\t\t\t\ttPath.addPoint(x,y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdx=Math.cos(endAngle);\r\n\t\t\tdy=Math.sin(endAngle);\r\n\t\t\tx=cx+dx *r;\r\n\t\t\ty=cy+dy *r;\r\n\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\tif (x !=this._path.getEndPointX()|| y !=this._path.getEndPointY()){\r\n\t\t\t\ttPath.addPoint(x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.quadraticCurveTo=function(cpx,cpy,x,y){\r\n\t\t\tvar tBezier=Bezier.I;\r\n\t\t\tvar tResultArray=[];\r\n\t\t\tx=this._curMat.a *x+this._curMat.c *y+this._curMat.tx;\r\n\t\t\ty=this._curMat.b *x+this._curMat.d *y+this._curMat.ty;\r\n\t\t\tcpx=this._curMat.a *cpx+this._curMat.c *cpy+this._curMat.tx;\r\n\t\t\tcpy=this._curMat.b *cpx+this._curMat.d *cpy+this._curMat.ty;\r\n\t\t\tvar tArray=tBezier.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),cpx,cpy,x,y],30,2);\r\n\t\t\tfor (var i=0,n=tArray.length / 2;i < n;i++){\r\n\t\t\t\tthis.lineTo(tArray[i *2],tArray[i *2+1],false);\r\n\t\t\t}\r\n\t\t\tthis.lineTo(x,y,false);\r\n\t\t}\r\n\r\n\t\t__proto.rect=function(x,y,width,height){\r\n\t\t\tthis._other=this._other.make();\r\n\t\t\tthis._other.path || (this._other.path=new Path());\r\n\t\t\tthis._other.path.rect(x,y,width,height);\r\n\t\t}\r\n\r\n\t\t__proto.strokeRect=function(x,y,width,height,parameterLineWidth){\r\n\t\t\tvar tW=parameterLineWidth *0.5;\r\n\t\t\tthis.line(x-tW,y,x+width+tW,y,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x+width,y,x+width,y+height,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x,y,x,y+height,parameterLineWidth,this._curMat);\r\n\t\t\tthis.line(x-tW,y+height,x+width+tW,y+height,parameterLineWidth,this._curMat);\r\n\t\t}\r\n\r\n\t\t__proto.clip=function(){}\r\n\t\t/**\r\n\t\t*画多边形(用)\r\n\t\t*@param x\r\n\t\t*@param y\r\n\t\t*@param points\r\n\t\t*/\r\n\t\t__proto.drawPoly=function(x,y,points,color,lineWidth,boderColor,isConvexPolygon){\r\n\t\t\t(isConvexPolygon===void 0)&& (isConvexPolygon=false);\r\n\t\t\tthis._renderKey=0;\r\n\t\t\tthis._shader2D.glTexture=null;\r\n\t\t\tvar tPath=this._getPath();\r\n\t\t\tif (this.mId==-1){\r\n\t\t\t\ttPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor)\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (this.mHaveKey){\r\n\t\t\t\t\tvar tShape=VectorGraphManager.getInstance().shapeDic[this.mId];\r\n\t\t\t\t\ttShape.setMatrix(this._curMat);\r\n\t\t\t\t\ttShape.rebuild(tPath.tempArray);\r\n\t\t\t\t\ttPath.setGeomtry(tShape);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tvar t=tPath.polygon(x,y,points,color,lineWidth ? lineWidth :1,boderColor);\r\n\t\t\t\t\tVectorGraphManager.getInstance().addShape(this.mId,t);\r\n\t\t\t\t\tt.setMatrix(this._curMat);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttPath.update();\r\n\t\t\tvar tPosArray=[this.mX,this.mY];\r\n\t\t\tvar tempSubmit;\r\n\t\t\tif (!isConvexPolygon){\r\n\t\t\t\tvar submit=SubmitStencil.create(4);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=RenderState2D.EMPTYMAT4_ARRAY;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t\tsubmit=SubmitStencil.create(5);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t}\r\n\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t(tempSubmit.shaderValue).u_pos=tPosArray;\r\n\t\t\ttempSubmit.shaderValue.u_mmat2=RenderState2D.EMPTYMAT4_ARRAY;\r\n\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\tif (!isConvexPolygon){\r\n\t\t\t\tsubmit=SubmitStencil.create(3);\r\n\t\t\t\tthis.addRenderObject(submit);\r\n\t\t\t}\r\n\t\t\tif (lineWidth > 0){\r\n\t\t\t\tif (this.mHaveLineKey){\r\n\t\t\t\t\tvar tShapeLine=VectorGraphManager.getInstance().shapeLineDic[this.mId];\r\n\t\t\t\t\ttShapeLine.rebuild(tPath.tempArray);\r\n\t\t\t\t\ttPath.setGeomtry(tShapeLine);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tVectorGraphManager.getInstance().addShape(this.mId,tPath.drawLine(x,y,points,lineWidth,boderColor));\r\n\t\t\t\t}\r\n\t\t\t\ttPath.update();\r\n\t\t\t\ttempSubmit=Submit.createShape(this,tPath.ib,tPath.vb,tPath.count,tPath.offset,Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0));\r\n\t\t\t\ttempSubmit.shaderValue.ALPHA=this._shader2D.ALPHA;\r\n\t\t\t\ttempSubmit.shaderValue.u_mmat2=RenderState2D.EMPTYMAT4_ARRAY;\r\n\t\t\t\tthis._submits[this._submits._length++]=tempSubmit;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/*******************************************end矢量绘制***************************************************/\r\n\t\t__proto.drawParticle=function(x,y,pt){\r\n\t\t\tpt.x=x;\r\n\t\t\tpt.y=y;\r\n\t\t\tthis._submits[this._submits._length++]=pt;\r\n\t\t}\r\n\r\n\t\t__proto._getPath=function(){\r\n\t\t\treturn this._path || (this._path=new Path());\r\n\t\t}\r\n\r\n\t\t/*,_shader2D.ALPHA=1*/\r\n\t\t__getset(0,__proto,'globalCompositeOperation',function(){\r\n\t\t\treturn BlendMode.NAMES[this._nBlendType];\r\n\t\t\t},function(value){\r\n\t\t\tvar n=BlendMode.TOINT[value];\r\n\t\t\tn==null || (this._nBlendType===n)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_GLOBALCOMPOSITEOPERATION*/0x10000,this,true),this._curSubmit=Submit.RENDERBASE,this._renderKey=0,this._nBlendType=n);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'strokeStyle',function(){\r\n\t\t\treturn this._shader2D.strokeStyle;\r\n\t\t\t},function(value){\r\n\t\t\tthis._shader2D.strokeStyle.equal(value)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_STROKESTYLE*/0x200,this._shader2D,false),this._shader2D.strokeStyle=DrawStyle.create(value));\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'globalAlpha',function(){\r\n\t\t\treturn this._shader2D.ALPHA;\r\n\t\t\t},function(value){\r\n\t\t\tvalue=Math.floor(value *1000)/ 1000;\r\n\t\t\tif (value !=this._shader2D.ALPHA){\r\n\t\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_ALPHA*/0x1,this._shader2D,true);\r\n\t\t\t\tthis._shader2D.ALPHA=value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t//webGLCanvas为0;\r\n\t\t__getset(0,__proto,'asBitmap',null,function(value){\r\n\t\t\tif (value){\r\n\t\t\t\tthis._targets || (this._targets=new RenderTargetMAX());\r\n\t\t\t\tthis._targets.repaint=true;\r\n\t\t\t\tif (!this._width || !this._height)\r\n\t\t\t\t\tthrow Error(\"asBitmap no size!\");\r\n\t\t\t\tthis._targets.size(this._width,this._height);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tthis._targets=null;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'fillStyle',function(){\r\n\t\t\treturn this._shader2D.fillStyle;\r\n\t\t\t},function(value){\r\n\t\t\tthis._shader2D.fillStyle.equal(value)|| (SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FILESTYLE*/0x2,this._shader2D,false),this._shader2D.fillStyle=DrawStyle.create(value));\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'textAlign',function(){\r\n\t\t\treturn this._other.textAlign;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.textAlign===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_TEXTALIGN*/0x8000,this._other,false),this._other.textAlign=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'lineWidth',function(){\r\n\t\t\treturn this._other.lineWidth;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.lineWidth===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_LINEWIDTH*/0x100,this._other,false),this._other.lineWidth=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'textBaseline',function(){\r\n\t\t\treturn this._other.textBaseline;\r\n\t\t\t},function(value){\r\n\t\t\t(this._other.textBaseline===value)|| (this._other=this._other.make(),SaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_TEXTBASELINE*/0x4000,this._other,false),this._other.textBaseline=value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'font',null,function(str){\r\n\t\t\tif (str==this._other.font.toString())\r\n\t\t\t\treturn;\r\n\t\t\tthis._other=this._other.make();\r\n\t\t\tSaveBase.save(this,/*laya.webgl.canvas.save.SaveBase.TYPE_FONT*/0x8,this._other,false);\r\n\t\t\tthis._other.font===FontInContext.EMPTY ? (this._other.font=new FontInContext(str)):(this._other.font.setFont(str));\r\n\t\t});\r\n\r\n\t\tWebGLContext2D.__init__=function(){\r\n\t\t\tContextParams.DEFAULT=new ContextParams();\r\n\t\t}\r\n\r\n\t\tWebGLContext2D._SUBMITVBSIZE=32000;\r\n\t\tWebGLContext2D._MAXSIZE=99999999;\r\n\t\tWebGLContext2D._RECTVBSIZE=16;\r\n\t\tWebGLContext2D.MAXCLIPRECT=new Rectangle(0,0,99999999,99999999);\r\n\t\tWebGLContext2D._COUNT=0;\r\n\t\tWebGLContext2D._tmpMatrix=new Matrix();\r\n\t\t__static(WebGLContext2D,\r\n\t\t['_fontTemp',function(){return this._fontTemp=new FontInContext();},'_drawStyleTemp',function(){return this._drawStyleTemp=new DrawStyle(null);}\r\n\t\t]);\r\n\t\tWebGLContext2D.__init$=function(){\r\n\t\t\t//class ContextParams\r\n\t\t\tContextParams=(function(){\r\n\t\t\t\tfunction ContextParams(){\r\n\t\t\t\t\tthis.lineWidth=1;\r\n\t\t\t\t\tthis.path=null;\r\n\t\t\t\t\tthis.textAlign=null;\r\n\t\t\t\t\tthis.textBaseline=null;\r\n\t\t\t\t\tthis.font=FontInContext.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t\t__class(ContextParams,'');\r\n\t\t\t\tvar __proto=ContextParams.prototype;\r\n\t\t\t\t__proto.clear=function(){\r\n\t\t\t\t\tthis.lineWidth=1;\r\n\t\t\t\t\tthis.path && this.path.clear();\r\n\t\t\t\t\tthis.textAlign=this.textBaseline=null;\r\n\t\t\t\t\tthis.font=FontInContext.EMPTY;\r\n\t\t\t\t}\r\n\t\t\t\t__proto.make=function(){\r\n\t\t\t\t\treturn this===ContextParams.DEFAULT ? new ContextParams():this;\r\n\t\t\t\t}\r\n\t\t\t\tContextParams.DEFAULT=null\r\n\t\t\t\treturn ContextParams;\r\n\t\t\t})()\r\n\t\t}\r\n\r\n\t\treturn WebGLContext2D;\r\n\t})(Context)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.Value2D extends laya.webgl.shader.ShaderValue\r\n\tvar Value2D=(function(_super){\r\n\t\tfunction Value2D(mainID,subID){\r\n\t\t\tthis.size=[0,0];\r\n\t\t\tthis.alpha=1.0;\r\n\t\t\t//this.mmat=null;\r\n\t\t\tthis.ALPHA=1.0;\r\n\t\t\t//this.shader=null;\r\n\t\t\t//this.mainID=0;\r\n\t\t\tthis.subID=0;\r\n\t\t\t//this.filters=null;\r\n\t\t\t//this.textureHost=null;\r\n\t\t\t//this.texture=null;\r\n\t\t\t//this.fillStyle=null;\r\n\t\t\t//this.color=null;\r\n\t\t\t//this.strokeStyle=null;\r\n\t\t\t//this.colorAdd=null;\r\n\t\t\t//this.glTexture=null;\r\n\t\t\t//this.u_mmat2=null;\r\n\t\t\t//this._inClassCache=null;\r\n\t\t\tthis._cacheID=0;\r\n\t\t\tValue2D.__super.call(this);\r\n\t\t\tthis.defines=new ShaderDefines2D();\r\n\t\t\tthis.position=Value2D._POSITION;\r\n\t\t\tthis.mainID=mainID;\r\n\t\t\tthis.subID=subID;\r\n\t\t\tthis.textureHost=null;\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.fillStyle=null;\r\n\t\t\tthis.color=null;\r\n\t\t\tthis.strokeStyle=null;\r\n\t\t\tthis.colorAdd=null;\r\n\t\t\tthis.glTexture=null;\r\n\t\t\tthis.u_mmat2=null;\r\n\t\t\tthis._cacheID=mainID|subID;\r\n\t\t\tthis._inClassCache=Value2D._cache[this._cacheID];\r\n\t\t\tif (mainID>0 && !this._inClassCache){\r\n\t\t\t\tthis._inClassCache=Value2D._cache[this._cacheID]=[];\r\n\t\t\t\tthis._inClassCache._length=0;\r\n\t\t\t}\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__class(Value2D,'laya.webgl.shader.d2.value.Value2D',_super);\r\n\t\tvar __proto=Value2D.prototype;\r\n\t\t__proto.setValue=function(value){}\r\n\t\t//throw new Error(\"todo in subclass\");\r\n\t\t__proto.refresh=function(){\r\n\t\t\tvar size=this.size;\r\n\t\t\tsize[0]=RenderState2D.width;\r\n\t\t\tsize[1]=RenderState2D.height;\r\n\t\t\tthis.alpha=this.ALPHA *RenderState2D.worldAlpha;\r\n\t\t\tthis.mmat=RenderState2D.worldMatrix4;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto._ShaderWithCompile=function(){\r\n\t\t\treturn Shader.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID | this.defines._value,Shader2X.create);\r\n\t\t}\r\n\r\n\t\t__proto._withWorldShaderDefines=function(){\r\n\t\t\tvar defs=RenderState2D.worldShaderDefines;\r\n\t\t\tvar sd=Shader.sharders [this.mainID | this.defines._value | defs.getValue()];\r\n\t\t\tif (!sd){\r\n\t\t\t\tvar def={};\r\n\t\t\t\tvar dic;\r\n\t\t\t\tvar name;\r\n\t\t\t\tdic=this.defines.toNameDic();for (name in dic)def[name]=\"\";\r\n\t\t\t\tdic=defs.toNameDic();for (name in dic)def[name]=\"\";\r\n\t\t\t\tsd=Shader.withCompile2D(0,this.mainID,def,this.mainID | this.defines._value| defs.getValue(),Shader2X.create);\r\n\t\t\t};\r\n\t\t\tvar worldFilters=RenderState2D.worldFilters;\r\n\t\t\tif (!worldFilters)return sd;\r\n\t\t\tvar n=worldFilters.length,f;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\t((f=worldFilters[i]))&& f.action.setValue(this);\r\n\t\t\t}\r\n\t\t\treturn sd;\r\n\t\t}\r\n\r\n\t\t__proto.upload=function(){\r\n\t\t\tvar renderstate2d=RenderState2D;\r\n\t\t\tthis.alpha=this.ALPHA *renderstate2d.worldAlpha;\r\n\t\t\tif (RenderState2D.worldMatrix4!==RenderState2D.TEMPMAT4_ARRAY)this.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.WORLDMAT*/0x80);\r\n\t\t\tvar sd=renderstate2d.worldShaderDefines?this._withWorldShaderDefines():(Shader.sharders [this.mainID | this.defines._value] || this._ShaderWithCompile());\r\n\t\t\tvar params;\r\n\t\t\tthis.size[0]=renderstate2d.width,this.size[1]=renderstate2d.height;\r\n\t\t\tthis.mmat=renderstate2d.worldMatrix4;\r\n\t\t\tif (BaseShader.activeShader!==sd){\r\n\t\t\t\tif (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){\r\n\t\t\t\t\tsd._shaderValueWidth=renderstate2d.width;\r\n\t\t\t\t\tsd._shaderValueHeight=renderstate2d.height;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tparams=sd._params2dQuick2 || sd._make2dQuick2();\r\n\t\t\t\t}\r\n\t\t\t\tsd.upload(this,params);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tif (sd._shaderValueWidth!==renderstate2d.width || sd._shaderValueHeight!==renderstate2d.height){\r\n\t\t\t\t\tsd._shaderValueWidth=renderstate2d.width;\r\n\t\t\t\t\tsd._shaderValueHeight=renderstate2d.height;\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tparams=(sd._params2dQuick1)|| sd._make2dQuick1();\r\n\t\t\t\t}\r\n\t\t\t\tsd.upload(this,params);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.setFilters=function(value){\r\n\t\t\tthis.filters=value;\r\n\t\t\tif (!value)\r\n\t\t\t\treturn;\r\n\t\t\tvar n=value.length,f;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\tf=value[i];\r\n\t\t\t\tif (f){\r\n\t\t\t\t\tthis.defines.add(f.type);\r\n\t\t\t\t\tf.action.setValue(this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.defines.setValue(this.subID);\r\n\t\t}\r\n\r\n\t\t__proto.release=function(){\r\n\t\t\tthis._inClassCache[this._inClassCache._length++]=this;\r\n\t\t\tthis.fillStyle=null;\r\n\t\t\tthis.strokeStyle=null;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\tValue2D._initone=function(type,classT){\r\n\t\t\tValue2D._typeClass[type]=classT;\r\n\t\t\tValue2D._cache[type]=[];\r\n\t\t\tValue2D._cache[type]._length=0;\r\n\t\t}\r\n\r\n\t\tValue2D.__init__=function(){\r\n\t\t\tValue2D._POSITION=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,4 *CONST3D2D.BYTES_PE,0];\r\n\t\t\tValue2D._TEXCOORD=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,4 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,Color2dSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,PrimitiveSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,FillTextureSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,SkinSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,TextureSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01 | /*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40,TextSV);\r\n\t\t\tValue2D._initone(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01 | /*laya.webgl.shader.d2.ShaderDefines2D.FILTERGLOW*/0x08,TextureSV);\r\n\t\t}\r\n\r\n\t\tValue2D.create=function(mainType,subType){\r\n\t\t\tvar types=Value2D._cache[mainType|subType];\r\n\t\t\tif (types._length)\r\n\t\t\t\treturn types[--types._length];\r\n\t\t\telse\r\n\t\t\treturn new Value2D._typeClass[mainType|subType](subType);\r\n\t\t}\r\n\r\n\t\tValue2D._POSITION=null\r\n\t\tValue2D._TEXCOORD=null\r\n\t\tValue2D._cache=[];\r\n\t\tValue2D._typeClass=[];\r\n\t\tValue2D.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];\r\n\t\treturn Value2D;\r\n\t})(ShaderValue)\r\n\r\n\r\n\t//class laya.webgl.utils.RenderSprite3D extends laya.renders.RenderSprite\r\n\tvar RenderSprite3D=(function(_super){\r\n\t\tfunction RenderSprite3D(type,next){\r\n\t\t\tRenderSprite3D.__super.call(this,type,next);\r\n\t\t}\r\n\r\n\t\t__class(RenderSprite3D,'laya.webgl.utils.RenderSprite3D',_super);\r\n\t\tvar __proto=RenderSprite3D.prototype;\r\n\t\t__proto.onCreate=function(type){\r\n\t\t\tswitch (type){\r\n\t\t\t\tcase 0x08:\r\n\t\t\t\t\tthis._fun=this._blend;\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 0x04:\r\n\t\t\t\t\tthis._fun=this._transform;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._mask=function(sprite,context,x,y){\r\n\t\t\tvar next=this._next;\r\n\t\t\tvar mask=sprite.mask;\r\n\t\t\tvar submitCMD;\r\n\t\t\tvar submitStencil;\r\n\t\t\tif (mask){\r\n\t\t\t\tcontext.ctx.save();\r\n\t\t\t\tvar preBlendMode=(context.ctx).globalCompositeOperation;\r\n\t\t\t\tvar tRect=new Rectangle();\r\n\t\t\t\ttRect.copyFrom(mask.getBounds());\r\n\t\t\t\ttRect.width=Math.round(tRect.width);\r\n\t\t\t\ttRect.height=Math.round(tRect.height);\r\n\t\t\t\ttRect.x=Math.round(tRect.x);\r\n\t\t\t\ttRect.y=Math.round(tRect.y);\r\n\t\t\t\tif (tRect.width > 0 && tRect.height > 0){\r\n\t\t\t\t\tvar scope=SubmitCMDScope.create();\r\n\t\t\t\t\tscope.addValue(\"bounds\",tRect);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope,context],laya.webgl.utils.RenderSprite3D.tmpTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tmask.render(context,-tRect.x,-tRect.y);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.endTmpTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tcontext.ctx.save();\r\n\t\t\t\t\tcontext.clipRect(x+tRect.x,y+tRect.y,tRect.width,tRect.height);\r\n\t\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\t\tcontext.ctx.restore();\r\n\t\t\t\t\tsubmitStencil=SubmitStencil.create(6);\r\n\t\t\t\t\tpreBlendMode=(context.ctx).globalCompositeOperation;\r\n\t\t\t\t\tsubmitStencil.blendMode=\"mask\";\r\n\t\t\t\t\tcontext.addRenderObject(submitStencil);\r\n\t\t\t\t\tMatrix.TEMP.identity();\r\n\t\t\t\t\tvar shaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\t\t\tvar uv=Texture.INV_UV;\r\n\t\t\t\t\tvar w=tRect.width;\r\n\t\t\t\t\tvar h=tRect.height;\r\n\t\t\t\t\tvar tempLimit=32;\r\n\t\t\t\t\tif (tRect.width < tempLimit || tRect.height < tempLimit){\r\n\t\t\t\t\t\tuv=RenderSprite3D.tempUV;\r\n\t\t\t\t\t\tuv[0]=0;\r\n\t\t\t\t\t\tuv[1]=0;\r\n\t\t\t\t\t\tuv[2]=(tRect.width >=32)? 1 :tRect.width/tempLimit;\r\n\t\t\t\t\t\tuv[3]=0\r\n\t\t\t\t\t\tuv[4]=(tRect.width >=32)? 1 :tRect.width/tempLimit;\r\n\t\t\t\t\t\tuv[5]=(tRect.height >=32)? 1 :tRect.height/tempLimit;\r\n\t\t\t\t\t\tuv[6]=0;\r\n\t\t\t\t\t\tuv[7]=(tRect.height >=32)? 1 :tRect.height/tempLimit;\r\n\t\t\t\t\t\ttRect.width=(tRect.width >=32)? tRect.width :tempLimit;\r\n\t\t\t\t\t\ttRect.height=(tRect.height >=32)? tRect.height :tempLimit;\r\n\t\t\t\t\t\tuv[1] *=-1;uv[3] *=-1;uv[5] *=-1;uv[7] *=-1;\r\n\t\t\t\t\t\tuv[1]+=1;uv[3]+=1;uv[5]+=1;uv[7]+=1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t(context.ctx).drawTarget(scope,x+tRect.x,y+tRect.y,w,h,Matrix.TEMP,\"tmpTarget\",shaderValue,uv,6);\r\n\t\t\t\t\tsubmitCMD=SubmitCMD.create([scope],laya.webgl.utils.RenderSprite3D.recycleTarget);\r\n\t\t\t\t\tcontext.addRenderObject(submitCMD);\r\n\t\t\t\t\tsubmitStencil=SubmitStencil.create(6);\r\n\t\t\t\t\tsubmitStencil.blendMode=preBlendMode;\r\n\t\t\t\t\tcontext.addRenderObject(submitStencil);\r\n\t\t\t\t}\r\n\t\t\t\tcontext.ctx.restore();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._blend=function(sprite,context,x,y){\r\n\t\t\tvar style=sprite._style;\r\n\t\t\tvar next=this._next;\r\n\t\t\tif (style.blendMode){\r\n\t\t\t\tcontext.ctx.save();\r\n\t\t\t\tcontext.ctx.globalCompositeOperation=style.blendMode;\r\n\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t\tcontext.ctx.restore();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tnext._fun.call(next,sprite,context,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._transform=function(sprite,context,x,y){\r\n\t\t\t'use strict';\r\n\t\t\tvar transform=sprite.transform,_next=this._next;\r\n\t\t\tif (transform && _next !=RenderSprite.NORENDER){\r\n\t\t\t\tvar ctx=context.ctx;\r\n\t\t\t\tvar style=sprite._style;\r\n\t\t\t\ttransform.tx=x;\r\n\t\t\t\ttransform.ty=y;\r\n\t\t\t\tvar m2=ctx._getTransformMatrix();\r\n\t\t\t\tvar m1=m2.clone();\r\n\t\t\t\tMatrix.mul(transform,m2,m2);\r\n\t\t\t\tm2._checkTransform();\r\n\t\t\t\ttransform.tx=transform.ty=0;\r\n\t\t\t\t_next._fun.call(_next,sprite,context,0,0);\r\n\t\t\t\tm1.copyTo(m2);\r\n\t\t\t\tm1.destroy();\r\n\t\t\t\t}else {\r\n\t\t\t\t_next._fun.call(_next,sprite,context,x,y);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.tmpTarget=function(scope,context){\r\n\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\tvar tmpTarget=RenderTarget2D.create(b.width,b.height);\r\n\t\t\ttmpTarget.start();\r\n\t\t\ttmpTarget.clear(0,0,0,0);\r\n\t\t\tscope.addValue(\"tmpTarget\",tmpTarget);\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.endTmpTarget=function(scope){\r\n\t\t\tvar tmpTarget=scope.getValue(\"tmpTarget\");\r\n\t\t\ttmpTarget.end();\r\n\t\t}\r\n\r\n\t\tRenderSprite3D.recycleTarget=function(scope){\r\n\t\t\tvar tmpTarget=scope.getValue(\"tmpTarget\");\r\n\t\t\ttmpTarget.recycle();\r\n\t\t\tscope.recycle();\r\n\t\t}\r\n\r\n\t\t__static(RenderSprite3D,\r\n\t\t['tempUV',function(){return this.tempUV=new Array(8);}\r\n\t\t]);\r\n\t\treturn RenderSprite3D;\r\n\t})(RenderSprite)\r\n\r\n\r\n\t//class laya.filters.webgl.ColorFilterActionGL extends laya.filters.webgl.FilterActionGL\r\n\tvar ColorFilterActionGL=(function(_super){\r\n\t\tfunction ColorFilterActionGL(){\r\n\t\t\tthis.data=null;\r\n\t\t\tColorFilterActionGL.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(ColorFilterActionGL,'laya.filters.webgl.ColorFilterActionGL',_super);\r\n\t\tvar __proto=ColorFilterActionGL.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.filters.IFilterActionGL\":true})\r\n\t\t__proto.setValue=function(shader){\r\n\t\t\tshader.colorMat=this.data._mat;\r\n\t\t\tshader.colorAlpha=this.data._alpha;\r\n\t\t}\r\n\r\n\t\t__proto.apply3d=function(scope,sprite,context,x,y){\r\n\t\t\tvar b=scope.getValue(\"bounds\");\r\n\t\t\tvar shaderValue=Value2D.create(/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,0);\r\n\t\t\tshaderValue.setFilters([this.data]);\r\n\t\t\tvar tMatrix=Matrix.TEMP;\r\n\t\t\ttMatrix.identity();\r\n\t\t\tcontext.ctx.drawTarget(scope,0,0,b.width,b.height,tMatrix,\"src\",shaderValue);\r\n\t\t}\r\n\r\n\t\treturn ColorFilterActionGL;\r\n\t})(FilterActionGL)\r\n\r\n\r\n\t//class laya.webgl.atlas.Atlaser extends laya.webgl.atlas.AtlasGrid\r\n\tvar Atlaser=(function(_super){\r\n\t\tfunction Atlaser(gridNumX,gridNumY,width,height,atlasID){\r\n\t\t\tthis._atlasCanvas=null;\r\n\t\t\tthis._inAtlasTextureKey=null;\r\n\t\t\tthis._inAtlasTextureBitmapValue=null;\r\n\t\t\tthis._inAtlasTextureOriUVValue=null;\r\n\t\t\tthis._InAtlasWebGLImagesKey=null;\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue=null;\r\n\t\t\tAtlaser.__super.call(this,gridNumX,gridNumY,atlasID);\r\n\t\t\tthis._inAtlasTextureKey=[];\r\n\t\t\tthis._inAtlasTextureBitmapValue=[];\r\n\t\t\tthis._inAtlasTextureOriUVValue=[];\r\n\t\t\tthis._InAtlasWebGLImagesKey=[];\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue=[];\r\n\t\t\tthis._atlasCanvas=new AtlasWebGLCanvas();\r\n\t\t\tthis._atlasCanvas.width=width;\r\n\t\t\tthis._atlasCanvas.height=height;\r\n\t\t\tthis._atlasCanvas.activeResource();\r\n\t\t\tthis._atlasCanvas.lock=true;\r\n\t\t}\r\n\r\n\t\t__class(Atlaser,'laya.webgl.atlas.Atlaser',_super);\r\n\t\tvar __proto=Atlaser.prototype;\r\n\t\t__proto.computeUVinAtlasTexture=function(texture,oriUV,offsetX,offsetY){\r\n\t\t\tvar tex=texture;\r\n\t\t\tvar _width=AtlasResourceManager.atlasTextureWidth;\r\n\t\t\tvar _height=AtlasResourceManager.atlasTextureHeight;\r\n\t\t\tvar u1=offsetX / _width,v1=offsetY / _height,u2=(offsetX+texture.bitmap.width)/ _width,v2=(offsetY+texture.bitmap.height)/ _height;\r\n\t\t\tvar inAltasUVWidth=texture.bitmap.width / _width,inAltasUVHeight=texture.bitmap.height / _height;\r\n\t\t\ttexture.uv=[u1+oriUV[0] *inAltasUVWidth,v1+oriUV[1] *inAltasUVHeight,u2-(1-oriUV[2])*inAltasUVWidth,v1+oriUV[3] *inAltasUVHeight,u2-(1-oriUV[4])*inAltasUVWidth,v2-(1-oriUV[5])*inAltasUVHeight,u1+oriUV[6] *inAltasUVWidth,v2-(1-oriUV[7])*inAltasUVHeight];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*\r\n\t\t*@param inAtlasRes\r\n\t\t*@return 是否已经存在队列中\r\n\t\t*/\r\n\t\t__proto.addToAtlasTexture=function(mergeAtlasBitmap,offsetX,offsetY){\r\n\t\t\t((mergeAtlasBitmap instanceof laya.webgl.resource.WebGLImage ))&& (this._InAtlasWebGLImagesKey.push(mergeAtlasBitmap),this._InAtlasWebGLImagesOffsetValue.push([offsetX,offsetY]));\r\n\t\t\tthis._atlasCanvas.texSubImage2D(offsetX,offsetY,mergeAtlasBitmap.atlasSource);\r\n\t\t\tmergeAtlasBitmap.clearAtlasSource();\r\n\t\t}\r\n\r\n\t\t__proto.addToAtlas=function(texture,offsetX,offsetY){\r\n\t\t\tvar oriUV=texture.uv.slice();\r\n\t\t\tvar oriBitmap=texture.bitmap;\r\n\t\t\tthis._inAtlasTextureKey.push(texture);\r\n\t\t\tthis._inAtlasTextureOriUVValue.push(oriUV);\r\n\t\t\tthis._inAtlasTextureBitmapValue.push(oriBitmap);\r\n\t\t\tthis.computeUVinAtlasTexture(texture,oriUV,offsetX,offsetY);\r\n\t\t\ttexture.bitmap=this._atlasCanvas;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tfor (var i=0,n=this._inAtlasTextureKey.length;i < n;i++){\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap=this._inAtlasTextureBitmapValue[i];\r\n\t\t\t\tthis._inAtlasTextureKey[i].uv=this._inAtlasTextureOriUVValue[i];\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap.lock=false;\r\n\t\t\t\tthis._inAtlasTextureKey[i].bitmap.releaseResource();\r\n\t\t\t}\r\n\t\t\tthis._inAtlasTextureKey.length=0;\r\n\t\t\tthis._inAtlasTextureBitmapValue.length=0;\r\n\t\t\tthis._inAtlasTextureOriUVValue.length=0;\r\n\t\t\tthis._InAtlasWebGLImagesKey.length=0;\r\n\t\t\tthis._InAtlasWebGLImagesOffsetValue.length=0;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.clear();\r\n\t\t\tthis._atlasCanvas.dispose();\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'InAtlasWebGLImagesOffsetValue',function(){\r\n\t\t\treturn this._InAtlasWebGLImagesOffsetValue;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'texture',function(){\r\n\t\t\treturn this._atlasCanvas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'inAtlasWebGLImagesKey',function(){\r\n\t\t\treturn this._InAtlasWebGLImagesKey;\r\n\t\t});\r\n\r\n\t\treturn Atlaser;\r\n\t})(AtlasGrid)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.ShaderDefines2D extends laya.webgl.shader.ShaderDefines\r\n\tvar ShaderDefines2D=(function(_super){\r\n\t\tfunction ShaderDefines2D(){\r\n\t\t\tShaderDefines2D.__super.call(this,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name,ShaderDefines2D.__int2nameMap);\r\n\t\t}\r\n\r\n\t\t__class(ShaderDefines2D,'laya.webgl.shader.d2.ShaderDefines2D',_super);\r\n\t\tShaderDefines2D.__init__=function(){\r\n\t\t\tShaderDefines2D.reg(\"TEXTURE2D\",0x01);\r\n\t\t\tShaderDefines2D.reg(\"COLOR2D\",0x02);\r\n\t\t\tShaderDefines2D.reg(\"PRIMITIVE\",0x04);\r\n\t\t\tShaderDefines2D.reg(\"GLOW_FILTER\",0x08);\r\n\t\t\tShaderDefines2D.reg(\"BLUR_FILTER\",0x10);\r\n\t\t\tShaderDefines2D.reg(\"COLOR_FILTER\",0x20);\r\n\t\t\tShaderDefines2D.reg(\"COLOR_ADD\",0x40);\r\n\t\t\tShaderDefines2D.reg(\"WORLDMAT\",0x80);\r\n\t\t\tShaderDefines2D.reg(\"FILLTEXTURE\",0x100);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.reg=function(name,value){\r\n\t\t\tShaderDefines._reg(name,value,ShaderDefines2D.__name2int,ShaderDefines2D.__int2name);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.toText=function(value,int2name,int2nameMap){\r\n\t\t\treturn ShaderDefines._toText(value,int2name,int2nameMap);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.toInt=function(names){\r\n\t\t\treturn ShaderDefines._toInt(names,ShaderDefines2D.__name2int);\r\n\t\t}\r\n\r\n\t\tShaderDefines2D.TEXTURE2D=0x01;\r\n\t\tShaderDefines2D.COLOR2D=0x02;\r\n\t\tShaderDefines2D.PRIMITIVE=0x04;\r\n\t\tShaderDefines2D.FILTERGLOW=0x08;\r\n\t\tShaderDefines2D.FILTERBLUR=0x10;\r\n\t\tShaderDefines2D.FILTERCOLOR=0x20;\r\n\t\tShaderDefines2D.COLORADD=0x40;\r\n\t\tShaderDefines2D.WORLDMAT=0x80;\r\n\t\tShaderDefines2D.FILLTEXTURE=0x100;\r\n\t\tShaderDefines2D.SKINMESH=0x200;\r\n\t\tShaderDefines2D.__name2int={};\r\n\t\tShaderDefines2D.__int2name=[];\r\n\t\tShaderDefines2D.__int2nameMap=[];\r\n\t\treturn ShaderDefines2D;\r\n\t})(ShaderDefines)\r\n\r\n\r\n\t//class laya.webgl.shapes.Ellipse extends laya.webgl.shapes.BasePoly\r\n\tvar Ellipse=(function(_super){\r\n\t\tfunction Ellipse(x,y,width,height,color,borderWidth,borderColor){\r\n\t\t\tEllipse.__super.call(this,x,y,width,height,40,color,borderWidth,borderColor);\r\n\t\t}\r\n\r\n\t\t__class(Ellipse,'laya.webgl.shapes.Ellipse',_super);\r\n\t\treturn Ellipse;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.Line extends laya.webgl.shapes.BasePoly\r\n\tvar Line=(function(_super){\r\n\t\tfunction Line(x,y,points,borderWidth,color){\r\n\t\t\tthis._points=[];\r\n\t\t\tthis.rebuild(points);\r\n\t\t\tLine.__super.call(this,x,y,0,0,0,color,borderWidth,color,0);\r\n\t\t}\r\n\r\n\t\t__class(Line,'laya.webgl.shapes.Line',_super);\r\n\t\tvar __proto=Line.prototype;\r\n\t\t__proto.rebuild=function(points){\r\n\t\t\tvar len=points.length;\r\n\t\t\tvar preLen=this._points.length;\r\n\t\t\tif (len !=preLen){\r\n\t\t\t\tthis.mUint16Array=new Uint16Array((len/2-1)*6);\r\n\t\t\t\tthis.mFloat32Array=new Float32Array(len*5);\r\n\t\t\t}\r\n\t\t\tthis._points.length=0;\r\n\t\t\tvar tCurrX=NaN;\r\n\t\t\tvar tCurrY=NaN;\r\n\t\t\tvar tLastX=-1;\r\n\t\t\tvar tLastY=-1;\r\n\t\t\tvar tLen=points.length / 2;\r\n\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\ttCurrX=points[i *2];\r\n\t\t\t\ttCurrY=points[i *2+1];\r\n\t\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)>0.01){\r\n\t\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t\t}\r\n\t\t\t\ttLastX=tCurrX;\r\n\t\t\t\ttLastY=tCurrY;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tvar indices=[];\r\n\t\t\tvar verts=[];\r\n\t\t\t(this.borderWidth > 0)&& this.createLine2(this._points,indices,this.borderWidth,start,verts,this._points.length / 2);\r\n\t\t\tthis.mUint16Array.set(indices,0);\r\n\t\t\tthis.mFloat32Array.set(verts,0);\r\n\t\t\tib.append(this.mUint16Array);\r\n\t\t\tvb.append(this.mFloat32Array);\r\n\t\t}\r\n\r\n\t\treturn Line;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.LoopLine extends laya.webgl.shapes.BasePoly\r\n\tvar LoopLine=(function(_super){\r\n\t\tfunction LoopLine(x,y,points,width,color){\r\n\t\t\tthis._points=[];\r\n\t\t\tvar tCurrX=NaN;\r\n\t\t\tvar tCurrY=NaN;\r\n\t\t\tvar tLastX=-1;\r\n\t\t\tvar tLastY=-1;\r\n\t\t\tvar tLen=points.length / 2-1;\r\n\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\ttCurrX=points[i *2];\r\n\t\t\t\ttCurrY=points[i *2+1];\r\n\t\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){\r\n\t\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t\t}\r\n\t\t\t\ttLastX=tCurrX;\r\n\t\t\t\ttLastY=tCurrY;\r\n\t\t\t}\r\n\t\t\ttCurrX=points[tLen *2];\r\n\t\t\ttCurrY=points[tLen *2+1];\r\n\t\t\ttLastX=this._points[0];\r\n\t\t\ttLastY=this._points[1];\r\n\t\t\tif (Math.abs(tLastX-tCurrX)> 0.01 || Math.abs(tLastY-tCurrY)> 0.01){\r\n\t\t\t\tthis._points.push(tCurrX,tCurrY);\r\n\t\t\t}\r\n\t\t\tLoopLine.__super.call(this,x,y,0,0,this._points.length / 2,0,width,color);\r\n\t\t}\r\n\r\n\t\t__class(LoopLine,'laya.webgl.shapes.LoopLine',_super);\r\n\t\tvar __proto=LoopLine.prototype;\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tif (this.borderWidth > 0){\r\n\t\t\t\tvar color=this.color;\r\n\t\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\t\tvar verts=[];\r\n\t\t\t\tvar tLastX=-1,tLastY=-1;\r\n\t\t\t\tvar tCurrX=0,tCurrY=0;\r\n\t\t\t\tvar indices=[];\r\n\t\t\t\tvar tLen=Math.floor(this._points.length / 2);\r\n\t\t\t\tfor (var i=0;i < tLen;i++){\r\n\t\t\t\t\ttCurrX=this._points[i *2];\r\n\t\t\t\t\ttCurrY=this._points[i *2+1];\r\n\t\t\t\t\tverts.push(this.x+tCurrX,this.y+tCurrY,r,g,b);\r\n\t\t\t\t}\r\n\t\t\t\tthis.createLoopLine(verts,indices,this.borderWidth,start+verts.length / 5);\r\n\t\t\t\tib.append(new Uint16Array(indices));\r\n\t\t\t\tvb.append(new Float32Array(verts));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.createLoopLine=function(p,indices,lineWidth,len,outVertex,outIndex){\r\n\t\t\tvar tLen=p.length / 5;\r\n\t\t\tvar points=p.concat();\r\n\t\t\tvar result=outVertex ? outVertex :p;\r\n\t\t\tvar color=this.borderColor;\r\n\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\tvar firstPoint=[points[0],points[1]];\r\n\t\t\tvar lastPoint=[points[points.length-5],points[points.length-4]];\r\n\t\t\tvar midPointX=lastPoint[0]+(firstPoint[0]-lastPoint[0])*0.5;\r\n\t\t\tvar midPointY=lastPoint[1]+(firstPoint[1]-lastPoint[1])*0.5;\r\n\t\t\tpoints.unshift(midPointX,midPointY,0,0,0);\r\n\t\t\tpoints.push(midPointX,midPointY,0,0,0);\r\n\t\t\tvar length=points.length / 5;\r\n\t\t\tvar iStart=len,w=lineWidth / 2;\r\n\t\t\tvar px,py,p1x,p1y,p2x,p2y,p3x,p3y;\r\n\t\t\tvar perpx,perpy,perp2x,perp2y,perp3x,perp3y;\r\n\t\t\tvar a1,b1,c1,a2,b2,c2;\r\n\t\t\tvar denom,pdist,dist;\r\n\t\t\tp1x=points[0];\r\n\t\t\tp1y=points[1];\r\n\t\t\tp2x=points[5];\r\n\t\t\tp2y=points[6];\r\n\t\t\tperpx=-(p1y-p2y);\r\n\t\t\tperpy=p1x-p2x;\r\n\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\tperpx=perpx / dist *w;\r\n\t\t\tperpy=perpy / dist *w;\r\n\t\t\tresult.push(p1x-perpx,p1y-perpy,r,g,b,p1x+perpx,p1y+perpy,r,g,b);\r\n\t\t\tfor (var i=1;i < length-1;i++){\r\n\t\t\t\tp1x=points[(i-1)*5];\r\n\t\t\t\tp1y=points[(i-1)*5+1];\r\n\t\t\t\tp2x=points[(i)*5];\r\n\t\t\t\tp2y=points[(i)*5+1];\r\n\t\t\t\tp3x=points[(i+1)*5];\r\n\t\t\t\tp3y=points[(i+1)*5+1];\r\n\t\t\t\tperpx=-(p1y-p2y);\r\n\t\t\t\tperpy=p1x-p2x;\r\n\t\t\t\tdist=Math.sqrt(perpx *perpx+perpy *perpy);\r\n\t\t\t\tperpx=perpx / dist *w;\r\n\t\t\t\tperpy=perpy / dist *w;\r\n\t\t\t\tperp2x=-(p2y-p3y);\r\n\t\t\t\tperp2y=p2x-p3x;\r\n\t\t\t\tdist=Math.sqrt(perp2x *perp2x+perp2y *perp2y);\r\n\t\t\t\tperp2x=perp2x / dist *w;\r\n\t\t\t\tperp2y=perp2y / dist *w;\r\n\t\t\t\ta1=(-perpy+p1y)-(-perpy+p2y);\r\n\t\t\t\tb1=(-perpx+p2x)-(-perpx+p1x);\r\n\t\t\t\tc1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y);\r\n\t\t\t\ta2=(-perp2y+p3y)-(-perp2y+p2y);\r\n\t\t\t\tb2=(-perp2x+p2x)-(-perp2x+p3x);\r\n\t\t\t\tc2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y);\r\n\t\t\t\tdenom=a1 *b2-a2 *b1;\r\n\t\t\t\tif (Math.abs(denom)< 0.1){\r\n\t\t\t\t\tdenom+=10.1;\r\n\t\t\t\t\tresult.push(p2x-perpx,p2y-perpy,r,g,b,p2x+perpx,p2y+perpy,r,g,b);\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tpx=(b1 *c2-b2 *c1)/ denom;\r\n\t\t\t\tpy=(a2 *c1-a1 *c2)/ denom;\r\n\t\t\t\tpdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y);\r\n\t\t\t\tresult.push(px,py,r,g,b,p2x-(px-p2x),p2y-(py-p2y),r,g,b);\r\n\t\t\t}\r\n\t\t\tif (outIndex){\r\n\t\t\t\tindices=outIndex;\r\n\t\t\t};\r\n\t\t\tvar groupLen=this.edges+1;\r\n\t\t\tfor (i=1;i < groupLen;i++){\r\n\t\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+i *2+1,iStart+i *2+1,iStart+i *2,iStart+(i-1)*2);\r\n\t\t\t}\r\n\t\t\tindices.push(iStart+(i-1)*2,iStart+(i-1)*2+1,iStart+1,iStart+1,iStart,iStart+(i-1)*2);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\treturn LoopLine;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.shapes.Polygon extends laya.webgl.shapes.BasePoly\r\n\tvar Polygon=(function(_super){\r\n\t\tfunction Polygon(x,y,points,color,borderWidth,borderColor){\r\n\t\t\tthis._points=null;\r\n\t\t\tthis._start=-1;\r\n\t\t\tthis._repaint=false;\r\n\t\t\tthis._mat=Matrix.create();\r\n\t\t\tthis._points=points.slice(0,points.length);\r\n\t\t\tPolygon.__super.call(this,x,y,0,0,this._points.length / 2,color,borderWidth,borderColor);\r\n\t\t}\r\n\r\n\t\t__class(Polygon,'laya.webgl.shapes.Polygon',_super);\r\n\t\tvar __proto=Polygon.prototype;\r\n\t\t__proto.rebuild=function(point){\r\n\t\t\tif (!this._repaint){\r\n\t\t\t\tthis._points.length=0;\r\n\t\t\t\tthis._points=this._points.concat(point);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.setMatrix=function(mat){\r\n\t\t\tmat.copyTo(this._mat);\r\n\t\t}\r\n\r\n\t\t__proto.needUpdate=function(mat){\r\n\t\t\tthis._repaint=(this._mat.a==mat.a && this._mat.b==mat.b && this._mat.c==mat.c && this._mat.d==mat.d && this._mat.tx==mat.tx && this._mat.ty==mat.ty);\r\n\t\t\treturn !this._repaint;\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(ib,vb,start){\r\n\t\t\tvar indices,i=0;\r\n\t\t\tvar tArray=this._points;\r\n\t\t\tvar tLen=0;\r\n\t\t\tif (this.mUint16Array && this.mFloat32Array&&this._repaint){\r\n\t\t\t\tif (this._start !=start){\r\n\t\t\t\t\tthis._start=start;\r\n\t\t\t\t\tindices=[];\r\n\t\t\t\t\ttLen=Math.floor(tArray.length / 2);\r\n\t\t\t\t\tfor (i=2;i < tLen;i++){\r\n\t\t\t\t\t\tindices.push(start,start+i-1,start+i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.mUint16Array=new Uint16Array(indices);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._start=start;\r\n\t\t\t\tindices=[];\r\n\t\t\t\tvar verts=[];\r\n\t\t\t\tvar color=this.color;\r\n\t\t\t\tvar r=((color >> 16)& 0x0000ff)/ 255,g=((color >> 8)& 0xff)/ 255,b=(color & 0x0000ff)/ 255;\r\n\t\t\t\ttLen=Math.floor(tArray.length / 2);\r\n\t\t\t\tfor (i=0;i < tLen;i++){\r\n\t\t\t\t\tverts.push(this.x+tArray[i *2],this.y+tArray[i *2+1],r,g,b);\r\n\t\t\t\t}\r\n\t\t\t\tfor (i=2;i < tLen;i++){\r\n\t\t\t\t\tindices.push(start,start+i-1,start+i);\r\n\t\t\t\t}\r\n\t\t\t\tthis.mUint16Array=new Uint16Array(indices);\r\n\t\t\t\tthis.mFloat32Array=new Float32Array(verts);\r\n\t\t\t}\r\n\t\t\tib.append(this.mUint16Array);\r\n\t\t\tvb.append(this.mFloat32Array);\r\n\t\t}\r\n\r\n\t\treturn Polygon;\r\n\t})(BasePoly)\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitCanvas extends laya.webgl.submit.Submit\r\n\tvar SubmitCanvas=(function(_super){\r\n\t\tfunction SubmitCanvas(){\r\n\t\t\t//this._ctx_src=null;\r\n\t\t\tthis._matrix=new Matrix();\r\n\t\t\tthis._matrix4=CONST3D2D.defaultMatrix4.concat();\r\n\t\t\tSubmitCanvas.__super.call(this,/*laya.webgl.submit.Submit.TYPE_2D*/10000);\r\n\t\t\tthis.shaderValue=new Value2D(0,0);\r\n\t\t}\r\n\r\n\t\t__class(SubmitCanvas,'laya.webgl.submit.SubmitCanvas',_super);\r\n\t\tvar __proto=SubmitCanvas.prototype;\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._ctx_src._targets){\r\n\t\t\t\tthis._ctx_src._targets.flush(this._ctx_src);\r\n\t\t\t\treturn 1;\r\n\t\t\t};\r\n\t\t\tvar preAlpha=RenderState2D.worldAlpha;\r\n\t\t\tvar preMatrix4=RenderState2D.worldMatrix4;\r\n\t\t\tvar preMatrix=RenderState2D.worldMatrix;\r\n\t\t\tvar preFilters=RenderState2D.worldFilters;\r\n\t\t\tvar preWorldShaderDefines=RenderState2D.worldShaderDefines;\r\n\t\t\tvar v=this.shaderValue;\r\n\t\t\tvar m=this._matrix;\r\n\t\t\tvar m4=this._matrix4;\r\n\t\t\tvar mout=Matrix.TEMP;\r\n\t\t\tMatrix.mul(m,preMatrix,mout);\r\n\t\t\tm4[0]=mout.a;\r\n\t\t\tm4[1]=mout.b;\r\n\t\t\tm4[4]=mout.c;\r\n\t\t\tm4[5]=mout.d;\r\n\t\t\tm4[12]=mout.tx;\r\n\t\t\tm4[13]=mout.ty;\r\n\t\t\tRenderState2D.worldMatrix=mout.clone();\r\n\t\t\tRenderState2D.worldMatrix4=m4;\r\n\t\t\tRenderState2D.worldAlpha=RenderState2D.worldAlpha *v.alpha;\r\n\t\t\tif (v.filters && v.filters.length){\r\n\t\t\t\tRenderState2D.worldFilters=v.filters;\r\n\t\t\t\tRenderState2D.worldShaderDefines=v.defines;\r\n\t\t\t}\r\n\t\t\tthis._ctx_src.flush();\r\n\t\t\tRenderState2D.worldAlpha=preAlpha;\r\n\t\t\tRenderState2D.worldMatrix4=preMatrix4;\r\n\t\t\tRenderState2D.worldMatrix.destroy();\r\n\t\t\tRenderState2D.worldMatrix=preMatrix;\r\n\t\t\tRenderState2D.worldFilters=preFilters;\r\n\t\t\tRenderState2D.worldShaderDefines=preWorldShaderDefines;\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitCanvas._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t}\r\n\r\n\t\t__proto.getRenderType=function(){\r\n\t\t\treturn /*laya.webgl.submit.Submit.TYPE_CANVAS*/10003;\r\n\t\t}\r\n\r\n\t\tSubmitCanvas.create=function(ctx_src,alpha,filters){\r\n\t\t\tvar o=(!SubmitCanvas._cache._length)? (new SubmitCanvas()):SubmitCanvas._cache[--SubmitCanvas._cache._length];\r\n\t\t\to._ctx_src=ctx_src;\r\n\t\t\tvar v=o.shaderValue;\r\n\t\t\tv.alpha=alpha;\r\n\t\t\tv.defines.setValue(0);\r\n\t\t\tfilters && filters.length && v.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitCanvas._cache=(SubmitCanvas._cache=[],SubmitCanvas._cache._length=0,SubmitCanvas._cache);\r\n\t\treturn SubmitCanvas;\r\n\t})(Submit)\r\n\r\n\r\n\t//class laya.webgl.submit.SubmitTexture extends laya.webgl.submit.Submit\r\n\tvar SubmitTexture=(function(_super){\r\n\t\tfunction SubmitTexture(renderType){\r\n\t\t\tthis._preIsSameTextureShader=false;\r\n\t\t\tthis._isSameTexture=true;\r\n\t\t\tthis._texs=new Array;\r\n\t\t\tthis._texsID=new Array;\r\n\t\t\tthis._vbPos=new Array;\r\n\t\t\t(renderType===void 0)&& (renderType=10000);\r\n\t\t\tSubmitTexture.__super.call(this,renderType);\r\n\t\t}\r\n\r\n\t\t__class(SubmitTexture,'laya.webgl.submit.SubmitTexture',_super);\r\n\t\tvar __proto=SubmitTexture.prototype;\r\n\t\t__proto.releaseRender=function(){\r\n\t\t\tvar cache=SubmitTexture._cache;\r\n\t\t\tcache[cache._length++]=this;\r\n\t\t\tthis.shaderValue.release();\r\n\t\t\tthis._preIsSameTextureShader=false;\r\n\t\t\tthis._vb=null;\r\n\t\t\tthis._texs.length=0;\r\n\t\t\tthis._vbPos.length=0;\r\n\t\t\tthis._isSameTexture=true;\r\n\t\t}\r\n\r\n\t\t__proto.addTexture=function(tex,vbpos){\r\n\t\t\tthis._texsID[this._texs.length]=tex._uvID;\r\n\t\t\tthis._texs.push(tex);\r\n\t\t\tthis._vbPos.push(vbpos);\r\n\t\t}\r\n\r\n\t\t//检查材质是否修改，修改UV，设置是否是同一材质\r\n\t\t__proto.checkTexture=function(){\r\n\t\t\tif (this._texs.length < 1){\r\n\t\t\t\tthis._isSameTexture=true;\r\n\t\t\t\treturn;\r\n\t\t\t};\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tvar webGLImg=_tex.bitmap;\r\n\t\t\tif (webGLImg===null)return;\r\n\t\t\tvar vbdata=this._vb.getFloat32Array();\r\n\t\t\tfor (var i=0,s=this._texs.length;i < s;i++){\r\n\t\t\t\tvar tex=this._texs[i];\r\n\t\t\t\ttex.active();\r\n\t\t\t\tvar newUV=tex.uv;\r\n\t\t\t\tif (this._texsID[i]!==tex._uvID){\r\n\t\t\t\t\tthis._texsID[i]=tex._uvID;\r\n\t\t\t\t\tvar vbPos=this._vbPos[i];\r\n\t\t\t\t\tvbdata[vbPos+2]=newUV[0];\r\n\t\t\t\t\tvbdata[vbPos+3]=newUV[1];\r\n\t\t\t\t\tvbdata[vbPos+6]=newUV[2];\r\n\t\t\t\t\tvbdata[vbPos+7]=newUV[3];\r\n\t\t\t\t\tvbdata[vbPos+10]=newUV[4];\r\n\t\t\t\t\tvbdata[vbPos+11]=newUV[5];\r\n\t\t\t\t\tvbdata[vbPos+14]=newUV[6];\r\n\t\t\t\t\tvbdata[vbPos+15]=newUV[7];\r\n\t\t\t\t\tthis._vb.setNeedUpload();\r\n\t\t\t\t}\r\n\t\t\t\tif (tex.bitmap!==webGLImg){\r\n\t\t\t\t\tthis._isSameTexture=false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.renderSubmit=function(){\r\n\t\t\tif (this._numEle===0){\r\n\t\t\t\tSubmitTexture._shaderSet=false;\r\n\t\t\t\treturn 1;\r\n\t\t\t};\r\n\t\t\tvar _tex=this.shaderValue.textureHost;\r\n\t\t\tif (_tex){\r\n\t\t\t\tvar source=_tex.source;\r\n\t\t\t\tif (!_tex.bitmap || !source){\r\n\t\t\t\t\tSubmitTexture._shaderSet=false;\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\tthis.shaderValue.texture=source;\r\n\t\t\t}\r\n\t\t\tthis._vb.bind_upload(this._ib);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tif (BlendMode.activeBlendFunction!==this._blendFn){\r\n\t\t\t\tgl.enable(/*laya.webgl.WebGLContext.BLEND*/0x0BE2);\r\n\t\t\t\tthis._blendFn(gl);\r\n\t\t\t\tBlendMode.activeBlendFunction=this._blendFn;\r\n\t\t\t}\r\n\t\t\tStat.drawCall++;\r\n\t\t\tStat.trianglesFaces+=this._numEle / 3;\r\n\t\t\tif (this._preIsSameTextureShader && BaseShader.activeShader && SubmitTexture._shaderSet)\r\n\t\t\t\t(BaseShader.activeShader).uploadTexture2D(this.shaderValue.texture);\r\n\t\t\telse this.shaderValue.upload();\r\n\t\t\tSubmitTexture._shaderSet=true;\r\n\t\t\tif (this._texs.length > 1 && !this._isSameTexture){\r\n\t\t\t\tvar webGLImg=_tex.bitmap;\r\n\t\t\t\tvar index=0;\r\n\t\t\t\tvar shader=BaseShader.activeShader;\r\n\t\t\t\tfor (var i=0,s=this._texs.length;i < s;i++){\r\n\t\t\t\t\tvar tex2=this._texs[i];\r\n\t\t\t\t\tif (tex2.bitmap!==webGLImg || (i+1)===s){\r\n\t\t\t\t\t\tshader.uploadTexture2D(tex2.source);\r\n\t\t\t\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,(i-index+1)*6,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx+index *6 *CONST3D2D.BYTES_PIDX);\r\n\t\t\t\t\t\twebGLImg=tex2.bitmap;\r\n\t\t\t\t\t\tindex=i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.drawElements(/*laya.webgl.WebGLContext.TRIANGLES*/0x0004,this._numEle,/*laya.webgl.WebGLContext.UNSIGNED_SHORT*/0x1403,this._startIdx);\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\tSubmitTexture.create=function(context,ib,vb,pos,sv){\r\n\t\t\tvar o=SubmitTexture._cache._length ? SubmitTexture._cache[--SubmitTexture._cache._length] :new SubmitTexture();\r\n\t\t\tif (vb==null){\r\n\t\t\t\tvb=o._selfVb || (o._selfVb=VertexBuffer2D.create(-1));\r\n\t\t\t\tvb.clear();\r\n\t\t\t\tpos=0;\r\n\t\t\t}\r\n\t\t\to._ib=ib;\r\n\t\t\to._vb=vb;\r\n\t\t\to._startIdx=pos *CONST3D2D.BYTES_PIDX;\r\n\t\t\to._numEle=0;\r\n\t\t\tvar blendType=context._nBlendType;\r\n\t\t\to._blendFn=context._targets ? BlendMode.targetFns[blendType] :BlendMode.fns[blendType];\r\n\t\t\to.shaderValue=sv;\r\n\t\t\to.shaderValue.setValue(context._shader2D);\r\n\t\t\tvar filters=context._shader2D.filters;\r\n\t\t\tfilters && o.shaderValue.setFilters(filters);\r\n\t\t\treturn o;\r\n\t\t}\r\n\r\n\t\tSubmitTexture._cache=(SubmitTexture._cache=[],SubmitTexture._cache._length=0,SubmitTexture._cache);\r\n\t\tSubmitTexture._shaderSet=true;\r\n\t\treturn SubmitTexture;\r\n\t})(Submit)\r\n\r\n\r\n\t/**\r\n\t*...\r\n\t*@author ...\r\n\t*/\r\n\t//class laya.webgl.shader.BaseShader extends laya.resource.Resource\r\n\tvar BaseShader=(function(_super){\r\n\t\tfunction BaseShader(){\r\n\t\t\tBaseShader.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(BaseShader,'laya.webgl.shader.BaseShader',_super);\r\n\t\tBaseShader.activeShader=null\r\n\t\tBaseShader.bindShader=null\r\n\t\treturn BaseShader;\r\n\t})(Resource)\r\n\r\n\r\n\t//class laya.webgl.resource.RenderTarget2D extends laya.resource.Texture\r\n\tvar RenderTarget2D=(function(_super){\r\n\t\tfunction RenderTarget2D(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\tthis._type=0;\r\n\t\t\tthis._svWidth=NaN;\r\n\t\t\tthis._svHeight=NaN;\r\n\t\t\tthis._preRenderTarget=null;\r\n\t\t\tthis._alreadyResolved=false;\r\n\t\t\tthis._looked=false;\r\n\t\t\tthis._surfaceFormat=0;\r\n\t\t\tthis._surfaceType=0;\r\n\t\t\tthis._depthStencilFormat=0;\r\n\t\t\tthis._mipMap=false;\r\n\t\t\tthis._repeat=false;\r\n\t\t\tthis._minFifter=0;\r\n\t\t\tthis._magFifter=0;\r\n\t\t\tthis._destroy=false;\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=-1);\r\n\t\t\tthis._type=1;\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis._surfaceFormat=surfaceFormat;\r\n\t\t\tthis._surfaceType=surfaceType;\r\n\t\t\tthis._depthStencilFormat=depthStencilFormat;\r\n\t\t\tthis._mipMap=mipMap;\r\n\t\t\tthis._repeat=repeat;\r\n\t\t\tthis._minFifter=minFifter;\r\n\t\t\tthis._magFifter=magFifter;\r\n\t\t\tthis._createWebGLRenderTarget();\r\n\t\t\tthis.bitmap.lock=true;\r\n\t\t\tRenderTarget2D.__super.call(this,this.bitmap,Texture.INV_UV);\r\n\t\t}\r\n\r\n\t\t__class(RenderTarget2D,'laya.webgl.resource.RenderTarget2D',_super);\r\n\t\tvar __proto=RenderTarget2D.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.resource.IDispose\":true})\r\n\t\t//TODO:临时......................................................\r\n\t\t__proto.getType=function(){\r\n\t\t\treturn this._type;\r\n\t\t}\r\n\r\n\t\t//*/\r\n\t\t__proto.getTexture=function(){\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.size=function(w,h){\r\n\t\t\tif (this._w==w && this._h==h)\r\n\t\t\t\treturn;\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tthis.release();\r\n\t\t\tif (this._w !=0 && this._h !=0)this._createWebGLRenderTarget();\r\n\t\t}\r\n\r\n\t\t__proto.release=function(){\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\r\n\t\t__proto.recycle=function(){\r\n\t\t\tRenderTarget2D.POOL.push(this);\r\n\t\t}\r\n\r\n\t\t__proto.start=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._preRenderTarget=RenderState2D.curRenderTarget;\r\n\t\t\tRenderState2D.curRenderTarget=this;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this.bitmap.frameBuffer);\r\n\t\t\tthis._alreadyResolved=false;\r\n\t\t\tif (this._type==1){\r\n\t\t\t\tgl.viewport(0,0,this._w,this._h);\r\n\t\t\t\tthis._svWidth=RenderState2D.width;\r\n\t\t\t\tthis._svHeight=RenderState2D.height;\r\n\t\t\t\tRenderState2D.width=this._w;\r\n\t\t\t\tRenderState2D.height=this._h;\r\n\t\t\t\tBaseShader.activeShader=null;\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(r,g,b,a){\r\n\t\t\t(r===void 0)&& (r=0.0);\r\n\t\t\t(g===void 0)&& (g=0.0);\r\n\t\t\t(b===void 0)&& (b=0.0);\r\n\t\t\t(a===void 0)&& (a=1.0);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.clearColor(r,g,b,a);\r\n\t\t\tvar clearFlag=/*laya.webgl.WebGLContext.COLOR_BUFFER_BIT*/0x00004000;\r\n\t\t\tswitch (this._depthStencilFormat){\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.STENCIL_INDEX8*/0x8D48:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400;\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9:\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.DEPTH_BUFFER_BIT*/0x00000100;\r\n\t\t\t\t\tclearFlag |=/*laya.webgl.WebGLContext.STENCIL_BUFFER_BIT*/0x00000400\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t\tgl.clear(clearFlag);\r\n\t\t}\r\n\r\n\t\t__proto.end=function(){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this._preRenderTarget ? this._preRenderTarget.bitmap.frameBuffer :null);\r\n\t\t\tthis._alreadyResolved=true;\r\n\t\t\tRenderState2D.curRenderTarget=this._preRenderTarget;\r\n\t\t\tif (this._type==1){\r\n\t\t\t\tgl.viewport(0,0,this._svWidth,this._svHeight);\r\n\t\t\t\tRenderState2D.width=this._svWidth;\r\n\t\t\t\tRenderState2D.height=this._svHeight;\r\n\t\t\t\tBaseShader.activeShader=null;\r\n\t\t\t}else gl.viewport(0,0,Laya.stage.width,Laya.stage.height);\r\n\t\t}\r\n\r\n\t\t__proto.getData=function(x,y,width,height){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,(this.bitmap).frameBuffer);\r\n\t\t\tvar canRead=(gl.checkFramebufferStatus(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40)===/*laya.webgl.WebGLContext.FRAMEBUFFER_COMPLETE*/0x8CD5);\r\n\t\t\tif (!canRead){\r\n\t\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\t\treturn null;\r\n\t\t\t};\r\n\t\t\tvar pixels=new Uint8Array(this._w *this._h *4);\r\n\t\t\tgl.readPixels(x,y,width,height,this._surfaceFormat,this._surfaceType,pixels);\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\treturn pixels;\r\n\t\t}\r\n\r\n\t\t/**彻底清理资源,注意会强制解锁清理*/\r\n\t\t__proto.destroy=function(foreDiposeTexture){\r\n\t\t\t(foreDiposeTexture===void 0)&& (foreDiposeTexture=false);\r\n\t\t\tif (!this._destroy){\r\n\t\t\t\tthis._loaded=false;\r\n\t\t\t\tthis.bitmap.dispose();\r\n\t\t\t\tthis.bitmap=null;\r\n\t\t\t\tthis._alreadyResolved=false;\r\n\t\t\t\tthis._destroy=true;\r\n\t\t\t\t_super.prototype.destroy.call(this);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//待测试\r\n\t\t__proto.dispose=function(){}\r\n\t\t__proto._createWebGLRenderTarget=function(){\r\n\t\t\tthis.bitmap=new WebGLRenderTarget(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter);\r\n\t\t\tthis.bitmap.activeResource();\r\n\t\t\tthis._alreadyResolved=true;\r\n\t\t\tthis._destroy=false;\r\n\t\t\tthis._loaded=true;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'surfaceFormat',function(){\r\n\t\t\treturn this._surfaceFormat;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'magFifter',function(){\r\n\t\t\treturn this._magFifter;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'surfaceType',function(){\r\n\t\t\treturn this._surfaceType;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'mipMap',function(){\r\n\t\t\treturn this._mipMap;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'depthStencilFormat',function(){\r\n\t\t\treturn this._depthStencilFormat;\r\n\t\t});\r\n\r\n\t\t//}\r\n\t\t__getset(0,__proto,'minFifter',function(){\r\n\t\t\treturn this._minFifter;\r\n\t\t});\r\n\r\n\t\t/**返回RenderTarget的Texture*/\r\n\t\t__getset(0,__proto,'source',function(){\r\n\t\t\tif (this._alreadyResolved)\r\n\t\t\t\treturn _super.prototype._$get_source.call(this);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tRenderTarget2D.create=function(w,h,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=-1);\r\n\t\t\tvar t=RenderTarget2D.POOL.pop();\r\n\t\t\tt || (t=new RenderTarget2D(w,h));\r\n\t\t\tif (!t.bitmap || t._w !=w || t._h !=h || t._surfaceFormat !=surfaceFormat || t._surfaceType !=surfaceType || t._depthStencilFormat !=depthStencilFormat || t._mipMap !=mipMap || t._repeat !=repeat || t._minFifter !=minFifter || t._magFifter !=magFifter){\r\n\t\t\t\tt._w=w;\r\n\t\t\t\tt._h=h;\r\n\t\t\t\tt._surfaceFormat=surfaceFormat;\r\n\t\t\t\tt._surfaceType=surfaceType;\r\n\t\t\t\tt._depthStencilFormat=depthStencilFormat;\r\n\t\t\t\tt._mipMap=mipMap;\r\n\t\t\t\tt._repeat=repeat;\r\n\t\t\t\tt._minFifter=minFifter;\r\n\t\t\t\tt._magFifter=magFifter;\r\n\t\t\t\tt.release();\r\n\t\t\t\tt._createWebGLRenderTarget();\r\n\t\t\t}\r\n\t\t\treturn t;\r\n\t\t}\r\n\r\n\t\tRenderTarget2D.TYPE2D=1;\r\n\t\tRenderTarget2D.TYPE3D=2;\r\n\t\tRenderTarget2D.POOL=[];\r\n\t\treturn RenderTarget2D;\r\n\t})(Texture)\r\n\r\n\r\n\t//class laya.webgl.utils.Buffer extends laya.resource.Resource\r\n\tvar Buffer=(function(_super){\r\n\t\tfunction Buffer(){\r\n\t\t\tthis._glBuffer=null;\r\n\t\t\tthis._buffer=null;\r\n\t\t\tthis._bufferType=0;\r\n\t\t\tthis._bufferUsage=0;\r\n\t\t\tthis._byteLength=0;\r\n\t\t\tBuffer.__super.call(this);\r\n\t\t\tBuffer._gl=WebGL.mainContext;\r\n\t\t}\r\n\r\n\t\t__class(Buffer,'laya.webgl.utils.Buffer',_super);\r\n\t\tvar __proto=Buffer.prototype;\r\n\t\t__proto._bind=function(){\r\n\t\t\tthis.activeResource();\r\n\t\t\t(Buffer._bindActive[this._bufferType]===this._glBuffer)|| (Buffer._gl.bindBuffer(this._bufferType,Buffer._bindActive[this._bufferType]=this._glBuffer),BaseShader.activeShader=null);\r\n\t\t}\r\n\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tthis._glBuffer || (this._glBuffer=Buffer._gl.createBuffer());\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._glBuffer){\r\n\t\t\t\tWebGL.mainContext.deleteBuffer(this._glBuffer);\r\n\t\t\t\tthis._glBuffer=null;\r\n\t\t\t}\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.resourceManager.removeResource(this);\r\n\t\t\t_super.prototype.dispose.call(this);\r\n\t\t}\r\n\r\n\t\t//TODO:私有\r\n\t\t__getset(0,__proto,'byteLength',function(){\r\n\t\t\treturn this._byteLength;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'bufferType',function(){\r\n\t\t\treturn this._bufferType;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'bufferUsage',function(){\r\n\t\t\treturn this._bufferUsage;\r\n\t\t});\r\n\r\n\t\tBuffer._gl=null\r\n\t\tBuffer._bindActive={};\r\n\t\treturn Buffer;\r\n\t})(Resource)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.skinAnishader.SkinSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar SkinSV=(function(_super){\r\n\t\tfunction SkinSV(type){\r\n\t\t\tthis.texcoord=null;\r\n\t\t\tthis.offsetX=300;\r\n\t\t\tthis.offsetY=0;\r\n\t\t\tSkinSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.SKINMESH*/0x200,0);\r\n\t\t\tvar _vlen=8 *CONST3D2D.BYTES_PE;\r\n\t\t\tthis.position=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,0];\r\n\t\t\tthis.texcoord=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,2 *CONST3D2D.BYTES_PE];\r\n\t\t\tthis.color=[4,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,_vlen,4 *CONST3D2D.BYTES_PE];\r\n\t\t}\r\n\r\n\t\t__class(SkinSV,'laya.webgl.shader.d2.skinAnishader.SkinSV',_super);\r\n\t\treturn SkinSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.Color2dSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar Color2dSV=(function(_super){\r\n\t\tfunction Color2dSV(args){\r\n\t\t\tColor2dSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.COLOR2D*/0x02,0);\r\n\t\t\tthis.color=[];\r\n\t\t}\r\n\r\n\t\t__class(Color2dSV,'laya.webgl.shader.d2.value.Color2dSV',_super);\r\n\t\tvar __proto=Color2dSV.prototype;\r\n\t\t__proto.setValue=function(value){\r\n\t\t\tvalue.fillStyle&&(this.color=value.fillStyle._color._color);\r\n\t\t\tvalue.strokeStyle&&(this.color=value.strokeStyle._color._color);\r\n\t\t}\r\n\r\n\t\treturn Color2dSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.FillTextureSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar FillTextureSV=(function(_super){\r\n\t\tfunction FillTextureSV(type){\r\n\t\t\tthis.u_colorMatrix=null;\r\n\t\t\tthis.strength=0;\r\n\t\t\tthis.colorMat=null;\r\n\t\t\tthis.colorAlpha=null;\r\n\t\t\tthis.u_TexRange=[0,1,0,1];\r\n\t\t\tthis.u_offset=[0,0];\r\n\t\t\tthis.texcoord=Value2D._TEXCOORD;\r\n\t\t\tFillTextureSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.FILLTEXTURE*/0x100,0);\r\n\t\t}\r\n\r\n\t\t__class(FillTextureSV,'laya.webgl.shader.d2.value.FillTextureSV',_super);\r\n\t\tvar __proto=FillTextureSV.prototype;\r\n\t\t//this.color=[4,WebGLContext.FLOAT,false,_vlen,4 *CONST3D2D.BYTES_PE];\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\tthis.ALPHA=vo.ALPHA;\r\n\t\t\tvo.filters && this.setFilters(vo.filters);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.shader=null;\r\n\t\t\tthis.defines.setValue(0);\r\n\t\t}\r\n\r\n\t\treturn FillTextureSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.TextureSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar TextureSV=(function(_super){\r\n\t\tfunction TextureSV(subID){\r\n\t\t\tthis.u_colorMatrix=null;\r\n\t\t\tthis.strength=0;\r\n\t\t\tthis.colorMat=null;\r\n\t\t\tthis.colorAlpha=null;\r\n\t\t\tthis.texcoord=Value2D._TEXCOORD;\r\n\t\t\t(subID===void 0)&& (subID=0);\r\n\t\t\tTextureSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01,subID);\r\n\t\t}\r\n\r\n\t\t__class(TextureSV,'laya.webgl.shader.d2.value.TextureSV',_super);\r\n\t\tvar __proto=TextureSV.prototype;\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\tthis.ALPHA=vo.ALPHA;\r\n\t\t\tvo.filters && this.setFilters(vo.filters);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis.texture=null;\r\n\t\t\tthis.shader=null;\r\n\t\t\tthis.defines.setValue(0);\r\n\t\t}\r\n\r\n\t\treturn TextureSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.PrimitiveSV extends laya.webgl.shader.d2.value.Value2D\r\n\tvar PrimitiveSV=(function(_super){\r\n\t\tfunction PrimitiveSV(args){\r\n\t\t\tthis.a_color=null;\r\n\t\t\tthis.u_pos=[0,0];\r\n\t\t\tPrimitiveSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.PRIMITIVE*/0x04,0);\r\n\t\t\tthis.position=[2,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,5 *CONST3D2D.BYTES_PE,0];\r\n\t\t\tthis.a_color=[3,/*laya.webgl.WebGLContext.FLOAT*/0x1406,false,5 *CONST3D2D.BYTES_PE,2 *CONST3D2D.BYTES_PE];\r\n\t\t}\r\n\r\n\t\t__class(PrimitiveSV,'laya.webgl.shader.d2.value.PrimitiveSV',_super);\r\n\t\treturn PrimitiveSV;\r\n\t})(Value2D)\r\n\r\n\r\n\t//class laya.webgl.atlas.AtlasWebGLCanvas extends laya.resource.Bitmap\r\n\tvar AtlasWebGLCanvas=(function(_super){\r\n\t\tfunction AtlasWebGLCanvas(){\r\n\t\t\tthis._flashCacheImage=null;\r\n\t\t\tthis._flashCacheImageNeedFlush=false;\r\n\t\t\tAtlasWebGLCanvas.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(AtlasWebGLCanvas,'laya.webgl.atlas.AtlasWebGLCanvas',_super);\r\n\t\tvar __proto=AtlasWebGLCanvas.prototype;\r\n\t\t/***重新创建资源*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar glTex=this._source=gl.createTexture();\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,null);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t/***销毁资源*/\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._source){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**采样image到WebGLTexture的一部分*/\r\n\t\t__proto.texSubImage2D=function(xoffset,yoffset,bitmap){\r\n\t\t\tif (!Render.isFlash){\r\n\t\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\t\t(xoffset-1 >=0)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset-1,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(xoffset+1 <=this._w)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset+1,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(yoffset-1 >=0)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset-1,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\t(yoffset+1 <=this._h)&& (gl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset+1,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap));\r\n\t\t\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,bitmap);\r\n\t\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\t\t}else {\r\n\t\t\t\tif (!this._flashCacheImage){\r\n\t\t\t\t\tthis._flashCacheImage=HTMLImage.create(null);\r\n\t\t\t\t\tthis._flashCacheImage.image.createCanvas(this._w,this._h);\r\n\t\t\t\t};\r\n\t\t\t\tvar bmData=bitmap.bitmapdata;\r\n\t\t\t\t(xoffset-1 >=0)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width-1,bmData.height,xoffset,yoffset));\r\n\t\t\t\t(xoffset+1 <=this._w)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width+1,bmData.height,xoffset,yoffset));\r\n\t\t\t\t(yoffset-1 >=0)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width,bmData.height-1,xoffset,yoffset));\r\n\t\t\t\t(yoffset+1 <=this._h)&& (this._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width+1,bmData.height,xoffset,yoffset));\r\n\t\t\t\tthis._flashCacheImage.image.copyPixels(bmData,0,0,bmData.width,bmData.height,xoffset,yoffset);\r\n\t\t\t\t(this._flashCacheImageNeedFlush)|| (this._flashCacheImageNeedFlush=true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**采样image到WebGLTexture的一部分*/\r\n\t\t__proto.texSubImage2DPixel=function(xoffset,yoffset,width,height,pixel){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\tvar pixels=new Uint8Array(pixel.data);\r\n\t\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,width,height,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,pixels);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t}\r\n\r\n\t\t/***\r\n\t\t*设置图片宽度\r\n\t\t*@param value 图片宽度\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',_super.prototype._$get_width,function(value){\r\n\t\t\tthis._w=value;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置图片高度\r\n\t\t*@param value 图片高度\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',_super.prototype._$get_height,function(value){\r\n\t\t\tthis._h=value;\r\n\t\t});\r\n\r\n\t\treturn AtlasWebGLCanvas;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLCanvas extends laya.resource.Bitmap\r\n\tvar WebGLCanvas=(function(_super){\r\n\t\tfunction WebGLCanvas(type){\r\n\t\t\t//this._ctx=null;\r\n\t\t\tthis._is2D=false;\r\n\t\t\t//this._canvas=null;\r\n\t\t\t//this.iscpuSource=false;\r\n\t\t\tvar _$this=this;\r\n\t\t\tWebGLCanvas.__super.call(this);\r\n\t\t\tthis._canvas=this;\r\n\t\t\tif (type===\"2D\" || (type===\"AUTO\" && !Render.isWebGL)){\r\n\t\t\t\tthis._is2D=true;\r\n\t\t\t\tthis._canvas=this._source=Browser.createElement(\"canvas\");\r\n\t\t\t\tthis.iscpuSource=true;\r\n\t\t\t\tvar o=this;\r\n\t\t\t\to.getContext=function (contextID,other){\r\n\t\t\t\t\tif (_$this._ctx)return _$this._ctx;\r\n\t\t\t\t\tvar ctx=_$this._ctx=_$this._canvas.getContext(contextID,other);\r\n\t\t\t\t\tif (ctx){\r\n\t\t\t\t\t\tctx._canvas=o;\r\n\t\t\t\t\t\tctx.size=function (){\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ctx;\r\n\t\t\t\t}\r\n\t\t\t}else this._canvas={};\r\n\t\t}\r\n\r\n\t\t__class(WebGLCanvas,'laya.webgl.resource.WebGLCanvas',_super);\r\n\t\tvar __proto=WebGLCanvas.prototype;\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._ctx && this._ctx.clear();\r\n\t\t}\r\n\r\n\t\t__proto.destroy=function(){\r\n\t\t\tthis._ctx && this._ctx.destroy();\r\n\t\t\tthis._ctx=null;\r\n\t\t}\r\n\r\n\t\t__proto._setContext=function(context){\r\n\t\t\tthis._ctx=context;\r\n\t\t}\r\n\r\n\t\t__proto.getContext=function(contextID,other){\r\n\t\t\treturn this._ctx ? this._ctx :(this._ctx=WebGLCanvas._createContext(this));\r\n\t\t}\r\n\r\n\t\t/*override public function copyTo(dec:Bitmap):void {\r\n\t\tsuper.copyTo(dec);\r\n\t\t(dec as WebGLCanvas)._ctx=_ctx;\r\n\t}*/\r\n\r\n\r\n\t__proto.size=function(w,h){\r\n\t\tif (this._w !=w || this._h !=h){\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tthis._ctx && this._ctx.size(w,h);\r\n\t\t\tthis._canvas && (this._canvas.height=h,this._canvas.width=w);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.recreateResource=function(){\r\n\t\tthis.startCreate();\r\n\t\tthis.createWebGlTexture();\r\n\t\tthis.completeCreate();\r\n\t}\r\n\r\n\r\n\t__proto.detoryResource=function(){\r\n\t\tif (this._source && !this.iscpuSource){\r\n\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\tthis._source=null;\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.createWebGlTexture=function(){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tif (!this._canvas){\r\n\t\t\tthrow \"create GLTextur err:no data:\"+this._canvas;\r\n\t\t};\r\n\r\n\t\tvar glTex=this._source=gl.createTexture();\r\n\t\tthis.iscpuSource=false;\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,null);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\tthis._canvas=null;\r\n\t}\r\n\r\n\r\n\t__proto.texSubImage2D=function(webglCanvas,xoffset,yoffset){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\tgl.texSubImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,xoffset,yoffset,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,webglCanvas._source);\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t}\r\n\r\n\r\n\t/**\r\n\t*返回HTML Image,as3无internal货friend，通常禁止开发者修改image内的任何属性\r\n\t*@param HTML Image\r\n\t*/\r\n\t__getset(0,__proto,'canvas',function(){\r\n\t\treturn this._canvas;\r\n\t});\r\n\r\n\r\n\t__getset(0,__proto,'context',function(){\r\n\t\treturn this._ctx;\r\n\t});\r\n\r\n\r\n\t__getset(0,__proto,'asBitmap',null,function(value){\r\n\t\tthis._ctx && (this._ctx.asBitmap=value);\r\n\t});\r\n\r\n\r\n\tWebGLCanvas.create=function(type){\r\n\t\treturn new WebGLCanvas(type);\r\n\t}\r\n\r\n\r\n\tWebGLCanvas._createContext=null\r\n\treturn WebGLCanvas;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLCharImage extends laya.resource.Bitmap\r\n\tvar WebGLCharImage=(function(_super){\r\n\t\tfunction WebGLCharImage(canvas,char){\r\n\t\t\tthis.borderSize=12;\r\n\t\t\t//this._ctx=null;\r\n\t\t\t//this._allowMerageInAtlas=false;\r\n\t\t\t//this._enableMerageInAtlas=false;\r\n\t\t\t//this.canvas=null;\r\n\t\t\t//this.char=null;\r\n\t\t\tWebGLCharImage.__super.call(this);\r\n\t\t\tthis.canvas=canvas;\r\n\t\t\tthis.char=char;\r\n\t\t\tthis._enableMerageInAtlas=true;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\t/*__JS__ */this._ctx=canvas;\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ctx=canvas.getContext('2d',undefined);\r\n\t\t\t};\r\n\t\t\tvar xs=char.xs,ys=char.ys;\r\n\t\t\tvar t=null;\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\tthis._ctx.font=char.font;\r\n\t\t\t\tt=this._ctx.measureText(char.char);\r\n\t\t\t\tchar.width=t.width *xs;\r\n\t\t\t\tchar.height=t.height *ys;\r\n\t\t\t\t}else {\r\n\t\t\t\tt=Utils.measureText(char.char,char.font);\r\n\t\t\t\tchar.width=t.width *xs;\r\n\t\t\t\tchar.height=t.height *ys;\r\n\t\t\t}\r\n\t\t\tthis.onresize(char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t}\r\n\r\n\t\t__class(WebGLCharImage,'laya.webgl.resource.WebGLCharImage',_super);\r\n\t\tvar __proto=WebGLCharImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar char=this.char;\r\n\t\t\tvar bIsConchApp=Render.isConchApp;\r\n\t\t\tvar xs=char.xs,ys=char.ys;\r\n\t\t\tthis.onresize(char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t\tthis.canvas && (this.canvas.height=this._h,this.canvas.width=this._w);\r\n\t\t\tif (bIsConchApp){\r\n\t\t\t\tvar nFontSize=char.fontSize;\r\n\t\t\t\tif (xs !=1 || ys !=1){\r\n\t\t\t\t\tnFontSize=parseInt(nFontSize *((xs > ys)? xs :ys)+\"\");\r\n\t\t\t\t};\r\n\t\t\t\tvar sFont=\"normal 100 \"+nFontSize+\"px Arial\";\r\n\t\t\t\tif (char.borderColor){\r\n\t\t\t\t\tsFont+=\" 1 \"+char.borderColor;\r\n\t\t\t\t}\r\n\t\t\t\tthis._ctx.font=sFont;\r\n\t\t\t\tthis._ctx.textBaseline=\"top\";\r\n\t\t\t\tthis._ctx.fillStyle=char.fillColor;\r\n\t\t\t\tthis._ctx.fillText(char.char,this.borderSize,this.borderSize,null,null,null);\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._ctx.save();\r\n\t\t\t\t(this._ctx).clearRect(0,0,char.width+this.borderSize *2,char.height+this.borderSize *2);\r\n\t\t\t\tthis._ctx.font=char.font;\r\n\t\t\t\tthis._ctx.textBaseline=\"top\";\r\n\t\t\t\tthis._ctx.translate(this.borderSize,this.borderSize);\r\n\t\t\t\tif (xs !=1 || ys !=1){\r\n\t\t\t\t\tthis._ctx.scale(xs,ys);\r\n\t\t\t\t}\r\n\t\t\t\tif (char.fillColor && char.borderColor){\r\n\t\t\t\t\t/*__JS__ */this._ctx.strokeStyle=char.borderColor;\r\n\t\t\t\t\t/*__JS__ */this._ctx.lineWidth=char.lineWidth;\r\n\t\t\t\t\tthis._ctx.strokeText(char.char,0,0,null,null,0,null);\r\n\t\t\t\t\tthis._ctx.fillStyle=char.fillColor;\r\n\t\t\t\t\tthis._ctx.fillText(char.char,0,0,null,null,null);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tif (char.lineWidth===-1){\r\n\t\t\t\t\t\tthis._ctx.fillStyle=char.fillColor ? char.fillColor :\"white\";\r\n\t\t\t\t\t\tthis._ctx.fillText(char.char,0,0,null,null,null);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t/*__JS__ */this._ctx.strokeStyle=char.borderColor?char.borderColor:'white';\r\n\t\t\t\t\t\t/*__JS__ */this._ctx.lineWidth=char.lineWidth;\r\n\t\t\t\t\t\tthis._ctx.strokeText(char.char,0,0,null,null,0,null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis._ctx.restore();\r\n\t\t\t}\r\n\t\t\tchar.borderSize=this.borderSize;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.onresize=function(w,h){\r\n\t\t\tthis._w=w;\r\n\t\t\tthis._h=h;\r\n\t\t\tif ((this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)){\r\n\t\t\t\tthis._allowMerageInAtlas=true\r\n\t\t\t\t}else {\r\n\t\t\t\tthis._allowMerageInAtlas=false;\r\n\t\t\t\tthrow new Error(\"文字尺寸超出大图合集限制！\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.clearAtlasSource=function(){}\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\t\treturn this._allowMerageInAtlas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'atlasSource',function(){\r\n\t\t\treturn this.canvas;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source,通常禁止修改\r\n\t\t*@param value 是否创建\r\n\t\t*/\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\t\treturn this._enableMerageInAtlas;\r\n\t\t\t},function(value){\r\n\t\t\tthis._enableMerageInAtlas=value;\r\n\t\t});\r\n\r\n\t\treturn WebGLCharImage;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLRenderTarget extends laya.resource.Bitmap\r\n\tvar WebGLRenderTarget=(function(_super){\r\n\t\tfunction WebGLRenderTarget(width,height,surfaceFormat,surfaceType,depthStencilFormat,mipMap,repeat,minFifter,magFifter){\r\n\t\t\t//this._frameBuffer=null;\r\n\t\t\t//this._depthStencilBuffer=null;\r\n\t\t\t//this._surfaceFormat=0;\r\n\t\t\t//this._surfaceType=0;\r\n\t\t\t//this._depthStencilFormat=0;\r\n\t\t\t//this._mipMap=false;\r\n\t\t\t//this._repeat=false;\r\n\t\t\t//this._minFifter=0;\r\n\t\t\t//this._magFifter=0;\r\n\t\t\t(surfaceFormat===void 0)&& (surfaceFormat=/*laya.webgl.WebGLContext.RGBA*/0x1908);\r\n\t\t\t(surfaceType===void 0)&& (surfaceType=/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401);\r\n\t\t\t(depthStencilFormat===void 0)&& (depthStencilFormat=/*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9);\r\n\t\t\t(mipMap===void 0)&& (mipMap=false);\r\n\t\t\t(repeat===void 0)&& (repeat=false);\r\n\t\t\t(minFifter===void 0)&& (minFifter=-1);\r\n\t\t\t(magFifter===void 0)&& (magFifter=1);\r\n\t\t\tWebGLRenderTarget.__super.call(this);\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis._surfaceFormat=surfaceFormat;\r\n\t\t\tthis._surfaceType=surfaceType;\r\n\t\t\tthis._depthStencilFormat=depthStencilFormat;\r\n\t\t\tthis._mipMap=mipMap;\r\n\t\t\tthis._repeat=repeat;\r\n\t\t\tthis._minFifter=minFifter;\r\n\t\t\tthis._magFifter=magFifter;\r\n\t\t}\r\n\r\n\t\t__class(WebGLRenderTarget,'laya.webgl.resource.WebGLRenderTarget',_super);\r\n\t\tvar __proto=WebGLRenderTarget.prototype;\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._frameBuffer || (this._frameBuffer=gl.createFramebuffer());\r\n\t\t\tthis._source || (this._source=gl.createTexture());\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);\r\n\t\t\tvar minFifter=this._minFifter;\r\n\t\t\tvar magFifter=this._magFifter;\r\n\t\t\tvar repeat=this._repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\t\tvar isPot=Arith.isPOT(this._w,this._h);\r\n\t\t\tif (isPot){\r\n\t\t\t\tif (this._mipMap)\r\n\t\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\t\telse\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\t\tthis._mipMap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t\t}else {\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t}\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,this._frameBuffer);\r\n\t\t\tgl.framebufferTexture2D(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.COLOR_ATTACHMENT0*/0x8CE0,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,this._source,0);\r\n\t\t\tif (this._depthStencilFormat){\r\n\t\t\t\tthis._depthStencilBuffer || (this._depthStencilBuffer=gl.createRenderbuffer());\r\n\t\t\t\tgl.bindRenderbuffer(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\tgl.renderbufferStorage(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilFormat,this._w,this._h);\r\n\t\t\t\tswitch (this._depthStencilFormat){\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_COMPONENT16*/0x81A5:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.DEPTH_ATTACHMENT*/0x8D00,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.STENCIL_INDEX8*/0x8D48:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.STENCIL_ATTACHMENT*/0x8D20,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.DEPTH_STENCIL*/0x84F9:\r\n\t\t\t\t\t\tgl.framebufferRenderbuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,/*laya.webgl.WebGLContext.DEPTH_STENCIL_ATTACHMENT*/0x821A,/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,this._depthStencilBuffer);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tgl.bindFramebuffer(/*laya.webgl.WebGLContext.FRAMEBUFFER*/0x8D40,null);\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tgl.bindRenderbuffer(/*laya.webgl.WebGLContext.RENDERBUFFER*/0x8D41,null);\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis.completeCreate();\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._frameBuffer){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tWebGL.mainContext.deleteFramebuffer(this._frameBuffer);\r\n\t\t\t\tWebGL.mainContext.deleteRenderbuffer(this._depthStencilBuffer);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis._frameBuffer=null;\r\n\t\t\t\tthis._depthStencilBuffer=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'depthStencilBuffer',function(){\r\n\t\t\treturn this._depthStencilBuffer;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'frameBuffer',function(){\r\n\t\t\treturn this._frameBuffer;\r\n\t\t});\r\n\r\n\t\treturn WebGLRenderTarget;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLSubImage extends laya.resource.Bitmap\r\n\tvar WebGLSubImage=(function(_super){\r\n\t\tfunction WebGLSubImage(canvas,offsetX,offsetY,width,height,atlasImage,src,enableMerageInAtlas){\r\n\t\t\t//this._ctx=null;\r\n\t\t\t//this._allowMerageInAtlas=false;\r\n\t\t\t//this._enableMerageInAtlas=false;\r\n\t\t\t//this.canvas=null;\r\n\t\t\t//this.repeat=false;\r\n\t\t\t//this.mipmap=false;\r\n\t\t\t//this.minFifter=0;\r\n\t\t\t//this.magFifter=0;\r\n\t\t\t//this.atlasImage=null;\r\n\t\t\tthis.offsetX=0;\r\n\t\t\tthis.offsetY=0;\r\n\t\t\t//this.src=null;\r\n\t\t\t(enableMerageInAtlas===void 0)&& (enableMerageInAtlas=true);\r\n\t\t\tWebGLSubImage.__super.call(this);\r\n\t\t\tthis.repeat=true;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=-1;\r\n\t\t\tthis.magFifter=-1;\r\n\t\t\tthis.atlasImage=atlasImage;\r\n\t\t\tthis.canvas=canvas;\r\n\t\t\tthis._ctx=canvas.getContext('2d',undefined);\r\n\t\t\tthis._w=width;\r\n\t\t\tthis._h=height;\r\n\t\t\tthis.offsetX=offsetX;\r\n\t\t\tthis.offsetY=offsetY;\r\n\t\t\tthis.src=src;\r\n\t\t\tthis._enableMerageInAtlas=enableMerageInAtlas;\r\n\t\t}\r\n\r\n\t\t__class(WebGLSubImage,'laya.webgl.resource.WebGLSubImage',_super);\r\n\t\tvar __proto=WebGLSubImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t/*override public function copyTo(dec:Bitmap):void {\r\n\t\tvar d:WebGLSubImage=dec as WebGLSubImage;\r\n\t\tsuper.copyTo(dec);\r\n\t\td._ctx=_ctx;\r\n\t}*/\r\n\r\n\r\n\t__proto.size=function(w,h){\r\n\t\tthis._w=w;\r\n\t\tthis._h=h;\r\n\t\tthis._ctx && this._ctx.size(w,h);\r\n\t\tthis.canvas && (this.canvas.height=h,this.canvas.width=w);\r\n\t}\r\n\r\n\r\n\t__proto.recreateResource=function(){\r\n\t\tthis.startCreate();\r\n\t\tthis.size(this._w,this._h);\r\n\t\tthis._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h);\r\n\t\t(!(AtlasResourceManager.enabled && this._allowMerageInAtlas))&& (this.createWebGlTexture());\r\n\t\tthis.completeCreate();\r\n\t}\r\n\r\n\r\n\t__proto.createWebGlTexture=function(){\r\n\t\tvar gl=WebGL.mainContext;\r\n\t\tif (!this.canvas){\r\n\t\t\tthrow \"create GLTextur err:no data:\"+this.canvas;\r\n\t\t};\r\n\r\n\t\tvar glTex=this._source=gl.createTexture();\r\n\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,this.canvas);\r\n\t\tvar minFifter=this.minFifter;\r\n\t\tvar magFifter=this.magFifter;\r\n\t\tvar repeat=this.repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\tvar isPOT=Arith.isPOT(this.width,this.height);\r\n\t\tif (isPOT){\r\n\t\t\tif (this.mipmap)\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\telse\r\n\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\tthis.mipmap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t}else {\r\n\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t}\r\n\r\n\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\tthis.canvas=null;\r\n\t\tthis.memorySize=this._w *this._h *4;\r\n\t}\r\n\r\n\r\n\t__proto.detoryResource=function(){\r\n\t\tif (!(AtlasResourceManager.enabled && this._allowMerageInAtlas)&& this._source){\r\n\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\tthis._source=null;\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t__proto.clearAtlasSource=function(){\r\n\t\tthis.canvas=null;\r\n\t}\r\n\r\n\r\n\t__proto.dispose=function(){\r\n\t\tthis.resourceManager.removeResource(this);\r\n\t\t_super.prototype.dispose.call(this);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t*是否创建私有Source\r\n\t*@return 是否创建\r\n\t*/\r\n\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\treturn this._allowMerageInAtlas;\r\n\t});\r\n\r\n\r\n\t//public var createFromPixel:Boolean=true;\r\n\t__getset(0,__proto,'atlasSource',function(){\r\n\t\treturn this.canvas;\r\n\t});\r\n\r\n\r\n\t/**\r\n\t*是否创建私有Source,通常禁止修改\r\n\t*@param value 是否创建\r\n\t*/\r\n\t/**\r\n\t*是否创建私有Source\r\n\t*@return 是否创建\r\n\t*/\r\n\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\treturn this._allowMerageInAtlas;\r\n\t\t},function(value){\r\n\r\n\t\tthis._allowMerageInAtlas=value;\r\n\t});\r\n\r\n\r\n\treturn WebGLSubImage;\r\n\t})(Bitmap)\r\n\r\n\r\n\t//class laya.webgl.shader.Shader extends laya.webgl.shader.BaseShader\r\n\tvar Shader=(function(_super){\r\n\t\tfunction Shader(vs,ps,saveName,nameMap){\r\n\t\t\tthis.customCompile=false;\r\n\t\t\t//this._nameMap=null;\r\n\t\t\t//this._vs=null;\r\n\t\t\t//this._ps=null;\r\n\t\t\tthis._curActTexIndex=0;\r\n\t\t\t//this._reCompile=false;\r\n\t\t\tthis.tag={};\r\n\t\t\t//this._vshader=null;\r\n\t\t\t//this._pshader=null;\r\n\t\t\tthis._program=null;\r\n\t\t\tthis._params=null;\r\n\t\t\tthis._paramsMap={};\r\n\t\t\tthis._offset=0;\r\n\t\t\t//this._id=0;\r\n\t\t\tShader.__super.call(this);\r\n\t\t\tif ((!vs)|| (!ps))throw \"Shader Error\";\r\n\t\t\tif (Render.isConchApp || Render.isFlash){\r\n\t\t\t\tthis.customCompile=true;\r\n\t\t\t}\r\n\t\t\tthis._id=++Shader._count;\r\n\t\t\tthis._vs=vs;\r\n\t\t\tthis._ps=ps;\r\n\t\t\tthis._nameMap=nameMap ? nameMap :{};\r\n\t\t\tsaveName !=null && (Shader.sharders[saveName]=this);\r\n\t\t}\r\n\r\n\t\t__class(Shader,'laya.webgl.shader.Shader',_super);\r\n\t\tvar __proto=Shader.prototype;\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tthis.startCreate();\r\n\t\t\tthis._compile();\r\n\t\t\tthis.completeCreate();\r\n\t\t\tthis.memorySize=0;\r\n\t\t}\r\n\r\n\t\t//忽略尺寸尺寸\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tWebGL.mainContext.deleteShader(this._vshader);\r\n\t\t\tWebGL.mainContext.deleteShader(this._pshader);\r\n\t\t\tWebGL.mainContext.deleteProgram(this._program);\r\n\t\t\tthis._vshader=this._pshader=this._program=null;\r\n\t\t\tthis._params=null;\r\n\t\t\tthis._paramsMap={};\r\n\t\t\tthis.memorySize=0;\r\n\t\t\tthis._curActTexIndex=0;\r\n\t\t}\r\n\r\n\t\t__proto._compile=function(){\r\n\t\t\tif (!this._vs || !this._ps || this._params)\r\n\t\t\t\treturn;\r\n\t\t\tthis._reCompile=true;\r\n\t\t\tthis._params=[];\r\n\t\t\tvar text=[this._vs,this._ps];\r\n\t\t\tvar result;\r\n\t\t\tif (this.customCompile)\r\n\t\t\t\tresult=this._preGetParams(this._vs,this._ps);\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tthis._program=gl.createProgram();\r\n\t\t\tthis._vshader=Shader._createShader(gl,text[0],/*laya.webgl.WebGLContext.VERTEX_SHADER*/0x8B31);\r\n\t\t\tthis._pshader=Shader._createShader(gl,text[1],/*laya.webgl.WebGLContext.FRAGMENT_SHADER*/0x8B30);\r\n\t\t\tgl.attachShader(this._program,this._vshader);\r\n\t\t\tgl.attachShader(this._program,this._pshader);\r\n\t\t\tgl.linkProgram(this._program);\r\n\t\t\tif (!this.customCompile && !gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.LINK_STATUS*/0x8B82)){\r\n\t\t\t\tthrow gl.getProgramInfoLog(this._program);\r\n\t\t\t};\r\n\t\t\tvar one,i=0,j=0,n=0,location;\r\n\t\t\tvar attribNum=this.customCompile ? result.attributes.length :gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.ACTIVE_ATTRIBUTES*/0x8B89);\r\n\t\t\tfor (i=0;i < attribNum;i++){\r\n\t\t\t\tvar attrib=this.customCompile ? result.attributes[i] :gl.getActiveAttrib(this._program,i);\r\n\t\t\t\tlocation=gl.getAttribLocation(this._program,attrib.name);\r\n\t\t\t\tone={vartype:\"attribute\",ivartype:0,attrib:attrib,location:location,name:attrib.name,type:attrib.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};\r\n\t\t\t\tthis._params.push(one);\r\n\t\t\t};\r\n\t\t\tvar nUniformNum=this.customCompile ? result.uniforms.length :gl.getProgramParameter(this._program,/*laya.webgl.WebGLContext.ACTIVE_UNIFORMS*/0x8B86);\r\n\t\t\tfor (i=0;i < nUniformNum;i++){\r\n\t\t\t\tvar uniform=this.customCompile ? result.uniforms[i] :gl.getActiveUniform(this._program,i);\r\n\t\t\t\tlocation=gl.getUniformLocation(this._program,uniform.name);\r\n\t\t\t\tone={vartype:\"uniform\",ivartype:1,attrib:attrib,location:location,name:uniform.name,type:uniform.type,isArray:false,isSame:false,preValue:null,indexOfParams:0};\r\n\t\t\t\tif (one.name.indexOf('[0]')> 0){\r\n\t\t\t\t\tone.name=one.name.substr(0,one.name.length-3);\r\n\t\t\t\t\tone.isArray=true;\r\n\t\t\t\t\tone.location=gl.getUniformLocation(this._program,one.name);\r\n\t\t\t\t}\r\n\t\t\t\tthis._params.push(one);\r\n\t\t\t}\r\n\t\t\tfor (i=0,n=this._params.length;i < n;i++){\r\n\t\t\t\tone=this._params[i];\r\n\t\t\t\tone.indexOfParams=i;\r\n\t\t\t\tone.index=1;\r\n\t\t\t\tone.value=[one.location,null];\r\n\t\t\t\tone.codename=one.name;\r\n\t\t\t\tone.name=this._nameMap[one.codename] ? this._nameMap[one.codename] :one.codename;\r\n\t\t\t\tthis._paramsMap[one.name]=one;\r\n\t\t\t\tone._this=this;\r\n\t\t\t\tone.uploadedValue=[];\r\n\t\t\t\tif (one.vartype===\"attribute\"){\r\n\t\t\t\t\tone.fun=this._attribute;\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (one.type){\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.INT*/0x1404:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform1iv :this._uniform1i;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT*/0x1406:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform1fv :this._uniform1f;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC2*/0x8B50:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec2v:this._uniform_vec2;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC3*/0x8B51:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec3v:this._uniform_vec3;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_VEC4*/0x8B52:\r\n\t\t\t\t\t\tone.fun=one.isArray ? this._uniform_vec4v:this._uniform_vec4;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.SAMPLER_2D*/0x8B5E:\r\n\t\t\t\t\t\tone.fun=this._uniform_sampler2D;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.SAMPLER_CUBE*/0x8B60:\r\n\t\t\t\t\t\tone.fun=this._uniform_samplerCube;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT4*/0x8B5C:\r\n\t\t\t\t\t\tone.fun=this._uniformMatrix4fv;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.BOOL*/0x8B56:\r\n\t\t\t\t\t\tone.fun=this._uniform1i;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT2*/0x8B5A:\r\n\t\t\t\t\tcase /*laya.webgl.WebGLContext.FLOAT_MAT3*/0x8B5B:\r\n\t\t\t\t\t\tthrow new Error(\"compile shader err!\");\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tdefault :\r\n\t\t\t\t\t\tthrow new Error(\"compile shader err!\");\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*根据变量名字获得\r\n\t\t*@param name\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getUniform=function(name){\r\n\t\t\treturn this._paramsMap[name];\r\n\t\t}\r\n\r\n\t\t__proto._attribute=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.enableVertexAttribArray(one.location);\r\n\t\t\tgl.vertexAttribPointer(one.location,value[0],value[1],value[2],value[3],value[4]+this._offset);\r\n\t\t\treturn 2;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1f=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value){\r\n\t\t\t\tWebGL.mainContext.uniform1f(one.location,uploadedValue[0]=value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1fv=function(one,value){\r\n\t\t\tif (value.length < 4){\r\n\t\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\t\tWebGL.mainContext.uniform1fv(one.location,value);\r\n\t\t\t\t\tuploadedValue[0]=value[0];\r\n\t\t\t\t\tuploadedValue[1]=value[1];\r\n\t\t\t\t\tuploadedValue[2]=value[2];\r\n\t\t\t\t\tuploadedValue[3]=value[3];\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t\t}else {\r\n\t\t\t\tWebGL.mainContext.uniform1fv(one.location,value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec2=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){\r\n\t\t\t\tWebGL.mainContext.uniform2f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec2v=function(one,value){\r\n\t\t\tif (value.length < 2){\r\n\t\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\t\tWebGL.mainContext.uniform2fv(one.location,value);\r\n\t\t\t\t\tuploadedValue[0]=value[0];\r\n\t\t\t\t\tuploadedValue[1]=value[1];\r\n\t\t\t\t\tuploadedValue[2]=value[2];\r\n\t\t\t\t\tuploadedValue[3]=value[3];\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t\t}else {\r\n\t\t\t\tWebGL.mainContext.uniform2fv(one.location,value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){\r\n\t\t\t\tWebGL.mainContext.uniform3f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform3fv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\tWebGL.mainContext.uniform4f(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform4fv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix2fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix2fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix3fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix3fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniformMatrix4fv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniformMatrix4fv(one.location,false,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value){\r\n\t\t\t\tWebGL.mainContext.uniform1i(one.location,uploadedValue[0]=value);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform1iv=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform1iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_ivec2=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1]){\r\n\t\t\t\tWebGL.mainContext.uniform2i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_ivec2v=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform2iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2]){\r\n\t\t\t\tWebGL.mainContext.uniform3i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec3vi=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform3iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4i=function(one,value){\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]!==value[0] || uploadedValue[1]!==value[1] || uploadedValue[2]!==value[2] || uploadedValue[3]!==value[3]){\r\n\t\t\t\tWebGL.mainContext.uniform4i(one.location,uploadedValue[0]=value[0],uploadedValue[1]=value[1],uploadedValue[2]=value[2],uploadedValue[3]=value[3]);\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_vec4vi=function(one,value){\r\n\t\t\tWebGL.mainContext.uniform4iv(one.location,value);\r\n\t\t\treturn 1;\r\n\t\t}\r\n\r\n\t\t__proto._uniform_sampler2D=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]==null){\r\n\t\t\t\tuploadedValue[0]=this._curActTexIndex;\r\n\t\t\t\tgl.uniform1i(one.location,this._curActTexIndex);\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t\t\tthis._curActTexIndex++;\r\n\t\t\t\treturn 1;\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._uniform_samplerCube=function(one,value){\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar uploadedValue=one.uploadedValue;\r\n\t\t\tif (uploadedValue[0]==null){\r\n\t\t\t\tuploadedValue[0]=this._curActTexIndex;\r\n\t\t\t\tgl.uniform1i(one.location,this._curActTexIndex);\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[this._curActTexIndex]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_CUBE_MAP*/0x8513,value);\r\n\t\t\t\tthis._curActTexIndex++;\r\n\t\t\t\treturn 1;\r\n\t\t\t\t}else {\r\n\t\t\t\tgl.activeTexture(Shader._TEXTURES[uploadedValue[0]]);\r\n\t\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_CUBE_MAP*/0x8513,value);\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._noSetValue=function(one){\r\n\t\t\tconsole.log(\"no....:\"+one.name);\r\n\t\t}\r\n\r\n\t\t//throw new Error(\"upload shader err,must set value:\"+one.name);\r\n\t\t__proto.uploadOne=function(name,value){\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tvar one=this._paramsMap[name];\r\n\t\t\tone.fun.call(this,one,value);\r\n\t\t}\r\n\r\n\t\t__proto.uploadTexture2D=function(value){\r\n\t\t\tStat.shaderCall++;\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tgl.activeTexture(/*laya.webgl.WebGLContext.TEXTURE0*/0x84C0);\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,value);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*提交shader到GPU\r\n\t\t*@param shaderValue\r\n\t\t*/\r\n\t\t__proto.upload=function(shaderValue,params){\r\n\t\t\tBaseShader.activeShader=this;\r\n\t\t\tBaseShader.bindShader=this;\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tif (this._reCompile){\r\n\t\t\t\tparams=this._params;\r\n\t\t\t\tthis._reCompile=false;\r\n\t\t\t\t}else {\r\n\t\t\t\tparams=params || this._params;\r\n\t\t\t};\r\n\t\t\tvar one,value,n=params.length,shaderCall=0;\r\n\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\tone=params[i];\r\n\t\t\t\t((value=shaderValue[one.name])!==null)&& (shaderCall+=one.fun.call(this,one,value));\r\n\t\t\t}\r\n\t\t\tStat.shaderCall+=shaderCall;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*按数组的定义提交\r\n\t\t*@param shaderValue 数组格式[name,value,...]\r\n\t\t*/\r\n\t\t__proto.uploadArray=function(shaderValue,length,_bufferUsage){\r\n\t\t\tBaseShader.activeShader=this;\r\n\t\t\tBaseShader.bindShader=this;\r\n\t\t\tthis.activeResource();\r\n\t\t\tWebGLContext.UseProgram(this._program);\r\n\t\t\tvar params=this._params,value;\r\n\t\t\tvar one,shaderCall=0;\r\n\t\t\tfor (var i=length-2;i >=0;i-=2){\r\n\t\t\t\tone=this._paramsMap[shaderValue[i]];\r\n\t\t\t\tif (!one)\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\tvalue=shaderValue[i+1];\r\n\t\t\t\tif (value !=null){\r\n\t\t\t\t\t_bufferUsage && _bufferUsage[one.name] && _bufferUsage[one.name].bind();\r\n\t\t\t\t\tshaderCall+=one.fun.call(this,one,value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tStat.shaderCall+=shaderCall;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*得到编译后的变量及相关预定义\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto.getParams=function(){\r\n\t\t\treturn this._params;\r\n\t\t}\r\n\r\n\t\t__proto._preGetParams=function(vs,ps){\r\n\t\t\tvar text=[vs,ps];\r\n\t\t\tvar result={};\r\n\t\t\tvar attributes=[];\r\n\t\t\tvar uniforms=[];\r\n\t\t\tvar definesInfo={};\r\n\t\t\tvar definesName=[];\r\n\t\t\tresult.attributes=attributes;\r\n\t\t\tresult.uniforms=uniforms;\r\n\t\t\tresult.defines=definesInfo;\r\n\t\t\tvar removeAnnotation=new RegExp(\"(/\\\\*([^*]|[\\\\r\\\\\\n]|(\\\\*+([^*/]|[\\\\r\\\\n])))*\\\\*+/)|(//.*)\",\"g\");\r\n\t\t\tvar reg=new RegExp(\"(\\\".*\\\")|('.*')|([#\\\\w\\\\*-\\\\.+/()=<>{}\\\\\\\\]+)|([,;:\\\\\\\\])\",\"g\");\r\n\t\t\tvar i=0,n=0,one;\r\n\t\t\tfor (var s=0;s < 2;s++){\r\n\t\t\t\ttext[s]=text[s].replace(removeAnnotation,\"\");\r\n\t\t\t\tvar words=text[s].match(reg);\r\n\t\t\t\tvar tempelse;\r\n\t\t\t\tfor (i=0,n=words.length;i < n;i++){\r\n\t\t\t\t\tvar word=words[i];\r\n\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\tif (word==\"#define\"){\r\n\t\t\t\t\t\t\tword=words[++i];\r\n\t\t\t\t\t\t\tdefinesName[word]=1;\r\n\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t}else if (word==\"#ifdef\"){\r\n\t\t\t\t\t\t\ttempelse=words[++i];\r\n\t\t\t\t\t\t\tvar def=definesInfo[tempelse]=definesInfo[tempelse] || [];\r\n\t\t\t\t\t\t\tfor (i++;i < n;i++){\r\n\t\t\t\t\t\t\t\tword=words[i];\r\n\t\t\t\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\t\t\t\tif (word==\"#else\"){\r\n\t\t\t\t\t\t\t\t\t\tfor (i++;i < n;i++){\r\n\t\t\t\t\t\t\t\t\t\t\tword=words[i];\r\n\t\t\t\t\t\t\t\t\t\t\tif (word !=\"attribute\" && word !=\"uniform\"){\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (word==\"#endif\"){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,!definesName[tempelse]);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,definesName[tempelse]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ti=this.parseOne(attributes,uniforms,words,i,word,true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t__proto.parseOne=function(attributes,uniforms,words,i,word,b){\r\n\t\t\tvar one={type:Shader.shaderParamsMap[words[i+1]],name:words[i+2],size:isNaN(parseInt(words[i+3]))? 1 :parseInt(words[i+3])};\r\n\t\t\tif (b){\r\n\t\t\t\tif (word==\"attribute\"){\r\n\t\t\t\t\tattributes.push(one);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tuniforms.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (words[i+3]==':'){\r\n\t\t\t\tone.type=words[i+4];\r\n\t\t\t\ti+=2;\r\n\t\t\t}\r\n\t\t\ti+=2;\r\n\t\t\treturn i;\r\n\t\t}\r\n\r\n\t\t__proto.dispose=function(){\r\n\t\t\tthis.resourceManager.removeResource(this);\r\n\t\t\tlaya.resource.Resource.prototype.dispose.call(this);\r\n\t\t}\r\n\r\n\t\tShader.getShader=function(name){\r\n\t\t\treturn Shader.sharders[name];\r\n\t\t}\r\n\r\n\t\tShader.create=function(vs,ps,saveName,nameMap){\r\n\t\t\treturn new Shader(vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\tShader.withCompile=function(nameID,define,shaderName,createShader){\r\n\t\t\tif (shaderName && Shader.sharders[shaderName])\r\n\t\t\t\treturn Shader.sharders[shaderName];\r\n\t\t\tvar pre=Shader._preCompileShader[0.0002 *nameID];\r\n\t\t\tif (!pre)\r\n\t\t\t\tthrow new Error(\"withCompile shader err!\"+nameID);\r\n\t\t\treturn pre.createShader(define,shaderName,createShader);\r\n\t\t}\r\n\r\n\t\tShader.withCompile2D=function(nameID,mainID,define,shaderName,createShader){\r\n\t\t\tif (shaderName && Shader.sharders[shaderName])\r\n\t\t\t\treturn Shader.sharders[shaderName];\r\n\t\t\tvar pre=Shader._preCompileShader[0.0002 *nameID+mainID];\r\n\t\t\tif (!pre)\r\n\t\t\t\tthrow new Error(\"withCompile shader err!\"+nameID+\" \"+mainID);\r\n\t\t\treturn pre.createShader(define,shaderName,createShader);\r\n\t\t}\r\n\r\n\t\tShader.addInclude=function(fileName,txt){\r\n\t\t\tif (!txt || txt.length===0)\r\n\t\t\t\tthrow new Error(\"add shader include file err:\"+fileName);\r\n\t\t\tif (Shader._includeFiles[fileName])\r\n\t\t\t\tthrow new Error(\"add shader include file err, has add:\"+fileName);\r\n\t\t\tShader._includeFiles[fileName]=txt;\r\n\t\t}\r\n\r\n\t\tShader.preCompile=function(nameID,vs,ps,nameMap){\r\n\t\t\tvar id=0.0002 *nameID;\r\n\t\t\tShader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap,Shader._includeFiles);\r\n\t\t}\r\n\r\n\t\tShader.preCompile2D=function(nameID,mainID,vs,ps,nameMap){\r\n\t\t\tvar id=0.0002 *nameID+mainID;\r\n\t\t\tShader._preCompileShader[id]=new ShaderCompile(id,vs,ps,nameMap,Shader._includeFiles);\r\n\t\t}\r\n\r\n\t\tShader._createShader=function(gl,str,type){\r\n\t\t\tvar shader=gl.createShader(type);\r\n\t\t\tgl.shaderSource(shader,str);\r\n\t\t\tgl.compileShader(shader);\r\n\t\t\tif (!gl.getShaderParameter(shader,/*laya.webgl.WebGLContext.COMPILE_STATUS*/0x8B81)){\r\n\t\t\t\tthrow gl.getShaderInfoLog(shader);\r\n\t\t\t}\r\n\t\t\treturn shader;\r\n\t\t}\r\n\r\n\t\tShader._TEXTURES=[ /*laya.webgl.WebGLContext.TEXTURE0*/0x84C0,/*laya.webgl.WebGLContext.TEXTURE1*/0x84C1,/*laya.webgl.WebGLContext.TEXTURE2*/0x84C2,/*laya.webgl.WebGLContext.TEXTURE3*/0x84C3,/*laya.webgl.WebGLContext.TEXTURE4*/0x84C4,/*laya.webgl.WebGLContext.TEXTURE5*/0x84C5,/*laya.webgl.WebGLContext.TEXTURE6*/0x84C6,,/*laya.webgl.WebGLContext.TEXTURE7*/0x84C7,/*laya.webgl.WebGLContext.TEXTURE8*/0x84C8];\r\n\t\tShader._includeFiles={};\r\n\t\tShader._count=0;\r\n\t\tShader._preCompileShader={};\r\n\t\tShader.SHADERNAME2ID=0.0002;\r\n\t\tShader.sharders=(Shader.sharders=[],Shader.sharders.length=0x20,Shader.sharders);\r\n\t\t__static(Shader,\r\n\t\t['shaderParamsMap',function(){return this.shaderParamsMap={\"float\":/*laya.webgl.WebGLContext.FLOAT*/0x1406,\"int\":/*laya.webgl.WebGLContext.INT*/0x1404,\"bool\":/*laya.webgl.WebGLContext.BOOL*/0x8B56,\"vec2\":/*laya.webgl.WebGLContext.FLOAT_VEC2*/0x8B50,\"vec3\":/*laya.webgl.WebGLContext.FLOAT_VEC3*/0x8B51,\"vec4\":/*laya.webgl.WebGLContext.FLOAT_VEC4*/0x8B52,\"ivec2\":/*laya.webgl.WebGLContext.INT_VEC2*/0x8B53,\"ivec3\":/*laya.webgl.WebGLContext.INT_VEC3*/0x8B54,\"ivec4\":/*laya.webgl.WebGLContext.INT_VEC4*/0x8B55,\"bvec2\":/*laya.webgl.WebGLContext.BOOL_VEC2*/0x8B57,\"bvec3\":/*laya.webgl.WebGLContext.BOOL_VEC3*/0x8B58,\"bvec4\":/*laya.webgl.WebGLContext.BOOL_VEC4*/0x8B59,\"mat2\":/*laya.webgl.WebGLContext.FLOAT_MAT2*/0x8B5A,\"mat3\":/*laya.webgl.WebGLContext.FLOAT_MAT3*/0x8B5B,\"mat4\":/*laya.webgl.WebGLContext.FLOAT_MAT4*/0x8B5C,\"sampler2D\":/*laya.webgl.WebGLContext.SAMPLER_2D*/0x8B5E,\"samplerCube\":/*laya.webgl.WebGLContext.SAMPLER_CUBE*/0x8B60};},'nameKey',function(){return this.nameKey=new StringKey();}\r\n\t\t]);\r\n\t\treturn Shader;\r\n\t})(BaseShader)\r\n\r\n\r\n\t//class laya.webgl.utils.Buffer2D extends laya.webgl.utils.Buffer\r\n\tvar Buffer2D=(function(_super){\r\n\t\tfunction Buffer2D(){\r\n\t\t\tthis._maxsize=0;\r\n\t\t\tthis._upload=true;\r\n\t\t\tthis._uploadSize=0;\r\n\t\t\tBuffer2D.__super.call(this);\r\n\t\t\tthis.lock=true;\r\n\t\t}\r\n\r\n\t\t__class(Buffer2D,'laya.webgl.utils.Buffer2D',_super);\r\n\t\tvar __proto=Buffer2D.prototype;\r\n\t\t__proto._bufferData=function(){\r\n\t\t\tthis._maxsize=Math.max(this._maxsize,this._byteLength);\r\n\t\t\tif (Stat.loopCount % 30==0){\r\n\t\t\t\tif (this._buffer.byteLength > (this._maxsize+64)){\r\n\t\t\t\t\tthis.memorySize=this._buffer.byteLength;\r\n\t\t\t\t\tthis._buffer=this._buffer.slice(0,this._maxsize+64);\r\n\t\t\t\t\tthis._checkArrayUse();\r\n\t\t\t\t}\r\n\t\t\t\tthis._maxsize=this._byteLength;\r\n\t\t\t}\r\n\t\t\tif (this._uploadSize < this._buffer.byteLength){\r\n\t\t\t\tthis._uploadSize=this._buffer.byteLength;\r\n\t\t\t\tBuffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);\r\n\t\t\t\tthis.memorySize=this._uploadSize;\r\n\t\t\t}\r\n\t\t\tBuffer._gl.bufferSubData(this._bufferType,0,this._buffer);\r\n\t\t}\r\n\r\n\t\t__proto._bufferSubData=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tthis._maxsize=Math.max(this._maxsize,this._byteLength);\r\n\t\t\tif (Stat.loopCount % 30==0){\r\n\t\t\t\tif (this._buffer.byteLength > (this._maxsize+64)){\r\n\t\t\t\t\tthis.memorySize=this._buffer.byteLength;\r\n\t\t\t\t\tthis._buffer=this._buffer.slice(0,this._maxsize+64);\r\n\t\t\t\t\tthis._checkArrayUse();\r\n\t\t\t\t}\r\n\t\t\t\tthis._maxsize=this._byteLength;\r\n\t\t\t}\r\n\t\t\tif (this._uploadSize < this._buffer.byteLength){\r\n\t\t\t\tthis._uploadSize=this._buffer.byteLength;\r\n\t\t\t\tBuffer._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage);\r\n\t\t\t\tthis.memorySize=this._uploadSize;\r\n\t\t\t}\r\n\t\t\tif (dataStart || dataLength){\r\n\t\t\t\tvar subBuffer=this._buffer.slice(dataStart,dataLength);\r\n\t\t\t\tBuffer._gl.bufferSubData(this._bufferType,offset,subBuffer);\r\n\t\t\t\t}else {\r\n\t\t\t\tBuffer._gl.bufferSubData(this._bufferType,offset,this._buffer);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._checkArrayUse=function(){}\r\n\t\t__proto._bind_upload=function(){\r\n\t\t\tif (!this._upload)\r\n\t\t\t\treturn false;\r\n\t\t\tthis._upload=false;\r\n\t\t\tthis._bind();\r\n\t\t\tthis._bufferData();\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._bind_subUpload=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tif (!this._upload)\r\n\t\t\t\treturn false;\r\n\t\t\tthis._upload=false;\r\n\t\t\tthis._bind();\r\n\t\t\tthis._bufferSubData(offset,dataStart,dataLength);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t__proto._resizeBuffer=function(nsz,copy){\r\n\t\t\tif (nsz < this._buffer.byteLength)\r\n\t\t\t\treturn this;\r\n\t\t\tthis.memorySize=nsz;\r\n\t\t\tif (copy && this._buffer && this._buffer.byteLength > 0){\r\n\t\t\t\tvar newbuffer=new ArrayBuffer(nsz);\r\n\t\t\t\tvar n=new Uint8Array(newbuffer);\r\n\t\t\t\tn.set(new Uint8Array(this._buffer),0);\r\n\t\t\t\tthis._buffer=newbuffer;\r\n\t\t\t}else\r\n\t\t\tthis._buffer=new ArrayBuffer(nsz);\r\n\t\t\tthis._checkArrayUse();\r\n\t\t\tthis._upload=true;\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\t__proto.append=function(data){\r\n\t\t\tthis._upload=true;\r\n\t\t\tvar byteLen=0,n;\r\n\t\t\tbyteLen=data.byteLength;\r\n\t\t\tif ((data instanceof Uint8Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Uint8Array(this._buffer,this._byteLength);\r\n\t\t\t\t}else if ((data instanceof Uint16Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Uint16Array(this._buffer,this._byteLength);\r\n\t\t\t\t}else if ((data instanceof Float32Array)){\r\n\t\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\t\tn=new Float32Array(this._buffer,this._byteLength);\r\n\t\t\t}\r\n\t\t\tn.set(data,0);\r\n\t\t\tthis._byteLength+=byteLen;\r\n\t\t\tthis._checkArrayUse();\r\n\t\t}\r\n\r\n\t\t__proto.appendEx=function(data,type){\r\n\t\t\tthis._upload=true;\r\n\t\t\tvar byteLen=0,n;\r\n\t\t\tbyteLen=data.byteLength;\r\n\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\tn=new type(this._buffer,this._byteLength);\r\n\t\t\tn.set(data,0);\r\n\t\t\tthis._byteLength+=byteLen;\r\n\t\t\tthis._checkArrayUse();\r\n\t\t}\r\n\r\n\t\t__proto.appendEx2=function(data,type,dataLen,perDataLen){\r\n\t\t\t(perDataLen===void 0)&& (perDataLen=1);\r\n\t\t\tthis._upload=true;\r\n\t\t\tvar byteLen=0,n;\r\n\t\t\tbyteLen=dataLen*perDataLen;\r\n\t\t\tthis._resizeBuffer(this._byteLength+byteLen,true);\r\n\t\t\tn=new type(this._buffer,this._byteLength);\r\n\t\t\tvar i=0;\r\n\t\t\tfor (i=0;i < dataLen;i++){\r\n\t\t\t\tn[i]=data[i];\r\n\t\t\t}\r\n\t\t\tthis._byteLength+=byteLen;\r\n\t\t\tthis._checkArrayUse();\r\n\t\t}\r\n\r\n\t\t__proto.getBuffer=function(){\r\n\t\t\treturn this._buffer;\r\n\t\t}\r\n\r\n\t\t__proto.setNeedUpload=function(){\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.getNeedUpload=function(){\r\n\t\t\treturn this._upload;\r\n\t\t}\r\n\r\n\t\t__proto.upload=function(){\r\n\t\t\tvar scuess=this._bind_upload();\r\n\t\t\tBuffer._gl.bindBuffer(this._bufferType,null);\r\n\t\t\tBuffer._bindActive[this._bufferType]=null;\r\n\t\t\tBaseShader.activeShader=null\r\n\t\t\treturn scuess;\r\n\t\t}\r\n\r\n\t\t__proto.subUpload=function(offset,dataStart,dataLength){\r\n\t\t\t(offset===void 0)&& (offset=0);\r\n\t\t\t(dataStart===void 0)&& (dataStart=0);\r\n\t\t\t(dataLength===void 0)&& (dataLength=0);\r\n\t\t\tvar scuess=this._bind_subUpload();\r\n\t\t\tBuffer._gl.bindBuffer(this._bufferType,null);\r\n\t\t\tBuffer._bindActive[this._bufferType]=null;\r\n\t\t\tBaseShader.activeShader=null\r\n\t\t\treturn scuess;\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tthis._upload=true;\r\n\t\t\tthis._uploadSize=0;\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\tthis._byteLength=0;\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'bufferLength',function(){\r\n\t\t\treturn this._buffer.byteLength;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'byteLength',_super.prototype._$get_byteLength,function(value){\r\n\t\t\tif (this._byteLength===value)\r\n\t\t\t\treturn;\r\n\t\t\tvalue <=this._buffer.byteLength || (this._resizeBuffer(value *2+256,true));\r\n\t\t\tthis._byteLength=value;\r\n\t\t});\r\n\r\n\t\tBuffer2D.__int__=function(gl){\r\n\t\t\tIndexBuffer2D.QuadrangleIB=IndexBuffer2D.create(/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\tGlUtils.fillIBQuadrangle(IndexBuffer2D.QuadrangleIB,16);\r\n\t\t}\r\n\r\n\t\tBuffer2D.FLOAT32=4;\r\n\t\tBuffer2D.SHORT=2;\r\n\t\treturn Buffer2D;\r\n\t})(Buffer)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.GlowSV extends laya.webgl.shader.d2.value.TextureSV\r\n\tvar GlowSV=(function(_super){\r\n\t\tfunction GlowSV(args){\r\n\t\t\tthis.u_blurX=false;\r\n\t\t\tthis.u_color=null;\r\n\t\t\tthis.u_offset=null;\r\n\t\t\tthis.u_strength=NaN;\r\n\t\t\tthis.u_texW=0;\r\n\t\t\tthis.u_texH=0;\r\n\t\t\tGlowSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.FILTERGLOW*/0x08| /*laya.webgl.shader.d2.ShaderDefines2D.TEXTURE2D*/0x01);\r\n\t\t}\r\n\r\n\t\t__class(GlowSV,'laya.webgl.shader.d2.value.GlowSV',_super);\r\n\t\tvar __proto=GlowSV.prototype;\r\n\t\t__proto.setValue=function(vo){\r\n\t\t\t_super.prototype.setValue.call(this,vo);\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\t_super.prototype.clear.call(this);\r\n\t\t}\r\n\r\n\t\treturn GlowSV;\r\n\t})(TextureSV)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.value.TextSV extends laya.webgl.shader.d2.value.TextureSV\r\n\tvar TextSV=(function(_super){\r\n\t\tfunction TextSV(args){\r\n\t\t\tTextSV.__super.call(this,/*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40);\r\n\t\t\tthis.defines.add(/*laya.webgl.shader.d2.ShaderDefines2D.COLORADD*/0x40);\r\n\t\t}\r\n\r\n\t\t__class(TextSV,'laya.webgl.shader.d2.value.TextSV',_super);\r\n\t\tvar __proto=TextSV.prototype;\r\n\t\t__proto.release=function(){\r\n\t\t\tTextSV.pool[TextSV._length++]=this;\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\r\n\t\t__proto.clear=function(){\r\n\t\t\t_super.prototype.clear.call(this);\r\n\t\t}\r\n\r\n\t\tTextSV.create=function(){\r\n\t\t\tif (TextSV._length)return TextSV.pool[--TextSV._length];\r\n\t\t\telse return new TextSV(null);\r\n\t\t}\r\n\r\n\t\tTextSV.pool=[];\r\n\t\tTextSV._length=0;\r\n\t\treturn TextSV;\r\n\t})(TextureSV)\r\n\r\n\r\n\t//class laya.webgl.shader.d2.Shader2X extends laya.webgl.shader.Shader\r\n\tvar Shader2X=(function(_super){\r\n\t\tfunction Shader2X(vs,ps,saveName,nameMap){\r\n\t\t\tthis._params2dQuick1=null;\r\n\t\t\tthis._params2dQuick2=null;\r\n\t\t\tthis._shaderValueWidth=NaN;\r\n\t\t\tthis._shaderValueHeight=NaN;\r\n\t\t\tShader2X.__super.call(this,vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\t__class(Shader2X,'laya.webgl.shader.d2.Shader2X',_super);\r\n\t\tvar __proto=Shader2X.prototype;\r\n\t\t__proto.upload2dQuick1=function(shaderValue){\r\n\t\t\tthis.upload(shaderValue,this._params2dQuick1 || this._make2dQuick1());\r\n\t\t}\r\n\r\n\t\t__proto._make2dQuick1=function(){\r\n\t\t\tif (!this._params2dQuick1){\r\n\t\t\t\tthis.activeResource();\r\n\t\t\t\tthis._params2dQuick1=[];\r\n\t\t\t\tvar params=this._params,one;\r\n\t\t\t\tfor (var i=0,n=params.length;i < n;i++){\r\n\t\t\t\t\tone=params[i];\r\n\t\t\t\t\tif (!Render.isFlash && (one.name===\"size\" || one.name===\"mmat\" || one.name===\"position\" || one.name===\"texcoord\"))continue ;\r\n\t\t\t\t\tthis._params2dQuick1.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this._params2dQuick1;\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tthis._params2dQuick1=null;\r\n\t\t\tthis._params2dQuick2=null;\r\n\t\t}\r\n\r\n\t\t__proto.upload2dQuick2=function(shaderValue){\r\n\t\t\tthis.upload(shaderValue,this._params2dQuick2 || this._make2dQuick2());\r\n\t\t}\r\n\r\n\t\t__proto._make2dQuick2=function(){\r\n\t\t\tif (!this._params2dQuick2){\r\n\t\t\t\tthis.activeResource();\r\n\t\t\t\tthis._params2dQuick2=[];\r\n\t\t\t\tvar params=this._params,one;\r\n\t\t\t\tfor (var i=0,n=params.length;i < n;i++){\r\n\t\t\t\t\tone=params[i];\r\n\t\t\t\t\tif (!Render.isFlash && (one.name===\"size\"))continue ;\r\n\t\t\t\t\tthis._params2dQuick2.push(one);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this._params2dQuick2;\r\n\t\t}\r\n\r\n\t\tShader2X.create=function(vs,ps,saveName,nameMap){\r\n\t\t\treturn new Shader2X(vs,ps,saveName,nameMap);\r\n\t\t}\r\n\r\n\t\treturn Shader2X;\r\n\t})(Shader)\r\n\r\n\r\n\t//class laya.webgl.utils.IndexBuffer2D extends laya.webgl.utils.Buffer2D\r\n\tvar IndexBuffer2D=(function(_super){\r\n\t\tfunction IndexBuffer2D(bufferUsage){\r\n\t\t\tthis._uint8Array=null;\r\n\t\t\tthis._uint16Array=null;\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\tIndexBuffer2D.__super.call(this);\r\n\t\t\tthis._bufferUsage=bufferUsage;\r\n\t\t\tthis._bufferType=/*laya.webgl.WebGLContext.ELEMENT_ARRAY_BUFFER*/0x8893;\r\n\t\t\tRender.isFlash || (this._buffer=new ArrayBuffer(8));\r\n\t\t}\r\n\r\n\t\t__class(IndexBuffer2D,'laya.webgl.utils.IndexBuffer2D',_super);\r\n\t\tvar __proto=IndexBuffer2D.prototype;\r\n\t\t__proto._checkArrayUse=function(){\r\n\t\t\tthis._uint8Array && (this._uint8Array=new Uint8Array(this._buffer));\r\n\t\t\tthis._uint16Array && (this._uint16Array=new Uint16Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.getUint8Array=function(){\r\n\t\t\treturn this._uint8Array || (this._uint8Array=new Uint8Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.getUint16Array=function(){\r\n\t\t\treturn this._uint16Array || (this._uint16Array=new Uint16Array(this._buffer));\r\n\t\t}\r\n\r\n\t\tIndexBuffer2D.QuadrangleIB=null\r\n\t\tIndexBuffer2D.create=function(bufferUsage){\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.STATIC_DRAW*/0x88E4);\r\n\t\t\treturn new IndexBuffer2D(bufferUsage);\r\n\t\t}\r\n\r\n\t\treturn IndexBuffer2D;\r\n\t})(Buffer2D)\r\n\r\n\r\n\t//class laya.webgl.utils.VertexBuffer2D extends laya.webgl.utils.Buffer2D\r\n\tvar VertexBuffer2D=(function(_super){\r\n\t\tfunction VertexBuffer2D(vertexStride,bufferUsage){\r\n\t\t\tthis._floatArray32=null;\r\n\t\t\tthis._vertexStride=0;\r\n\t\t\tVertexBuffer2D.__super.call(this);\r\n\t\t\tthis._vertexStride=vertexStride;\r\n\t\t\tthis._bufferUsage=bufferUsage;\r\n\t\t\tthis._bufferType=/*laya.webgl.WebGLContext.ARRAY_BUFFER*/0x8892;\r\n\t\t\tRender.isFlash || (this._buffer=new ArrayBuffer(8));\r\n\t\t\tthis.getFloat32Array();\r\n\t\t}\r\n\r\n\t\t__class(VertexBuffer2D,'laya.webgl.utils.VertexBuffer2D',_super);\r\n\t\tvar __proto=VertexBuffer2D.prototype;\r\n\t\t__proto.getFloat32Array=function(){\r\n\t\t\treturn this._floatArray32 || (this._floatArray32=new Float32Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.bind=function(ibBuffer){\r\n\t\t\t(ibBuffer)&& (ibBuffer._bind());\r\n\t\t\tthis._bind();\r\n\t\t}\r\n\r\n\t\t__proto.insertData=function(data,pos){\r\n\t\t\tvar vbdata=this.getFloat32Array();\r\n\t\t\tvbdata.set(data,pos);\r\n\t\t\tthis._upload=true;\r\n\t\t}\r\n\r\n\t\t__proto.bind_upload=function(ibBuffer){\r\n\t\t\t(ibBuffer._bind_upload())|| (ibBuffer._bind());\r\n\t\t\t(this._bind_upload())|| (this._bind());\r\n\t\t}\r\n\r\n\t\t__proto._checkArrayUse=function(){\r\n\t\t\tthis._floatArray32 && (this._floatArray32=new Float32Array(this._buffer));\r\n\t\t}\r\n\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\t_super.prototype.detoryResource.call(this);\r\n\t\t\tfor (var i=0;i < 10;i++)\r\n\t\t\tWebGL.mainContext.disableVertexAttribArray(i);\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'vertexStride',function(){\r\n\t\t\treturn this._vertexStride;\r\n\t\t});\r\n\r\n\t\tVertexBuffer2D.create=function(vertexStride,bufferUsage){\r\n\t\t\t(bufferUsage===void 0)&& (bufferUsage=/*laya.webgl.WebGLContext.DYNAMIC_DRAW*/0x88E8);\r\n\t\t\treturn new VertexBuffer2D(vertexStride,bufferUsage);\r\n\t\t}\r\n\r\n\t\treturn VertexBuffer2D;\r\n\t})(Buffer2D)\r\n\r\n\r\n\t//class laya.webgl.resource.WebGLImage extends laya.resource.HTMLImage\r\n\tvar WebGLImage=(function(_super){\r\n\t\tfunction WebGLImage(src,def){\r\n\t\t\tthis._image=null;\r\n\t\t\tthis._allowMerageInAtlas=false;\r\n\t\t\tthis._enableMerageInAtlas=false;\r\n\t\t\tthis.repeat=false;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=0;\r\n\t\t\tthis.magFifter=0;\r\n\t\t\tWebGLImage.__super.call(this,src,def);\r\n\t\t\tthis.repeat=false;\r\n\t\t\tthis.mipmap=false;\r\n\t\t\tthis.minFifter=-1;\r\n\t\t\tthis.magFifter=-1;\r\n\t\t\tif ((typeof src=='string')){\r\n\t\t\t\tthis._src=src;\r\n\t\t\t\tthis._image=new Browser.window.Image();\r\n\t\t\t\tif (def){\r\n\t\t\t\t\tdef.onload && (this.onload=def.onload);\r\n\t\t\t\t\tdef.onerror && (this.onerror=def.onerror);\r\n\t\t\t\t\tdef.onCreate && def.onCreate(this);\r\n\t\t\t\t}\r\n\t\t\t\tthis._image.crossOrigin=(src && (src.indexOf(\"data:\")==0))? null :\"\";\r\n\t\t\t\t(src)&& (this._image.src=src);\r\n\t\t\t\t}else{\r\n\t\t\t\tthis._src=def;\r\n\t\t\t\tthis._image=src[\"source\"];\r\n\t\t\t\tthis.onresize();\r\n\t\t\t}\r\n\t\t\t(src)&& (this._image.src=src);\r\n\t\t\tthis._enableMerageInAtlas=true;\r\n\t\t}\r\n\r\n\t\t__class(WebGLImage,'laya.webgl.resource.WebGLImage',_super);\r\n\t\tvar __proto=WebGLImage.prototype;\r\n\t\tLaya.imps(__proto,{\"laya.webgl.resource.IMergeAtlasBitmap\":true})\r\n\t\t__proto._init_=function(src,def){}\r\n\t\t__proto._createWebGlTexture=function(){\r\n\t\t\tif (!this._image){\r\n\t\t\t\tthrow \"create GLTextur err:no data:\"+this._image;\r\n\t\t\t};\r\n\t\t\tvar gl=WebGL.mainContext;\r\n\t\t\tvar glTex=this._source=gl.createTexture();\r\n\t\t\tvar preTarget=WebGLContext.curBindTexTarget;\r\n\t\t\tvar preTexture=WebGLContext.curBindTexValue;\r\n\t\t\tWebGLContext.bindTexture(gl,/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,glTex);\r\n\t\t\tgl.texImage2D(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,0,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.RGBA*/0x1908,/*laya.webgl.WebGLContext.UNSIGNED_BYTE*/0x1401,this._image);\r\n\t\t\tvar minFifter=this.minFifter;\r\n\t\t\tvar magFifter=this.magFifter;\r\n\t\t\tvar repeat=this.repeat ? /*laya.webgl.WebGLContext.REPEAT*/0x2901 :/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F;\r\n\t\t\tvar isPot=Arith.isPOT(this._w,this._h);\r\n\t\t\tif (isPot){\r\n\t\t\t\tif (this.mipmap)\r\n\t\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR_MIPMAP_LINEAR*/0x2703);\r\n\t\t\t\telse\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,repeat);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,repeat);\r\n\t\t\t\tthis.mipmap && gl.generateMipmap(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1);\r\n\t\t\t\t}else {\r\n\t\t\t\t(minFifter!==-1)|| (minFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\t(magFifter!==-1)|| (magFifter=/*laya.webgl.WebGLContext.LINEAR*/0x2601);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MIN_FILTER*/0x2801,minFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_MAG_FILTER*/0x2800,magFifter);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_S*/0x2802,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t\tgl.texParameteri(/*laya.webgl.WebGLContext.TEXTURE_2D*/0x0DE1,/*laya.webgl.WebGLContext.TEXTURE_WRAP_T*/0x2803,/*laya.webgl.WebGLContext.CLAMP_TO_EDGE*/0x812F);\r\n\t\t\t}\r\n\t\t\t(preTarget && preTexture)&& (WebGLContext.bindTexture(gl,preTarget,preTexture));\r\n\t\t\tthis._image.onload=null;\r\n\t\t\tthis._image=null;\r\n\t\t\tif (isPot)\r\n\t\t\t\tthis.memorySize=this._w *this._h *4 *(1+1 / 3);\r\n\t\t\telse\r\n\t\t\tthis.memorySize=this._w *this._h *4;\r\n\t\t\tthis._recreateLock=false;\r\n\t\t}\r\n\r\n\t\t/***重新创建资源，如果异步创建中被强制释放再创建，则需等待释放完成后再重新加载创建。*/\r\n\t\t__proto.recreateResource=function(){\r\n\t\t\tvar _$this=this;\r\n\t\t\tif (this._src==null || this._src===\"\")\r\n\t\t\t\treturn;\r\n\t\t\tthis._needReleaseAgain=false;\r\n\t\t\tif (!this._image){\r\n\t\t\t\tthis._recreateLock=true;\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\tvar _this=this;\r\n\t\t\t\tthis._image=new Browser.window.Image();\r\n\t\t\t\tthis._image.crossOrigin=this._src.indexOf(\"data:\")==0 ? null :\"\";\r\n\t\t\t\tthis._image.onload=function (){\r\n\t\t\t\t\tif (_this._needReleaseAgain){\r\n\t\t\t\t\t\t_this._needReleaseAgain=false;\r\n\t\t\t\t\t\t_this._image.onload=null;\r\n\t\t\t\t\t\t_this._image=null;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t(!(_this._allowMerageInAtlas && _this._enableMerageInAtlas))? (_this._createWebGlTexture()):(_$this.memorySize=0,_$this._recreateLock=false);\r\n\t\t\t\t\t_this.completeCreate();\r\n\t\t\t\t};\r\n\t\t\t\tthis._image.src=this._src;\r\n\t\t\t\t}else {\r\n\t\t\t\tif (this._recreateLock){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.startCreate();\r\n\t\t\t\t(!(this._allowMerageInAtlas && this._enableMerageInAtlas))? (this._createWebGlTexture()):(this.memorySize=0,this._recreateLock=false);\r\n\t\t\t\tthis.completeCreate();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***销毁资源*/\r\n\t\t__proto.detoryResource=function(){\r\n\t\t\tif (this._recreateLock){\r\n\t\t\t\tthis._needReleaseAgain=true;\r\n\t\t\t}\r\n\t\t\tif (this._source){\r\n\t\t\t\tWebGL.mainContext.deleteTexture(this._source);\r\n\t\t\t\tthis._source=null;\r\n\t\t\t\tthis._image=null;\r\n\t\t\t\tthis.memorySize=0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/***调整尺寸*/\r\n\t\t__proto.onresize=function(){\r\n\t\t\tthis._w=this._image.width;\r\n\t\t\tthis._h=this._image.height;\r\n\t\t\t(AtlasResourceManager.enabled)&& (this._w < AtlasResourceManager.atlasLimitWidth && this._h < AtlasResourceManager.atlasLimitHeight)? this._allowMerageInAtlas=true :this._allowMerageInAtlas=false;\r\n\t\t}\r\n\r\n\t\t__proto.clearAtlasSource=function(){\r\n\t\t\tthis._image=null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*返回HTML Image,as3无internal货friend，通常禁止开发者修改image内的任何属性\r\n\t\t*@param HTML Image\r\n\t\t*/\r\n\t\t__getset(0,__proto,'image',function(){\r\n\t\t\treturn this._image;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'allowMerageInAtlas',function(){\r\n\t\t\treturn this._allowMerageInAtlas;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'atlasSource',function(){\r\n\t\t\treturn this._image;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*是否创建私有Source,通常禁止修改\r\n\t\t*@param value 是否创建\r\n\t\t*/\r\n\t\t/**\r\n\t\t*是否创建私有Source\r\n\t\t*@return 是否创建\r\n\t\t*/\r\n\t\t__getset(0,__proto,'enableMerageInAtlas',function(){\r\n\t\t\treturn this._enableMerageInAtlas;\r\n\t\t\t},function(value){\r\n\t\t\tthis._enableMerageInAtlas=value;\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置onload函数\r\n\t\t*@param value onload函数\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onload',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onload=value;\r\n\t\t\tthis._image && (this._image.onload=this._onload !=null ? (function(){\r\n\t\t\t\t_$this.onresize();\r\n\t\t\t\t_$this._onload();\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\t/***\r\n\t\t*设置onerror函数\r\n\t\t*@param value onerror函数\r\n\t\t*/\r\n\t\t__getset(0,__proto,'onerror',null,function(value){\r\n\t\t\tvar _$this=this;\r\n\t\t\tthis._onerror=value;\r\n\t\t\tthis._image && (this._image.onerror=this._onerror !=null ? (function(){\r\n\t\t\t\t_$this._onerror()\r\n\t\t\t}):null);\r\n\t\t});\r\n\r\n\t\treturn WebGLImage;\r\n\t})(HTMLImage)\r\n\r\n\r\n\tLaya.__init([DrawText,AtlasGrid,WebGLContext2D,RenderTargetMAX,ShaderCompile]);\r\n})(window,document,Laya);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/libs/laya.webgl.js\n// module id = 32\n// module chunks = 3","\r\n(function(window,document,Laya){\r\n\tvar __un=Laya.un,__uns=Laya.uns,__static=Laya.static,__class=Laya.class,__getset=Laya.getset,__newvec=Laya.__newvec;\r\n\r\n\tvar Browser=laya.utils.Browser,CSSStyle=laya.display.css.CSSStyle,ClassUtils=laya.utils.ClassUtils;\r\n\tvar Event=laya.events.Event,HTMLChar=laya.utils.HTMLChar,Loader=laya.net.Loader,Node=laya.display.Node,Rectangle=laya.maths.Rectangle;\r\n\tvar Render=laya.renders.Render,RenderContext=laya.renders.RenderContext,RenderSprite=laya.renders.RenderSprite;\r\n\tvar Sprite=laya.display.Sprite,Stat=laya.utils.Stat,Texture=laya.resource.Texture,URL=laya.net.URL,Utils=laya.utils.Utils;\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.utils.HTMLParse\r\n\tvar HTMLParse=(function(){\r\n\t\tfunction HTMLParse(){};\r\n\t\t__class(HTMLParse,'laya.html.utils.HTMLParse');\r\n\t\tHTMLParse.parse=function(ower,xmlString,url){\r\n\t\t\txmlString=xmlString.replace(/<br>/g,\"<br/>\");\r\n\t\t\txmlString=\"<root>\"+xmlString+\"</root>\";\r\n\t\t\txmlString=xmlString.replace(HTMLParse.spacePattern,HTMLParse.char255);\r\n\t\t\tvar xml=Utils.parseXMLFromString(xmlString);\r\n\t\t\tHTMLParse._parseXML(ower,xml.childNodes[0].childNodes,url);\r\n\t\t}\r\n\r\n\t\tHTMLParse._parseXML=function(parent,xml,url,href){\r\n\t\t\tvar i=0,n=0;\r\n\t\t\tif (xml.join || xml.item){\r\n\t\t\t\tfor (i=0,n=xml.length;i < n;++i){\r\n\t\t\t\t\tHTMLParse._parseXML(parent,xml[i],url,href);\r\n\t\t\t\t}\r\n\t\t\t\t}else {\r\n\t\t\t\tvar node;\r\n\t\t\t\tvar nodeName;\r\n\t\t\t\tif (xml.nodeType==3){\r\n\t\t\t\t\tvar txt;\r\n\t\t\t\t\tif ((parent instanceof laya.html.dom.HTMLDivElement )){\r\n\t\t\t\t\t\tif (xml.nodeName==null){\r\n\t\t\t\t\t\t\txml.nodeName=\"#text\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnodeName=xml.nodeName.toLowerCase();\r\n\t\t\t\t\t\ttxt=xml.textContent.replace(/^\\s+|\\s+$/g,'');\r\n\t\t\t\t\t\tif (txt.length > 0){\r\n\t\t\t\t\t\t\tnode=ClassUtils.getInstance(nodeName);\r\n\t\t\t\t\t\t\tif (node){\r\n\t\t\t\t\t\t\t\tparent.addChild(node);\r\n\t\t\t\t\t\t\t\t((node).innerTEXT=txt.replace(HTMLParse.char255AndOneSpacePattern,\" \"));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\ttxt=xml.textContent.replace(/^\\s+|\\s+$/g,'');\r\n\t\t\t\t\t\tif (txt.length > 0){\r\n\t\t\t\t\t\t\t((parent).innerTEXT=txt.replace(HTMLParse.char255AndOneSpacePattern,\" \"));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tnodeName=xml.nodeName.toLowerCase();\r\n\t\t\t\t\tif (nodeName==\"#comment\")return;\r\n\t\t\t\t\tnode=ClassUtils.getInstance(nodeName);\r\n\t\t\t\t\tif (node){\r\n\t\t\t\t\t\tnode=parent.addChild(node);\r\n\t\t\t\t\t\t(node).URI=url;\r\n\t\t\t\t\t\t(node).href=href;\r\n\t\t\t\t\t\tvar attributes=xml.attributes;\r\n\t\t\t\t\t\tif (attributes && attributes.length > 0){\r\n\t\t\t\t\t\t\tfor (i=0,n=attributes.length;i < n;++i){\r\n\t\t\t\t\t\t\t\tvar attribute=attributes[i];\r\n\t\t\t\t\t\t\t\tvar attrName=attribute.nodeName;\r\n\t\t\t\t\t\t\t\tvar value=attribute.value;\r\n\t\t\t\t\t\t\t\tnode._setAttributes(attrName,value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tHTMLParse._parseXML(node,xml.childNodes,url,(node).href);\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tHTMLParse._parseXML(parent,xml.childNodes,url,href);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tHTMLParse.char255=String.fromCharCode(255);\r\n\t\tHTMLParse.spacePattern=/&nbsp;|&#160;/g;\r\n\t\tHTMLParse.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+\"|(\\\\s+)\",\"g\");\r\n\t\treturn HTMLParse;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*HTML的布局类\r\n\t*对HTML的显示对象进行排版\r\n\t*/\r\n\t//class laya.html.utils.Layout\r\n\tvar Layout=(function(){\r\n\t\tfunction Layout(){};\r\n\t\t__class(Layout,'laya.html.utils.Layout');\r\n\t\tLayout.later=function(element){\r\n\t\t\tif (Layout._will==null){\r\n\t\t\t\tLayout._will=[];\r\n\t\t\t\tLaya.stage.frameLoop(1,null,function(){\r\n\t\t\t\t\tif (Layout._will.length < 1)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tfor (var i=0;i < Layout._will.length;i++){\r\n\t\t\t\t\t\tlaya.html.utils.Layout.layout(Layout._will[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tLayout._will.length=0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tLayout._will.push(element);\r\n\t\t}\r\n\r\n\t\tLayout.layout=function(element){\r\n\t\t\tif ((element._style._type & /*laya.display.css.CSSStyle.ADDLAYOUTED*/0x200)===0)\r\n\t\t\t\treturn null;\r\n\t\t\telement.getStyle()._type &=~ /*laya.display.css.CSSStyle.ADDLAYOUTED*/0x200;\r\n\t\t\tvar arr=Layout._multiLineLayout(element);\r\n\t\t\tif (Render.isConchApp&&element[\"layaoutCallNative\"]){\r\n\t\t\t\t(element).layaoutCallNative();\r\n\t\t\t}\r\n\t\t\treturn arr;\r\n\t\t}\r\n\r\n\t\tLayout._multiLineLayout=function(element){\r\n\t\t\tvar elements=new Array;\r\n\t\t\telement._addChildsToLayout(elements);\r\n\t\t\tvar i=0,n=elements.length,j=0;\r\n\t\t\tvar style=element._getCSSStyle();\r\n\t\t\tvar letterSpacing=style.letterSpacing;\r\n\t\t\tvar leading=style.leading;\r\n\t\t\tvar lineHeight=style.lineHeight;\r\n\t\t\tvar widthAuto=style._widthAuto()|| !style.wordWrap;\r\n\t\t\tvar width=widthAuto ? 999999 :element.width;\r\n\t\t\tvar height=element.height;\r\n\t\t\tvar maxWidth=0;\r\n\t\t\tvar exWidth=style.italic ? style.fontSize / 3 :0;\r\n\t\t\tvar align=style._getAlign();\r\n\t\t\tvar valign=style._getValign();\r\n\t\t\tvar endAdjust=valign!==0 || align!==0 || lineHeight !=0;\r\n\t\t\tvar oneLayout;\r\n\t\t\tvar x=0;\r\n\t\t\tvar y=0;\r\n\t\t\tvar w=0;\r\n\t\t\tvar h=0;\r\n\t\t\tvar tBottom=0;\r\n\t\t\tvar lines=new Array;\r\n\t\t\tvar curStyle;\r\n\t\t\tvar curPadding;\r\n\t\t\tvar curLine=lines[0]=new LayoutLine();\r\n\t\t\tvar newLine=false,nextNewline=false;\r\n\t\t\tvar htmlWord;\r\n\t\t\tvar sprite;\r\n\t\t\tcurLine.h=0;\r\n\t\t\tif (style.italic)\r\n\t\t\t\twidth-=style.fontSize / 3;\r\n\t\t\tvar tWordWidth=0;\r\n\t\t\tvar tLineFirstKey=true;\r\n\t\t\tfunction addLine (){\r\n\t\t\t\tcurLine.y=y;\r\n\t\t\t\ty+=curLine.h+leading;\r\n\t\t\t\tcurLine.mWidth=tWordWidth;\r\n\t\t\t\ttWordWidth=0;\r\n\t\t\t\tcurLine=new LayoutLine();\r\n\t\t\t\tlines.push(curLine);\r\n\t\t\t\tcurLine.h=0;\r\n\t\t\t\tx=0;\r\n\t\t\t\ttLineFirstKey=true;\r\n\t\t\t\tnewLine=false;\r\n\t\t\t}\r\n\t\t\tfor (i=0;i < n;i++){\r\n\t\t\t\toneLayout=elements[i];\r\n\t\t\t\tif (oneLayout==null){\r\n\t\t\t\t\tif (!tLineFirstKey){\r\n\t\t\t\t\t\tx+=Layout.DIV_ELEMENT_PADDING;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurLine.wordStartIndex=curLine.elements.length;\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t}\r\n\t\t\t\ttLineFirstKey=false;\r\n\t\t\t\tif ((oneLayout instanceof laya.html.dom.HTMLBrElement )){\r\n\t\t\t\t\taddLine();\r\n\t\t\t\t\tcurLine.y=y;\r\n\t\t\t\t\tcurLine.h=lineHeight;\r\n\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t}else if (oneLayout._isChar()){\r\n\t\t\t\t\thtmlWord=oneLayout;\r\n\t\t\t\t\tif (!htmlWord.isWord){\r\n\t\t\t\t\t\tif (lines.length > 0 && (x+w)> width && curLine.wordStartIndex > 0){\r\n\t\t\t\t\t\t\tvar tLineWord=0;\r\n\t\t\t\t\t\t\ttLineWord=curLine.elements.length-curLine.wordStartIndex+1;\r\n\t\t\t\t\t\t\tcurLine.elements.length=curLine.wordStartIndex;\r\n\t\t\t\t\t\t\ti-=tLineWord;\r\n\t\t\t\t\t\t\taddLine();\r\n\t\t\t\t\t\t\tcontinue ;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnewLine=false;\r\n\t\t\t\t\t\ttWordWidth+=htmlWord.width;\r\n\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\tnewLine=nextNewline || (htmlWord.char==='\\n');\r\n\t\t\t\t\t\tcurLine.wordStartIndex=curLine.elements.length;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tw=htmlWord.width+letterSpacing;\r\n\t\t\t\t\th=htmlWord.height;\r\n\t\t\t\t\tnextNewline=false;\r\n\t\t\t\t\tnewLine=newLine || ((x+w)> width);\r\n\t\t\t\t\tnewLine && addLine();\r\n\t\t\t\t\tcurLine.minTextHeight=Math.min(curLine.minTextHeight,oneLayout.height);\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tcurStyle=oneLayout._getCSSStyle();\r\n\t\t\t\t\tsprite=oneLayout;\r\n\t\t\t\t\tcurPadding=curStyle.padding;\r\n\t\t\t\t\tcurStyle._getCssFloat()===0 || (endAdjust=true);\r\n\t\t\t\t\tnewLine=nextNewline || curStyle.lineElement;\r\n\t\t\t\t\tw=sprite.width *sprite._style._tf.scaleX+curPadding[1]+curPadding[3]+letterSpacing;\r\n\t\t\t\t\th=sprite.height *sprite._style._tf.scaleY+curPadding[0]+curPadding[2];\r\n\t\t\t\t\tnextNewline=curStyle.lineElement;\r\n\t\t\t\t\tnewLine=newLine || ((x+w)> width && curStyle.wordWrap);\r\n\t\t\t\t\tnewLine && addLine();\r\n\t\t\t\t}\r\n\t\t\t\tcurLine.elements.push(oneLayout);\r\n\t\t\t\tcurLine.h=Math.max(curLine.h,h);\r\n\t\t\t\toneLayout.x=x;\r\n\t\t\t\toneLayout.y=y;\r\n\t\t\t\tx+=w;\r\n\t\t\t\tcurLine.w=x-letterSpacing;\r\n\t\t\t\tcurLine.y=y;\r\n\t\t\t\tmaxWidth=Math.max(x+exWidth,maxWidth);\r\n\t\t\t}\r\n\t\t\ty=curLine.y+curLine.h;\r\n\t\t\tif (endAdjust){\r\n\t\t\t\tvar tY=0;\r\n\t\t\t\tvar tWidth=width;\r\n\t\t\t\tif (widthAuto && element.width > 0){\r\n\t\t\t\t\ttWidth=element.width;\r\n\t\t\t\t}\r\n\t\t\t\tfor (i=0,n=lines.length;i < n;i++){\r\n\t\t\t\t\tlines[i].updatePos(0,tWidth,i,tY,align,valign,lineHeight);\r\n\t\t\t\t\ttY+=Math.max(lineHeight,lines[i].h);\r\n\t\t\t\t}\r\n\t\t\t\ty=tY;\r\n\t\t\t}\r\n\t\t\twidthAuto && (element.width=maxWidth);\r\n\t\t\t(y > element.height)&& (element.height=y);\r\n\t\t\treturn [maxWidth,y];\r\n\t\t}\r\n\r\n\t\tLayout._will=null\r\n\t\tLayout.DIV_ELEMENT_PADDING=0;\r\n\t\treturn Layout;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.utils.LayoutLine\r\n\tvar LayoutLine=(function(){\r\n\t\tfunction LayoutLine(){\r\n\t\t\tthis.x=0;\r\n\t\t\tthis.y=0;\r\n\t\t\tthis.w=0;\r\n\t\t\tthis.h=0;\r\n\t\t\tthis.wordStartIndex=0;\r\n\t\t\tthis.minTextHeight=99999;\r\n\t\t\tthis.mWidth=0;\r\n\t\t\tthis.elements=new Array;\r\n\t\t}\r\n\r\n\t\t__class(LayoutLine,'laya.html.utils.LayoutLine');\r\n\t\tvar __proto=LayoutLine.prototype;\r\n\t\t/**\r\n\t\t*底对齐（默认）\r\n\t\t*@param left\r\n\t\t*@param width\r\n\t\t*@param dy\r\n\t\t*@param align 水平\r\n\t\t*@param valign 垂直\r\n\t\t*@param lineHeight 行高\r\n\t\t*/\r\n\t\t__proto.updatePos=function(left,width,lineNum,dy,align,valign,lineHeight){\r\n\t\t\tvar w=0;\r\n\t\t\tvar one\r\n\t\t\tif (this.elements.length > 0){\r\n\t\t\t\tone=this.elements[this.elements.length-1];\r\n\t\t\t\tw=one.x+one.width-this.elements[0].x;\r\n\t\t\t};\r\n\t\t\tvar dx=0,ddy=NaN;\r\n\t\t\talign===/*laya.display.css.CSSStyle.ALIGN_CENTER*/1 && (dx=(width-w)/ 2);\r\n\t\t\talign===/*laya.display.css.CSSStyle.ALIGN_RIGHT*/2 && (dx=(width-w));\r\n\t\t\tlineHeight===0 || valign !=0 || (valign=1);\r\n\t\t\tfor (var i=0,n=this.elements.length;i < n;i++){\r\n\t\t\t\tone=this.elements[i];\r\n\t\t\t\tvar tCSSStyle=one._getCSSStyle();\r\n\t\t\t\tdx!==0 && (one.x+=dx);\r\n\t\t\t\tswitch (tCSSStyle._getValign()){\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tone.y=dy;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.display.css.CSSStyle.VALIGN_MIDDLE*/1:;\r\n\t\t\t\t\t\tvar tMinTextHeight=0;\r\n\t\t\t\t\t\tif (this.minTextHeight !=99999){\r\n\t\t\t\t\t\t\ttMinTextHeight=this.minTextHeight;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar tBottomLineY=(tMinTextHeight+lineHeight)/ 2;\r\n\t\t\t\t\t\ttBottomLineY=Math.max(tBottomLineY,this.h);\r\n\t\t\t\t\t\tif ((one instanceof laya.html.dom.HTMLImageElement )){\r\n\t\t\t\t\t\t\tddy=dy+tBottomLineY-one.height;\r\n\t\t\t\t\t\t\t}else {\r\n\t\t\t\t\t\t\tddy=dy+tBottomLineY-one.height;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tone.y=ddy;\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\tcase /*laya.display.css.CSSStyle.VALIGN_BOTTOM*/2:\r\n\t\t\t\t\t\tone.y=dy+(lineHeight-one.height);\r\n\t\t\t\t\t\tbreak ;\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn LayoutLine;\r\n\t})()\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLElement extends laya.display.Sprite\r\n\tvar HTMLElement=(function(_super){\r\n\t\tfunction HTMLElement(){\r\n\t\t\tthis.URI=null;\r\n\t\t\tthis._href=null;\r\n\t\t\tHTMLElement.__super.call(this);\r\n\t\t\tthis._text=HTMLElement._EMPTYTEXT;\r\n\t\t\tthis.setStyle(new CSSStyle(this));\r\n\t\t\tthis._getCSSStyle().valign=\"middle\";\r\n\t\t\tthis.mouseEnabled=true;\r\n\t\t}\r\n\r\n\t\t__class(HTMLElement,'laya.html.dom.HTMLElement',_super);\r\n\t\tvar __proto=HTMLElement.prototype;\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*/\r\n\t\t__proto.layaoutCallNative=function(){\r\n\t\t\tvar n=0;\r\n\t\t\tif (this._childs &&(n=this._childs.length)> 0){\r\n\t\t\t\tfor (var i=0;i < n;i++){\r\n\t\t\t\t\tthis._childs[i].layaoutCallNative && this._childs[i].layaoutCallNative();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tvar word=this._getWords();\r\n\t\t\tword&&HTMLElement.fillWords(this,word,0,0,this.style.font,this.style.color);\r\n\t\t}\r\n\r\n\t\t__proto.appendChild=function(c){\r\n\t\t\treturn this.addChild(c);\r\n\t\t}\r\n\r\n\t\t__proto._getWords=function(){\r\n\t\t\tvar txt=this._text.text;\r\n\t\t\tif (!txt || txt.length===0)\r\n\t\t\t\treturn null;\r\n\t\t\tvar words=this._text.words;\r\n\t\t\tif (words && words.length===txt.length)\r\n\t\t\t\treturn words;\r\n\t\t\twords===null && (this._text.words=words=[]);\r\n\t\t\twords.length=txt.length;\r\n\t\t\tvar size;\r\n\t\t\tvar style=this.style;\r\n\t\t\tvar fontStr=style.font;\r\n\t\t\tvar startX=0;\r\n\t\t\tfor (var i=0,n=txt.length;i < n;i++){\r\n\t\t\t\tsize=Utils.measureText(txt.charAt(i),fontStr);\r\n\t\t\t\tvar tHTMLChar=words[i]=new HTMLChar(txt.charAt(i),size.width,size.height,style);\r\n\t\t\t\tif (this.href){\r\n\t\t\t\t\tvar tSprite=new Sprite();\r\n\t\t\t\t\tthis.addChild(tSprite);\r\n\t\t\t\t\ttHTMLChar.setSprite(tSprite);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn words;\r\n\t\t}\r\n\r\n\t\t__proto.showLinkSprite=function(){\r\n\t\t\tvar words=this._text.words;\r\n\t\t\tif (words){\r\n\t\t\t\tvar tLinkSpriteList=[];\r\n\t\t\t\tvar tSprite;\r\n\t\t\t\tvar tHtmlChar;\r\n\t\t\t\tfor (var i=0;i < words.length;i++){\r\n\t\t\t\t\ttHtmlChar=words[i];\r\n\t\t\t\t\ttSprite=new Sprite();\r\n\t\t\t\t\ttSprite.graphics.drawRect(0,0,tHtmlChar.width,tHtmlChar.height,\"#ff0000\");\r\n\t\t\t\t\ttSprite.width=tHtmlChar.width;\r\n\t\t\t\t\ttSprite.height=tHtmlChar.height;\r\n\t\t\t\t\tthis.addChild(tSprite);\r\n\t\t\t\t\ttLinkSpriteList.push(tSprite);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._layoutLater=function(){\r\n\t\t\tvar style=this.style;\r\n\t\t\tif ((style._type & /*laya.display.css.CSSStyle.ADDLAYOUTED*/0x200))return;\r\n\t\t\tif (style.widthed(this)&& (this._childs.length>0 || this._getWords()!=null)&& style.block){\r\n\t\t\t\tLayout.later(this);\r\n\t\t\t\tstyle._type |=/*laya.display.css.CSSStyle.ADDLAYOUTED*/0x200;\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.parent && (this.parent)._layoutLater();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto._setAttributes=function(name,value){\r\n\t\t\tswitch (name){\r\n\t\t\t\tcase 'style':\r\n\t\t\t\t\tthis.style.cssText(value);\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase 'class':\r\n\t\t\t\t\tthis.className=value;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t_super.prototype._setAttributes.call(this,name,value);\r\n\t\t}\r\n\r\n\t\t__proto.updateHref=function(){\r\n\t\t\tif (this._href !=null){\r\n\t\t\t\tvar words=this._getWords();\r\n\t\t\t\tif (words){\r\n\t\t\t\t\tvar tHTMLChar;\r\n\t\t\t\t\tvar tSprite;\r\n\t\t\t\t\tfor (var i=0;i < words.length;i++){\r\n\t\t\t\t\t\ttHTMLChar=words[i];\r\n\t\t\t\t\t\ttSprite=tHTMLChar.getSprite();\r\n\t\t\t\t\t\tif (tSprite){\r\n\t\t\t\t\t\t\tvar tHeight=tHTMLChar.height-1;\r\n\t\t\t\t\t\t\ttSprite.graphics.drawLine(0,tHeight,tHTMLChar.width,tHeight,tHTMLChar._getCSSStyle().color);\r\n\t\t\t\t\t\t\ttSprite.size(tHTMLChar.width,tHTMLChar.height);\r\n\t\t\t\t\t\t\ttSprite.on(/*laya.events.Event.CLICK*/\"click\",this,this.onLinkHandler);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.onLinkHandler=function(e){\r\n\t\t\tswitch(e.type){\r\n\t\t\t\tcase /*laya.events.Event.CLICK*/\"click\":;\r\n\t\t\t\t\tvar target=this;\r\n\t\t\t\t\twhile (target){\r\n\t\t\t\t\t\ttarget.event(/*laya.events.Event.LINK*/\"link\",[this.href]);\r\n\t\t\t\t\t\ttarget=target.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\t__proto.formatURL=function(url){\r\n\t\t\treturn URL.formatURL(url,this.URI ? this.URI.path :null);\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'href',function(){\r\n\t\t\treturn this._href;\r\n\t\t\t},function(url){\r\n\t\t\tthis._href=url;\r\n\t\t\tif (url !=null){\r\n\t\t\t\tthis.updateHref();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'color',null,function(value){\r\n\t\t\tthis.style.color=value;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'onClick',null,function(value){\r\n\t\t\tvar fn;\r\n\t\t\t/*__JS__ */eval(\"fn=function(event){\"+value+\";}\");\r\n\t\t\tthis.on(/*laya.events.Event.CLICK*/\"click\",this,fn);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'id',null,function(value){\r\n\t\t\tHTMLDocument.document.setElementById(value,this);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'innerTEXT',function(){\r\n\t\t\treturn this._text.text;\r\n\t\t\t},function(value){\r\n\t\t\tthis.text=value;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'style',function(){\r\n\t\t\treturn this._style;\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'text',function(){\r\n\t\t\treturn this._text.text;\r\n\t\t\t},function(value){\r\n\t\t\tif (this._text==HTMLElement._EMPTYTEXT){\r\n\t\t\t\tthis._text={text:value,words:null};\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis._text.text=value;\r\n\t\t\t\tthis._text.words && (this._text.words.length=0);\r\n\t\t\t}\r\n\t\t\tthis._renderType |=/*laya.renders.RenderSprite.CHILDS*/0x800;\r\n\t\t\tthis.repaint();\r\n\t\t\tthis.updateHref();\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'parent',_super.prototype._$get_parent,function(value){\r\n\t\t\tif ((value instanceof laya.html.dom.HTMLElement )){\r\n\t\t\t\tvar p=value;\r\n\t\t\t\tthis.URI || (this.URI=p.URI);\r\n\t\t\t\tthis.style.inherit(p.style);\r\n\t\t\t}\r\n\t\t\t_super.prototype._$set_parent.call(this,value);\r\n\t\t});\r\n\r\n\t\t__getset(0,__proto,'className',null,function(value){\r\n\t\t\tthis.style.attrs(HTMLDocument.document.styleSheets['.'+value]);\r\n\t\t});\r\n\r\n\t\tHTMLElement.fillWords=function(ele,words,x,y,font,color){\r\n\t\t\tele.graphics.clear();\r\n\t\t\tfor (var i=0,n=words.length;i < n;i++){\r\n\t\t\t\tvar a=words[i];\r\n\t\t\t\tele.graphics.fillText(a.char,a.x+x,a.y+y,font,color,'left');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tHTMLElement._EMPTYTEXT={text:null,words:null};\r\n\t\treturn HTMLElement;\r\n\t})(Sprite)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLBrElement extends laya.html.dom.HTMLElement\r\n\tvar HTMLBrElement=(function(_super){\r\n\t\tfunction HTMLBrElement(){\r\n\t\t\tHTMLBrElement.__super.call(this);\r\n\t\t\tthis.style.lineElement=true;\r\n\t\t\tthis.style.block=true;\r\n\t\t}\r\n\r\n\t\t__class(HTMLBrElement,'laya.html.dom.HTMLBrElement',_super);\r\n\t\treturn HTMLBrElement;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*DIV标签\r\n\t*/\r\n\t//class laya.html.dom.HTMLDivElement extends laya.html.dom.HTMLElement\r\n\tvar HTMLDivElement=(function(_super){\r\n\t\tfunction HTMLDivElement(){\r\n\t\t\tthis.contextHeight=NaN;\r\n\t\t\tthis.contextWidth=NaN;\r\n\t\t\tHTMLDivElement.__super.call(this);\r\n\t\t\tthis.style.block=true;\r\n\t\t\tthis.style.lineElement=true;\r\n\t\t\tthis.style.width=200;\r\n\t\t\tthis.style.height=200;\r\n\t\t\tHTMLStyleElement;\r\n\t\t}\r\n\r\n\t\t__class(HTMLDivElement,'laya.html.dom.HTMLDivElement',_super);\r\n\t\tvar __proto=HTMLDivElement.prototype;\r\n\t\t/**\r\n\t\t*追加内容，解析并对显示对象排版\r\n\t\t*@param text\r\n\t\t*/\r\n\t\t__proto.appendHTML=function(text){\r\n\t\t\tHTMLParse.parse(this,text,this.URI);\r\n\t\t\tthis.layout();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*@param out\r\n\t\t*@return\r\n\t\t*/\r\n\t\t__proto._addChildsToLayout=function(out){\r\n\t\t\tvar words=this._getWords();\r\n\t\t\tif (words==null && this._childs.length==0)return false;\r\n\t\t\twords && words.forEach(function(o){\r\n\t\t\t\tout.push(o);\r\n\t\t\t});\r\n\t\t\tvar tFirstKey=true;\r\n\t\t\tfor (var i=0,len=this._childs.length;i < len;i++){\r\n\t\t\t\tvar o=this._childs[i];\r\n\t\t\t\tif (tFirstKey){\r\n\t\t\t\t\ttFirstKey=false;\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\tout.push(null);\r\n\t\t\t\t}\r\n\t\t\t\to._addToLayout(out)\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*@param out\r\n\t\t*/\r\n\t\t__proto._addToLayout=function(out){\r\n\t\t\tthis.layout();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*@private\r\n\t\t*对显示内容进行排版\r\n\t\t*/\r\n\t\t__proto.layout=function(){\r\n\t\t\tthis.style._type |=/*laya.display.css.CSSStyle.ADDLAYOUTED*/0x200;\r\n\t\t\tvar tArray=Layout.layout(this);\r\n\t\t\tif (tArray){\r\n\t\t\t\tif (!this._$P.mHtmlBounds)this._set$P(\"mHtmlBounds\",new Rectangle());\r\n\t\t\t\tvar tRectangle=this._$P.mHtmlBounds;\r\n\t\t\t\ttRectangle.x=tRectangle.y=0;\r\n\t\t\t\ttRectangle.width=this.contextWidth=tArray[0];\r\n\t\t\t\ttRectangle.height=this.contextHeight=tArray[1];\r\n\t\t\t\tthis.setBounds(tRectangle);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t*获取对象的高\r\n\t\t*/\r\n\t\t__getset(0,__proto,'height',function(){\r\n\t\t\tif (this._height)return this._height;\r\n\t\t\treturn this.contextHeight;\r\n\t\t},_super.prototype._$set_height);\r\n\r\n\t\t/**\r\n\t\t*设置标签内容\r\n\t\t*/\r\n\t\t__getset(0,__proto,'innerHTML',null,function(text){\r\n\t\t\tthis.destroyChildren();\r\n\t\t\tthis.appendHTML(text);\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t*获取对象的宽\r\n\t\t*/\r\n\t\t__getset(0,__proto,'width',function(){\r\n\t\t\tif (this._width)return this._width;\r\n\t\t\treturn this.contextWidth;\r\n\t\t},_super.prototype._$set_width);\r\n\r\n\t\treturn HTMLDivElement;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLDocument extends laya.html.dom.HTMLElement\r\n\tvar HTMLDocument=(function(_super){\r\n\t\tfunction HTMLDocument(){\r\n\t\t\tthis.all=new Array;\r\n\t\t\tthis.styleSheets=CSSStyle.styleSheets;\r\n\t\t\tHTMLDocument.__super.call(this);\r\n\t\t}\r\n\r\n\t\t__class(HTMLDocument,'laya.html.dom.HTMLDocument',_super);\r\n\t\tvar __proto=HTMLDocument.prototype;\r\n\t\t__proto.getElementById=function(id){\r\n\t\t\treturn this.all[id];\r\n\t\t}\r\n\r\n\t\t__proto.setElementById=function(id,e){\r\n\t\t\tthis.all[id]=e;\r\n\t\t}\r\n\r\n\t\t__static(HTMLDocument,\r\n\t\t['document',function(){return this.document=new HTMLDocument();}\r\n\t\t]);\r\n\t\treturn HTMLDocument;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLImageElement extends laya.html.dom.HTMLElement\r\n\tvar HTMLImageElement=(function(_super){\r\n\t\tfunction HTMLImageElement(){\r\n\t\t\tthis._tex=null;\r\n\t\t\tthis._url=null;\r\n\t\t\tthis._renderArgs=[];\r\n\t\t\tHTMLImageElement.__super.call(this);\r\n\t\t\tthis.style.block=true;\r\n\t\t}\r\n\r\n\t\t__class(HTMLImageElement,'laya.html.dom.HTMLImageElement',_super);\r\n\t\tvar __proto=HTMLImageElement.prototype;\r\n\t\t__proto._addToLayout=function(out){\r\n\t\t\t!this._style.absolute && out.push(this);\r\n\t\t}\r\n\r\n\t\t__proto.render=function(context,x,y){\r\n\t\t\tif (!this._tex || !this._tex.loaded || !this._tex.loaded || this._width < 1 || this._height < 1)return;\r\n\t\t\tStat.spriteCount++;\r\n\t\t\tthis._renderArgs[0]=this._tex;\r\n\t\t\tthis._renderArgs[1]=this.x;\r\n\t\t\tthis._renderArgs[2]=this.y;\r\n\t\t\tthis._renderArgs[3]=this.width || this._tex.width;\r\n\t\t\tthis._renderArgs[4]=this.height || this._tex.height;\r\n\t\t\tcontext.ctx.drawTexture2(x,y,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs);\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'src',null,function(url){\r\n\t\t\tvar _$this=this;\r\n\t\t\turl=this.formatURL(url);\r\n\t\t\tif (this._url==url)return;\r\n\t\t\tthis._url=url;\r\n\t\t\tthis._tex=Loader.getRes(url)\r\n\t\t\tif (!this._tex){\r\n\t\t\t\tthis._tex=new Texture();\r\n\t\t\t\tthis._tex.load(url);\r\n\t\t\t\tLoader.cacheRes(url,this._tex);\r\n\t\t\t};\r\n\t\t\tvar tex=this._tex=Loader.getRes(url);\r\n\t\t\tif (!tex){\r\n\t\t\t\tthis._tex=tex=new Texture();\r\n\t\t\t\ttex.load(url);\r\n\t\t\t\tLoader.cacheRes(url,tex);\r\n\t\t\t}\r\n\t\t\tfunction onloaded (){\r\n\t\t\t\tvar style=_$this._style;\r\n\t\t\t\tvar w=style.widthed(_$this)?-1:_$this._tex.width;\r\n\t\t\t\tvar h=style.heighted(_$this)?-1:_$this._tex.height;\r\n\t\t\t\tif (!style.widthed(_$this)&& _$this._width !=_$this._tex.width){\r\n\t\t\t\t\t_$this.width=_$this._tex.width;\r\n\t\t\t\t\t_$this.parent && (_$this.parent)._layoutLater();\r\n\t\t\t\t}\r\n\t\t\t\tif (!style.heighted(_$this)&& _$this._height !=_$this._tex.height){\r\n\t\t\t\t\t_$this.height=_$this._tex.height;\r\n\t\t\t\t\t_$this.parent && (_$this.parent)._layoutLater();\r\n\t\t\t\t}\r\n\t\t\t\tif (Render.isConchApp){\r\n\t\t\t\t\t_$this._renderArgs[0]=_$this._tex;\r\n\t\t\t\t\t_$this._renderArgs[1]=_$this.x;\r\n\t\t\t\t\t_$this._renderArgs[2]=_$this.y;\r\n\t\t\t\t\t_$this._renderArgs[3]=_$this.width || _$this._tex.width;\r\n\t\t\t\t\t_$this._renderArgs[4]=_$this.height || _$this._tex.height;\r\n\t\t\t\t\t_$this.graphics.drawTexture(_$this._tex,0,0,_$this._renderArgs[3],_$this._renderArgs[4]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttex.loaded?onloaded():tex.on(/*laya.events.Event.LOADED*/\"loaded\",null,onloaded);\r\n\t\t});\r\n\r\n\t\treturn HTMLImageElement;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLLinkElement extends laya.html.dom.HTMLElement\r\n\tvar HTMLLinkElement=(function(_super){\r\n\t\tfunction HTMLLinkElement(){\r\n\t\t\tthis.type=null;\r\n\t\t\tHTMLLinkElement.__super.call(this);\r\n\t\t\tthis.visible=false;\r\n\t\t}\r\n\r\n\t\t__class(HTMLLinkElement,'laya.html.dom.HTMLLinkElement',_super);\r\n\t\tvar __proto=HTMLLinkElement.prototype;\r\n\t\t__proto._onload=function(data){\r\n\t\t\tswitch(this.type){\r\n\t\t\t\tcase 'text/css':\r\n\t\t\t\t\tCSSStyle.parseCSS(data,this.URI);\r\n\t\t\t\t\tbreak ;\r\n\t\t\t\t}\r\n\t\t}\r\n\r\n\t\t__getset(0,__proto,'href',_super.prototype._$get_href,function(url){\r\n\t\t\tvar _$this=this;\r\n\t\t\turl=this.formatURL(url);\r\n\t\t\tthis.URI=new URL(url);\r\n\t\t\tvar l=new Loader();\r\n\t\t\tl.once(/*laya.events.Event.COMPLETE*/\"complete\",null,function(data){\r\n\t\t\t\t_$this._onload(data);\r\n\t\t\t});\r\n\t\t\tl.load(url,/*laya.net.Loader.TEXT*/\"text\");\r\n\t\t});\r\n\r\n\t\tHTMLLinkElement._cuttingStyle=new RegExp(\"((@keyframes[\\\\s\\\\t]+|)(.+))[\\\\t\\\\n\\\\r\\\\\\s]*{\",\"g\");\r\n\t\treturn HTMLLinkElement;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*@private\r\n\t*/\r\n\t//class laya.html.dom.HTMLStyleElement extends laya.html.dom.HTMLElement\r\n\tvar HTMLStyleElement=(function(_super){\r\n\t\tfunction HTMLStyleElement(){\r\n\t\t\tHTMLStyleElement.__super.call(this);\r\n\t\t\tthis.visible=false;\r\n\t\t}\r\n\r\n\t\t__class(HTMLStyleElement,'laya.html.dom.HTMLStyleElement',_super);\r\n\t\tvar __proto=HTMLStyleElement.prototype;\r\n\t\t/**\r\n\t\t*解析样式\r\n\t\t*/\r\n\t\t__getset(0,__proto,'text',_super.prototype._$get_text,function(value){\r\n\t\t\tCSSStyle.parseCSS(value,null);\r\n\t\t});\r\n\r\n\t\treturn HTMLStyleElement;\r\n\t})(HTMLElement)\r\n\r\n\r\n\t/**\r\n\t*iframe标签类，目前用于加载外并解析数据\r\n\t*/\r\n\t//class laya.html.dom.HTMLIframeElement extends laya.html.dom.HTMLDivElement\r\n\tvar HTMLIframeElement=(function(_super){\r\n\t\tfunction HTMLIframeElement(){\r\n\t\t\tHTMLIframeElement.__super.call(this);\r\n\t\t\tthis._getCSSStyle().valign=\"middle\";\r\n\t\t}\r\n\r\n\t\t__class(HTMLIframeElement,'laya.html.dom.HTMLIframeElement',_super);\r\n\t\tvar __proto=HTMLIframeElement.prototype;\r\n\t\t/**\r\n\t\t*加载html文件，并解析数据\r\n\t\t*@param url\r\n\t\t*/\r\n\t\t__getset(0,__proto,'href',_super.prototype._$get_href,function(url){\r\n\t\t\tvar _$this=this;\r\n\t\t\turl=this.formatURL(url);\r\n\t\t\tvar l=new Loader();\r\n\t\t\tl.once(/*laya.events.Event.COMPLETE*/\"complete\",null,function(data){\r\n\t\t\t\tvar pre=_$this.URI;\r\n\t\t\t\t_$this.URI=new URL(url);\r\n\t\t\t\t_$this.innerHTML=data;\r\n\t\t\t\t!pre || (_$this.URI=pre);\r\n\t\t\t});\r\n\t\t\tl.load(url,/*laya.net.Loader.TEXT*/\"text\");\r\n\t\t});\r\n\r\n\t\treturn HTMLIframeElement;\r\n\t})(HTMLDivElement)\r\n\r\n\r\n\r\n})(window,document,Laya);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/libs/laya.html.js\n// module id = 33\n// module chunks = 3"],"sourceRoot":""}